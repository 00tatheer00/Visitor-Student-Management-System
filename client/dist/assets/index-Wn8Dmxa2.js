var cD=Object.defineProperty;var uD=(e,t,r)=>t in e?cD(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var Cg=(e,t,r)=>uD(e,typeof t!="symbol"?t+"":t,r);function fD(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in e)){const a=Object.getOwnPropertyDescriptor(n,i);a&&Object.defineProperty(e,i,a.get?a:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=r(i);fetch(i.href,a)}})();var mu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function bs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var z4={exports:{}},P1={},W4={exports:{}},wt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var J0=Symbol.for("react.element"),dD=Symbol.for("react.portal"),hD=Symbol.for("react.fragment"),pD=Symbol.for("react.strict_mode"),gD=Symbol.for("react.profiler"),mD=Symbol.for("react.provider"),xD=Symbol.for("react.context"),vD=Symbol.for("react.forward_ref"),yD=Symbol.for("react.suspense"),wD=Symbol.for("react.memo"),ED=Symbol.for("react.lazy"),_E=Symbol.iterator;function AD(e){return e===null||typeof e!="object"?null:(e=_E&&e[_E]||e["@@iterator"],typeof e=="function"?e:null)}var V4={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},H4=Object.assign,G4={};function Wc(e,t,r){this.props=e,this.context=t,this.refs=G4,this.updater=r||V4}Wc.prototype.isReactComponent={};Wc.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Wc.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function $4(){}$4.prototype=Wc.prototype;function Uv(e,t,r){this.props=e,this.context=t,this.refs=G4,this.updater=r||V4}var zv=Uv.prototype=new $4;zv.constructor=Uv;H4(zv,Wc.prototype);zv.isPureReactComponent=!0;var bE=Array.isArray,X4=Object.prototype.hasOwnProperty,Wv={current:null},K4={key:!0,ref:!0,__self:!0,__source:!0};function Y4(e,t,r){var n,i={},a=null,o=null;if(t!=null)for(n in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(a=""+t.key),t)X4.call(t,n)&&!K4.hasOwnProperty(n)&&(i[n]=t[n]);var c=arguments.length-2;if(c===1)i.children=r;else if(1<c){for(var f=Array(c),d=0;d<c;d++)f[d]=arguments[d+2];i.children=f}if(e&&e.defaultProps)for(n in c=e.defaultProps,c)i[n]===void 0&&(i[n]=c[n]);return{$$typeof:J0,type:e,key:a,ref:o,props:i,_owner:Wv.current}}function CD(e,t){return{$$typeof:J0,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Vv(e){return typeof e=="object"&&e!==null&&e.$$typeof===J0}function SD(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var TE=/\/+/g;function Sg(e,t){return typeof e=="object"&&e!==null&&e.key!=null?SD(""+e.key):t.toString(36)}function Nd(e,t,r,n,i){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(a){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case J0:case dD:o=!0}}if(o)return o=e,i=i(o),e=n===""?"."+Sg(o,0):n,bE(i)?(r="",e!=null&&(r=e.replace(TE,"$&/")+"/"),Nd(i,t,r,"",function(d){return d})):i!=null&&(Vv(i)&&(i=CD(i,r+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(TE,"$&/")+"/")+e)),t.push(i)),1;if(o=0,n=n===""?".":n+":",bE(e))for(var c=0;c<e.length;c++){a=e[c];var f=n+Sg(a,c);o+=Nd(a,t,r,f,i)}else if(f=AD(e),typeof f=="function")for(e=f.call(e),c=0;!(a=e.next()).done;)a=a.value,f=n+Sg(a,c++),o+=Nd(a,t,r,f,i);else if(a==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function zf(e,t,r){if(e==null)return e;var n=[],i=0;return Nd(e,n,"","",function(a){return t.call(r,a,i++)}),n}function _D(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Qn={current:null},Pd={transition:null},bD={ReactCurrentDispatcher:Qn,ReactCurrentBatchConfig:Pd,ReactCurrentOwner:Wv};function Z4(){throw Error("act(...) is not supported in production builds of React.")}wt.Children={map:zf,forEach:function(e,t,r){zf(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return zf(e,function(){t++}),t},toArray:function(e){return zf(e,function(t){return t})||[]},only:function(e){if(!Vv(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};wt.Component=Wc;wt.Fragment=hD;wt.Profiler=gD;wt.PureComponent=Uv;wt.StrictMode=pD;wt.Suspense=yD;wt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=bD;wt.act=Z4;wt.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=H4({},e.props),i=e.key,a=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(a=t.ref,o=Wv.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(f in t)X4.call(t,f)&&!K4.hasOwnProperty(f)&&(n[f]=t[f]===void 0&&c!==void 0?c[f]:t[f])}var f=arguments.length-2;if(f===1)n.children=r;else if(1<f){c=Array(f);for(var d=0;d<f;d++)c[d]=arguments[d+2];n.children=c}return{$$typeof:J0,type:e.type,key:i,ref:a,props:n,_owner:o}};wt.createContext=function(e){return e={$$typeof:xD,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:mD,_context:e},e.Consumer=e};wt.createElement=Y4;wt.createFactory=function(e){var t=Y4.bind(null,e);return t.type=e,t};wt.createRef=function(){return{current:null}};wt.forwardRef=function(e){return{$$typeof:vD,render:e}};wt.isValidElement=Vv;wt.lazy=function(e){return{$$typeof:ED,_payload:{_status:-1,_result:e},_init:_D}};wt.memo=function(e,t){return{$$typeof:wD,type:e,compare:t===void 0?null:t}};wt.startTransition=function(e){var t=Pd.transition;Pd.transition={};try{e()}finally{Pd.transition=t}};wt.unstable_act=Z4;wt.useCallback=function(e,t){return Qn.current.useCallback(e,t)};wt.useContext=function(e){return Qn.current.useContext(e)};wt.useDebugValue=function(){};wt.useDeferredValue=function(e){return Qn.current.useDeferredValue(e)};wt.useEffect=function(e,t){return Qn.current.useEffect(e,t)};wt.useId=function(){return Qn.current.useId()};wt.useImperativeHandle=function(e,t,r){return Qn.current.useImperativeHandle(e,t,r)};wt.useInsertionEffect=function(e,t){return Qn.current.useInsertionEffect(e,t)};wt.useLayoutEffect=function(e,t){return Qn.current.useLayoutEffect(e,t)};wt.useMemo=function(e,t){return Qn.current.useMemo(e,t)};wt.useReducer=function(e,t,r){return Qn.current.useReducer(e,t,r)};wt.useRef=function(e){return Qn.current.useRef(e)};wt.useState=function(e){return Qn.current.useState(e)};wt.useSyncExternalStore=function(e,t,r){return Qn.current.useSyncExternalStore(e,t,r)};wt.useTransition=function(){return Qn.current.useTransition()};wt.version="18.3.1";W4.exports=wt;var I=W4.exports;const rr=bs(I),TD=fD({__proto__:null,default:rr},[I]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var OD=I,kD=Symbol.for("react.element"),ID=Symbol.for("react.fragment"),ND=Object.prototype.hasOwnProperty,PD=OD.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,DD={key:!0,ref:!0,__self:!0,__source:!0};function q4(e,t,r){var n,i={},a=null,o=null;r!==void 0&&(a=""+r),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(o=t.ref);for(n in t)ND.call(t,n)&&!DD.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)i[n]===void 0&&(i[n]=t[n]);return{$$typeof:kD,type:e,key:a,ref:o,props:i,_owner:PD.current}}P1.Fragment=ID;P1.jsx=q4;P1.jsxs=q4;z4.exports=P1;var k=z4.exports,Nm={},Q4={exports:{}},Ii={},J4={exports:{}},eb={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(se,q){var fe=se.length;se.push(q);e:for(;0<fe;){var we=fe-1>>>1,G=se[we];if(0<i(G,q))se[we]=q,se[fe]=G,fe=we;else break e}}function r(se){return se.length===0?null:se[0]}function n(se){if(se.length===0)return null;var q=se[0],fe=se.pop();if(fe!==q){se[0]=fe;e:for(var we=0,G=se.length,le=G>>>1;we<le;){var ne=2*(we+1)-1,ae=se[ne],he=ne+1,ke=se[he];if(0>i(ae,fe))he<G&&0>i(ke,ae)?(se[we]=ke,se[he]=fe,we=he):(se[we]=ae,se[ne]=fe,we=ne);else if(he<G&&0>i(ke,fe))se[we]=ke,se[he]=fe,we=he;else break e}}return q}function i(se,q){var fe=se.sortIndex-q.sortIndex;return fe!==0?fe:se.id-q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var o=Date,c=o.now();e.unstable_now=function(){return o.now()-c}}var f=[],d=[],h=1,m=null,v=3,w=!1,E=!1,A=!1,S=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function _(se){for(var q=r(d);q!==null;){if(q.callback===null)n(d);else if(q.startTime<=se)n(d),q.sortIndex=q.expirationTime,t(f,q);else break;q=r(d)}}function N(se){if(A=!1,_(se),!E)if(r(f)!==null)E=!0,Ce(M);else{var q=r(d);q!==null&&ue(N,q.startTime-se)}}function M(se,q){E=!1,A&&(A=!1,b(z),z=-1),w=!0;var fe=v;try{for(_(q),m=r(f);m!==null&&(!(m.expirationTime>q)||se&&!ee());){var we=m.callback;if(typeof we=="function"){m.callback=null,v=m.priorityLevel;var G=we(m.expirationTime<=q);q=e.unstable_now(),typeof G=="function"?m.callback=G:m===r(f)&&n(f),_(q)}else n(f);m=r(f)}if(m!==null)var le=!0;else{var ne=r(d);ne!==null&&ue(N,ne.startTime-q),le=!1}return le}finally{m=null,v=fe,w=!1}}var R=!1,P=null,z=-1,B=5,re=-1;function ee(){return!(e.unstable_now()-re<B)}function V(){if(P!==null){var se=e.unstable_now();re=se;var q=!0;try{q=P(!0,se)}finally{q?de():(R=!1,P=null)}}else R=!1}var de;if(typeof T=="function")de=function(){T(V)};else if(typeof MessageChannel<"u"){var pe=new MessageChannel,K=pe.port2;pe.port1.onmessage=V,de=function(){K.postMessage(null)}}else de=function(){S(V,0)};function Ce(se){P=se,R||(R=!0,de())}function ue(se,q){z=S(function(){se(e.unstable_now())},q)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(se){se.callback=null},e.unstable_continueExecution=function(){E||w||(E=!0,Ce(M))},e.unstable_forceFrameRate=function(se){0>se||125<se?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):B=0<se?Math.floor(1e3/se):5},e.unstable_getCurrentPriorityLevel=function(){return v},e.unstable_getFirstCallbackNode=function(){return r(f)},e.unstable_next=function(se){switch(v){case 1:case 2:case 3:var q=3;break;default:q=v}var fe=v;v=q;try{return se()}finally{v=fe}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(se,q){switch(se){case 1:case 2:case 3:case 4:case 5:break;default:se=3}var fe=v;v=se;try{return q()}finally{v=fe}},e.unstable_scheduleCallback=function(se,q,fe){var we=e.unstable_now();switch(typeof fe=="object"&&fe!==null?(fe=fe.delay,fe=typeof fe=="number"&&0<fe?we+fe:we):fe=we,se){case 1:var G=-1;break;case 2:G=250;break;case 5:G=1073741823;break;case 4:G=1e4;break;default:G=5e3}return G=fe+G,se={id:h++,callback:q,priorityLevel:se,startTime:fe,expirationTime:G,sortIndex:-1},fe>we?(se.sortIndex=fe,t(d,se),r(f)===null&&se===r(d)&&(A?(b(z),z=-1):A=!0,ue(N,fe-we))):(se.sortIndex=G,t(f,se),E||w||(E=!0,Ce(M))),se},e.unstable_shouldYield=ee,e.unstable_wrapCallback=function(se){var q=v;return function(){var fe=v;v=q;try{return se.apply(this,arguments)}finally{v=fe}}}})(eb);J4.exports=eb;var RD=J4.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var MD=I,Ti=RD;function Me(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var tb=new Set,u0={};function El(e,t){Cc(e,t),Cc(e+"Capture",t)}function Cc(e,t){for(u0[e]=t,e=0;e<t.length;e++)tb.add(t[e])}var ps=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Pm=Object.prototype.hasOwnProperty,FD=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,OE={},kE={};function LD(e){return Pm.call(kE,e)?!0:Pm.call(OE,e)?!1:FD.test(e)?kE[e]=!0:(OE[e]=!0,!1)}function BD(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function jD(e,t,r,n){if(t===null||typeof t>"u"||BD(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Jn(e,t,r,n,i,a,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=o}var Sn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Sn[e]=new Jn(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Sn[t]=new Jn(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Sn[e]=new Jn(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Sn[e]=new Jn(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Sn[e]=new Jn(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Sn[e]=new Jn(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Sn[e]=new Jn(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Sn[e]=new Jn(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Sn[e]=new Jn(e,5,!1,e.toLowerCase(),null,!1,!1)});var Hv=/[\-:]([a-z])/g;function Gv(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Hv,Gv);Sn[t]=new Jn(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Hv,Gv);Sn[t]=new Jn(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Hv,Gv);Sn[t]=new Jn(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Sn[e]=new Jn(e,1,!1,e.toLowerCase(),null,!1,!1)});Sn.xlinkHref=new Jn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Sn[e]=new Jn(e,1,!1,e.toLowerCase(),null,!0,!0)});function $v(e,t,r,n){var i=Sn.hasOwnProperty(t)?Sn[t]:null;(i!==null?i.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(jD(t,r,i,n)&&(r=null),n||i===null?LD(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=r===null?i.type===3?!1:"":r:(t=i.attributeName,n=i.attributeNamespace,r===null?e.removeAttribute(t):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Ts=MD.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Wf=Symbol.for("react.element"),Yl=Symbol.for("react.portal"),Zl=Symbol.for("react.fragment"),Xv=Symbol.for("react.strict_mode"),Dm=Symbol.for("react.profiler"),rb=Symbol.for("react.provider"),nb=Symbol.for("react.context"),Kv=Symbol.for("react.forward_ref"),Rm=Symbol.for("react.suspense"),Mm=Symbol.for("react.suspense_list"),Yv=Symbol.for("react.memo"),$s=Symbol.for("react.lazy"),ib=Symbol.for("react.offscreen"),IE=Symbol.iterator;function xu(e){return e===null||typeof e!="object"?null:(e=IE&&e[IE]||e["@@iterator"],typeof e=="function"?e:null)}var mr=Object.assign,_g;function Ru(e){if(_g===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);_g=t&&t[1]||""}return`
`+_g+e}var bg=!1;function Tg(e,t){if(!e||bg)return"";bg=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(d){var n=d}Reflect.construct(e,[],t)}else{try{t.call()}catch(d){n=d}e.call(t.prototype)}else{try{throw Error()}catch(d){n=d}e()}}catch(d){if(d&&n&&typeof d.stack=="string"){for(var i=d.stack.split(`
`),a=n.stack.split(`
`),o=i.length-1,c=a.length-1;1<=o&&0<=c&&i[o]!==a[c];)c--;for(;1<=o&&0<=c;o--,c--)if(i[o]!==a[c]){if(o!==1||c!==1)do if(o--,c--,0>c||i[o]!==a[c]){var f=`
`+i[o].replace(" at new "," at ");return e.displayName&&f.includes("<anonymous>")&&(f=f.replace("<anonymous>",e.displayName)),f}while(1<=o&&0<=c);break}}}finally{bg=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Ru(e):""}function UD(e){switch(e.tag){case 5:return Ru(e.type);case 16:return Ru("Lazy");case 13:return Ru("Suspense");case 19:return Ru("SuspenseList");case 0:case 2:case 15:return e=Tg(e.type,!1),e;case 11:return e=Tg(e.type.render,!1),e;case 1:return e=Tg(e.type,!0),e;default:return""}}function Fm(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Zl:return"Fragment";case Yl:return"Portal";case Dm:return"Profiler";case Xv:return"StrictMode";case Rm:return"Suspense";case Mm:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case nb:return(e.displayName||"Context")+".Consumer";case rb:return(e._context.displayName||"Context")+".Provider";case Kv:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Yv:return t=e.displayName||null,t!==null?t:Fm(e.type)||"Memo";case $s:t=e._payload,e=e._init;try{return Fm(e(t))}catch{}}return null}function zD(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Fm(t);case 8:return t===Xv?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function xo(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function ab(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function WD(e){var t=ab(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,a=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(o){n=""+o,a.call(this,o)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Vf(e){e._valueTracker||(e._valueTracker=WD(e))}function sb(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=ab(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Yd(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Lm(e,t){var r=t.checked;return mr({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function NE(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=xo(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function ob(e,t){t=t.checked,t!=null&&$v(e,"checked",t,!1)}function Bm(e,t){ob(e,t);var r=xo(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?jm(e,t.type,r):t.hasOwnProperty("defaultValue")&&jm(e,t.type,xo(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function PE(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function jm(e,t,r){(t!=="number"||Yd(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Mu=Array.isArray;function dc(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+xo(r),t=null,i=0;i<e.length;i++){if(e[i].value===r){e[i].selected=!0,n&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function Um(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Me(91));return mr({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function DE(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Me(92));if(Mu(r)){if(1<r.length)throw Error(Me(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:xo(r)}}function lb(e,t){var r=xo(t.value),n=xo(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function RE(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function cb(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function zm(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?cb(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Hf,ub=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,i){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Hf=Hf||document.createElement("div"),Hf.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Hf.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function f0(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Gu={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},VD=["Webkit","ms","Moz","O"];Object.keys(Gu).forEach(function(e){VD.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Gu[t]=Gu[e]})});function fb(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Gu.hasOwnProperty(e)&&Gu[e]?(""+t).trim():t+"px"}function db(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=fb(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}var HD=mr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Wm(e,t){if(t){if(HD[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Me(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Me(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Me(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Me(62))}}function Vm(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Hm=null;function Zv(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Gm=null,hc=null,pc=null;function ME(e){if(e=rf(e)){if(typeof Gm!="function")throw Error(Me(280));var t=e.stateNode;t&&(t=L1(t),Gm(e.stateNode,e.type,t))}}function hb(e){hc?pc?pc.push(e):pc=[e]:hc=e}function pb(){if(hc){var e=hc,t=pc;if(pc=hc=null,ME(e),t)for(e=0;e<t.length;e++)ME(t[e])}}function gb(e,t){return e(t)}function mb(){}var Og=!1;function xb(e,t,r){if(Og)return e(t,r);Og=!0;try{return gb(e,t,r)}finally{Og=!1,(hc!==null||pc!==null)&&(mb(),pb())}}function d0(e,t){var r=e.stateNode;if(r===null)return null;var n=L1(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Me(231,t,typeof r));return r}var $m=!1;if(ps)try{var vu={};Object.defineProperty(vu,"passive",{get:function(){$m=!0}}),window.addEventListener("test",vu,vu),window.removeEventListener("test",vu,vu)}catch{$m=!1}function GD(e,t,r,n,i,a,o,c,f){var d=Array.prototype.slice.call(arguments,3);try{t.apply(r,d)}catch(h){this.onError(h)}}var $u=!1,Zd=null,qd=!1,Xm=null,$D={onError:function(e){$u=!0,Zd=e}};function XD(e,t,r,n,i,a,o,c,f){$u=!1,Zd=null,GD.apply($D,arguments)}function KD(e,t,r,n,i,a,o,c,f){if(XD.apply(this,arguments),$u){if($u){var d=Zd;$u=!1,Zd=null}else throw Error(Me(198));qd||(qd=!0,Xm=d)}}function Al(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function vb(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function FE(e){if(Al(e)!==e)throw Error(Me(188))}function YD(e){var t=e.alternate;if(!t){if(t=Al(e),t===null)throw Error(Me(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(i===null)break;var a=i.alternate;if(a===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===r)return FE(i),e;if(a===n)return FE(i),t;a=a.sibling}throw Error(Me(188))}if(r.return!==n.return)r=i,n=a;else{for(var o=!1,c=i.child;c;){if(c===r){o=!0,r=i,n=a;break}if(c===n){o=!0,n=i,r=a;break}c=c.sibling}if(!o){for(c=a.child;c;){if(c===r){o=!0,r=a,n=i;break}if(c===n){o=!0,n=a,r=i;break}c=c.sibling}if(!o)throw Error(Me(189))}}if(r.alternate!==n)throw Error(Me(190))}if(r.tag!==3)throw Error(Me(188));return r.stateNode.current===r?e:t}function yb(e){return e=YD(e),e!==null?wb(e):null}function wb(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=wb(e);if(t!==null)return t;e=e.sibling}return null}var Eb=Ti.unstable_scheduleCallback,LE=Ti.unstable_cancelCallback,ZD=Ti.unstable_shouldYield,qD=Ti.unstable_requestPaint,Nr=Ti.unstable_now,QD=Ti.unstable_getCurrentPriorityLevel,qv=Ti.unstable_ImmediatePriority,Ab=Ti.unstable_UserBlockingPriority,Qd=Ti.unstable_NormalPriority,JD=Ti.unstable_LowPriority,Cb=Ti.unstable_IdlePriority,D1=null,za=null;function eR(e){if(za&&typeof za.onCommitFiberRoot=="function")try{za.onCommitFiberRoot(D1,e,void 0,(e.current.flags&128)===128)}catch{}}var ya=Math.clz32?Math.clz32:nR,tR=Math.log,rR=Math.LN2;function nR(e){return e>>>=0,e===0?32:31-(tR(e)/rR|0)|0}var Gf=64,$f=4194304;function Fu(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Jd(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,i=e.suspendedLanes,a=e.pingedLanes,o=r&268435455;if(o!==0){var c=o&~i;c!==0?n=Fu(c):(a&=o,a!==0&&(n=Fu(a)))}else o=r&~i,o!==0?n=Fu(o):a!==0&&(n=Fu(a));if(n===0)return 0;if(t!==0&&t!==n&&!(t&i)&&(i=n&-n,a=t&-t,i>=a||i===16&&(a&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-ya(t),i=1<<r,n|=e[r],t&=~i;return n}function iR(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function aR(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,a=e.pendingLanes;0<a;){var o=31-ya(a),c=1<<o,f=i[o];f===-1?(!(c&r)||c&n)&&(i[o]=iR(c,t)):f<=t&&(e.expiredLanes|=c),a&=~c}}function Km(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Sb(){var e=Gf;return Gf<<=1,!(Gf&4194240)&&(Gf=64),e}function kg(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function ef(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-ya(t),e[t]=r}function sR(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-ya(r),a=1<<i;t[i]=0,n[i]=-1,e[i]=-1,r&=~a}}function Qv(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-ya(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}var Lt=0;function _b(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var bb,Jv,Tb,Ob,kb,Ym=!1,Xf=[],ao=null,so=null,oo=null,h0=new Map,p0=new Map,Zs=[],oR="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function BE(e,t){switch(e){case"focusin":case"focusout":ao=null;break;case"dragenter":case"dragleave":so=null;break;case"mouseover":case"mouseout":oo=null;break;case"pointerover":case"pointerout":h0.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":p0.delete(t.pointerId)}}function yu(e,t,r,n,i,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:a,targetContainers:[i]},t!==null&&(t=rf(t),t!==null&&Jv(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function lR(e,t,r,n,i){switch(t){case"focusin":return ao=yu(ao,e,t,r,n,i),!0;case"dragenter":return so=yu(so,e,t,r,n,i),!0;case"mouseover":return oo=yu(oo,e,t,r,n,i),!0;case"pointerover":var a=i.pointerId;return h0.set(a,yu(h0.get(a)||null,e,t,r,n,i)),!0;case"gotpointercapture":return a=i.pointerId,p0.set(a,yu(p0.get(a)||null,e,t,r,n,i)),!0}return!1}function Ib(e){var t=Wo(e.target);if(t!==null){var r=Al(t);if(r!==null){if(t=r.tag,t===13){if(t=vb(r),t!==null){e.blockedOn=t,kb(e.priority,function(){Tb(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Dd(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Zm(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Hm=n,r.target.dispatchEvent(n),Hm=null}else return t=rf(r),t!==null&&Jv(t),e.blockedOn=r,!1;t.shift()}return!0}function jE(e,t,r){Dd(e)&&r.delete(t)}function cR(){Ym=!1,ao!==null&&Dd(ao)&&(ao=null),so!==null&&Dd(so)&&(so=null),oo!==null&&Dd(oo)&&(oo=null),h0.forEach(jE),p0.forEach(jE)}function wu(e,t){e.blockedOn===t&&(e.blockedOn=null,Ym||(Ym=!0,Ti.unstable_scheduleCallback(Ti.unstable_NormalPriority,cR)))}function g0(e){function t(i){return wu(i,e)}if(0<Xf.length){wu(Xf[0],e);for(var r=1;r<Xf.length;r++){var n=Xf[r];n.blockedOn===e&&(n.blockedOn=null)}}for(ao!==null&&wu(ao,e),so!==null&&wu(so,e),oo!==null&&wu(oo,e),h0.forEach(t),p0.forEach(t),r=0;r<Zs.length;r++)n=Zs[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Zs.length&&(r=Zs[0],r.blockedOn===null);)Ib(r),r.blockedOn===null&&Zs.shift()}var gc=Ts.ReactCurrentBatchConfig,eh=!0;function uR(e,t,r,n){var i=Lt,a=gc.transition;gc.transition=null;try{Lt=1,e2(e,t,r,n)}finally{Lt=i,gc.transition=a}}function fR(e,t,r,n){var i=Lt,a=gc.transition;gc.transition=null;try{Lt=4,e2(e,t,r,n)}finally{Lt=i,gc.transition=a}}function e2(e,t,r,n){if(eh){var i=Zm(e,t,r,n);if(i===null)jg(e,t,n,th,r),BE(e,n);else if(lR(i,e,t,r,n))n.stopPropagation();else if(BE(e,n),t&4&&-1<oR.indexOf(e)){for(;i!==null;){var a=rf(i);if(a!==null&&bb(a),a=Zm(e,t,r,n),a===null&&jg(e,t,n,th,r),a===i)break;i=a}i!==null&&n.stopPropagation()}else jg(e,t,n,null,r)}}var th=null;function Zm(e,t,r,n){if(th=null,e=Zv(n),e=Wo(e),e!==null)if(t=Al(e),t===null)e=null;else if(r=t.tag,r===13){if(e=vb(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return th=e,null}function Nb(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(QD()){case qv:return 1;case Ab:return 4;case Qd:case JD:return 16;case Cb:return 536870912;default:return 16}default:return 16}}var eo=null,t2=null,Rd=null;function Pb(){if(Rd)return Rd;var e,t=t2,r=t.length,n,i="value"in eo?eo.value:eo.textContent,a=i.length;for(e=0;e<r&&t[e]===i[e];e++);var o=r-e;for(n=1;n<=o&&t[r-n]===i[a-n];n++);return Rd=i.slice(e,1<n?1-n:void 0)}function Md(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Kf(){return!0}function UE(){return!1}function Ni(e){function t(r,n,i,a,o){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=a,this.target=o,this.currentTarget=null;for(var c in e)e.hasOwnProperty(c)&&(r=e[c],this[c]=r?r(a):a[c]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?Kf:UE,this.isPropagationStopped=UE,this}return mr(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Kf)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Kf)},persist:function(){},isPersistent:Kf}),t}var Vc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},r2=Ni(Vc),tf=mr({},Vc,{view:0,detail:0}),dR=Ni(tf),Ig,Ng,Eu,R1=mr({},tf,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:n2,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Eu&&(Eu&&e.type==="mousemove"?(Ig=e.screenX-Eu.screenX,Ng=e.screenY-Eu.screenY):Ng=Ig=0,Eu=e),Ig)},movementY:function(e){return"movementY"in e?e.movementY:Ng}}),zE=Ni(R1),hR=mr({},R1,{dataTransfer:0}),pR=Ni(hR),gR=mr({},tf,{relatedTarget:0}),Pg=Ni(gR),mR=mr({},Vc,{animationName:0,elapsedTime:0,pseudoElement:0}),xR=Ni(mR),vR=mr({},Vc,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),yR=Ni(vR),wR=mr({},Vc,{data:0}),WE=Ni(wR),ER={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},AR={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},CR={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function SR(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=CR[e])?!!t[e]:!1}function n2(){return SR}var _R=mr({},tf,{key:function(e){if(e.key){var t=ER[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Md(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?AR[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:n2,charCode:function(e){return e.type==="keypress"?Md(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Md(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),bR=Ni(_R),TR=mr({},R1,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),VE=Ni(TR),OR=mr({},tf,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:n2}),kR=Ni(OR),IR=mr({},Vc,{propertyName:0,elapsedTime:0,pseudoElement:0}),NR=Ni(IR),PR=mr({},R1,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),DR=Ni(PR),RR=[9,13,27,32],i2=ps&&"CompositionEvent"in window,Xu=null;ps&&"documentMode"in document&&(Xu=document.documentMode);var MR=ps&&"TextEvent"in window&&!Xu,Db=ps&&(!i2||Xu&&8<Xu&&11>=Xu),HE=" ",GE=!1;function Rb(e,t){switch(e){case"keyup":return RR.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Mb(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var ql=!1;function FR(e,t){switch(e){case"compositionend":return Mb(t);case"keypress":return t.which!==32?null:(GE=!0,HE);case"textInput":return e=t.data,e===HE&&GE?null:e;default:return null}}function LR(e,t){if(ql)return e==="compositionend"||!i2&&Rb(e,t)?(e=Pb(),Rd=t2=eo=null,ql=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Db&&t.locale!=="ko"?null:t.data;default:return null}}var BR={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function $E(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!BR[e.type]:t==="textarea"}function Fb(e,t,r,n){hb(n),t=rh(t,"onChange"),0<t.length&&(r=new r2("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Ku=null,m0=null;function jR(e){Xb(e,0)}function M1(e){var t=ec(e);if(sb(t))return e}function UR(e,t){if(e==="change")return t}var Lb=!1;if(ps){var Dg;if(ps){var Rg="oninput"in document;if(!Rg){var XE=document.createElement("div");XE.setAttribute("oninput","return;"),Rg=typeof XE.oninput=="function"}Dg=Rg}else Dg=!1;Lb=Dg&&(!document.documentMode||9<document.documentMode)}function KE(){Ku&&(Ku.detachEvent("onpropertychange",Bb),m0=Ku=null)}function Bb(e){if(e.propertyName==="value"&&M1(m0)){var t=[];Fb(t,m0,e,Zv(e)),xb(jR,t)}}function zR(e,t,r){e==="focusin"?(KE(),Ku=t,m0=r,Ku.attachEvent("onpropertychange",Bb)):e==="focusout"&&KE()}function WR(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return M1(m0)}function VR(e,t){if(e==="click")return M1(t)}function HR(e,t){if(e==="input"||e==="change")return M1(t)}function GR(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Ca=typeof Object.is=="function"?Object.is:GR;function x0(e,t){if(Ca(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!Pm.call(t,i)||!Ca(e[i],t[i]))return!1}return!0}function YE(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ZE(e,t){var r=YE(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=YE(r)}}function jb(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?jb(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Ub(){for(var e=window,t=Yd();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Yd(e.document)}return t}function a2(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function $R(e){var t=Ub(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&jb(r.ownerDocument.documentElement,r)){if(n!==null&&a2(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=r.textContent.length,a=Math.min(n.start,i);n=n.end===void 0?a:Math.min(n.end,i),!e.extend&&a>n&&(i=n,n=a,a=i),i=ZE(r,a);var o=ZE(r,n);i&&o&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),a>n?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var XR=ps&&"documentMode"in document&&11>=document.documentMode,Ql=null,qm=null,Yu=null,Qm=!1;function qE(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Qm||Ql==null||Ql!==Yd(n)||(n=Ql,"selectionStart"in n&&a2(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Yu&&x0(Yu,n)||(Yu=n,n=rh(qm,"onSelect"),0<n.length&&(t=new r2("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Ql)))}function Yf(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Jl={animationend:Yf("Animation","AnimationEnd"),animationiteration:Yf("Animation","AnimationIteration"),animationstart:Yf("Animation","AnimationStart"),transitionend:Yf("Transition","TransitionEnd")},Mg={},zb={};ps&&(zb=document.createElement("div").style,"AnimationEvent"in window||(delete Jl.animationend.animation,delete Jl.animationiteration.animation,delete Jl.animationstart.animation),"TransitionEvent"in window||delete Jl.transitionend.transition);function F1(e){if(Mg[e])return Mg[e];if(!Jl[e])return e;var t=Jl[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in zb)return Mg[e]=t[r];return e}var Wb=F1("animationend"),Vb=F1("animationiteration"),Hb=F1("animationstart"),Gb=F1("transitionend"),$b=new Map,QE="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ao(e,t){$b.set(e,t),El(t,[e])}for(var Fg=0;Fg<QE.length;Fg++){var Lg=QE[Fg],KR=Lg.toLowerCase(),YR=Lg[0].toUpperCase()+Lg.slice(1);Ao(KR,"on"+YR)}Ao(Wb,"onAnimationEnd");Ao(Vb,"onAnimationIteration");Ao(Hb,"onAnimationStart");Ao("dblclick","onDoubleClick");Ao("focusin","onFocus");Ao("focusout","onBlur");Ao(Gb,"onTransitionEnd");Cc("onMouseEnter",["mouseout","mouseover"]);Cc("onMouseLeave",["mouseout","mouseover"]);Cc("onPointerEnter",["pointerout","pointerover"]);Cc("onPointerLeave",["pointerout","pointerover"]);El("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));El("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));El("onBeforeInput",["compositionend","keypress","textInput","paste"]);El("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));El("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));El("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Lu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),ZR=new Set("cancel close invalid load scroll toggle".split(" ").concat(Lu));function JE(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,KD(n,t,void 0,e),e.currentTarget=null}function Xb(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var a=void 0;if(t)for(var o=n.length-1;0<=o;o--){var c=n[o],f=c.instance,d=c.currentTarget;if(c=c.listener,f!==a&&i.isPropagationStopped())break e;JE(i,c,d),a=f}else for(o=0;o<n.length;o++){if(c=n[o],f=c.instance,d=c.currentTarget,c=c.listener,f!==a&&i.isPropagationStopped())break e;JE(i,c,d),a=f}}}if(qd)throw e=Xm,qd=!1,Xm=null,e}function tr(e,t){var r=t[nx];r===void 0&&(r=t[nx]=new Set);var n=e+"__bubble";r.has(n)||(Kb(t,e,2,!1),r.add(n))}function Bg(e,t,r){var n=0;t&&(n|=4),Kb(r,e,n,t)}var Zf="_reactListening"+Math.random().toString(36).slice(2);function v0(e){if(!e[Zf]){e[Zf]=!0,tb.forEach(function(r){r!=="selectionchange"&&(ZR.has(r)||Bg(r,!1,e),Bg(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Zf]||(t[Zf]=!0,Bg("selectionchange",!1,t))}}function Kb(e,t,r,n){switch(Nb(t)){case 1:var i=uR;break;case 4:i=fR;break;default:i=e2}r=i.bind(null,t,r,e),i=void 0,!$m||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),n?i!==void 0?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):i!==void 0?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function jg(e,t,r,n,i){var a=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var c=n.stateNode.containerInfo;if(c===i||c.nodeType===8&&c.parentNode===i)break;if(o===4)for(o=n.return;o!==null;){var f=o.tag;if((f===3||f===4)&&(f=o.stateNode.containerInfo,f===i||f.nodeType===8&&f.parentNode===i))return;o=o.return}for(;c!==null;){if(o=Wo(c),o===null)return;if(f=o.tag,f===5||f===6){n=a=o;continue e}c=c.parentNode}}n=n.return}xb(function(){var d=a,h=Zv(r),m=[];e:{var v=$b.get(e);if(v!==void 0){var w=r2,E=e;switch(e){case"keypress":if(Md(r)===0)break e;case"keydown":case"keyup":w=bR;break;case"focusin":E="focus",w=Pg;break;case"focusout":E="blur",w=Pg;break;case"beforeblur":case"afterblur":w=Pg;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":w=zE;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":w=pR;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":w=kR;break;case Wb:case Vb:case Hb:w=xR;break;case Gb:w=NR;break;case"scroll":w=dR;break;case"wheel":w=DR;break;case"copy":case"cut":case"paste":w=yR;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":w=VE}var A=(t&4)!==0,S=!A&&e==="scroll",b=A?v!==null?v+"Capture":null:v;A=[];for(var T=d,_;T!==null;){_=T;var N=_.stateNode;if(_.tag===5&&N!==null&&(_=N,b!==null&&(N=d0(T,b),N!=null&&A.push(y0(T,N,_)))),S)break;T=T.return}0<A.length&&(v=new w(v,E,null,r,h),m.push({event:v,listeners:A}))}}if(!(t&7)){e:{if(v=e==="mouseover"||e==="pointerover",w=e==="mouseout"||e==="pointerout",v&&r!==Hm&&(E=r.relatedTarget||r.fromElement)&&(Wo(E)||E[gs]))break e;if((w||v)&&(v=h.window===h?h:(v=h.ownerDocument)?v.defaultView||v.parentWindow:window,w?(E=r.relatedTarget||r.toElement,w=d,E=E?Wo(E):null,E!==null&&(S=Al(E),E!==S||E.tag!==5&&E.tag!==6)&&(E=null)):(w=null,E=d),w!==E)){if(A=zE,N="onMouseLeave",b="onMouseEnter",T="mouse",(e==="pointerout"||e==="pointerover")&&(A=VE,N="onPointerLeave",b="onPointerEnter",T="pointer"),S=w==null?v:ec(w),_=E==null?v:ec(E),v=new A(N,T+"leave",w,r,h),v.target=S,v.relatedTarget=_,N=null,Wo(h)===d&&(A=new A(b,T+"enter",E,r,h),A.target=_,A.relatedTarget=S,N=A),S=N,w&&E)t:{for(A=w,b=E,T=0,_=A;_;_=zl(_))T++;for(_=0,N=b;N;N=zl(N))_++;for(;0<T-_;)A=zl(A),T--;for(;0<_-T;)b=zl(b),_--;for(;T--;){if(A===b||b!==null&&A===b.alternate)break t;A=zl(A),b=zl(b)}A=null}else A=null;w!==null&&eA(m,v,w,A,!1),E!==null&&S!==null&&eA(m,S,E,A,!0)}}e:{if(v=d?ec(d):window,w=v.nodeName&&v.nodeName.toLowerCase(),w==="select"||w==="input"&&v.type==="file")var M=UR;else if($E(v))if(Lb)M=HR;else{M=WR;var R=zR}else(w=v.nodeName)&&w.toLowerCase()==="input"&&(v.type==="checkbox"||v.type==="radio")&&(M=VR);if(M&&(M=M(e,d))){Fb(m,M,r,h);break e}R&&R(e,v,d),e==="focusout"&&(R=v._wrapperState)&&R.controlled&&v.type==="number"&&jm(v,"number",v.value)}switch(R=d?ec(d):window,e){case"focusin":($E(R)||R.contentEditable==="true")&&(Ql=R,qm=d,Yu=null);break;case"focusout":Yu=qm=Ql=null;break;case"mousedown":Qm=!0;break;case"contextmenu":case"mouseup":case"dragend":Qm=!1,qE(m,r,h);break;case"selectionchange":if(XR)break;case"keydown":case"keyup":qE(m,r,h)}var P;if(i2)e:{switch(e){case"compositionstart":var z="onCompositionStart";break e;case"compositionend":z="onCompositionEnd";break e;case"compositionupdate":z="onCompositionUpdate";break e}z=void 0}else ql?Rb(e,r)&&(z="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(z="onCompositionStart");z&&(Db&&r.locale!=="ko"&&(ql||z!=="onCompositionStart"?z==="onCompositionEnd"&&ql&&(P=Pb()):(eo=h,t2="value"in eo?eo.value:eo.textContent,ql=!0)),R=rh(d,z),0<R.length&&(z=new WE(z,e,null,r,h),m.push({event:z,listeners:R}),P?z.data=P:(P=Mb(r),P!==null&&(z.data=P)))),(P=MR?FR(e,r):LR(e,r))&&(d=rh(d,"onBeforeInput"),0<d.length&&(h=new WE("onBeforeInput","beforeinput",null,r,h),m.push({event:h,listeners:d}),h.data=P))}Xb(m,t)})}function y0(e,t,r){return{instance:e,listener:t,currentTarget:r}}function rh(e,t){for(var r=t+"Capture",n=[];e!==null;){var i=e,a=i.stateNode;i.tag===5&&a!==null&&(i=a,a=d0(e,r),a!=null&&n.unshift(y0(e,a,i)),a=d0(e,t),a!=null&&n.push(y0(e,a,i))),e=e.return}return n}function zl(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function eA(e,t,r,n,i){for(var a=t._reactName,o=[];r!==null&&r!==n;){var c=r,f=c.alternate,d=c.stateNode;if(f!==null&&f===n)break;c.tag===5&&d!==null&&(c=d,i?(f=d0(r,a),f!=null&&o.unshift(y0(r,f,c))):i||(f=d0(r,a),f!=null&&o.push(y0(r,f,c)))),r=r.return}o.length!==0&&e.push({event:t,listeners:o})}var qR=/\r\n?/g,QR=/\u0000|\uFFFD/g;function tA(e){return(typeof e=="string"?e:""+e).replace(qR,`
`).replace(QR,"")}function qf(e,t,r){if(t=tA(t),tA(e)!==t&&r)throw Error(Me(425))}function nh(){}var Jm=null,ex=null;function tx(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var rx=typeof setTimeout=="function"?setTimeout:void 0,JR=typeof clearTimeout=="function"?clearTimeout:void 0,rA=typeof Promise=="function"?Promise:void 0,eM=typeof queueMicrotask=="function"?queueMicrotask:typeof rA<"u"?function(e){return rA.resolve(null).then(e).catch(tM)}:rx;function tM(e){setTimeout(function(){throw e})}function Ug(e,t){var r=t,n=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){e.removeChild(i),g0(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);g0(t)}function lo(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function nA(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Hc=Math.random().toString(36).slice(2),Ba="__reactFiber$"+Hc,w0="__reactProps$"+Hc,gs="__reactContainer$"+Hc,nx="__reactEvents$"+Hc,rM="__reactListeners$"+Hc,nM="__reactHandles$"+Hc;function Wo(e){var t=e[Ba];if(t)return t;for(var r=e.parentNode;r;){if(t=r[gs]||r[Ba]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=nA(e);e!==null;){if(r=e[Ba])return r;e=nA(e)}return t}e=r,r=e.parentNode}return null}function rf(e){return e=e[Ba]||e[gs],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function ec(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Me(33))}function L1(e){return e[w0]||null}var ix=[],tc=-1;function Co(e){return{current:e}}function ir(e){0>tc||(e.current=ix[tc],ix[tc]=null,tc--)}function Zt(e,t){tc++,ix[tc]=e.current,e.current=t}var vo={},Bn=Co(vo),ui=Co(!1),nl=vo;function Sc(e,t){var r=e.type.contextTypes;if(!r)return vo;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i={},a;for(a in r)i[a]=t[a];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function fi(e){return e=e.childContextTypes,e!=null}function ih(){ir(ui),ir(Bn)}function iA(e,t,r){if(Bn.current!==vo)throw Error(Me(168));Zt(Bn,t),Zt(ui,r)}function Yb(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in t))throw Error(Me(108,zD(e)||"Unknown",i));return mr({},r,n)}function ah(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||vo,nl=Bn.current,Zt(Bn,e),Zt(ui,ui.current),!0}function aA(e,t,r){var n=e.stateNode;if(!n)throw Error(Me(169));r?(e=Yb(e,t,nl),n.__reactInternalMemoizedMergedChildContext=e,ir(ui),ir(Bn),Zt(Bn,e)):ir(ui),Zt(ui,r)}var ts=null,B1=!1,zg=!1;function Zb(e){ts===null?ts=[e]:ts.push(e)}function iM(e){B1=!0,Zb(e)}function So(){if(!zg&&ts!==null){zg=!0;var e=0,t=Lt;try{var r=ts;for(Lt=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}ts=null,B1=!1}catch(i){throw ts!==null&&(ts=ts.slice(e+1)),Eb(qv,So),i}finally{Lt=t,zg=!1}}return null}var rc=[],nc=0,sh=null,oh=0,Gi=[],$i=0,il=null,is=1,as="";function Fo(e,t){rc[nc++]=oh,rc[nc++]=sh,sh=e,oh=t}function qb(e,t,r){Gi[$i++]=is,Gi[$i++]=as,Gi[$i++]=il,il=e;var n=is;e=as;var i=32-ya(n)-1;n&=~(1<<i),r+=1;var a=32-ya(t)+i;if(30<a){var o=i-i%5;a=(n&(1<<o)-1).toString(32),n>>=o,i-=o,is=1<<32-ya(t)+i|r<<i|n,as=a+e}else is=1<<a|r<<i|n,as=e}function s2(e){e.return!==null&&(Fo(e,1),qb(e,1,0))}function o2(e){for(;e===sh;)sh=rc[--nc],rc[nc]=null,oh=rc[--nc],rc[nc]=null;for(;e===il;)il=Gi[--$i],Gi[$i]=null,as=Gi[--$i],Gi[$i]=null,is=Gi[--$i],Gi[$i]=null}var _i=null,Ci=null,ur=!1,da=null;function Qb(e,t){var r=Xi(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function sA(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,_i=e,Ci=lo(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,_i=e,Ci=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=il!==null?{id:is,overflow:as}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Xi(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,_i=e,Ci=null,!0):!1;default:return!1}}function ax(e){return(e.mode&1)!==0&&(e.flags&128)===0}function sx(e){if(ur){var t=Ci;if(t){var r=t;if(!sA(e,t)){if(ax(e))throw Error(Me(418));t=lo(r.nextSibling);var n=_i;t&&sA(e,t)?Qb(n,r):(e.flags=e.flags&-4097|2,ur=!1,_i=e)}}else{if(ax(e))throw Error(Me(418));e.flags=e.flags&-4097|2,ur=!1,_i=e}}}function oA(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;_i=e}function Qf(e){if(e!==_i)return!1;if(!ur)return oA(e),ur=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!tx(e.type,e.memoizedProps)),t&&(t=Ci)){if(ax(e))throw Jb(),Error(Me(418));for(;t;)Qb(e,t),t=lo(t.nextSibling)}if(oA(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Me(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Ci=lo(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Ci=null}}else Ci=_i?lo(e.stateNode.nextSibling):null;return!0}function Jb(){for(var e=Ci;e;)e=lo(e.nextSibling)}function _c(){Ci=_i=null,ur=!1}function l2(e){da===null?da=[e]:da.push(e)}var aM=Ts.ReactCurrentBatchConfig;function Au(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Me(309));var n=r.stateNode}if(!n)throw Error(Me(147,e));var i=n,a=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===a?t.ref:(t=function(o){var c=i.refs;o===null?delete c[a]:c[a]=o},t._stringRef=a,t)}if(typeof e!="string")throw Error(Me(284));if(!r._owner)throw Error(Me(290,e))}return e}function Jf(e,t){throw e=Object.prototype.toString.call(t),Error(Me(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function lA(e){var t=e._init;return t(e._payload)}function eT(e){function t(b,T){if(e){var _=b.deletions;_===null?(b.deletions=[T],b.flags|=16):_.push(T)}}function r(b,T){if(!e)return null;for(;T!==null;)t(b,T),T=T.sibling;return null}function n(b,T){for(b=new Map;T!==null;)T.key!==null?b.set(T.key,T):b.set(T.index,T),T=T.sibling;return b}function i(b,T){return b=ho(b,T),b.index=0,b.sibling=null,b}function a(b,T,_){return b.index=_,e?(_=b.alternate,_!==null?(_=_.index,_<T?(b.flags|=2,T):_):(b.flags|=2,T)):(b.flags|=1048576,T)}function o(b){return e&&b.alternate===null&&(b.flags|=2),b}function c(b,T,_,N){return T===null||T.tag!==6?(T=Kg(_,b.mode,N),T.return=b,T):(T=i(T,_),T.return=b,T)}function f(b,T,_,N){var M=_.type;return M===Zl?h(b,T,_.props.children,N,_.key):T!==null&&(T.elementType===M||typeof M=="object"&&M!==null&&M.$$typeof===$s&&lA(M)===T.type)?(N=i(T,_.props),N.ref=Au(b,T,_),N.return=b,N):(N=Wd(_.type,_.key,_.props,null,b.mode,N),N.ref=Au(b,T,_),N.return=b,N)}function d(b,T,_,N){return T===null||T.tag!==4||T.stateNode.containerInfo!==_.containerInfo||T.stateNode.implementation!==_.implementation?(T=Yg(_,b.mode,N),T.return=b,T):(T=i(T,_.children||[]),T.return=b,T)}function h(b,T,_,N,M){return T===null||T.tag!==7?(T=qo(_,b.mode,N,M),T.return=b,T):(T=i(T,_),T.return=b,T)}function m(b,T,_){if(typeof T=="string"&&T!==""||typeof T=="number")return T=Kg(""+T,b.mode,_),T.return=b,T;if(typeof T=="object"&&T!==null){switch(T.$$typeof){case Wf:return _=Wd(T.type,T.key,T.props,null,b.mode,_),_.ref=Au(b,null,T),_.return=b,_;case Yl:return T=Yg(T,b.mode,_),T.return=b,T;case $s:var N=T._init;return m(b,N(T._payload),_)}if(Mu(T)||xu(T))return T=qo(T,b.mode,_,null),T.return=b,T;Jf(b,T)}return null}function v(b,T,_,N){var M=T!==null?T.key:null;if(typeof _=="string"&&_!==""||typeof _=="number")return M!==null?null:c(b,T,""+_,N);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Wf:return _.key===M?f(b,T,_,N):null;case Yl:return _.key===M?d(b,T,_,N):null;case $s:return M=_._init,v(b,T,M(_._payload),N)}if(Mu(_)||xu(_))return M!==null?null:h(b,T,_,N,null);Jf(b,_)}return null}function w(b,T,_,N,M){if(typeof N=="string"&&N!==""||typeof N=="number")return b=b.get(_)||null,c(T,b,""+N,M);if(typeof N=="object"&&N!==null){switch(N.$$typeof){case Wf:return b=b.get(N.key===null?_:N.key)||null,f(T,b,N,M);case Yl:return b=b.get(N.key===null?_:N.key)||null,d(T,b,N,M);case $s:var R=N._init;return w(b,T,_,R(N._payload),M)}if(Mu(N)||xu(N))return b=b.get(_)||null,h(T,b,N,M,null);Jf(T,N)}return null}function E(b,T,_,N){for(var M=null,R=null,P=T,z=T=0,B=null;P!==null&&z<_.length;z++){P.index>z?(B=P,P=null):B=P.sibling;var re=v(b,P,_[z],N);if(re===null){P===null&&(P=B);break}e&&P&&re.alternate===null&&t(b,P),T=a(re,T,z),R===null?M=re:R.sibling=re,R=re,P=B}if(z===_.length)return r(b,P),ur&&Fo(b,z),M;if(P===null){for(;z<_.length;z++)P=m(b,_[z],N),P!==null&&(T=a(P,T,z),R===null?M=P:R.sibling=P,R=P);return ur&&Fo(b,z),M}for(P=n(b,P);z<_.length;z++)B=w(P,b,z,_[z],N),B!==null&&(e&&B.alternate!==null&&P.delete(B.key===null?z:B.key),T=a(B,T,z),R===null?M=B:R.sibling=B,R=B);return e&&P.forEach(function(ee){return t(b,ee)}),ur&&Fo(b,z),M}function A(b,T,_,N){var M=xu(_);if(typeof M!="function")throw Error(Me(150));if(_=M.call(_),_==null)throw Error(Me(151));for(var R=M=null,P=T,z=T=0,B=null,re=_.next();P!==null&&!re.done;z++,re=_.next()){P.index>z?(B=P,P=null):B=P.sibling;var ee=v(b,P,re.value,N);if(ee===null){P===null&&(P=B);break}e&&P&&ee.alternate===null&&t(b,P),T=a(ee,T,z),R===null?M=ee:R.sibling=ee,R=ee,P=B}if(re.done)return r(b,P),ur&&Fo(b,z),M;if(P===null){for(;!re.done;z++,re=_.next())re=m(b,re.value,N),re!==null&&(T=a(re,T,z),R===null?M=re:R.sibling=re,R=re);return ur&&Fo(b,z),M}for(P=n(b,P);!re.done;z++,re=_.next())re=w(P,b,z,re.value,N),re!==null&&(e&&re.alternate!==null&&P.delete(re.key===null?z:re.key),T=a(re,T,z),R===null?M=re:R.sibling=re,R=re);return e&&P.forEach(function(V){return t(b,V)}),ur&&Fo(b,z),M}function S(b,T,_,N){if(typeof _=="object"&&_!==null&&_.type===Zl&&_.key===null&&(_=_.props.children),typeof _=="object"&&_!==null){switch(_.$$typeof){case Wf:e:{for(var M=_.key,R=T;R!==null;){if(R.key===M){if(M=_.type,M===Zl){if(R.tag===7){r(b,R.sibling),T=i(R,_.props.children),T.return=b,b=T;break e}}else if(R.elementType===M||typeof M=="object"&&M!==null&&M.$$typeof===$s&&lA(M)===R.type){r(b,R.sibling),T=i(R,_.props),T.ref=Au(b,R,_),T.return=b,b=T;break e}r(b,R);break}else t(b,R);R=R.sibling}_.type===Zl?(T=qo(_.props.children,b.mode,N,_.key),T.return=b,b=T):(N=Wd(_.type,_.key,_.props,null,b.mode,N),N.ref=Au(b,T,_),N.return=b,b=N)}return o(b);case Yl:e:{for(R=_.key;T!==null;){if(T.key===R)if(T.tag===4&&T.stateNode.containerInfo===_.containerInfo&&T.stateNode.implementation===_.implementation){r(b,T.sibling),T=i(T,_.children||[]),T.return=b,b=T;break e}else{r(b,T);break}else t(b,T);T=T.sibling}T=Yg(_,b.mode,N),T.return=b,b=T}return o(b);case $s:return R=_._init,S(b,T,R(_._payload),N)}if(Mu(_))return E(b,T,_,N);if(xu(_))return A(b,T,_,N);Jf(b,_)}return typeof _=="string"&&_!==""||typeof _=="number"?(_=""+_,T!==null&&T.tag===6?(r(b,T.sibling),T=i(T,_),T.return=b,b=T):(r(b,T),T=Kg(_,b.mode,N),T.return=b,b=T),o(b)):r(b,T)}return S}var bc=eT(!0),tT=eT(!1),lh=Co(null),ch=null,ic=null,c2=null;function u2(){c2=ic=ch=null}function f2(e){var t=lh.current;ir(lh),e._currentValue=t}function ox(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function mc(e,t){ch=e,c2=ic=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(oi=!0),e.firstContext=null)}function Zi(e){var t=e._currentValue;if(c2!==e)if(e={context:e,memoizedValue:t,next:null},ic===null){if(ch===null)throw Error(Me(308));ic=e,ch.dependencies={lanes:0,firstContext:e}}else ic=ic.next=e;return t}var Vo=null;function d2(e){Vo===null?Vo=[e]:Vo.push(e)}function rT(e,t,r,n){var i=t.interleaved;return i===null?(r.next=r,d2(t)):(r.next=i.next,i.next=r),t.interleaved=r,ms(e,n)}function ms(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Xs=!1;function h2(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function nT(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function cs(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function co(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,It&2){var i=n.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),n.pending=t,ms(e,r)}return i=n.interleaved,i===null?(t.next=t,d2(n)):(t.next=i.next,i.next=t),n.interleaved=t,ms(e,r)}function Fd(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Qv(e,r)}}function cA(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,a=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};a===null?i=a=o:a=a.next=o,r=r.next}while(r!==null);a===null?i=a=t:a=a.next=t}else i=a=t;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function uh(e,t,r,n){var i=e.updateQueue;Xs=!1;var a=i.firstBaseUpdate,o=i.lastBaseUpdate,c=i.shared.pending;if(c!==null){i.shared.pending=null;var f=c,d=f.next;f.next=null,o===null?a=d:o.next=d,o=f;var h=e.alternate;h!==null&&(h=h.updateQueue,c=h.lastBaseUpdate,c!==o&&(c===null?h.firstBaseUpdate=d:c.next=d,h.lastBaseUpdate=f))}if(a!==null){var m=i.baseState;o=0,h=d=f=null,c=a;do{var v=c.lane,w=c.eventTime;if((n&v)===v){h!==null&&(h=h.next={eventTime:w,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var E=e,A=c;switch(v=t,w=r,A.tag){case 1:if(E=A.payload,typeof E=="function"){m=E.call(w,m,v);break e}m=E;break e;case 3:E.flags=E.flags&-65537|128;case 0:if(E=A.payload,v=typeof E=="function"?E.call(w,m,v):E,v==null)break e;m=mr({},m,v);break e;case 2:Xs=!0}}c.callback!==null&&c.lane!==0&&(e.flags|=64,v=i.effects,v===null?i.effects=[c]:v.push(c))}else w={eventTime:w,lane:v,tag:c.tag,payload:c.payload,callback:c.callback,next:null},h===null?(d=h=w,f=m):h=h.next=w,o|=v;if(c=c.next,c===null){if(c=i.shared.pending,c===null)break;v=c,c=v.next,v.next=null,i.lastBaseUpdate=v,i.shared.pending=null}}while(!0);if(h===null&&(f=m),i.baseState=f,i.firstBaseUpdate=d,i.lastBaseUpdate=h,t=i.shared.interleaved,t!==null){i=t;do o|=i.lane,i=i.next;while(i!==t)}else a===null&&(i.shared.lanes=0);sl|=o,e.lanes=o,e.memoizedState=m}}function uA(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(Me(191,i));i.call(n)}}}var nf={},Wa=Co(nf),E0=Co(nf),A0=Co(nf);function Ho(e){if(e===nf)throw Error(Me(174));return e}function p2(e,t){switch(Zt(A0,t),Zt(E0,e),Zt(Wa,nf),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:zm(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=zm(t,e)}ir(Wa),Zt(Wa,t)}function Tc(){ir(Wa),ir(E0),ir(A0)}function iT(e){Ho(A0.current);var t=Ho(Wa.current),r=zm(t,e.type);t!==r&&(Zt(E0,e),Zt(Wa,r))}function g2(e){E0.current===e&&(ir(Wa),ir(E0))}var pr=Co(0);function fh(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Wg=[];function m2(){for(var e=0;e<Wg.length;e++)Wg[e]._workInProgressVersionPrimary=null;Wg.length=0}var Ld=Ts.ReactCurrentDispatcher,Vg=Ts.ReactCurrentBatchConfig,al=0,gr=null,Wr=null,an=null,dh=!1,Zu=!1,C0=0,sM=0;function Tn(){throw Error(Me(321))}function x2(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Ca(e[r],t[r]))return!1;return!0}function v2(e,t,r,n,i,a){if(al=a,gr=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Ld.current=e===null||e.memoizedState===null?uM:fM,e=r(n,i),Zu){a=0;do{if(Zu=!1,C0=0,25<=a)throw Error(Me(301));a+=1,an=Wr=null,t.updateQueue=null,Ld.current=dM,e=r(n,i)}while(Zu)}if(Ld.current=hh,t=Wr!==null&&Wr.next!==null,al=0,an=Wr=gr=null,dh=!1,t)throw Error(Me(300));return e}function y2(){var e=C0!==0;return C0=0,e}function La(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return an===null?gr.memoizedState=an=e:an=an.next=e,an}function qi(){if(Wr===null){var e=gr.alternate;e=e!==null?e.memoizedState:null}else e=Wr.next;var t=an===null?gr.memoizedState:an.next;if(t!==null)an=t,Wr=e;else{if(e===null)throw Error(Me(310));Wr=e,e={memoizedState:Wr.memoizedState,baseState:Wr.baseState,baseQueue:Wr.baseQueue,queue:Wr.queue,next:null},an===null?gr.memoizedState=an=e:an=an.next=e}return an}function S0(e,t){return typeof t=="function"?t(e):t}function Hg(e){var t=qi(),r=t.queue;if(r===null)throw Error(Me(311));r.lastRenderedReducer=e;var n=Wr,i=n.baseQueue,a=r.pending;if(a!==null){if(i!==null){var o=i.next;i.next=a.next,a.next=o}n.baseQueue=i=a,r.pending=null}if(i!==null){a=i.next,n=n.baseState;var c=o=null,f=null,d=a;do{var h=d.lane;if((al&h)===h)f!==null&&(f=f.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),n=d.hasEagerState?d.eagerState:e(n,d.action);else{var m={lane:h,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};f===null?(c=f=m,o=n):f=f.next=m,gr.lanes|=h,sl|=h}d=d.next}while(d!==null&&d!==a);f===null?o=n:f.next=c,Ca(n,t.memoizedState)||(oi=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=f,r.lastRenderedState=n}if(e=r.interleaved,e!==null){i=e;do a=i.lane,gr.lanes|=a,sl|=a,i=i.next;while(i!==e)}else i===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Gg(e){var t=qi(),r=t.queue;if(r===null)throw Error(Me(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,a=t.memoizedState;if(i!==null){r.pending=null;var o=i=i.next;do a=e(a,o.action),o=o.next;while(o!==i);Ca(a,t.memoizedState)||(oi=!0),t.memoizedState=a,t.baseQueue===null&&(t.baseState=a),r.lastRenderedState=a}return[a,n]}function aT(){}function sT(e,t){var r=gr,n=qi(),i=t(),a=!Ca(n.memoizedState,i);if(a&&(n.memoizedState=i,oi=!0),n=n.queue,w2(cT.bind(null,r,n,e),[e]),n.getSnapshot!==t||a||an!==null&&an.memoizedState.tag&1){if(r.flags|=2048,_0(9,lT.bind(null,r,n,i,t),void 0,null),on===null)throw Error(Me(349));al&30||oT(r,t,i)}return i}function oT(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=gr.updateQueue,t===null?(t={lastEffect:null,stores:null},gr.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function lT(e,t,r,n){t.value=r,t.getSnapshot=n,uT(t)&&fT(e)}function cT(e,t,r){return r(function(){uT(t)&&fT(e)})}function uT(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Ca(e,r)}catch{return!0}}function fT(e){var t=ms(e,1);t!==null&&wa(t,e,1,-1)}function fA(e){var t=La();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:S0,lastRenderedState:e},t.queue=e,e=e.dispatch=cM.bind(null,gr,e),[t.memoizedState,e]}function _0(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=gr.updateQueue,t===null?(t={lastEffect:null,stores:null},gr.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function dT(){return qi().memoizedState}function Bd(e,t,r,n){var i=La();gr.flags|=e,i.memoizedState=_0(1|t,r,void 0,n===void 0?null:n)}function j1(e,t,r,n){var i=qi();n=n===void 0?null:n;var a=void 0;if(Wr!==null){var o=Wr.memoizedState;if(a=o.destroy,n!==null&&x2(n,o.deps)){i.memoizedState=_0(t,r,a,n);return}}gr.flags|=e,i.memoizedState=_0(1|t,r,a,n)}function dA(e,t){return Bd(8390656,8,e,t)}function w2(e,t){return j1(2048,8,e,t)}function hT(e,t){return j1(4,2,e,t)}function pT(e,t){return j1(4,4,e,t)}function gT(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function mT(e,t,r){return r=r!=null?r.concat([e]):null,j1(4,4,gT.bind(null,t,e),r)}function E2(){}function xT(e,t){var r=qi();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&x2(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function vT(e,t){var r=qi();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&x2(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function yT(e,t,r){return al&21?(Ca(r,t)||(r=Sb(),gr.lanes|=r,sl|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,oi=!0),e.memoizedState=r)}function oM(e,t){var r=Lt;Lt=r!==0&&4>r?r:4,e(!0);var n=Vg.transition;Vg.transition={};try{e(!1),t()}finally{Lt=r,Vg.transition=n}}function wT(){return qi().memoizedState}function lM(e,t,r){var n=fo(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},ET(e))AT(t,r);else if(r=rT(e,t,r,n),r!==null){var i=Xn();wa(r,e,n,i),CT(r,t,n)}}function cM(e,t,r){var n=fo(e),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(ET(e))AT(t,i);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var o=t.lastRenderedState,c=a(o,r);if(i.hasEagerState=!0,i.eagerState=c,Ca(c,o)){var f=t.interleaved;f===null?(i.next=i,d2(t)):(i.next=f.next,f.next=i),t.interleaved=i;return}}catch{}finally{}r=rT(e,t,i,n),r!==null&&(i=Xn(),wa(r,e,n,i),CT(r,t,n))}}function ET(e){var t=e.alternate;return e===gr||t!==null&&t===gr}function AT(e,t){Zu=dh=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function CT(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Qv(e,r)}}var hh={readContext:Zi,useCallback:Tn,useContext:Tn,useEffect:Tn,useImperativeHandle:Tn,useInsertionEffect:Tn,useLayoutEffect:Tn,useMemo:Tn,useReducer:Tn,useRef:Tn,useState:Tn,useDebugValue:Tn,useDeferredValue:Tn,useTransition:Tn,useMutableSource:Tn,useSyncExternalStore:Tn,useId:Tn,unstable_isNewReconciler:!1},uM={readContext:Zi,useCallback:function(e,t){return La().memoizedState=[e,t===void 0?null:t],e},useContext:Zi,useEffect:dA,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Bd(4194308,4,gT.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Bd(4194308,4,e,t)},useInsertionEffect:function(e,t){return Bd(4,2,e,t)},useMemo:function(e,t){var r=La();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=La();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=lM.bind(null,gr,e),[n.memoizedState,e]},useRef:function(e){var t=La();return e={current:e},t.memoizedState=e},useState:fA,useDebugValue:E2,useDeferredValue:function(e){return La().memoizedState=e},useTransition:function(){var e=fA(!1),t=e[0];return e=oM.bind(null,e[1]),La().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=gr,i=La();if(ur){if(r===void 0)throw Error(Me(407));r=r()}else{if(r=t(),on===null)throw Error(Me(349));al&30||oT(n,t,r)}i.memoizedState=r;var a={value:r,getSnapshot:t};return i.queue=a,dA(cT.bind(null,n,a,e),[e]),n.flags|=2048,_0(9,lT.bind(null,n,a,r,t),void 0,null),r},useId:function(){var e=La(),t=on.identifierPrefix;if(ur){var r=as,n=is;r=(n&~(1<<32-ya(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=C0++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=sM++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},fM={readContext:Zi,useCallback:xT,useContext:Zi,useEffect:w2,useImperativeHandle:mT,useInsertionEffect:hT,useLayoutEffect:pT,useMemo:vT,useReducer:Hg,useRef:dT,useState:function(){return Hg(S0)},useDebugValue:E2,useDeferredValue:function(e){var t=qi();return yT(t,Wr.memoizedState,e)},useTransition:function(){var e=Hg(S0)[0],t=qi().memoizedState;return[e,t]},useMutableSource:aT,useSyncExternalStore:sT,useId:wT,unstable_isNewReconciler:!1},dM={readContext:Zi,useCallback:xT,useContext:Zi,useEffect:w2,useImperativeHandle:mT,useInsertionEffect:hT,useLayoutEffect:pT,useMemo:vT,useReducer:Gg,useRef:dT,useState:function(){return Gg(S0)},useDebugValue:E2,useDeferredValue:function(e){var t=qi();return Wr===null?t.memoizedState=e:yT(t,Wr.memoizedState,e)},useTransition:function(){var e=Gg(S0)[0],t=qi().memoizedState;return[e,t]},useMutableSource:aT,useSyncExternalStore:sT,useId:wT,unstable_isNewReconciler:!1};function ua(e,t){if(e&&e.defaultProps){t=mr({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function lx(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:mr({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var U1={isMounted:function(e){return(e=e._reactInternals)?Al(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Xn(),i=fo(e),a=cs(n,i);a.payload=t,r!=null&&(a.callback=r),t=co(e,a,i),t!==null&&(wa(t,e,i,n),Fd(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Xn(),i=fo(e),a=cs(n,i);a.tag=1,a.payload=t,r!=null&&(a.callback=r),t=co(e,a,i),t!==null&&(wa(t,e,i,n),Fd(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Xn(),n=fo(e),i=cs(r,n);i.tag=2,t!=null&&(i.callback=t),t=co(e,i,n),t!==null&&(wa(t,e,n,r),Fd(t,e,n))}};function hA(e,t,r,n,i,a,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,a,o):t.prototype&&t.prototype.isPureReactComponent?!x0(r,n)||!x0(i,a):!0}function ST(e,t,r){var n=!1,i=vo,a=t.contextType;return typeof a=="object"&&a!==null?a=Zi(a):(i=fi(t)?nl:Bn.current,n=t.contextTypes,a=(n=n!=null)?Sc(e,i):vo),t=new t(r,a),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=U1,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=a),t}function pA(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&U1.enqueueReplaceState(t,t.state,null)}function cx(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs={},h2(e);var a=t.contextType;typeof a=="object"&&a!==null?i.context=Zi(a):(a=fi(t)?nl:Bn.current,i.context=Sc(e,a)),i.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(lx(e,t,a,r),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&U1.enqueueReplaceState(i,i.state,null),uh(e,r,i,n),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function Oc(e,t){try{var r="",n=t;do r+=UD(n),n=n.return;while(n);var i=r}catch(a){i=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:t,stack:i,digest:null}}function $g(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function ux(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var hM=typeof WeakMap=="function"?WeakMap:Map;function _T(e,t,r){r=cs(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){gh||(gh=!0,wx=n),ux(e,t)},r}function bT(e,t,r){r=cs(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var i=t.value;r.payload=function(){return n(i)},r.callback=function(){ux(e,t)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(r.callback=function(){ux(e,t),typeof n!="function"&&(uo===null?uo=new Set([this]):uo.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),r}function gA(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new hM;var i=new Set;n.set(t,i)}else i=n.get(t),i===void 0&&(i=new Set,n.set(t,i));i.has(r)||(i.add(r),e=TM.bind(null,e,t,r),t.then(e,e))}function mA(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function xA(e,t,r,n,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=cs(-1,1),t.tag=2,co(r,t,1))),r.lanes|=1),e)}var pM=Ts.ReactCurrentOwner,oi=!1;function zn(e,t,r,n){t.child=e===null?tT(t,null,r,n):bc(t,e.child,r,n)}function vA(e,t,r,n,i){r=r.render;var a=t.ref;return mc(t,i),n=v2(e,t,r,n,a,i),r=y2(),e!==null&&!oi?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,xs(e,t,i)):(ur&&r&&s2(t),t.flags|=1,zn(e,t,n,i),t.child)}function yA(e,t,r,n,i){if(e===null){var a=r.type;return typeof a=="function"&&!k2(a)&&a.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=a,TT(e,t,a,n,i)):(e=Wd(r.type,null,n,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,!(e.lanes&i)){var o=a.memoizedProps;if(r=r.compare,r=r!==null?r:x0,r(o,n)&&e.ref===t.ref)return xs(e,t,i)}return t.flags|=1,e=ho(a,n),e.ref=t.ref,e.return=t,t.child=e}function TT(e,t,r,n,i){if(e!==null){var a=e.memoizedProps;if(x0(a,n)&&e.ref===t.ref)if(oi=!1,t.pendingProps=n=a,(e.lanes&i)!==0)e.flags&131072&&(oi=!0);else return t.lanes=e.lanes,xs(e,t,i)}return fx(e,t,r,n,i)}function OT(e,t,r){var n=t.pendingProps,i=n.children,a=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Zt(sc,yi),yi|=r;else{if(!(r&1073741824))return e=a!==null?a.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Zt(sc,yi),yi|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=a!==null?a.baseLanes:r,Zt(sc,yi),yi|=n}else a!==null?(n=a.baseLanes|r,t.memoizedState=null):n=r,Zt(sc,yi),yi|=n;return zn(e,t,i,r),t.child}function kT(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function fx(e,t,r,n,i){var a=fi(r)?nl:Bn.current;return a=Sc(t,a),mc(t,i),r=v2(e,t,r,n,a,i),n=y2(),e!==null&&!oi?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,xs(e,t,i)):(ur&&n&&s2(t),t.flags|=1,zn(e,t,r,i),t.child)}function wA(e,t,r,n,i){if(fi(r)){var a=!0;ah(t)}else a=!1;if(mc(t,i),t.stateNode===null)jd(e,t),ST(t,r,n),cx(t,r,n,i),n=!0;else if(e===null){var o=t.stateNode,c=t.memoizedProps;o.props=c;var f=o.context,d=r.contextType;typeof d=="object"&&d!==null?d=Zi(d):(d=fi(r)?nl:Bn.current,d=Sc(t,d));var h=r.getDerivedStateFromProps,m=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";m||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(c!==n||f!==d)&&pA(t,o,n,d),Xs=!1;var v=t.memoizedState;o.state=v,uh(t,n,o,i),f=t.memoizedState,c!==n||v!==f||ui.current||Xs?(typeof h=="function"&&(lx(t,r,h,n),f=t.memoizedState),(c=Xs||hA(t,r,c,n,v,f,d))?(m||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=f),o.props=n,o.state=f,o.context=d,n=c):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{o=t.stateNode,nT(e,t),c=t.memoizedProps,d=t.type===t.elementType?c:ua(t.type,c),o.props=d,m=t.pendingProps,v=o.context,f=r.contextType,typeof f=="object"&&f!==null?f=Zi(f):(f=fi(r)?nl:Bn.current,f=Sc(t,f));var w=r.getDerivedStateFromProps;(h=typeof w=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(c!==m||v!==f)&&pA(t,o,n,f),Xs=!1,v=t.memoizedState,o.state=v,uh(t,n,o,i);var E=t.memoizedState;c!==m||v!==E||ui.current||Xs?(typeof w=="function"&&(lx(t,r,w,n),E=t.memoizedState),(d=Xs||hA(t,r,d,n,v,E,f)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,E,f),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,E,f)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||c===e.memoizedProps&&v===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||c===e.memoizedProps&&v===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=E),o.props=n,o.state=E,o.context=f,n=d):(typeof o.componentDidUpdate!="function"||c===e.memoizedProps&&v===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||c===e.memoizedProps&&v===e.memoizedState||(t.flags|=1024),n=!1)}return dx(e,t,r,n,a,i)}function dx(e,t,r,n,i,a){kT(e,t);var o=(t.flags&128)!==0;if(!n&&!o)return i&&aA(t,r,!1),xs(e,t,a);n=t.stateNode,pM.current=t;var c=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&o?(t.child=bc(t,e.child,null,a),t.child=bc(t,null,c,a)):zn(e,t,c,a),t.memoizedState=n.state,i&&aA(t,r,!0),t.child}function IT(e){var t=e.stateNode;t.pendingContext?iA(e,t.pendingContext,t.pendingContext!==t.context):t.context&&iA(e,t.context,!1),p2(e,t.containerInfo)}function EA(e,t,r,n,i){return _c(),l2(i),t.flags|=256,zn(e,t,r,n),t.child}var hx={dehydrated:null,treeContext:null,retryLane:0};function px(e){return{baseLanes:e,cachePool:null,transitions:null}}function NT(e,t,r){var n=t.pendingProps,i=pr.current,a=!1,o=(t.flags&128)!==0,c;if((c=o)||(c=e!==null&&e.memoizedState===null?!1:(i&2)!==0),c?(a=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),Zt(pr,i&1),e===null)return sx(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=n.children,e=n.fallback,a?(n=t.mode,a=t.child,o={mode:"hidden",children:o},!(n&1)&&a!==null?(a.childLanes=0,a.pendingProps=o):a=V1(o,n,0,null),e=qo(e,n,r,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=px(r),t.memoizedState=hx,e):A2(t,o));if(i=e.memoizedState,i!==null&&(c=i.dehydrated,c!==null))return gM(e,t,o,n,c,i,r);if(a){a=n.fallback,o=t.mode,i=e.child,c=i.sibling;var f={mode:"hidden",children:n.children};return!(o&1)&&t.child!==i?(n=t.child,n.childLanes=0,n.pendingProps=f,t.deletions=null):(n=ho(i,f),n.subtreeFlags=i.subtreeFlags&14680064),c!==null?a=ho(c,a):(a=qo(a,o,r,null),a.flags|=2),a.return=t,n.return=t,n.sibling=a,t.child=n,n=a,a=t.child,o=e.child.memoizedState,o=o===null?px(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},a.memoizedState=o,a.childLanes=e.childLanes&~r,t.memoizedState=hx,n}return a=e.child,e=a.sibling,n=ho(a,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function A2(e,t){return t=V1({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function ed(e,t,r,n){return n!==null&&l2(n),bc(t,e.child,null,r),e=A2(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function gM(e,t,r,n,i,a,o){if(r)return t.flags&256?(t.flags&=-257,n=$g(Error(Me(422))),ed(e,t,o,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(a=n.fallback,i=t.mode,n=V1({mode:"visible",children:n.children},i,0,null),a=qo(a,i,o,null),a.flags|=2,n.return=t,a.return=t,n.sibling=a,t.child=n,t.mode&1&&bc(t,e.child,null,o),t.child.memoizedState=px(o),t.memoizedState=hx,a);if(!(t.mode&1))return ed(e,t,o,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var c=n.dgst;return n=c,a=Error(Me(419)),n=$g(a,n,void 0),ed(e,t,o,n)}if(c=(o&e.childLanes)!==0,oi||c){if(n=on,n!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|o)?0:i,i!==0&&i!==a.retryLane&&(a.retryLane=i,ms(e,i),wa(n,e,i,-1))}return O2(),n=$g(Error(Me(421))),ed(e,t,o,n)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=OM.bind(null,e),i._reactRetry=t,null):(e=a.treeContext,Ci=lo(i.nextSibling),_i=t,ur=!0,da=null,e!==null&&(Gi[$i++]=is,Gi[$i++]=as,Gi[$i++]=il,is=e.id,as=e.overflow,il=t),t=A2(t,n.children),t.flags|=4096,t)}function AA(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),ox(e.return,t,r)}function Xg(e,t,r,n,i){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=r,a.tailMode=i)}function PT(e,t,r){var n=t.pendingProps,i=n.revealOrder,a=n.tail;if(zn(e,t,n.children,r),n=pr.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&AA(e,r,t);else if(e.tag===19)AA(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Zt(pr,n),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(r=t.child,i=null;r!==null;)e=r.alternate,e!==null&&fh(e)===null&&(i=r),r=r.sibling;r=i,r===null?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),Xg(t,!1,i,r,a);break;case"backwards":for(r=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&fh(e)===null){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}Xg(t,!0,r,null,a);break;case"together":Xg(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function jd(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function xs(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),sl|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Me(153));if(t.child!==null){for(e=t.child,r=ho(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=ho(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function mM(e,t,r){switch(t.tag){case 3:IT(t),_c();break;case 5:iT(t);break;case 1:fi(t.type)&&ah(t);break;case 4:p2(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,i=t.memoizedProps.value;Zt(lh,n._currentValue),n._currentValue=i;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(Zt(pr,pr.current&1),t.flags|=128,null):r&t.child.childLanes?NT(e,t,r):(Zt(pr,pr.current&1),e=xs(e,t,r),e!==null?e.sibling:null);Zt(pr,pr.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return PT(e,t,r);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Zt(pr,pr.current),n)break;return null;case 22:case 23:return t.lanes=0,OT(e,t,r)}return xs(e,t,r)}var DT,gx,RT,MT;DT=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};gx=function(){};RT=function(e,t,r,n){var i=e.memoizedProps;if(i!==n){e=t.stateNode,Ho(Wa.current);var a=null;switch(r){case"input":i=Lm(e,i),n=Lm(e,n),a=[];break;case"select":i=mr({},i,{value:void 0}),n=mr({},n,{value:void 0}),a=[];break;case"textarea":i=Um(e,i),n=Um(e,n),a=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=nh)}Wm(r,n);var o;r=null;for(d in i)if(!n.hasOwnProperty(d)&&i.hasOwnProperty(d)&&i[d]!=null)if(d==="style"){var c=i[d];for(o in c)c.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(u0.hasOwnProperty(d)?a||(a=[]):(a=a||[]).push(d,null));for(d in n){var f=n[d];if(c=i!=null?i[d]:void 0,n.hasOwnProperty(d)&&f!==c&&(f!=null||c!=null))if(d==="style")if(c){for(o in c)!c.hasOwnProperty(o)||f&&f.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in f)f.hasOwnProperty(o)&&c[o]!==f[o]&&(r||(r={}),r[o]=f[o])}else r||(a||(a=[]),a.push(d,r)),r=f;else d==="dangerouslySetInnerHTML"?(f=f?f.__html:void 0,c=c?c.__html:void 0,f!=null&&c!==f&&(a=a||[]).push(d,f)):d==="children"?typeof f!="string"&&typeof f!="number"||(a=a||[]).push(d,""+f):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(u0.hasOwnProperty(d)?(f!=null&&d==="onScroll"&&tr("scroll",e),a||c===f||(a=[])):(a=a||[]).push(d,f))}r&&(a=a||[]).push("style",r);var d=a;(t.updateQueue=d)&&(t.flags|=4)}};MT=function(e,t,r,n){r!==n&&(t.flags|=4)};function Cu(e,t){if(!ur)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function On(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function xM(e,t,r){var n=t.pendingProps;switch(o2(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return On(t),null;case 1:return fi(t.type)&&ih(),On(t),null;case 3:return n=t.stateNode,Tc(),ir(ui),ir(Bn),m2(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Qf(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,da!==null&&(Cx(da),da=null))),gx(e,t),On(t),null;case 5:g2(t);var i=Ho(A0.current);if(r=t.type,e!==null&&t.stateNode!=null)RT(e,t,r,n,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(Me(166));return On(t),null}if(e=Ho(Wa.current),Qf(t)){n=t.stateNode,r=t.type;var a=t.memoizedProps;switch(n[Ba]=t,n[w0]=a,e=(t.mode&1)!==0,r){case"dialog":tr("cancel",n),tr("close",n);break;case"iframe":case"object":case"embed":tr("load",n);break;case"video":case"audio":for(i=0;i<Lu.length;i++)tr(Lu[i],n);break;case"source":tr("error",n);break;case"img":case"image":case"link":tr("error",n),tr("load",n);break;case"details":tr("toggle",n);break;case"input":NE(n,a),tr("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!a.multiple},tr("invalid",n);break;case"textarea":DE(n,a),tr("invalid",n)}Wm(r,a),i=null;for(var o in a)if(a.hasOwnProperty(o)){var c=a[o];o==="children"?typeof c=="string"?n.textContent!==c&&(a.suppressHydrationWarning!==!0&&qf(n.textContent,c,e),i=["children",c]):typeof c=="number"&&n.textContent!==""+c&&(a.suppressHydrationWarning!==!0&&qf(n.textContent,c,e),i=["children",""+c]):u0.hasOwnProperty(o)&&c!=null&&o==="onScroll"&&tr("scroll",n)}switch(r){case"input":Vf(n),PE(n,a,!0);break;case"textarea":Vf(n),RE(n);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(n.onclick=nh)}n=i,t.updateQueue=n,n!==null&&(t.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=cb(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=o.createElement(r,{is:n.is}):(e=o.createElement(r),r==="select"&&(o=e,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):e=o.createElementNS(e,r),e[Ba]=t,e[w0]=n,DT(e,t,!1,!1),t.stateNode=e;e:{switch(o=Vm(r,n),r){case"dialog":tr("cancel",e),tr("close",e),i=n;break;case"iframe":case"object":case"embed":tr("load",e),i=n;break;case"video":case"audio":for(i=0;i<Lu.length;i++)tr(Lu[i],e);i=n;break;case"source":tr("error",e),i=n;break;case"img":case"image":case"link":tr("error",e),tr("load",e),i=n;break;case"details":tr("toggle",e),i=n;break;case"input":NE(e,n),i=Lm(e,n),tr("invalid",e);break;case"option":i=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},i=mr({},n,{value:void 0}),tr("invalid",e);break;case"textarea":DE(e,n),i=Um(e,n),tr("invalid",e);break;default:i=n}Wm(r,i),c=i;for(a in c)if(c.hasOwnProperty(a)){var f=c[a];a==="style"?db(e,f):a==="dangerouslySetInnerHTML"?(f=f?f.__html:void 0,f!=null&&ub(e,f)):a==="children"?typeof f=="string"?(r!=="textarea"||f!=="")&&f0(e,f):typeof f=="number"&&f0(e,""+f):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(u0.hasOwnProperty(a)?f!=null&&a==="onScroll"&&tr("scroll",e):f!=null&&$v(e,a,f,o))}switch(r){case"input":Vf(e),PE(e,n,!1);break;case"textarea":Vf(e),RE(e);break;case"option":n.value!=null&&e.setAttribute("value",""+xo(n.value));break;case"select":e.multiple=!!n.multiple,a=n.value,a!=null?dc(e,!!n.multiple,a,!1):n.defaultValue!=null&&dc(e,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=nh)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return On(t),null;case 6:if(e&&t.stateNode!=null)MT(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(Me(166));if(r=Ho(A0.current),Ho(Wa.current),Qf(t)){if(n=t.stateNode,r=t.memoizedProps,n[Ba]=t,(a=n.nodeValue!==r)&&(e=_i,e!==null))switch(e.tag){case 3:qf(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&qf(n.nodeValue,r,(e.mode&1)!==0)}a&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Ba]=t,t.stateNode=n}return On(t),null;case 13:if(ir(pr),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(ur&&Ci!==null&&t.mode&1&&!(t.flags&128))Jb(),_c(),t.flags|=98560,a=!1;else if(a=Qf(t),n!==null&&n.dehydrated!==null){if(e===null){if(!a)throw Error(Me(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(Me(317));a[Ba]=t}else _c(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;On(t),a=!1}else da!==null&&(Cx(da),da=null),a=!0;if(!a)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||pr.current&1?Gr===0&&(Gr=3):O2())),t.updateQueue!==null&&(t.flags|=4),On(t),null);case 4:return Tc(),gx(e,t),e===null&&v0(t.stateNode.containerInfo),On(t),null;case 10:return f2(t.type._context),On(t),null;case 17:return fi(t.type)&&ih(),On(t),null;case 19:if(ir(pr),a=t.memoizedState,a===null)return On(t),null;if(n=(t.flags&128)!==0,o=a.rendering,o===null)if(n)Cu(a,!1);else{if(Gr!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=fh(e),o!==null){for(t.flags|=128,Cu(a,!1),n=o.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)a=r,e=n,a.flags&=14680066,o=a.alternate,o===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=o.childLanes,a.lanes=o.lanes,a.child=o.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=o.memoizedProps,a.memoizedState=o.memoizedState,a.updateQueue=o.updateQueue,a.type=o.type,e=o.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Zt(pr,pr.current&1|2),t.child}e=e.sibling}a.tail!==null&&Nr()>kc&&(t.flags|=128,n=!0,Cu(a,!1),t.lanes=4194304)}else{if(!n)if(e=fh(o),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Cu(a,!0),a.tail===null&&a.tailMode==="hidden"&&!o.alternate&&!ur)return On(t),null}else 2*Nr()-a.renderingStartTime>kc&&r!==1073741824&&(t.flags|=128,n=!0,Cu(a,!1),t.lanes=4194304);a.isBackwards?(o.sibling=t.child,t.child=o):(r=a.last,r!==null?r.sibling=o:t.child=o,a.last=o)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=Nr(),t.sibling=null,r=pr.current,Zt(pr,n?r&1|2:r&1),t):(On(t),null);case 22:case 23:return T2(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?yi&1073741824&&(On(t),t.subtreeFlags&6&&(t.flags|=8192)):On(t),null;case 24:return null;case 25:return null}throw Error(Me(156,t.tag))}function vM(e,t){switch(o2(t),t.tag){case 1:return fi(t.type)&&ih(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Tc(),ir(ui),ir(Bn),m2(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return g2(t),null;case 13:if(ir(pr),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Me(340));_c()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return ir(pr),null;case 4:return Tc(),null;case 10:return f2(t.type._context),null;case 22:case 23:return T2(),null;case 24:return null;default:return null}}var td=!1,Pn=!1,yM=typeof WeakSet=="function"?WeakSet:Set,Ke=null;function ac(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Sr(e,t,n)}else r.current=null}function mx(e,t,r){try{r()}catch(n){Sr(e,t,n)}}var CA=!1;function wM(e,t){if(Jm=eh,e=Ub(),a2(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{r.nodeType,a.nodeType}catch{r=null;break e}var o=0,c=-1,f=-1,d=0,h=0,m=e,v=null;t:for(;;){for(var w;m!==r||i!==0&&m.nodeType!==3||(c=o+i),m!==a||n!==0&&m.nodeType!==3||(f=o+n),m.nodeType===3&&(o+=m.nodeValue.length),(w=m.firstChild)!==null;)v=m,m=w;for(;;){if(m===e)break t;if(v===r&&++d===i&&(c=o),v===a&&++h===n&&(f=o),(w=m.nextSibling)!==null)break;m=v,v=m.parentNode}m=w}r=c===-1||f===-1?null:{start:c,end:f}}else r=null}r=r||{start:0,end:0}}else r=null;for(ex={focusedElem:e,selectionRange:r},eh=!1,Ke=t;Ke!==null;)if(t=Ke,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Ke=e;else for(;Ke!==null;){t=Ke;try{var E=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(E!==null){var A=E.memoizedProps,S=E.memoizedState,b=t.stateNode,T=b.getSnapshotBeforeUpdate(t.elementType===t.type?A:ua(t.type,A),S);b.__reactInternalSnapshotBeforeUpdate=T}break;case 3:var _=t.stateNode.containerInfo;_.nodeType===1?_.textContent="":_.nodeType===9&&_.documentElement&&_.removeChild(_.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Me(163))}}catch(N){Sr(t,t.return,N)}if(e=t.sibling,e!==null){e.return=t.return,Ke=e;break}Ke=t.return}return E=CA,CA=!1,E}function qu(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&e)===e){var a=i.destroy;i.destroy=void 0,a!==void 0&&mx(t,r,a)}i=i.next}while(i!==n)}}function z1(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function xx(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function FT(e){var t=e.alternate;t!==null&&(e.alternate=null,FT(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Ba],delete t[w0],delete t[nx],delete t[rM],delete t[nM])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function LT(e){return e.tag===5||e.tag===3||e.tag===4}function SA(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||LT(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function vx(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=nh));else if(n!==4&&(e=e.child,e!==null))for(vx(e,t,r),e=e.sibling;e!==null;)vx(e,t,r),e=e.sibling}function yx(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(yx(e,t,r),e=e.sibling;e!==null;)yx(e,t,r),e=e.sibling}var xn=null,fa=!1;function Hs(e,t,r){for(r=r.child;r!==null;)BT(e,t,r),r=r.sibling}function BT(e,t,r){if(za&&typeof za.onCommitFiberUnmount=="function")try{za.onCommitFiberUnmount(D1,r)}catch{}switch(r.tag){case 5:Pn||ac(r,t);case 6:var n=xn,i=fa;xn=null,Hs(e,t,r),xn=n,fa=i,xn!==null&&(fa?(e=xn,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):xn.removeChild(r.stateNode));break;case 18:xn!==null&&(fa?(e=xn,r=r.stateNode,e.nodeType===8?Ug(e.parentNode,r):e.nodeType===1&&Ug(e,r),g0(e)):Ug(xn,r.stateNode));break;case 4:n=xn,i=fa,xn=r.stateNode.containerInfo,fa=!0,Hs(e,t,r),xn=n,fa=i;break;case 0:case 11:case 14:case 15:if(!Pn&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var a=i,o=a.destroy;a=a.tag,o!==void 0&&(a&2||a&4)&&mx(r,t,o),i=i.next}while(i!==n)}Hs(e,t,r);break;case 1:if(!Pn&&(ac(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(c){Sr(r,t,c)}Hs(e,t,r);break;case 21:Hs(e,t,r);break;case 22:r.mode&1?(Pn=(n=Pn)||r.memoizedState!==null,Hs(e,t,r),Pn=n):Hs(e,t,r);break;default:Hs(e,t,r)}}function _A(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new yM),t.forEach(function(n){var i=kM.bind(null,e,n);r.has(n)||(r.add(n),n.then(i,i))})}}function oa(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var a=e,o=t,c=o;e:for(;c!==null;){switch(c.tag){case 5:xn=c.stateNode,fa=!1;break e;case 3:xn=c.stateNode.containerInfo,fa=!0;break e;case 4:xn=c.stateNode.containerInfo,fa=!0;break e}c=c.return}if(xn===null)throw Error(Me(160));BT(a,o,i),xn=null,fa=!1;var f=i.alternate;f!==null&&(f.return=null),i.return=null}catch(d){Sr(i,t,d)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)jT(t,e),t=t.sibling}function jT(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(oa(t,e),Na(e),n&4){try{qu(3,e,e.return),z1(3,e)}catch(A){Sr(e,e.return,A)}try{qu(5,e,e.return)}catch(A){Sr(e,e.return,A)}}break;case 1:oa(t,e),Na(e),n&512&&r!==null&&ac(r,r.return);break;case 5:if(oa(t,e),Na(e),n&512&&r!==null&&ac(r,r.return),e.flags&32){var i=e.stateNode;try{f0(i,"")}catch(A){Sr(e,e.return,A)}}if(n&4&&(i=e.stateNode,i!=null)){var a=e.memoizedProps,o=r!==null?r.memoizedProps:a,c=e.type,f=e.updateQueue;if(e.updateQueue=null,f!==null)try{c==="input"&&a.type==="radio"&&a.name!=null&&ob(i,a),Vm(c,o);var d=Vm(c,a);for(o=0;o<f.length;o+=2){var h=f[o],m=f[o+1];h==="style"?db(i,m):h==="dangerouslySetInnerHTML"?ub(i,m):h==="children"?f0(i,m):$v(i,h,m,d)}switch(c){case"input":Bm(i,a);break;case"textarea":lb(i,a);break;case"select":var v=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!a.multiple;var w=a.value;w!=null?dc(i,!!a.multiple,w,!1):v!==!!a.multiple&&(a.defaultValue!=null?dc(i,!!a.multiple,a.defaultValue,!0):dc(i,!!a.multiple,a.multiple?[]:"",!1))}i[w0]=a}catch(A){Sr(e,e.return,A)}}break;case 6:if(oa(t,e),Na(e),n&4){if(e.stateNode===null)throw Error(Me(162));i=e.stateNode,a=e.memoizedProps;try{i.nodeValue=a}catch(A){Sr(e,e.return,A)}}break;case 3:if(oa(t,e),Na(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{g0(t.containerInfo)}catch(A){Sr(e,e.return,A)}break;case 4:oa(t,e),Na(e);break;case 13:oa(t,e),Na(e),i=e.child,i.flags&8192&&(a=i.memoizedState!==null,i.stateNode.isHidden=a,!a||i.alternate!==null&&i.alternate.memoizedState!==null||(_2=Nr())),n&4&&_A(e);break;case 22:if(h=r!==null&&r.memoizedState!==null,e.mode&1?(Pn=(d=Pn)||h,oa(t,e),Pn=d):oa(t,e),Na(e),n&8192){if(d=e.memoizedState!==null,(e.stateNode.isHidden=d)&&!h&&e.mode&1)for(Ke=e,h=e.child;h!==null;){for(m=Ke=h;Ke!==null;){switch(v=Ke,w=v.child,v.tag){case 0:case 11:case 14:case 15:qu(4,v,v.return);break;case 1:ac(v,v.return);var E=v.stateNode;if(typeof E.componentWillUnmount=="function"){n=v,r=v.return;try{t=n,E.props=t.memoizedProps,E.state=t.memoizedState,E.componentWillUnmount()}catch(A){Sr(n,r,A)}}break;case 5:ac(v,v.return);break;case 22:if(v.memoizedState!==null){TA(m);continue}}w!==null?(w.return=v,Ke=w):TA(m)}h=h.sibling}e:for(h=null,m=e;;){if(m.tag===5){if(h===null){h=m;try{i=m.stateNode,d?(a=i.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(c=m.stateNode,f=m.memoizedProps.style,o=f!=null&&f.hasOwnProperty("display")?f.display:null,c.style.display=fb("display",o))}catch(A){Sr(e,e.return,A)}}}else if(m.tag===6){if(h===null)try{m.stateNode.nodeValue=d?"":m.memoizedProps}catch(A){Sr(e,e.return,A)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===e)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===e)break e;for(;m.sibling===null;){if(m.return===null||m.return===e)break e;h===m&&(h=null),m=m.return}h===m&&(h=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:oa(t,e),Na(e),n&4&&_A(e);break;case 21:break;default:oa(t,e),Na(e)}}function Na(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(LT(r)){var n=r;break e}r=r.return}throw Error(Me(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(f0(i,""),n.flags&=-33);var a=SA(e);yx(e,a,i);break;case 3:case 4:var o=n.stateNode.containerInfo,c=SA(e);vx(e,c,o);break;default:throw Error(Me(161))}}catch(f){Sr(e,e.return,f)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function EM(e,t,r){Ke=e,UT(e)}function UT(e,t,r){for(var n=(e.mode&1)!==0;Ke!==null;){var i=Ke,a=i.child;if(i.tag===22&&n){var o=i.memoizedState!==null||td;if(!o){var c=i.alternate,f=c!==null&&c.memoizedState!==null||Pn;c=td;var d=Pn;if(td=o,(Pn=f)&&!d)for(Ke=i;Ke!==null;)o=Ke,f=o.child,o.tag===22&&o.memoizedState!==null?OA(i):f!==null?(f.return=o,Ke=f):OA(i);for(;a!==null;)Ke=a,UT(a),a=a.sibling;Ke=i,td=c,Pn=d}bA(e)}else i.subtreeFlags&8772&&a!==null?(a.return=i,Ke=a):bA(e)}}function bA(e){for(;Ke!==null;){var t=Ke;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Pn||z1(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Pn)if(r===null)n.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:ua(t.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;a!==null&&uA(t,a,n);break;case 3:var o=t.updateQueue;if(o!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}uA(t,o,r)}break;case 5:var c=t.stateNode;if(r===null&&t.flags&4){r=c;var f=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":f.autoFocus&&r.focus();break;case"img":f.src&&(r.src=f.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var d=t.alternate;if(d!==null){var h=d.memoizedState;if(h!==null){var m=h.dehydrated;m!==null&&g0(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Me(163))}Pn||t.flags&512&&xx(t)}catch(v){Sr(t,t.return,v)}}if(t===e){Ke=null;break}if(r=t.sibling,r!==null){r.return=t.return,Ke=r;break}Ke=t.return}}function TA(e){for(;Ke!==null;){var t=Ke;if(t===e){Ke=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Ke=r;break}Ke=t.return}}function OA(e){for(;Ke!==null;){var t=Ke;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{z1(4,t)}catch(f){Sr(t,r,f)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var i=t.return;try{n.componentDidMount()}catch(f){Sr(t,i,f)}}var a=t.return;try{xx(t)}catch(f){Sr(t,a,f)}break;case 5:var o=t.return;try{xx(t)}catch(f){Sr(t,o,f)}}}catch(f){Sr(t,t.return,f)}if(t===e){Ke=null;break}var c=t.sibling;if(c!==null){c.return=t.return,Ke=c;break}Ke=t.return}}var AM=Math.ceil,ph=Ts.ReactCurrentDispatcher,C2=Ts.ReactCurrentOwner,Yi=Ts.ReactCurrentBatchConfig,It=0,on=null,Mr=null,En=0,yi=0,sc=Co(0),Gr=0,b0=null,sl=0,W1=0,S2=0,Qu=null,si=null,_2=0,kc=1/0,es=null,gh=!1,wx=null,uo=null,rd=!1,to=null,mh=0,Ju=0,Ex=null,Ud=-1,zd=0;function Xn(){return It&6?Nr():Ud!==-1?Ud:Ud=Nr()}function fo(e){return e.mode&1?It&2&&En!==0?En&-En:aM.transition!==null?(zd===0&&(zd=Sb()),zd):(e=Lt,e!==0||(e=window.event,e=e===void 0?16:Nb(e.type)),e):1}function wa(e,t,r,n){if(50<Ju)throw Ju=0,Ex=null,Error(Me(185));ef(e,r,n),(!(It&2)||e!==on)&&(e===on&&(!(It&2)&&(W1|=r),Gr===4&&qs(e,En)),di(e,n),r===1&&It===0&&!(t.mode&1)&&(kc=Nr()+500,B1&&So()))}function di(e,t){var r=e.callbackNode;aR(e,t);var n=Jd(e,e===on?En:0);if(n===0)r!==null&&LE(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&LE(r),t===1)e.tag===0?iM(kA.bind(null,e)):Zb(kA.bind(null,e)),eM(function(){!(It&6)&&So()}),r=null;else{switch(_b(n)){case 1:r=qv;break;case 4:r=Ab;break;case 16:r=Qd;break;case 536870912:r=Cb;break;default:r=Qd}r=KT(r,zT.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function zT(e,t){if(Ud=-1,zd=0,It&6)throw Error(Me(327));var r=e.callbackNode;if(xc()&&e.callbackNode!==r)return null;var n=Jd(e,e===on?En:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=xh(e,n);else{t=n;var i=It;It|=2;var a=VT();(on!==e||En!==t)&&(es=null,kc=Nr()+500,Zo(e,t));do try{_M();break}catch(c){WT(e,c)}while(!0);u2(),ph.current=a,It=i,Mr!==null?t=0:(on=null,En=0,t=Gr)}if(t!==0){if(t===2&&(i=Km(e),i!==0&&(n=i,t=Ax(e,i))),t===1)throw r=b0,Zo(e,0),qs(e,n),di(e,Nr()),r;if(t===6)qs(e,n);else{if(i=e.current.alternate,!(n&30)&&!CM(i)&&(t=xh(e,n),t===2&&(a=Km(e),a!==0&&(n=a,t=Ax(e,a))),t===1))throw r=b0,Zo(e,0),qs(e,n),di(e,Nr()),r;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(Me(345));case 2:Lo(e,si,es);break;case 3:if(qs(e,n),(n&130023424)===n&&(t=_2+500-Nr(),10<t)){if(Jd(e,0)!==0)break;if(i=e.suspendedLanes,(i&n)!==n){Xn(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=rx(Lo.bind(null,e,si,es),t);break}Lo(e,si,es);break;case 4:if(qs(e,n),(n&4194240)===n)break;for(t=e.eventTimes,i=-1;0<n;){var o=31-ya(n);a=1<<o,o=t[o],o>i&&(i=o),n&=~a}if(n=i,n=Nr()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*AM(n/1960))-n,10<n){e.timeoutHandle=rx(Lo.bind(null,e,si,es),n);break}Lo(e,si,es);break;case 5:Lo(e,si,es);break;default:throw Error(Me(329))}}}return di(e,Nr()),e.callbackNode===r?zT.bind(null,e):null}function Ax(e,t){var r=Qu;return e.current.memoizedState.isDehydrated&&(Zo(e,t).flags|=256),e=xh(e,t),e!==2&&(t=si,si=r,t!==null&&Cx(t)),e}function Cx(e){si===null?si=e:si.push.apply(si,e)}function CM(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],a=i.getSnapshot;i=i.value;try{if(!Ca(a(),i))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function qs(e,t){for(t&=~S2,t&=~W1,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-ya(t),n=1<<r;e[r]=-1,t&=~n}}function kA(e){if(It&6)throw Error(Me(327));xc();var t=Jd(e,0);if(!(t&1))return di(e,Nr()),null;var r=xh(e,t);if(e.tag!==0&&r===2){var n=Km(e);n!==0&&(t=n,r=Ax(e,n))}if(r===1)throw r=b0,Zo(e,0),qs(e,t),di(e,Nr()),r;if(r===6)throw Error(Me(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Lo(e,si,es),di(e,Nr()),null}function b2(e,t){var r=It;It|=1;try{return e(t)}finally{It=r,It===0&&(kc=Nr()+500,B1&&So())}}function ol(e){to!==null&&to.tag===0&&!(It&6)&&xc();var t=It;It|=1;var r=Yi.transition,n=Lt;try{if(Yi.transition=null,Lt=1,e)return e()}finally{Lt=n,Yi.transition=r,It=t,!(It&6)&&So()}}function T2(){yi=sc.current,ir(sc)}function Zo(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,JR(r)),Mr!==null)for(r=Mr.return;r!==null;){var n=r;switch(o2(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&ih();break;case 3:Tc(),ir(ui),ir(Bn),m2();break;case 5:g2(n);break;case 4:Tc();break;case 13:ir(pr);break;case 19:ir(pr);break;case 10:f2(n.type._context);break;case 22:case 23:T2()}r=r.return}if(on=e,Mr=e=ho(e.current,null),En=yi=t,Gr=0,b0=null,S2=W1=sl=0,si=Qu=null,Vo!==null){for(t=0;t<Vo.length;t++)if(r=Vo[t],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,a=r.pending;if(a!==null){var o=a.next;a.next=i,n.next=o}r.pending=n}Vo=null}return e}function WT(e,t){do{var r=Mr;try{if(u2(),Ld.current=hh,dh){for(var n=gr.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}dh=!1}if(al=0,an=Wr=gr=null,Zu=!1,C0=0,C2.current=null,r===null||r.return===null){Gr=1,b0=t,Mr=null;break}e:{var a=e,o=r.return,c=r,f=t;if(t=En,c.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){var d=f,h=c,m=h.tag;if(!(h.mode&1)&&(m===0||m===11||m===15)){var v=h.alternate;v?(h.updateQueue=v.updateQueue,h.memoizedState=v.memoizedState,h.lanes=v.lanes):(h.updateQueue=null,h.memoizedState=null)}var w=mA(o);if(w!==null){w.flags&=-257,xA(w,o,c,a,t),w.mode&1&&gA(a,d,t),t=w,f=d;var E=t.updateQueue;if(E===null){var A=new Set;A.add(f),t.updateQueue=A}else E.add(f);break e}else{if(!(t&1)){gA(a,d,t),O2();break e}f=Error(Me(426))}}else if(ur&&c.mode&1){var S=mA(o);if(S!==null){!(S.flags&65536)&&(S.flags|=256),xA(S,o,c,a,t),l2(Oc(f,c));break e}}a=f=Oc(f,c),Gr!==4&&(Gr=2),Qu===null?Qu=[a]:Qu.push(a),a=o;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t;var b=_T(a,f,t);cA(a,b);break e;case 1:c=f;var T=a.type,_=a.stateNode;if(!(a.flags&128)&&(typeof T.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&(uo===null||!uo.has(_)))){a.flags|=65536,t&=-t,a.lanes|=t;var N=bT(a,c,t);cA(a,N);break e}}a=a.return}while(a!==null)}GT(r)}catch(M){t=M,Mr===r&&r!==null&&(Mr=r=r.return);continue}break}while(!0)}function VT(){var e=ph.current;return ph.current=hh,e===null?hh:e}function O2(){(Gr===0||Gr===3||Gr===2)&&(Gr=4),on===null||!(sl&268435455)&&!(W1&268435455)||qs(on,En)}function xh(e,t){var r=It;It|=2;var n=VT();(on!==e||En!==t)&&(es=null,Zo(e,t));do try{SM();break}catch(i){WT(e,i)}while(!0);if(u2(),It=r,ph.current=n,Mr!==null)throw Error(Me(261));return on=null,En=0,Gr}function SM(){for(;Mr!==null;)HT(Mr)}function _M(){for(;Mr!==null&&!ZD();)HT(Mr)}function HT(e){var t=XT(e.alternate,e,yi);e.memoizedProps=e.pendingProps,t===null?GT(e):Mr=t,C2.current=null}function GT(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=vM(r,t),r!==null){r.flags&=32767,Mr=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Gr=6,Mr=null;return}}else if(r=xM(r,t,yi),r!==null){Mr=r;return}if(t=t.sibling,t!==null){Mr=t;return}Mr=t=e}while(t!==null);Gr===0&&(Gr=5)}function Lo(e,t,r){var n=Lt,i=Yi.transition;try{Yi.transition=null,Lt=1,bM(e,t,r,n)}finally{Yi.transition=i,Lt=n}return null}function bM(e,t,r,n){do xc();while(to!==null);if(It&6)throw Error(Me(327));r=e.finishedWork;var i=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Me(177));e.callbackNode=null,e.callbackPriority=0;var a=r.lanes|r.childLanes;if(sR(e,a),e===on&&(Mr=on=null,En=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||rd||(rd=!0,KT(Qd,function(){return xc(),null})),a=(r.flags&15990)!==0,r.subtreeFlags&15990||a){a=Yi.transition,Yi.transition=null;var o=Lt;Lt=1;var c=It;It|=4,C2.current=null,wM(e,r),jT(r,e),$R(ex),eh=!!Jm,ex=Jm=null,e.current=r,EM(r),qD(),It=c,Lt=o,Yi.transition=a}else e.current=r;if(rd&&(rd=!1,to=e,mh=i),a=e.pendingLanes,a===0&&(uo=null),eR(r.stateNode),di(e,Nr()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)i=t[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(gh)throw gh=!1,e=wx,wx=null,e;return mh&1&&e.tag!==0&&xc(),a=e.pendingLanes,a&1?e===Ex?Ju++:(Ju=0,Ex=e):Ju=0,So(),null}function xc(){if(to!==null){var e=_b(mh),t=Yi.transition,r=Lt;try{if(Yi.transition=null,Lt=16>e?16:e,to===null)var n=!1;else{if(e=to,to=null,mh=0,It&6)throw Error(Me(331));var i=It;for(It|=4,Ke=e.current;Ke!==null;){var a=Ke,o=a.child;if(Ke.flags&16){var c=a.deletions;if(c!==null){for(var f=0;f<c.length;f++){var d=c[f];for(Ke=d;Ke!==null;){var h=Ke;switch(h.tag){case 0:case 11:case 15:qu(8,h,a)}var m=h.child;if(m!==null)m.return=h,Ke=m;else for(;Ke!==null;){h=Ke;var v=h.sibling,w=h.return;if(FT(h),h===d){Ke=null;break}if(v!==null){v.return=w,Ke=v;break}Ke=w}}}var E=a.alternate;if(E!==null){var A=E.child;if(A!==null){E.child=null;do{var S=A.sibling;A.sibling=null,A=S}while(A!==null)}}Ke=a}}if(a.subtreeFlags&2064&&o!==null)o.return=a,Ke=o;else e:for(;Ke!==null;){if(a=Ke,a.flags&2048)switch(a.tag){case 0:case 11:case 15:qu(9,a,a.return)}var b=a.sibling;if(b!==null){b.return=a.return,Ke=b;break e}Ke=a.return}}var T=e.current;for(Ke=T;Ke!==null;){o=Ke;var _=o.child;if(o.subtreeFlags&2064&&_!==null)_.return=o,Ke=_;else e:for(o=T;Ke!==null;){if(c=Ke,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:z1(9,c)}}catch(M){Sr(c,c.return,M)}if(c===o){Ke=null;break e}var N=c.sibling;if(N!==null){N.return=c.return,Ke=N;break e}Ke=c.return}}if(It=i,So(),za&&typeof za.onPostCommitFiberRoot=="function")try{za.onPostCommitFiberRoot(D1,e)}catch{}n=!0}return n}finally{Lt=r,Yi.transition=t}}return!1}function IA(e,t,r){t=Oc(r,t),t=_T(e,t,1),e=co(e,t,1),t=Xn(),e!==null&&(ef(e,1,t),di(e,t))}function Sr(e,t,r){if(e.tag===3)IA(e,e,r);else for(;t!==null;){if(t.tag===3){IA(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(uo===null||!uo.has(n))){e=Oc(r,e),e=bT(t,e,1),t=co(t,e,1),e=Xn(),t!==null&&(ef(t,1,e),di(t,e));break}}t=t.return}}function TM(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Xn(),e.pingedLanes|=e.suspendedLanes&r,on===e&&(En&r)===r&&(Gr===4||Gr===3&&(En&130023424)===En&&500>Nr()-_2?Zo(e,0):S2|=r),di(e,t)}function $T(e,t){t===0&&(e.mode&1?(t=$f,$f<<=1,!($f&130023424)&&($f=4194304)):t=1);var r=Xn();e=ms(e,t),e!==null&&(ef(e,t,r),di(e,r))}function OM(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),$T(e,r)}function kM(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(Me(314))}n!==null&&n.delete(t),$T(e,r)}var XT;XT=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||ui.current)oi=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return oi=!1,mM(e,t,r);oi=!!(e.flags&131072)}else oi=!1,ur&&t.flags&1048576&&qb(t,oh,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;jd(e,t),e=t.pendingProps;var i=Sc(t,Bn.current);mc(t,r),i=v2(null,t,n,e,i,r);var a=y2();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,fi(n)?(a=!0,ah(t)):a=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,h2(t),i.updater=U1,t.stateNode=i,i._reactInternals=t,cx(t,n,e,r),t=dx(null,t,n,!0,a,r)):(t.tag=0,ur&&a&&s2(t),zn(null,t,i,r),t=t.child),t;case 16:n=t.elementType;e:{switch(jd(e,t),e=t.pendingProps,i=n._init,n=i(n._payload),t.type=n,i=t.tag=NM(n),e=ua(n,e),i){case 0:t=fx(null,t,n,e,r);break e;case 1:t=wA(null,t,n,e,r);break e;case 11:t=vA(null,t,n,e,r);break e;case 14:t=yA(null,t,n,ua(n.type,e),r);break e}throw Error(Me(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:ua(n,i),fx(e,t,n,i,r);case 1:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:ua(n,i),wA(e,t,n,i,r);case 3:e:{if(IT(t),e===null)throw Error(Me(387));n=t.pendingProps,a=t.memoizedState,i=a.element,nT(e,t),uh(t,n,null,r);var o=t.memoizedState;if(n=o.element,a.isDehydrated)if(a={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=a,t.memoizedState=a,t.flags&256){i=Oc(Error(Me(423)),t),t=EA(e,t,n,r,i);break e}else if(n!==i){i=Oc(Error(Me(424)),t),t=EA(e,t,n,r,i);break e}else for(Ci=lo(t.stateNode.containerInfo.firstChild),_i=t,ur=!0,da=null,r=tT(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(_c(),n===i){t=xs(e,t,r);break e}zn(e,t,n,r)}t=t.child}return t;case 5:return iT(t),e===null&&sx(t),n=t.type,i=t.pendingProps,a=e!==null?e.memoizedProps:null,o=i.children,tx(n,i)?o=null:a!==null&&tx(n,a)&&(t.flags|=32),kT(e,t),zn(e,t,o,r),t.child;case 6:return e===null&&sx(t),null;case 13:return NT(e,t,r);case 4:return p2(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=bc(t,null,n,r):zn(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:ua(n,i),vA(e,t,n,i,r);case 7:return zn(e,t,t.pendingProps,r),t.child;case 8:return zn(e,t,t.pendingProps.children,r),t.child;case 12:return zn(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,a=t.memoizedProps,o=i.value,Zt(lh,n._currentValue),n._currentValue=o,a!==null)if(Ca(a.value,o)){if(a.children===i.children&&!ui.current){t=xs(e,t,r);break e}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var c=a.dependencies;if(c!==null){o=a.child;for(var f=c.firstContext;f!==null;){if(f.context===n){if(a.tag===1){f=cs(-1,r&-r),f.tag=2;var d=a.updateQueue;if(d!==null){d=d.shared;var h=d.pending;h===null?f.next=f:(f.next=h.next,h.next=f),d.pending=f}}a.lanes|=r,f=a.alternate,f!==null&&(f.lanes|=r),ox(a.return,r,t),c.lanes|=r;break}f=f.next}}else if(a.tag===10)o=a.type===t.type?null:a.child;else if(a.tag===18){if(o=a.return,o===null)throw Error(Me(341));o.lanes|=r,c=o.alternate,c!==null&&(c.lanes|=r),ox(o,r,t),o=a.sibling}else o=a.child;if(o!==null)o.return=a;else for(o=a;o!==null;){if(o===t){o=null;break}if(a=o.sibling,a!==null){a.return=o.return,o=a;break}o=o.return}a=o}zn(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,mc(t,r),i=Zi(i),n=n(i),t.flags|=1,zn(e,t,n,r),t.child;case 14:return n=t.type,i=ua(n,t.pendingProps),i=ua(n.type,i),yA(e,t,n,i,r);case 15:return TT(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:ua(n,i),jd(e,t),t.tag=1,fi(n)?(e=!0,ah(t)):e=!1,mc(t,r),ST(t,n,i),cx(t,n,i,r),dx(null,t,n,!0,e,r);case 19:return PT(e,t,r);case 22:return OT(e,t,r)}throw Error(Me(156,t.tag))};function KT(e,t){return Eb(e,t)}function IM(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Xi(e,t,r,n){return new IM(e,t,r,n)}function k2(e){return e=e.prototype,!(!e||!e.isReactComponent)}function NM(e){if(typeof e=="function")return k2(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Kv)return 11;if(e===Yv)return 14}return 2}function ho(e,t){var r=e.alternate;return r===null?(r=Xi(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Wd(e,t,r,n,i,a){var o=2;if(n=e,typeof e=="function")k2(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case Zl:return qo(r.children,i,a,t);case Xv:o=8,i|=8;break;case Dm:return e=Xi(12,r,t,i|2),e.elementType=Dm,e.lanes=a,e;case Rm:return e=Xi(13,r,t,i),e.elementType=Rm,e.lanes=a,e;case Mm:return e=Xi(19,r,t,i),e.elementType=Mm,e.lanes=a,e;case ib:return V1(r,i,a,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case rb:o=10;break e;case nb:o=9;break e;case Kv:o=11;break e;case Yv:o=14;break e;case $s:o=16,n=null;break e}throw Error(Me(130,e==null?e:typeof e,""))}return t=Xi(o,r,t,i),t.elementType=e,t.type=n,t.lanes=a,t}function qo(e,t,r,n){return e=Xi(7,e,n,t),e.lanes=r,e}function V1(e,t,r,n){return e=Xi(22,e,n,t),e.elementType=ib,e.lanes=r,e.stateNode={isHidden:!1},e}function Kg(e,t,r){return e=Xi(6,e,null,t),e.lanes=r,e}function Yg(e,t,r){return t=Xi(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function PM(e,t,r,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=kg(0),this.expirationTimes=kg(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=kg(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function I2(e,t,r,n,i,a,o,c,f){return e=new PM(e,t,r,c,f),t===1?(t=1,a===!0&&(t|=8)):t=0,a=Xi(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},h2(a),e}function DM(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Yl,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function YT(e){if(!e)return vo;e=e._reactInternals;e:{if(Al(e)!==e||e.tag!==1)throw Error(Me(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(fi(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Me(171))}if(e.tag===1){var r=e.type;if(fi(r))return Yb(e,r,t)}return t}function ZT(e,t,r,n,i,a,o,c,f){return e=I2(r,n,!0,e,i,a,o,c,f),e.context=YT(null),r=e.current,n=Xn(),i=fo(r),a=cs(n,i),a.callback=t??null,co(r,a,i),e.current.lanes=i,ef(e,i,n),di(e,n),e}function H1(e,t,r,n){var i=t.current,a=Xn(),o=fo(i);return r=YT(r),t.context===null?t.context=r:t.pendingContext=r,t=cs(a,o),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=co(i,t,o),e!==null&&(wa(e,i,o,a),Fd(e,i,o)),o}function vh(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function NA(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function N2(e,t){NA(e,t),(e=e.alternate)&&NA(e,t)}function RM(){return null}var qT=typeof reportError=="function"?reportError:function(e){console.error(e)};function P2(e){this._internalRoot=e}G1.prototype.render=P2.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Me(409));H1(e,t,null,null)};G1.prototype.unmount=P2.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;ol(function(){H1(null,e,null,null)}),t[gs]=null}};function G1(e){this._internalRoot=e}G1.prototype.unstable_scheduleHydration=function(e){if(e){var t=Ob();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Zs.length&&t!==0&&t<Zs[r].priority;r++);Zs.splice(r,0,e),r===0&&Ib(e)}};function D2(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function $1(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function PA(){}function MM(e,t,r,n,i){if(i){if(typeof n=="function"){var a=n;n=function(){var d=vh(o);a.call(d)}}var o=ZT(t,n,e,0,null,!1,!1,"",PA);return e._reactRootContainer=o,e[gs]=o.current,v0(e.nodeType===8?e.parentNode:e),ol(),o}for(;i=e.lastChild;)e.removeChild(i);if(typeof n=="function"){var c=n;n=function(){var d=vh(f);c.call(d)}}var f=I2(e,0,!1,null,null,!1,!1,"",PA);return e._reactRootContainer=f,e[gs]=f.current,v0(e.nodeType===8?e.parentNode:e),ol(function(){H1(t,f,r,n)}),f}function X1(e,t,r,n,i){var a=r._reactRootContainer;if(a){var o=a;if(typeof i=="function"){var c=i;i=function(){var f=vh(o);c.call(f)}}H1(t,o,e,i)}else o=MM(r,t,e,i,n);return vh(o)}bb=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Fu(t.pendingLanes);r!==0&&(Qv(t,r|1),di(t,Nr()),!(It&6)&&(kc=Nr()+500,So()))}break;case 13:ol(function(){var n=ms(e,1);if(n!==null){var i=Xn();wa(n,e,1,i)}}),N2(e,1)}};Jv=function(e){if(e.tag===13){var t=ms(e,134217728);if(t!==null){var r=Xn();wa(t,e,134217728,r)}N2(e,134217728)}};Tb=function(e){if(e.tag===13){var t=fo(e),r=ms(e,t);if(r!==null){var n=Xn();wa(r,e,t,n)}N2(e,t)}};Ob=function(){return Lt};kb=function(e,t){var r=Lt;try{return Lt=e,t()}finally{Lt=r}};Gm=function(e,t,r){switch(t){case"input":if(Bm(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=L1(n);if(!i)throw Error(Me(90));sb(n),Bm(n,i)}}}break;case"textarea":lb(e,r);break;case"select":t=r.value,t!=null&&dc(e,!!r.multiple,t,!1)}};gb=b2;mb=ol;var FM={usingClientEntryPoint:!1,Events:[rf,ec,L1,hb,pb,b2]},Su={findFiberByHostInstance:Wo,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},LM={bundleType:Su.bundleType,version:Su.version,rendererPackageName:Su.rendererPackageName,rendererConfig:Su.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ts.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=yb(e),e===null?null:e.stateNode},findFiberByHostInstance:Su.findFiberByHostInstance||RM,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var nd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!nd.isDisabled&&nd.supportsFiber)try{D1=nd.inject(LM),za=nd}catch{}}Ii.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=FM;Ii.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!D2(t))throw Error(Me(200));return DM(e,t,null,r)};Ii.createRoot=function(e,t){if(!D2(e))throw Error(Me(299));var r=!1,n="",i=qT;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=I2(e,1,!1,null,null,r,!1,n,i),e[gs]=t.current,v0(e.nodeType===8?e.parentNode:e),new P2(t)};Ii.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Me(188)):(e=Object.keys(e).join(","),Error(Me(268,e)));return e=yb(t),e=e===null?null:e.stateNode,e};Ii.flushSync=function(e){return ol(e)};Ii.hydrate=function(e,t,r){if(!$1(t))throw Error(Me(200));return X1(null,e,t,!0,r)};Ii.hydrateRoot=function(e,t,r){if(!D2(e))throw Error(Me(405));var n=r!=null&&r.hydratedSources||null,i=!1,a="",o=qT;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(a=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),t=ZT(t,null,e,1,r??null,i,!1,a,o),e[gs]=t.current,v0(e),n)for(e=0;e<n.length;e++)r=n[e],i=r._getVersion,i=i(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,i]:t.mutableSourceEagerHydrationData.push(r,i);return new G1(t)};Ii.render=function(e,t,r){if(!$1(t))throw Error(Me(200));return X1(null,e,t,!1,r)};Ii.unmountComponentAtNode=function(e){if(!$1(e))throw Error(Me(40));return e._reactRootContainer?(ol(function(){X1(null,null,e,!1,function(){e._reactRootContainer=null,e[gs]=null})}),!0):!1};Ii.unstable_batchedUpdates=b2;Ii.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!$1(r))throw Error(Me(200));if(e==null||e._reactInternals===void 0)throw Error(Me(38));return X1(e,t,r,!1,n)};Ii.version="18.3.1-next-f1338f8080-20240426";function QT(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(QT)}catch(e){console.error(e)}}QT(),Q4.exports=Ii;var af=Q4.exports,DA=af;Nm.createRoot=DA.createRoot,Nm.hydrateRoot=DA.hydrateRoot;/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JT=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim();/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BM=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jM=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,r,n)=>n?n.toUpperCase():r.toLowerCase());/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RA=e=>{const t=jM(e);return t.charAt(0).toUpperCase()+t.slice(1)};/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var UM={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zM=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0;return!1};/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WM=I.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:i="",children:a,iconNode:o,...c},f)=>I.createElement("svg",{ref:f,...UM,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:JT("lucide",i),...!a&&!zM(c)&&{"aria-hidden":"true"},...c},[...o.map(([d,h])=>I.createElement(d,h)),...Array.isArray(a)?a:[a]]));/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zt=(e,t)=>{const r=I.forwardRef(({className:n,...i},a)=>I.createElement(WM,{ref:a,iconNode:t,className:JT(`lucide-${BM(RA(e))}`,`lucide-${e}`,n),...i}));return r.displayName=RA(e),r};/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VM=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],e8=zt("book-open",VM);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HM=[["path",{d:"M10 12h4",key:"a56b0p"}],["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2",key:"secmi2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16",key:"16ra0t"}]],GM=zt("building-2",HM);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $M=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],t8=zt("chart-column",$M);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XM=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],K1=zt("check",XM);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KM=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],YM=zt("circle-alert",KM);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZM=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],Y1=zt("clipboard-list",ZM);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qM=[["path",{d:"M4 9a2 2 0 0 0-2 2v2a2 2 0 0 0 2 2h4a1 1 0 0 1 1 1v4a2 2 0 0 0 2 2h2a2 2 0 0 0 2-2v-4a1 1 0 0 1 1-1h4a2 2 0 0 0 2-2v-2a2 2 0 0 0-2-2h-4a1 1 0 0 1-1-1V4a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v4a1 1 0 0 1-1 1z",key:"1xbrqy"}]],QM=zt("cross",qM);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JM=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],r8=zt("dollar-sign",JM);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e7=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],t7=zt("eye",e7);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r7=[["path",{d:"M14 2v6a2 2 0 0 0 .245.96l5.51 10.08A2 2 0 0 1 18 22H6a2 2 0 0 1-1.755-2.96l5.51-10.08A2 2 0 0 0 10 8V2",key:"18mbvz"}],["path",{d:"M6.453 15h11.094",key:"3shlmq"}],["path",{d:"M8.5 2h7",key:"csnxdl"}]],n7=zt("flask-conical",r7);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i7=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],MA=zt("folder-open",i7);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a7=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]],s7=zt("heart",a7);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o7=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],l7=zt("house",o7);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c7=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],u7=zt("lock",c7);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f7=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],d7=zt("log-out",f7);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h7=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],p7=zt("menu",h7);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g7=[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]],m7=zt("moon",g7);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x7=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],v7=zt("printer",x7);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y7=[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}],["path",{d:"M7 12h10",key:"b7w52i"}]],T0=zt("scan-line",y7);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w7=[["path",{d:"M14 9.536V7a4 4 0 0 1 4-4h1.5a.5.5 0 0 1 .5.5V5a4 4 0 0 1-4 4 4 4 0 0 0-4 4c0 2 1 3 1 5a5 5 0 0 1-1 3",key:"139s4v"}],["path",{d:"M4 9a5 5 0 0 1 8 4 5 5 0 0 1-8-4",key:"1dlkgp"}],["path",{d:"M5 21h14",key:"11awu3"}]],E7=zt("sprout",w7);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A7=[["path",{d:"M11 2v2",key:"1539x4"}],["path",{d:"M5 2v2",key:"1yf1q8"}],["path",{d:"M5 3H4a2 2 0 0 0-2 2v4a6 6 0 0 0 12 0V5a2 2 0 0 0-2-2h-1",key:"rb5t3r"}],["path",{d:"M8 15a6 6 0 0 0 12 0v-3",key:"x18d4x"}],["circle",{cx:"20",cy:"10",r:"2",key:"ts1r5v"}]],C7=zt("stethoscope",A7);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S7=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],_7=zt("sun",S7);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b7=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],n8=zt("trending-up",b7);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T7=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],O7=zt("triangle-alert",T7);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k7=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],I7=zt("upload",k7);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N7=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],P7=zt("user-plus",N7);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D7=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],R2=zt("users",D7);/**
 * @license lucide-react v0.575.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R7=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],M7=zt("x",R7),F7=({toasts:e})=>k.jsx("div",{className:"toast-container","aria-live":"polite",children:e.map(t=>k.jsxs("div",{className:`toast toast-${t.size} toast-${t.type}`,role:"alert",children:[k.jsx("span",{className:"toast-icon",children:t.type==="success"?k.jsx(K1,{size:18,strokeWidth:2.5}):k.jsx(M7,{size:18,strokeWidth:2.5})}),k.jsxs("div",{className:"toast-content",children:[t.title&&k.jsx("span",{className:"toast-title",children:t.title}),k.jsx("span",{className:"toast-message",children:t.message})]})]},t.id))}),i8=I.createContext(null),Cl=()=>{const e=I.useContext(i8);if(!e)throw new Error("useToast must be used within ToastProvider");return e},L7=({children:e})=>{const[t,r]=I.useState([]),n=I.useCallback(({message:a,type:o="success",size:c="small",title:f})=>{const d=Date.now()+Math.random();r(m=>[...m,{id:d,message:a,type:o,size:c,title:f}]),setTimeout(()=>{r(m=>m.filter(v=>v.id!==d))},c==="big"?4e3:3e3)},[]),i=I.useCallback((a,o={})=>{n({message:a,...o})},[n]);return k.jsxs(i8.Provider,{value:{addToast:n,toast:i},children:[e,k.jsx(F7,{toasts:t})]})},a8={instituteName:"Institute of Health Sciences",instituteAddress:"University of Peshawar",emergencyContact:"Emergency: 112",enablePhotoOnCard:!1,enableBackSidePrint:!0,autoPrintOnCheckIn:!0,playSoundOnPrint:!0},s8=I.createContext(null);function B7({children:e}){return k.jsx(s8.Provider,{value:{theme:a8,loading:!1,updateTheme:async()=>{}},children:e})}function sf(){return I.useContext(s8)||{theme:a8,loading:!1,updateTheme:async()=>{}}}const o8=I.createContext(null);function j7({children:e}){const[t,r]=I.useState(null);return k.jsx(o8.Provider,{value:{user:t,setUser:r},children:e})}function l8(){const e=I.useContext(o8);if(!e)throw new Error("useAuth must be used within AuthProvider");return e}const FA=({size:e="md"})=>k.jsx("div",{className:`loader loader-${e}`,role:"status","aria-label":"Loading",children:k.jsx("span",{className:"loader-spinner"})}),Ic=()=>k.jsx("span",{className:"loader-inline"}),c8="printWindow";function U7(e){const t=document.createElement("iframe");return t.width=`${document.documentElement.clientWidth}px`,t.height=`${document.documentElement.clientHeight}px`,t.style.position="absolute",t.style.top=`-${document.documentElement.clientHeight+100}px`,t.style.left=`-${document.documentElement.clientWidth+100}px`,t.id=c8,t.srcdoc="<!DOCTYPE html>",e&&(e.allow&&(t.allow=e.allow),e.referrerPolicy!==void 0&&(t.referrerPolicy=e.referrerPolicy),e.sandbox!==void 0&&(t.sandbox=e.sandbox)),t}function ai({level:e="error",messages:t,suppressErrors:r=!1}){r||(e==="error"?console.error(t):e==="warning"?console.warn(t):console.debug(t))}function u8(e,t){if(t||!e){const r=document.getElementById(c8);r&&document.body.removeChild(r)}}function yh(e){return e instanceof Error?e:new Error("Unknown Error")}function LA(e,t){const{documentTitle:r,onAfterPrint:n,onPrintError:i,preserveAfterPrint:a,print:o,suppressErrors:c}=t;setTimeout(()=>{var f;if(e.contentWindow){let d=function(){n==null||n(),u8(a)};if(e.contentWindow.focus(),o)o(e).then(d).catch(h=>{i?i("print",yh(h)):ai({messages:["An error was thrown by the specified `print` function"],suppressErrors:c})});else{if(e.contentWindow.print){const h=((f=e.contentDocument)==null?void 0:f.title)??"",m=e.ownerDocument.title,v=typeof r=="function"?r():r;v&&(e.ownerDocument.title=v,e.contentDocument&&(e.contentDocument.title=v)),e.contentWindow.print(),v&&(e.ownerDocument.title=m,e.contentDocument&&(e.contentDocument.title=h))}else ai({messages:["Printing for this browser is not currently possible: the browser does not have a `print` method available for iframes."],suppressErrors:c});z7()?setTimeout(d,500):d()}}else ai({messages:["Printing failed because the `contentWindow` of the print iframe did not load. This is possibly an error with `react-to-print`. Please file an issue: https://github.com/MatthewHerbst/react-to-print/issues/"],suppressErrors:c})},500)}function z7(){return[/Android/i,/webOS/i,/iPhone/i,/iPad/i,/iPod/i,/BlackBerry/i,/Windows Phone/i].some(e=>(navigator.userAgent??navigator.vendor??("opera"in window&&window.opera)).match(e))}function BA(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,null);let n=r.nextNode();for(;n;)t.push(n),n=r.nextNode();return t}function f8(e,t,r){const n=BA(e),i=BA(t);if(n.length!==i.length){ai({messages:["When cloning shadow root content, source and target elements have different size. `onBeforePrint` likely resolved too early.",e,t],suppressErrors:r});return}for(let a=0;a<n.length;a++){const o=n[a],c=i[a],f=o.shadowRoot;if(f!==null){const d=c.attachShadow({mode:f.mode});d.innerHTML=f.innerHTML,f8(f,d,r)}}}const W7=`
    @page {
        /* Remove browser default header (title) and footer (url) */
        margin: 0;
    }
    @media print {
        body {
            /* Tell browsers to print background colors */
            color-adjust: exact; /* Firefox. This is an older version of "print-color-adjust" */
            print-color-adjust: exact; /* Firefox/Safari */
            -webkit-print-color-adjust: exact; /* Chrome/Safari/Edge/Opera */
        }
    }
`;function V7(e,t,r){var N,M,R;const{contentNode:n,clonedContentNode:i,clonedImgNodes:a,clonedVideoNodes:o,numResourcesToLoad:c,originalCanvasNodes:f}=t,{bodyClass:d,fonts:h,ignoreGlobalStyles:m,pageStyle:v,nonce:w,suppressErrors:E,copyShadowRoots:A}=r,S=[],b=[];function T(P,z){if(S.includes(P)){ai({level:"debug",messages:["Tried to mark a resource that has already been handled",P],suppressErrors:E});return}z?(ai({messages:['"react-to-print" was unable to load a resource but will continue attempting to print the page',...z],suppressErrors:E}),b.push(P)):S.push(P),S.length+b.length===c&&LA(e,r)}e.onload=null;const _=e.contentDocument??((N=e.contentWindow)==null?void 0:N.document);if(_){const P=_.body.appendChild(i);A&&f8(n,P,!!E),h&&((M=e.contentDocument)!=null&&M.fonts&&((R=e.contentWindow)!=null&&R.FontFace)?h.forEach(pe=>{const K=new FontFace(pe.family,pe.source,{weight:pe.weight,style:pe.style});e.contentDocument.fonts.add(K),K.loaded.then(()=>{T(K)}).catch(Ce=>{T(K,["Failed loading the font:",K,"Load error:",yh(Ce)])})}):(h.forEach(pe=>{T(pe)}),ai({messages:['"react-to-print" is not able to load custom fonts because the browser does not support the FontFace API but will continue attempting to print the page'],suppressErrors:E})));const z=v??W7,B=_.createElement("style");w&&(B.setAttribute("nonce",w),_.head.setAttribute("nonce",w)),B.appendChild(_.createTextNode(z)),_.head.appendChild(B),d&&_.body.classList.add(...d.split(" "));const re=_.querySelectorAll("canvas");for(let pe=0;pe<f.length;++pe){const K=f[pe],Ce=re[pe];if(Ce===void 0){ai({messages:["A canvas element could not be copied for printing, has it loaded? `onBeforePrint` likely resolved too early.",K],suppressErrors:E});continue}const ue=Ce.getContext("2d");ue&&ue.drawImage(K,0,0)}for(let pe=0;pe<a.length;pe++){const K=a[pe],Ce=K.getAttribute("src");if(!Ce)T(K,['Found an <img> tag with an empty "src" attribute. This prevents pre-loading it.',K]);else{const ue=new Image;ue.onload=()=>{T(K)},ue.onerror=(se,q,fe,we,G)=>{T(K,["Error loading <img>",K,"Error",G])},ue.src=Ce}}for(let pe=0;pe<o.length;pe++){const K=o[pe];K.preload="auto";const Ce=K.getAttribute("poster");if(Ce){const ue=new Image;ue.onload=()=>{T(K)},ue.onerror=(se,q,fe,we,G)=>{T(K,["Error loading video poster",Ce,"for video",K,"Error:",G])},ue.src=Ce}else K.readyState>=2?T(K):K.src?(K.onloadeddata=()=>{T(K)},K.onerror=(ue,se,q,fe,we)=>{T(K,["Error loading video",K,"Error",we])},K.onstalled=()=>{T(K,["Loading video stalled, skipping",K])}):T(K,["Error loading video, `src` is empty",K])}const ee="select",V=n.querySelectorAll(ee),de=_.querySelectorAll(ee);for(let pe=0;pe<V.length;pe++)de[pe].value=V[pe].value;if(!m){const pe=document.querySelectorAll("style, link[rel~='stylesheet'], link[as='style']");for(let K=0,Ce=pe.length;K<Ce;++K){const ue=pe[K];if(ue.tagName.toLowerCase()==="style"){const se=_.createElement(ue.tagName),q=ue.sheet;if(q){let fe="";try{const we=q.cssRules.length;for(let G=0;G<we;++G)typeof q.cssRules[G].cssText=="string"&&(fe+=`${q.cssRules[G].cssText}\r
`)}catch(we){ai({messages:["A stylesheet could not be accessed. This is likely due to the stylesheet having cross-origin imports, and many browsers block script access to cross-origin stylesheets. See https://github.com/MatthewHerbst/react-to-print/issues/429 for details. You may be able to load the sheet by both marking the stylesheet with the cross `crossorigin` attribute, and setting the `Access-Control-Allow-Origin` header on the server serving the stylesheet. Alternatively, host the stylesheet on your domain to avoid this issue entirely.",ue,`Original error: ${yh(we).message}`],level:"warning"})}se.setAttribute("id",`react-to-print-${K}`),w&&se.setAttribute("nonce",w),se.appendChild(_.createTextNode(fe)),_.head.appendChild(se)}}else if(ue.getAttribute("href"))if(ue.hasAttribute("disabled"))ai({messages:["`react-to-print` encountered a <link> tag with a `disabled` attribute and will ignore it. Note that the `disabled` attribute is deprecated, and some browsers ignore it. You should stop using it. https://developer.mozilla.org/en-US/docs/Web/HTML/Element/link#attr-disabled. The <link> is:",ue],level:"warning"}),T(ue);else{const se=_.createElement(ue.tagName);for(let q=0,fe=ue.attributes.length;q<fe;++q){const we=ue.attributes[q];we&&se.setAttribute(we.nodeName,we.nodeValue??"")}se.onload=()=>{T(se)},se.onerror=(q,fe,we,G,le)=>{T(se,["Failed to load",se,"Error:",le])},w&&se.setAttribute("nonce",w),_.head.appendChild(se)}else ai({messages:["`react-to-print` encountered a <link> tag with an empty `href` attribute. In addition to being invalid HTML, this can cause problems in many browsers, and so the <link> was not loaded. The <link> is:",ue],level:"warning"}),T(ue)}}}c===0&&LA(e,r)}function H7(e,t,r){e.onload=()=>{V7(e,t,r)},document.body.appendChild(e)}function G7({contentRef:e,optionalContent:t,suppressErrors:r}){if(t&&typeof t=="function")return e&&ai({level:"warning",messages:['"react-to-print" received a `contentRef` option and an optional-content param passed to its callback. The `contentRef` option will be ignored.']}),t();if(e)return e.current;ai({messages:['"react-to-print" did not receive a `contentRef` option or a optional-content param pass to its callback.'],suppressErrors:r})}function $7(e,t){const{contentRef:r,fonts:n,ignoreGlobalStyles:i,suppressErrors:a}=t,o=G7({contentRef:r,optionalContent:e,suppressErrors:a});if(!o)return;const c=o.cloneNode(!0),f=document.querySelectorAll("link[rel~='stylesheet'], link[as='style']"),d=c.querySelectorAll("img"),h=c.querySelectorAll("video"),m=n?n.length:0,v=(i?0:f.length)+d.length+h.length+m;return{contentNode:o,clonedContentNode:c,clonedImgNodes:d,clonedVideoNodes:h,numResourcesToLoad:v,originalCanvasNodes:o.querySelectorAll("canvas")}}function X7({bodyClass:e,contentRef:t,copyShadowRoots:r,documentTitle:n,fonts:i,ignoreGlobalStyles:a,nonce:o,onAfterPrint:c,onBeforePrint:f,onPrintError:d,pageStyle:h,preserveAfterPrint:m,print:v,printIframeProps:w,suppressErrors:E}){return I.useCallback(A=>{u8(m,!0);function S(){const b={bodyClass:e,contentRef:t,copyShadowRoots:r,documentTitle:n,fonts:i,ignoreGlobalStyles:a,nonce:o,onAfterPrint:c,onPrintError:d,pageStyle:h,preserveAfterPrint:m,print:v,suppressErrors:E},T=U7(w),_=$7(A,b);if(!_){ai({messages:["There is nothing to print"],suppressErrors:E});return}H7(T,_,b)}f?f().then(()=>{S()}).catch(b=>{d==null||d("onBeforePrint",yh(b))}):S()},[e,t,r,n,i,a,o,c,f,d,h,m,w,v,E])}function d8({data:e,type:t="visitor"}){var d,h;const{theme:r}=sf(),n=t==="visitor",i=n?"Visitor":"Student",a=(r==null?void 0:r.instituteName)||"Institute of Health Sciences",o=(r==null?void 0:r.instituteAddress)||"University of Peshawar",c=n?"Pass ID":"ID",f=n?(e==null?void 0:e.passId)||"":(e==null?void 0:e.studentId)||"";return k.jsxs("div",{className:"card-school card-school-front print-card",children:[k.jsx("div",{className:"card-school-wavy"}),k.jsx("div",{className:"card-school-accent-tl"}),k.jsx("div",{className:"card-school-logo",children:k.jsx("img",{src:"/ihs-logo.png",alt:"IHS",className:"card-school-logo-img"})}),k.jsxs("div",{className:"card-school-institute",children:[k.jsx("div",{className:"card-school-name",children:a}),k.jsx("div",{className:"card-school-tagline",children:o})]}),k.jsx("div",{className:"card-school-photo-wrap",children:k.jsx("div",{className:"card-school-photo",children:r!=null&&r.enablePhotoOnCard&&(e!=null&&e.photoUrl)?k.jsx("img",{src:e.photoUrl,alt:""}):k.jsx("span",{className:"card-school-avatar",children:((d=e==null?void 0:e.name)==null?void 0:d.charAt(0))||"?"})})}),k.jsx("div",{className:"card-school-student-name",children:(h=e==null?void 0:e.name)==null?void 0:h.toUpperCase()}),k.jsx("div",{className:"card-school-role",children:i.toUpperCase()}),k.jsx("div",{className:"card-school-contact",children:k.jsxs("div",{children:[c,": ",f]})}),k.jsx("div",{className:"card-school-wave-bottom"})]})}var K7=Object.defineProperty,wh=Object.getOwnPropertySymbols,h8=Object.prototype.hasOwnProperty,p8=Object.prototype.propertyIsEnumerable,jA=(e,t,r)=>t in e?K7(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Sx=(e,t)=>{for(var r in t||(t={}))h8.call(t,r)&&jA(e,r,t[r]);if(wh)for(var r of wh(t))p8.call(t,r)&&jA(e,r,t[r]);return e},_x=(e,t)=>{var r={};for(var n in e)h8.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&wh)for(var n of wh(e))t.indexOf(n)<0&&p8.call(e,n)&&(r[n]=e[n]);return r};/**
 * @license QR Code generator library (TypeScript)
 * Copyright (c) Project Nayuki.
 * SPDX-License-Identifier: MIT
 */var ll;(e=>{const t=class yt{constructor(f,d,h,m){if(this.version=f,this.errorCorrectionLevel=d,this.modules=[],this.isFunction=[],f<yt.MIN_VERSION||f>yt.MAX_VERSION)throw new RangeError("Version value out of range");if(m<-1||m>7)throw new RangeError("Mask value out of range");this.size=f*4+17;let v=[];for(let E=0;E<this.size;E++)v.push(!1);for(let E=0;E<this.size;E++)this.modules.push(v.slice()),this.isFunction.push(v.slice());this.drawFunctionPatterns();const w=this.addEccAndInterleave(h);if(this.drawCodewords(w),m==-1){let E=1e9;for(let A=0;A<8;A++){this.applyMask(A),this.drawFormatBits(A);const S=this.getPenaltyScore();S<E&&(m=A,E=S),this.applyMask(A)}}i(0<=m&&m<=7),this.mask=m,this.applyMask(m),this.drawFormatBits(m),this.isFunction=[]}static encodeText(f,d){const h=e.QrSegment.makeSegments(f);return yt.encodeSegments(h,d)}static encodeBinary(f,d){const h=e.QrSegment.makeBytes(f);return yt.encodeSegments([h],d)}static encodeSegments(f,d,h=1,m=40,v=-1,w=!0){if(!(yt.MIN_VERSION<=h&&h<=m&&m<=yt.MAX_VERSION)||v<-1||v>7)throw new RangeError("Invalid value");let E,A;for(E=h;;E++){const _=yt.getNumDataCodewords(E,d)*8,N=o.getTotalBits(f,E);if(N<=_){A=N;break}if(E>=m)throw new RangeError("Data too long")}for(const _ of[yt.Ecc.MEDIUM,yt.Ecc.QUARTILE,yt.Ecc.HIGH])w&&A<=yt.getNumDataCodewords(E,_)*8&&(d=_);let S=[];for(const _ of f){r(_.mode.modeBits,4,S),r(_.numChars,_.mode.numCharCountBits(E),S);for(const N of _.getData())S.push(N)}i(S.length==A);const b=yt.getNumDataCodewords(E,d)*8;i(S.length<=b),r(0,Math.min(4,b-S.length),S),r(0,(8-S.length%8)%8,S),i(S.length%8==0);for(let _=236;S.length<b;_^=253)r(_,8,S);let T=[];for(;T.length*8<S.length;)T.push(0);return S.forEach((_,N)=>T[N>>>3]|=_<<7-(N&7)),new yt(E,d,T,v)}getModule(f,d){return 0<=f&&f<this.size&&0<=d&&d<this.size&&this.modules[d][f]}getModules(){return this.modules}drawFunctionPatterns(){for(let h=0;h<this.size;h++)this.setFunctionModule(6,h,h%2==0),this.setFunctionModule(h,6,h%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const f=this.getAlignmentPatternPositions(),d=f.length;for(let h=0;h<d;h++)for(let m=0;m<d;m++)h==0&&m==0||h==0&&m==d-1||h==d-1&&m==0||this.drawAlignmentPattern(f[h],f[m]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(f){const d=this.errorCorrectionLevel.formatBits<<3|f;let h=d;for(let v=0;v<10;v++)h=h<<1^(h>>>9)*1335;const m=(d<<10|h)^21522;i(m>>>15==0);for(let v=0;v<=5;v++)this.setFunctionModule(8,v,n(m,v));this.setFunctionModule(8,7,n(m,6)),this.setFunctionModule(8,8,n(m,7)),this.setFunctionModule(7,8,n(m,8));for(let v=9;v<15;v++)this.setFunctionModule(14-v,8,n(m,v));for(let v=0;v<8;v++)this.setFunctionModule(this.size-1-v,8,n(m,v));for(let v=8;v<15;v++)this.setFunctionModule(8,this.size-15+v,n(m,v));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let f=this.version;for(let h=0;h<12;h++)f=f<<1^(f>>>11)*7973;const d=this.version<<12|f;i(d>>>18==0);for(let h=0;h<18;h++){const m=n(d,h),v=this.size-11+h%3,w=Math.floor(h/3);this.setFunctionModule(v,w,m),this.setFunctionModule(w,v,m)}}drawFinderPattern(f,d){for(let h=-4;h<=4;h++)for(let m=-4;m<=4;m++){const v=Math.max(Math.abs(m),Math.abs(h)),w=f+m,E=d+h;0<=w&&w<this.size&&0<=E&&E<this.size&&this.setFunctionModule(w,E,v!=2&&v!=4)}}drawAlignmentPattern(f,d){for(let h=-2;h<=2;h++)for(let m=-2;m<=2;m++)this.setFunctionModule(f+m,d+h,Math.max(Math.abs(m),Math.abs(h))!=1)}setFunctionModule(f,d,h){this.modules[d][f]=h,this.isFunction[d][f]=!0}addEccAndInterleave(f){const d=this.version,h=this.errorCorrectionLevel;if(f.length!=yt.getNumDataCodewords(d,h))throw new RangeError("Invalid argument");const m=yt.NUM_ERROR_CORRECTION_BLOCKS[h.ordinal][d],v=yt.ECC_CODEWORDS_PER_BLOCK[h.ordinal][d],w=Math.floor(yt.getNumRawDataModules(d)/8),E=m-w%m,A=Math.floor(w/m);let S=[];const b=yt.reedSolomonComputeDivisor(v);for(let _=0,N=0;_<m;_++){let M=f.slice(N,N+A-v+(_<E?0:1));N+=M.length;const R=yt.reedSolomonComputeRemainder(M,b);_<E&&M.push(0),S.push(M.concat(R))}let T=[];for(let _=0;_<S[0].length;_++)S.forEach((N,M)=>{(_!=A-v||M>=E)&&T.push(N[_])});return i(T.length==w),T}drawCodewords(f){if(f.length!=Math.floor(yt.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let d=0;for(let h=this.size-1;h>=1;h-=2){h==6&&(h=5);for(let m=0;m<this.size;m++)for(let v=0;v<2;v++){const w=h-v,A=(h+1&2)==0?this.size-1-m:m;!this.isFunction[A][w]&&d<f.length*8&&(this.modules[A][w]=n(f[d>>>3],7-(d&7)),d++)}}i(d==f.length*8)}applyMask(f){if(f<0||f>7)throw new RangeError("Mask value out of range");for(let d=0;d<this.size;d++)for(let h=0;h<this.size;h++){let m;switch(f){case 0:m=(h+d)%2==0;break;case 1:m=d%2==0;break;case 2:m=h%3==0;break;case 3:m=(h+d)%3==0;break;case 4:m=(Math.floor(h/3)+Math.floor(d/2))%2==0;break;case 5:m=h*d%2+h*d%3==0;break;case 6:m=(h*d%2+h*d%3)%2==0;break;case 7:m=((h+d)%2+h*d%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[d][h]&&m&&(this.modules[d][h]=!this.modules[d][h])}}getPenaltyScore(){let f=0;for(let v=0;v<this.size;v++){let w=!1,E=0,A=[0,0,0,0,0,0,0];for(let S=0;S<this.size;S++)this.modules[v][S]==w?(E++,E==5?f+=yt.PENALTY_N1:E>5&&f++):(this.finderPenaltyAddHistory(E,A),w||(f+=this.finderPenaltyCountPatterns(A)*yt.PENALTY_N3),w=this.modules[v][S],E=1);f+=this.finderPenaltyTerminateAndCount(w,E,A)*yt.PENALTY_N3}for(let v=0;v<this.size;v++){let w=!1,E=0,A=[0,0,0,0,0,0,0];for(let S=0;S<this.size;S++)this.modules[S][v]==w?(E++,E==5?f+=yt.PENALTY_N1:E>5&&f++):(this.finderPenaltyAddHistory(E,A),w||(f+=this.finderPenaltyCountPatterns(A)*yt.PENALTY_N3),w=this.modules[S][v],E=1);f+=this.finderPenaltyTerminateAndCount(w,E,A)*yt.PENALTY_N3}for(let v=0;v<this.size-1;v++)for(let w=0;w<this.size-1;w++){const E=this.modules[v][w];E==this.modules[v][w+1]&&E==this.modules[v+1][w]&&E==this.modules[v+1][w+1]&&(f+=yt.PENALTY_N2)}let d=0;for(const v of this.modules)d=v.reduce((w,E)=>w+(E?1:0),d);const h=this.size*this.size,m=Math.ceil(Math.abs(d*20-h*10)/h)-1;return i(0<=m&&m<=9),f+=m*yt.PENALTY_N4,i(0<=f&&f<=2568888),f}getAlignmentPatternPositions(){if(this.version==1)return[];{const f=Math.floor(this.version/7)+2,d=this.version==32?26:Math.ceil((this.version*4+4)/(f*2-2))*2;let h=[6];for(let m=this.size-7;h.length<f;m-=d)h.splice(1,0,m);return h}}static getNumRawDataModules(f){if(f<yt.MIN_VERSION||f>yt.MAX_VERSION)throw new RangeError("Version number out of range");let d=(16*f+128)*f+64;if(f>=2){const h=Math.floor(f/7)+2;d-=(25*h-10)*h-55,f>=7&&(d-=36)}return i(208<=d&&d<=29648),d}static getNumDataCodewords(f,d){return Math.floor(yt.getNumRawDataModules(f)/8)-yt.ECC_CODEWORDS_PER_BLOCK[d.ordinal][f]*yt.NUM_ERROR_CORRECTION_BLOCKS[d.ordinal][f]}static reedSolomonComputeDivisor(f){if(f<1||f>255)throw new RangeError("Degree out of range");let d=[];for(let m=0;m<f-1;m++)d.push(0);d.push(1);let h=1;for(let m=0;m<f;m++){for(let v=0;v<d.length;v++)d[v]=yt.reedSolomonMultiply(d[v],h),v+1<d.length&&(d[v]^=d[v+1]);h=yt.reedSolomonMultiply(h,2)}return d}static reedSolomonComputeRemainder(f,d){let h=d.map(m=>0);for(const m of f){const v=m^h.shift();h.push(0),d.forEach((w,E)=>h[E]^=yt.reedSolomonMultiply(w,v))}return h}static reedSolomonMultiply(f,d){if(f>>>8||d>>>8)throw new RangeError("Byte out of range");let h=0;for(let m=7;m>=0;m--)h=h<<1^(h>>>7)*285,h^=(d>>>m&1)*f;return i(h>>>8==0),h}finderPenaltyCountPatterns(f){const d=f[1];i(d<=this.size*3);const h=d>0&&f[2]==d&&f[3]==d*3&&f[4]==d&&f[5]==d;return(h&&f[0]>=d*4&&f[6]>=d?1:0)+(h&&f[6]>=d*4&&f[0]>=d?1:0)}finderPenaltyTerminateAndCount(f,d,h){return f&&(this.finderPenaltyAddHistory(d,h),d=0),d+=this.size,this.finderPenaltyAddHistory(d,h),this.finderPenaltyCountPatterns(h)}finderPenaltyAddHistory(f,d){d[0]==0&&(f+=this.size),d.pop(),d.unshift(f)}};t.MIN_VERSION=1,t.MAX_VERSION=40,t.PENALTY_N1=3,t.PENALTY_N2=3,t.PENALTY_N3=40,t.PENALTY_N4=10,t.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],t.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],e.QrCode=t;function r(c,f,d){if(f<0||f>31||c>>>f)throw new RangeError("Value out of range");for(let h=f-1;h>=0;h--)d.push(c>>>h&1)}function n(c,f){return(c>>>f&1)!=0}function i(c){if(!c)throw new Error("Assertion error")}const a=class wr{constructor(f,d,h){if(this.mode=f,this.numChars=d,this.bitData=h,d<0)throw new RangeError("Invalid argument");this.bitData=h.slice()}static makeBytes(f){let d=[];for(const h of f)r(h,8,d);return new wr(wr.Mode.BYTE,f.length,d)}static makeNumeric(f){if(!wr.isNumeric(f))throw new RangeError("String contains non-numeric characters");let d=[];for(let h=0;h<f.length;){const m=Math.min(f.length-h,3);r(parseInt(f.substring(h,h+m),10),m*3+1,d),h+=m}return new wr(wr.Mode.NUMERIC,f.length,d)}static makeAlphanumeric(f){if(!wr.isAlphanumeric(f))throw new RangeError("String contains unencodable characters in alphanumeric mode");let d=[],h;for(h=0;h+2<=f.length;h+=2){let m=wr.ALPHANUMERIC_CHARSET.indexOf(f.charAt(h))*45;m+=wr.ALPHANUMERIC_CHARSET.indexOf(f.charAt(h+1)),r(m,11,d)}return h<f.length&&r(wr.ALPHANUMERIC_CHARSET.indexOf(f.charAt(h)),6,d),new wr(wr.Mode.ALPHANUMERIC,f.length,d)}static makeSegments(f){return f==""?[]:wr.isNumeric(f)?[wr.makeNumeric(f)]:wr.isAlphanumeric(f)?[wr.makeAlphanumeric(f)]:[wr.makeBytes(wr.toUtf8ByteArray(f))]}static makeEci(f){let d=[];if(f<0)throw new RangeError("ECI assignment value out of range");if(f<128)r(f,8,d);else if(f<16384)r(2,2,d),r(f,14,d);else if(f<1e6)r(6,3,d),r(f,21,d);else throw new RangeError("ECI assignment value out of range");return new wr(wr.Mode.ECI,0,d)}static isNumeric(f){return wr.NUMERIC_REGEX.test(f)}static isAlphanumeric(f){return wr.ALPHANUMERIC_REGEX.test(f)}getData(){return this.bitData.slice()}static getTotalBits(f,d){let h=0;for(const m of f){const v=m.mode.numCharCountBits(d);if(m.numChars>=1<<v)return 1/0;h+=4+v+m.bitData.length}return h}static toUtf8ByteArray(f){f=encodeURI(f);let d=[];for(let h=0;h<f.length;h++)f.charAt(h)!="%"?d.push(f.charCodeAt(h)):(d.push(parseInt(f.substring(h+1,h+3),16)),h+=2);return d}};a.NUMERIC_REGEX=/^[0-9]*$/,a.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,a.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";let o=a;e.QrSegment=a})(ll||(ll={}));(e=>{(t=>{const r=class{constructor(i,a){this.ordinal=i,this.formatBits=a}};r.LOW=new r(0,1),r.MEDIUM=new r(1,0),r.QUARTILE=new r(2,3),r.HIGH=new r(3,2),t.Ecc=r})(e.QrCode||(e.QrCode={}))})(ll||(ll={}));(e=>{(t=>{const r=class{constructor(i,a){this.modeBits=i,this.numBitsCharCount=a}numCharCountBits(i){return this.numBitsCharCount[Math.floor((i+7)/17)]}};r.NUMERIC=new r(1,[10,12,14]),r.ALPHANUMERIC=new r(2,[9,11,13]),r.BYTE=new r(4,[8,16,16]),r.KANJI=new r(8,[8,10,12]),r.ECI=new r(7,[0,0,0]),t.Mode=r})(e.QrSegment||(e.QrSegment={}))})(ll||(ll={}));var oc=ll;/**
 * @license qrcode.react
 * Copyright (c) Paul O'Shannessy
 * SPDX-License-Identifier: ISC
 */var Y7={L:oc.QrCode.Ecc.LOW,M:oc.QrCode.Ecc.MEDIUM,Q:oc.QrCode.Ecc.QUARTILE,H:oc.QrCode.Ecc.HIGH},g8=128,m8="L",x8="#FFFFFF",v8="#000000",y8=!1,w8=1,Z7=4,q7=0,Q7=.1;function E8(e,t=0){const r=[];return e.forEach(function(n,i){let a=null;n.forEach(function(o,c){if(!o&&a!==null){r.push(`M${a+t} ${i+t}h${c-a}v1H${a+t}z`),a=null;return}if(c===n.length-1){if(!o)return;a===null?r.push(`M${c+t},${i+t} h1v1H${c+t}z`):r.push(`M${a+t},${i+t} h${c+1-a}v1H${a+t}z`);return}o&&a===null&&(a=c)})}),r.join("")}function A8(e,t){return e.slice().map((r,n)=>n<t.y||n>=t.y+t.h?r:r.map((i,a)=>a<t.x||a>=t.x+t.w?i:!1))}function J7(e,t,r,n){if(n==null)return null;const i=e.length+r*2,a=Math.floor(t*Q7),o=i/t,c=(n.width||a)*o,f=(n.height||a)*o,d=n.x==null?e.length/2-c/2:n.x*o,h=n.y==null?e.length/2-f/2:n.y*o,m=n.opacity==null?1:n.opacity;let v=null;if(n.excavate){let E=Math.floor(d),A=Math.floor(h),S=Math.ceil(c+d-E),b=Math.ceil(f+h-A);v={x:E,y:A,w:S,h:b}}const w=n.crossOrigin;return{x:d,y:h,h:f,w:c,excavation:v,opacity:m,crossOrigin:w}}function eF(e,t){return t!=null?Math.max(Math.floor(t),0):e?Z7:q7}function C8({value:e,level:t,minVersion:r,includeMargin:n,marginSize:i,imageSettings:a,size:o,boostLevel:c}){let f=rr.useMemo(()=>{const E=(Array.isArray(e)?e:[e]).reduce((A,S)=>(A.push(...oc.QrSegment.makeSegments(S)),A),[]);return oc.QrCode.encodeSegments(E,Y7[t],r,void 0,void 0,c)},[e,t,r,c]);const{cells:d,margin:h,numCells:m,calculatedImageSettings:v}=rr.useMemo(()=>{let w=f.getModules();const E=eF(n,i),A=w.length+E*2,S=J7(w,o,E,a);return{cells:w,margin:E,numCells:A,calculatedImageSettings:S}},[f,o,a,n,i]);return{qrcode:f,margin:h,cells:d,numCells:m,calculatedImageSettings:v}}var tF=function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0}(),rF=rr.forwardRef(function(t,r){const n=t,{value:i,size:a=g8,level:o=m8,bgColor:c=x8,fgColor:f=v8,includeMargin:d=y8,minVersion:h=w8,boostLevel:m,marginSize:v,imageSettings:w}=n,A=_x(n,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","marginSize","imageSettings"]),{style:S}=A,b=_x(A,["style"]),T=w==null?void 0:w.src,_=rr.useRef(null),N=rr.useRef(null),M=rr.useCallback(pe=>{_.current=pe,typeof r=="function"?r(pe):r&&(r.current=pe)},[r]),[R,P]=rr.useState(!1),{margin:z,cells:B,numCells:re,calculatedImageSettings:ee}=C8({value:i,level:o,minVersion:h,boostLevel:m,includeMargin:d,marginSize:v,imageSettings:w,size:a});rr.useEffect(()=>{if(_.current!=null){const pe=_.current,K=pe.getContext("2d");if(!K)return;let Ce=B;const ue=N.current,se=ee!=null&&ue!==null&&ue.complete&&ue.naturalHeight!==0&&ue.naturalWidth!==0;se&&ee.excavation!=null&&(Ce=A8(B,ee.excavation));const q=window.devicePixelRatio||1;pe.height=pe.width=a*q;const fe=a/re*q;K.scale(fe,fe),K.fillStyle=c,K.fillRect(0,0,re,re),K.fillStyle=f,tF?K.fill(new Path2D(E8(Ce,z))):B.forEach(function(we,G){we.forEach(function(le,ne){le&&K.fillRect(ne+z,G+z,1,1)})}),ee&&(K.globalAlpha=ee.opacity),se&&K.drawImage(ue,ee.x+z,ee.y+z,ee.w,ee.h)}}),rr.useEffect(()=>{P(!1)},[T]);const V=Sx({height:a,width:a},S);let de=null;return T!=null&&(de=rr.createElement("img",{src:T,key:T,style:{display:"none"},onLoad:()=>{P(!0)},ref:N,crossOrigin:ee==null?void 0:ee.crossOrigin})),rr.createElement(rr.Fragment,null,rr.createElement("canvas",Sx({style:V,height:a,width:a,ref:M,role:"img"},b)),de)});rF.displayName="QRCodeCanvas";var S8=rr.forwardRef(function(t,r){const n=t,{value:i,size:a=g8,level:o=m8,bgColor:c=x8,fgColor:f=v8,includeMargin:d=y8,minVersion:h=w8,boostLevel:m,title:v,marginSize:w,imageSettings:E}=n,A=_x(n,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","title","marginSize","imageSettings"]),{margin:S,cells:b,numCells:T,calculatedImageSettings:_}=C8({value:i,level:o,minVersion:h,boostLevel:m,includeMargin:d,marginSize:w,imageSettings:E,size:a});let N=b,M=null;E!=null&&_!=null&&(_.excavation!=null&&(N=A8(b,_.excavation)),M=rr.createElement("image",{href:E.src,height:_.h,width:_.w,x:_.x+S,y:_.y+S,preserveAspectRatio:"none",opacity:_.opacity,crossOrigin:_.crossOrigin}));const R=E8(N,S);return rr.createElement("svg",Sx({height:a,width:a,viewBox:`0 0 ${T} ${T}`,ref:r,role:"img"},A),!!v&&rr.createElement("title",null,v),rr.createElement("path",{fill:c,d:`M0,0 h${T}v${T}H0z`,shapeRendering:"crispEdges"}),rr.createElement("path",{fill:f,d:R,shapeRendering:"crispEdges"}),M)});S8.displayName="QRCodeSVG";function _8({data:e,type:t="visitor"}){const{theme:r}=sf(),n=(e==null?void 0:e.qrCodeValue)||(e==null?void 0:e.studentId)||(e==null?void 0:e.passId)||"IHS",i=(r==null?void 0:r.instituteName)||"Institute of Health Sciences";return k.jsxs("div",{className:"card-school card-school-back print-card",children:[k.jsx("div",{className:"card-school-wavy"}),k.jsx("div",{className:"card-school-accent-tl"}),k.jsx("div",{className:"card-school-back-qr",children:k.jsx(S8,{value:n,size:100,level:"M",bgColor:"#FFFFFF",fgColor:"#000000"})}),k.jsx("div",{className:"card-school-back-institute",children:i.toUpperCase()}),k.jsxs("div",{className:"card-school-back-terms",children:[k.jsx("div",{className:"card-school-back-terms-title",children:"Term & Conditions"}),k.jsx("p",{className:"card-school-back-terms-text",children:"This card must be presented for entry, library access and events. If lost, report immediately to the administration office."})]}),k.jsx("div",{className:"card-school-wave-bottom"})]})}function nF({visitor:e,showBack:t=!0}){const{theme:r}=sf(),n={name:e.name,cnic:e.cnic,purpose:e.purpose,personToMeet:e.personToMeet,visitorType:e.visitorType,checkInTime:e.checkInTime,passId:e.passId,qrCodeValue:e.qrCodeValue,tokenNumber:e.tokenNumber};return k.jsx("div",{className:"premium-card-container premium-visitor-card",children:k.jsxs("div",{className:"premium-card-inner",children:[k.jsx(d8,{data:n,type:"visitor"}),t&&r.enableBackSidePrint&&k.jsx(_8,{data:n,type:"visitor"})]})})}function iF({student:e,showBack:t=!0}){const{theme:r}=sf(),n={name:e.name,studentId:e.studentId,department:e.department,qrCodeValue:e.qrCodeValue||e.studentId,checkInTime:new Date};return k.jsx("div",{className:"premium-card-container premium-student-card",children:k.jsxs("div",{className:"premium-card-inner",children:[k.jsx(d8,{data:n,type:"student"}),t&&r.enableBackSidePrint&&k.jsx(_8,{data:n,type:"student"})]})})}function Zg(){try{const e=new(window.AudioContext||window.webkitAudioContext),t=e.createOscillator(),r=e.createGain();t.connect(r),r.connect(e.destination),t.frequency.value=880,t.type="sine",r.gain.setValueAtTime(.2,e.currentTime),r.gain.exponentialRampToValueAtTime(.01,e.currentTime+.15),t.start(e.currentTime),t.stop(e.currentTime+.15)}catch{}}function b8({type:e,data:t,onClose:r,autoPrint:n=!0,playSound:i=!0}){const a=I.useRef(null),{theme:o}=sf(),c=X7({contentRef:a,documentTitle:"ID Card",onBeforePrint:async()=>{i&&o.playSoundOnPrint&&Zg()},pageStyle:`
      @page { margin: 0.5in; size: auto; }
      body { margin: 0; padding: 0.5in; display: flex; align-items: center; justify-content: center; min-height: 100vh; background: #fff; }
      .print-container, .print-container * { -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; }
    `}),f=()=>{Zg(),c(()=>a.current)};if(I.useEffect(()=>{if(t&&(i&&o.playSoundOnPrint&&Zg(),n&&o.autoPrintOnCheckIn)){const v=setTimeout(()=>c(()=>a.current),600);return()=>clearTimeout(v)}},[t,n,i,o.autoPrintOnCheckIn,o.playSoundOnPrint]),!t)return null;const d=v=>{v.target===v.currentTarget&&r()},h=k.jsxs(k.Fragment,{children:[e==="visitor"&&k.jsx(nF,{visitor:t,showBack:o.enableBackSidePrint}),e==="student"&&k.jsx(iF,{student:t,showBack:o.enableBackSidePrint})]}),m=k.jsx("div",{className:"card-preview-modal-overlay",id:"card-print-root",onClick:d,children:k.jsxs("div",{className:"card-preview-modal",onClick:v=>v.stopPropagation(),children:[k.jsxs("div",{className:"card-preview-header no-print",children:[k.jsx("h3",{children:"ID Card Preview"}),k.jsx("button",{type:"button",className:"card-preview-close",onClick:r,children:""})]}),k.jsx("div",{className:"card-preview-content",children:k.jsx("div",{className:"print-container",ref:a,children:h})}),k.jsxs("div",{className:"card-preview-actions no-print",children:[k.jsx("button",{type:"button",className:"btn-secondary",onClick:r,children:"Close"}),k.jsx("button",{type:"button",className:"btn-primary-wide",onClick:f,children:k.jsxs(k.Fragment,{children:[k.jsx(v7,{size:16,strokeWidth:2,style:{marginRight:6,verticalAlign:"middle"}})," Print Card"]})})]})]})});return af.createPortal(m,document.body)}const Ut="/api",aF=()=>{const{addToast:e}=Cl(),[t,r]=I.useState({name:"",cnic:"",phone:"",purpose:"",purposeCustom:"",personToMeet:"",personToMeetCustom:"",visitorType:"Guest"}),[n,i]=I.useState(null),[a,o]=I.useState(!1),[c,f]=I.useState(null),d=w=>{const{name:E,value:A}=w.target;r(S=>({...S,[E]:A}))},h=async w=>{if(w.preventDefault(),i(null),!t.name||!t.cnic){const A="Name and CNIC are required.";i({type:"error",message:A}),e({message:A,type:"error",size:"small"});return}if(!(t.purpose==="Other"&&t.purposeCustom?t.purposeCustom:t.purpose)){const A="Please select or specify purpose of visit.";i({type:"error",message:A}),e({message:A,type:"error",size:"small"});return}o(!0);try{const A=t.purpose==="Other"?t.purposeCustom||"Other":t.purpose,S=t.personToMeet==="Other"&&t.personToMeetCustom?t.personToMeetCustom:t.personToMeet,b={...t,purpose:A,personToMeet:S},T=await fetch(`${Ut}/visitors/check-in`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)}),_=await T.json();if(!T.ok)throw new Error(_.message||"Failed to check in visitor");i({type:"success",message:`Visitor checked in. Token: ${_.tokenNumber||""}`}),f(_),e({message:`${t.name}  Token ${_.tokenNumber||""}`,type:"success",size:"big",title:"Visitor Added"}),r({name:"",cnic:"",phone:"",purpose:"",purposeCustom:"",personToMeet:"",personToMeetCustom:"",visitorType:"Guest"})}catch(A){i({type:"error",message:A.message||"Something went wrong"}),e({message:A.message||"Something went wrong",type:"error",size:"small"})}finally{o(!1)}},m=["Meeting","Interview","Admission Inquiry","Fee Submission","Document Submission","Parent-Teacher Meeting","Vendor / Delivery","Official Visit","Other"],v=["Admin Office","Registrar","Principal","Academic Office","Accounts","Reception","Other"];return k.jsxs("form",{className:"visitor-checkin-form form-large",onSubmit:h,children:[k.jsxs("div",{className:"form-row-inline form-row-2",children:[k.jsxs("div",{className:"form-group",children:[k.jsx("label",{children:"Full Name"}),k.jsx("input",{name:"name",value:t.name,onChange:d,className:"input-large",placeholder:"e.g. Ahmed Khan",required:!0})]}),k.jsxs("div",{className:"form-group",children:[k.jsx("label",{children:"CNIC Number"}),k.jsx("input",{name:"cnic",value:t.cnic,onChange:d,className:"input-large",placeholder:"e.g. 3520112345678",required:!0})]})]}),k.jsxs("div",{className:"form-row-inline form-row-2",children:[k.jsxs("div",{className:"form-group",children:[k.jsx("label",{children:"Visitor Type"}),k.jsxs("select",{name:"visitorType",value:t.visitorType,onChange:d,className:"input-large select-professional",children:[k.jsx("option",{value:"Guest",children:"Guest"}),k.jsx("option",{value:"Parent",children:"Parent"}),k.jsx("option",{value:"Vendor",children:"Vendor"}),k.jsx("option",{value:"Student",children:"Student"}),k.jsx("option",{value:"Staff",children:"Staff"}),k.jsx("option",{value:"Contractor",children:"Contractor"}),k.jsx("option",{value:"Other",children:"Other"})]})]}),k.jsxs("div",{className:"form-group",children:[k.jsx("label",{children:"Purpose of Visit"}),k.jsxs("select",{name:"purpose",value:t.purpose,onChange:w=>{const E=w.target.value;d(w),E!=="Other"&&r(A=>({...A,purposeCustom:""}))},className:"input-large select-professional",required:!0,children:[k.jsx("option",{value:"",children:"Select purpose..."}),m.map(w=>k.jsx("option",{value:w,children:w},w))]}),t.purpose==="Other"&&k.jsx("input",{type:"text",placeholder:"Specify purpose (optional)",value:t.purposeCustom||"",onChange:w=>r(E=>({...E,purposeCustom:w.target.value})),className:"input-large",style:{marginTop:"0.5rem"}})]})]}),k.jsxs("div",{className:"form-row-inline form-row-2",children:[k.jsxs("div",{className:"form-group",children:[k.jsx("label",{children:"Phone Number"}),k.jsx("input",{name:"phone",value:t.phone,onChange:d,className:"input-large",placeholder:"e.g. 03001234567"})]}),k.jsxs("div",{className:"form-group",children:[k.jsx("label",{children:"Person to Meet"}),k.jsxs("select",{name:"personToMeet",value:t.personToMeet,onChange:w=>{const E=w.target.value;d(w),E!=="Other"&&r(A=>({...A,personToMeetCustom:""}))},className:"input-large select-professional",children:[k.jsx("option",{value:"",children:"Select (optional)"}),v.map(w=>k.jsx("option",{value:w,children:w},w))]}),t.personToMeet==="Other"&&k.jsx("input",{type:"text",placeholder:"Specify name or department",value:t.personToMeetCustom||"",onChange:w=>r(E=>({...E,personToMeetCustom:w.target.value})),className:"input-large",style:{marginTop:"0.5rem"}})]})]}),k.jsx("button",{type:"submit",className:"btn-primary-wide btn-checkin",disabled:a,children:a?k.jsxs(k.Fragment,{children:[k.jsx(Ic,{})," Checking In..."]}):k.jsxs(k.Fragment,{children:[k.jsx(K1,{size:16,strokeWidth:2,style:{marginRight:6,verticalAlign:"middle"}})," Check In Visitor"]})}),n&&k.jsx("div",{className:n.type==="success"?"status success":"status error",children:n.message}),c&&k.jsx(b8,{type:"visitor",data:c,onClose:()=>f(null),autoPrint:!0,playSound:!0})]})},Eh=({width:e,height:t,className:r="",style:n={}})=>k.jsx("div",{className:`skeleton ${r}`,style:{width:e||"100%",height:t||"1rem",...n}}),Ah=({rows:e=5,cols:t=6})=>k.jsx("div",{className:"table-wrapper skeleton-table",children:k.jsxs("table",{className:"table-large",children:[k.jsx("thead",{children:k.jsx("tr",{children:Array.from({length:t}).map((r,n)=>k.jsx("th",{children:k.jsx(Eh,{height:16})},n))})}),k.jsx("tbody",{children:Array.from({length:e}).map((r,n)=>k.jsx("tr",{children:Array.from({length:t}).map((i,a)=>k.jsx("td",{children:k.jsx(Eh,{height:14,width:"85%"})},a))},n))})]})}),sF=({count:e=3})=>k.jsx("div",{className:"report-cards",children:Array.from({length:e}).map((t,r)=>k.jsxs("div",{className:"report-card skeleton-card",children:[k.jsx(Eh,{height:12,width:"60%"}),k.jsx(Eh,{height:28,width:"40%",style:{marginTop:"0.5rem"}})]},r))}),oF=()=>{const{addToast:e}=Cl(),[t,r]=I.useState([]),[n,i]=I.useState(!0),[a,o]=I.useState(null),c=async(d=!1)=>{d||i(!0),o(null);try{const h=await fetch(`${Ut}/visitors/active`),m=await h.json();if(!h.ok)throw new Error(m.message||"Failed to load active visitors");r(m)}catch(h){o({type:"error",message:h.message||"Failed to load visitors"}),e({message:h.message||"Failed to load visitors",type:"error",size:"small"})}finally{i(!1)}};I.useEffect(()=>{c();const d=setInterval(()=>c(!0),3e4);return()=>clearInterval(d)},[]);const f=async d=>{try{const h=await fetch(`${Ut}/visitors/${d}/check-out`,{method:"POST"}),m=await h.json();if(!h.ok)throw new Error(m.message||"Failed to check out");o({type:"success",message:"Visitor checked out."}),e({message:"Visitor checked out",type:"success",size:"small"}),c(!0)}catch(h){o({type:"error",message:h.message||"Failed to check out visitor"}),e({message:h.message||"Failed to check out",type:"error",size:"small"})}};return k.jsxs("div",{className:"active-visitors",children:[a&&k.jsx("div",{className:a.type==="success"?"status success":"status error",children:a.message}),n?k.jsx(Ah,{rows:4,cols:6}):t.length===0?k.jsxs("div",{className:"empty-state",children:[k.jsx("span",{className:"empty-icon",children:k.jsx(K1,{size:32,strokeWidth:2})}),k.jsx("p",{children:"No active visitors at the moment."}),k.jsx("span",{className:"empty-hint",children:"Checked-out visitors will disappear from this list."})]}):k.jsx("div",{className:"table-wrapper active-visitors-table active-visitors-scroll",children:k.jsxs("table",{className:"table-large active-visitors-grid",children:[k.jsx("thead",{children:k.jsxs("tr",{children:[k.jsx("th",{children:"Token"}),k.jsx("th",{children:"Name"}),k.jsx("th",{children:"Type"}),k.jsx("th",{children:"CNIC"}),k.jsx("th",{children:"Phone"}),k.jsx("th",{children:"Purpose"}),k.jsx("th",{children:"Check-In Time"}),k.jsx("th",{children:"Action"})]})}),k.jsx("tbody",{children:t.map(d=>k.jsxs("tr",{children:[k.jsx("td",{children:k.jsx("span",{className:"token-badge",children:d.tokenNumber||""})}),k.jsx("td",{className:"cell-name",children:d.name}),k.jsx("td",{children:k.jsx("span",{className:"visitor-type-badge",children:d.visitorType||"Guest"})}),k.jsx("td",{className:"cell-cnic",children:d.cnic}),k.jsx("td",{className:"cell-phone",children:d.phone||""}),k.jsx("td",{className:"cell-purpose",children:d.purpose}),k.jsx("td",{children:new Date(d.checkInTime).toLocaleTimeString()}),k.jsx("td",{className:"cell-action",children:k.jsxs("button",{className:"btn-checkout",onClick:()=>f(d._id),children:[k.jsx(d7,{size:14,strokeWidth:2,style:{marginRight:4,verticalAlign:"middle"}})," Check Out"]})})]},d._id))})]})})]})};var Xe;(function(e){e[e.QR_CODE=0]="QR_CODE",e[e.AZTEC=1]="AZTEC",e[e.CODABAR=2]="CODABAR",e[e.CODE_39=3]="CODE_39",e[e.CODE_93=4]="CODE_93",e[e.CODE_128=5]="CODE_128",e[e.DATA_MATRIX=6]="DATA_MATRIX",e[e.MAXICODE=7]="MAXICODE",e[e.ITF=8]="ITF",e[e.EAN_13=9]="EAN_13",e[e.EAN_8=10]="EAN_8",e[e.PDF_417=11]="PDF_417",e[e.RSS_14=12]="RSS_14",e[e.RSS_EXPANDED=13]="RSS_EXPANDED",e[e.UPC_A=14]="UPC_A",e[e.UPC_E=15]="UPC_E",e[e.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(Xe||(Xe={}));var UA=new Map([[Xe.QR_CODE,"QR_CODE"],[Xe.AZTEC,"AZTEC"],[Xe.CODABAR,"CODABAR"],[Xe.CODE_39,"CODE_39"],[Xe.CODE_93,"CODE_93"],[Xe.CODE_128,"CODE_128"],[Xe.DATA_MATRIX,"DATA_MATRIX"],[Xe.MAXICODE,"MAXICODE"],[Xe.ITF,"ITF"],[Xe.EAN_13,"EAN_13"],[Xe.EAN_8,"EAN_8"],[Xe.PDF_417,"PDF_417"],[Xe.RSS_14,"RSS_14"],[Xe.RSS_EXPANDED,"RSS_EXPANDED"],[Xe.UPC_A,"UPC_A"],[Xe.UPC_E,"UPC_E"],[Xe.UPC_EAN_EXTENSION,"UPC_EAN_EXTENSION"]]),zA;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.URL=1]="URL"})(zA||(zA={}));function lF(e){return Object.values(Xe).includes(e)}var Ch;(function(e){e[e.SCAN_TYPE_CAMERA=0]="SCAN_TYPE_CAMERA",e[e.SCAN_TYPE_FILE=1]="SCAN_TYPE_FILE"})(Ch||(Ch={}));var cF=function(){function e(){}return e.GITHUB_PROJECT_URL="https://github.com/mebjas/html5-qrcode",e.SCAN_DEFAULT_FPS=2,e.DEFAULT_DISABLE_FLIP=!1,e.DEFAULT_REMEMBER_LAST_CAMERA_USED=!0,e.DEFAULT_SUPPORTED_SCAN_TYPE=[Ch.SCAN_TYPE_CAMERA,Ch.SCAN_TYPE_FILE],e}(),T8=function(){function e(t,r){this.format=t,this.formatName=r}return e.prototype.toString=function(){return this.formatName},e.create=function(t){if(!UA.has(t))throw"".concat(t," not in html5QrcodeSupportedFormatsTextMap");return new e(t,UA.get(t))},e}(),WA=function(){function e(){}return e.createFromText=function(t){var r={text:t};return{decodedText:t,result:r}},e.createFromQrcodeResult=function(t){return{decodedText:t.text,result:t}},e}(),bx;(function(e){e[e.UNKWOWN_ERROR=0]="UNKWOWN_ERROR",e[e.IMPLEMENTATION_ERROR=1]="IMPLEMENTATION_ERROR",e[e.NO_CODE_FOUND_ERROR=2]="NO_CODE_FOUND_ERROR"})(bx||(bx={}));var uF=function(){function e(){}return e.createFrom=function(t){return{errorMessage:t,type:bx.UNKWOWN_ERROR}},e}(),fF=function(){function e(t){this.verbose=t}return e.prototype.log=function(t){this.verbose&&console.log(t)},e.prototype.warn=function(t){this.verbose&&console.warn(t)},e.prototype.logError=function(t,r){(this.verbose||r===!0)&&console.error(t)},e.prototype.logErrors=function(t){if(t.length===0)throw"Logger#logError called without arguments";this.verbose&&console.error(t)},e}();function Ja(e){return typeof e>"u"||e===null}var lc=function(){function e(){}return e.codeParseError=function(t){return"QR code parse error, error = ".concat(t)},e.errorGettingUserMedia=function(t){return"Error getting userMedia, error = ".concat(t)},e.onlyDeviceSupportedError=function(){return"The device doesn't support navigator.mediaDevices , only supported cameraIdOrConfig in this case is deviceId parameter (string)."},e.cameraStreamingNotSupported=function(){return"Camera streaming not supported by the browser."},e.unableToQuerySupportedDevices=function(){return"Unable to query supported devices, unknown error."},e.insecureContextCameraQueryError=function(){return"Camera access is only supported in secure context like https or localhost."},e.scannerPaused=function(){return"Scanner paused"},e}(),O8=function(){function e(){}return e.isMediaStreamConstraintsValid=function(t,r){if(typeof t!="object"){var n=typeof t;return r.logError("videoConstraints should be of type object, the "+"object passed is of type ".concat(n,"."),!0),!1}for(var i=["autoGainControl","channelCount","echoCancellation","latency","noiseSuppression","sampleRate","sampleSize","volume"],a=new Set(i),o=Object.keys(t),c=0,f=o;c<f.length;c++){var d=f[c];if(a.has(d))return r.logError("".concat(d," is not supported videoConstaints."),!0),!1}return!0},e}(),Tx={exports:{}};(function(e,t){(function(r,n){n(t)})(mu,function(r){function n(F){return F==null}var i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(F,s){F.__proto__=s}||function(F,s){for(var l in s)s.hasOwnProperty(l)&&(F[l]=s[l])};function a(F,s){i(F,s);function l(){this.constructor=F}F.prototype=s===null?Object.create(s):(l.prototype=s.prototype,new l)}function o(F,s){var l=Object.setPrototypeOf;l?l(F,s):F.__proto__=s}function c(F,s){s===void 0&&(s=F.constructor);var l=Error.captureStackTrace;l&&l(F,s)}var f=function(F){a(s,F);function s(l){var u=this.constructor,p=F.call(this,l)||this;return Object.defineProperty(p,"name",{value:u.name,enumerable:!1}),o(p,u.prototype),c(p),p}return s}(Error);class d extends f{constructor(s=void 0){super(s),this.message=s}getKind(){return this.constructor.kind}}d.kind="Exception";class h extends d{}h.kind="ArgumentException";class m extends d{}m.kind="IllegalArgumentException";class v{constructor(s){if(this.binarizer=s,s===null)throw new m("Binarizer must be non-null.")}getWidth(){return this.binarizer.getWidth()}getHeight(){return this.binarizer.getHeight()}getBlackRow(s,l){return this.binarizer.getBlackRow(s,l)}getBlackMatrix(){return(this.matrix===null||this.matrix===void 0)&&(this.matrix=this.binarizer.getBlackMatrix()),this.matrix}isCropSupported(){return this.binarizer.getLuminanceSource().isCropSupported()}crop(s,l,u,p){const g=this.binarizer.getLuminanceSource().crop(s,l,u,p);return new v(this.binarizer.createBinarizer(g))}isRotateSupported(){return this.binarizer.getLuminanceSource().isRotateSupported()}rotateCounterClockwise(){const s=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new v(this.binarizer.createBinarizer(s))}rotateCounterClockwise45(){const s=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new v(this.binarizer.createBinarizer(s))}toString(){try{return this.getBlackMatrix().toString()}catch{return""}}}class w extends d{static getChecksumInstance(){return new w}}w.kind="ChecksumException";class E{constructor(s){this.source=s}getLuminanceSource(){return this.source}getWidth(){return this.source.getWidth()}getHeight(){return this.source.getHeight()}}class A{static arraycopy(s,l,u,p,g){for(;g--;)u[p++]=s[l++]}static currentTimeMillis(){return Date.now()}}class S extends d{}S.kind="IndexOutOfBoundsException";class b extends S{constructor(s=void 0,l=void 0){super(l),this.index=s,this.message=l}}b.kind="ArrayIndexOutOfBoundsException";class T{static fill(s,l){for(let u=0,p=s.length;u<p;u++)s[u]=l}static fillWithin(s,l,u,p){T.rangeCheck(s.length,l,u);for(let g=l;g<u;g++)s[g]=p}static rangeCheck(s,l,u){if(l>u)throw new m("fromIndex("+l+") > toIndex("+u+")");if(l<0)throw new b(l);if(u>s)throw new b(u)}static asList(...s){return s}static create(s,l,u){return Array.from({length:s}).map(g=>Array.from({length:l}).fill(u))}static createInt32Array(s,l,u){return Array.from({length:s}).map(g=>Int32Array.from({length:l}).fill(u))}static equals(s,l){if(!s||!l||!s.length||!l.length||s.length!==l.length)return!1;for(let u=0,p=s.length;u<p;u++)if(s[u]!==l[u])return!1;return!0}static hashCode(s){if(s===null)return 0;let l=1;for(const u of s)l=31*l+u;return l}static fillUint8Array(s,l){for(let u=0;u!==s.length;u++)s[u]=l}static copyOf(s,l){return s.slice(0,l)}static copyOfUint8Array(s,l){if(s.length<=l){const u=new Uint8Array(l);return u.set(s),u}return s.slice(0,l)}static copyOfRange(s,l,u){const p=u-l,g=new Int32Array(p);return A.arraycopy(s,l,g,0,p),g}static binarySearch(s,l,u){u===void 0&&(u=T.numberComparator);let p=0,g=s.length-1;for(;p<=g;){const x=g+p>>1,y=u(l,s[x]);if(y>0)p=x+1;else if(y<0)g=x-1;else return x}return-p-1}static numberComparator(s,l){return s-l}}class _{static numberOfTrailingZeros(s){let l;if(s===0)return 32;let u=31;return l=s<<16,l!==0&&(u-=16,s=l),l=s<<8,l!==0&&(u-=8,s=l),l=s<<4,l!==0&&(u-=4,s=l),l=s<<2,l!==0&&(u-=2,s=l),u-(s<<1>>>31)}static numberOfLeadingZeros(s){if(s===0)return 32;let l=1;return s>>>16||(l+=16,s<<=16),s>>>24||(l+=8,s<<=8),s>>>28||(l+=4,s<<=4),s>>>30||(l+=2,s<<=2),l-=s>>>31,l}static toHexString(s){return s.toString(16)}static toBinaryString(s){return String(parseInt(String(s),2))}static bitCount(s){return s=s-(s>>>1&1431655765),s=(s&858993459)+(s>>>2&858993459),s=s+(s>>>4)&252645135,s=s+(s>>>8),s=s+(s>>>16),s&63}static truncDivision(s,l){return Math.trunc(s/l)}static parseInt(s,l=void 0){return parseInt(s,l)}}_.MIN_VALUE_32_BITS=-2147483648,_.MAX_VALUE=Number.MAX_SAFE_INTEGER;class N{constructor(s,l){s===void 0?(this.size=0,this.bits=new Int32Array(1)):(this.size=s,l==null?this.bits=N.makeArray(s):this.bits=l)}getSize(){return this.size}getSizeInBytes(){return Math.floor((this.size+7)/8)}ensureCapacity(s){if(s>this.bits.length*32){const l=N.makeArray(s);A.arraycopy(this.bits,0,l,0,this.bits.length),this.bits=l}}get(s){return(this.bits[Math.floor(s/32)]&1<<(s&31))!==0}set(s){this.bits[Math.floor(s/32)]|=1<<(s&31)}flip(s){this.bits[Math.floor(s/32)]^=1<<(s&31)}getNextSet(s){const l=this.size;if(s>=l)return l;const u=this.bits;let p=Math.floor(s/32),g=u[p];g&=~((1<<(s&31))-1);const x=u.length;for(;g===0;){if(++p===x)return l;g=u[p]}const y=p*32+_.numberOfTrailingZeros(g);return y>l?l:y}getNextUnset(s){const l=this.size;if(s>=l)return l;const u=this.bits;let p=Math.floor(s/32),g=~u[p];g&=~((1<<(s&31))-1);const x=u.length;for(;g===0;){if(++p===x)return l;g=~u[p]}const y=p*32+_.numberOfTrailingZeros(g);return y>l?l:y}setBulk(s,l){this.bits[Math.floor(s/32)]=l}setRange(s,l){if(l<s||s<0||l>this.size)throw new m;if(l===s)return;l--;const u=Math.floor(s/32),p=Math.floor(l/32),g=this.bits;for(let x=u;x<=p;x++){const y=x>u?0:s&31,O=(2<<(x<p?31:l&31))-(1<<y);g[x]|=O}}clear(){const s=this.bits.length,l=this.bits;for(let u=0;u<s;u++)l[u]=0}isRange(s,l,u){if(l<s||s<0||l>this.size)throw new m;if(l===s)return!0;l--;const p=Math.floor(s/32),g=Math.floor(l/32),x=this.bits;for(let y=p;y<=g;y++){const C=y>p?0:s&31,D=(2<<(y<g?31:l&31))-(1<<C)&4294967295;if((x[y]&D)!==(u?D:0))return!1}return!0}appendBit(s){this.ensureCapacity(this.size+1),s&&(this.bits[Math.floor(this.size/32)]|=1<<(this.size&31)),this.size++}appendBits(s,l){if(l<0||l>32)throw new m("Num bits must be between 0 and 32");this.ensureCapacity(this.size+l);for(let u=l;u>0;u--)this.appendBit((s>>u-1&1)===1)}appendBitArray(s){const l=s.size;this.ensureCapacity(this.size+l);for(let u=0;u<l;u++)this.appendBit(s.get(u))}xor(s){if(this.size!==s.size)throw new m("Sizes don't match");const l=this.bits;for(let u=0,p=l.length;u<p;u++)l[u]^=s.bits[u]}toBytes(s,l,u,p){for(let g=0;g<p;g++){let x=0;for(let y=0;y<8;y++)this.get(s)&&(x|=1<<7-y),s++;l[u+g]=x}}getBitArray(){return this.bits}reverse(){const s=new Int32Array(this.bits.length),l=Math.floor((this.size-1)/32),u=l+1,p=this.bits;for(let g=0;g<u;g++){let x=p[g];x=x>>1&1431655765|(x&1431655765)<<1,x=x>>2&858993459|(x&858993459)<<2,x=x>>4&252645135|(x&252645135)<<4,x=x>>8&16711935|(x&16711935)<<8,x=x>>16&65535|(x&65535)<<16,s[l-g]=x}if(this.size!==u*32){const g=u*32-this.size;let x=s[0]>>>g;for(let y=1;y<u;y++){const C=s[y];x|=C<<32-g,s[y-1]=x,x=C>>>g}s[u-1]=x}this.bits=s}static makeArray(s){return new Int32Array(Math.floor((s+31)/32))}equals(s){if(!(s instanceof N))return!1;const l=s;return this.size===l.size&&T.equals(this.bits,l.bits)}hashCode(){return 31*this.size+T.hashCode(this.bits)}toString(){let s="";for(let l=0,u=this.size;l<u;l++)l&7||(s+=" "),s+=this.get(l)?"X":".";return s}clone(){return new N(this.size,this.bits.slice())}}var M;(function(F){F[F.OTHER=0]="OTHER",F[F.PURE_BARCODE=1]="PURE_BARCODE",F[F.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",F[F.TRY_HARDER=3]="TRY_HARDER",F[F.CHARACTER_SET=4]="CHARACTER_SET",F[F.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",F[F.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",F[F.ASSUME_GS1=7]="ASSUME_GS1",F[F.RETURN_CODABAR_START_END=8]="RETURN_CODABAR_START_END",F[F.NEED_RESULT_POINT_CALLBACK=9]="NEED_RESULT_POINT_CALLBACK",F[F.ALLOWED_EAN_EXTENSIONS=10]="ALLOWED_EAN_EXTENSIONS"})(M||(M={}));var R=M;class P extends d{static getFormatInstance(){return new P}}P.kind="FormatException";var z;(function(F){F[F.Cp437=0]="Cp437",F[F.ISO8859_1=1]="ISO8859_1",F[F.ISO8859_2=2]="ISO8859_2",F[F.ISO8859_3=3]="ISO8859_3",F[F.ISO8859_4=4]="ISO8859_4",F[F.ISO8859_5=5]="ISO8859_5",F[F.ISO8859_6=6]="ISO8859_6",F[F.ISO8859_7=7]="ISO8859_7",F[F.ISO8859_8=8]="ISO8859_8",F[F.ISO8859_9=9]="ISO8859_9",F[F.ISO8859_10=10]="ISO8859_10",F[F.ISO8859_11=11]="ISO8859_11",F[F.ISO8859_13=12]="ISO8859_13",F[F.ISO8859_14=13]="ISO8859_14",F[F.ISO8859_15=14]="ISO8859_15",F[F.ISO8859_16=15]="ISO8859_16",F[F.SJIS=16]="SJIS",F[F.Cp1250=17]="Cp1250",F[F.Cp1251=18]="Cp1251",F[F.Cp1252=19]="Cp1252",F[F.Cp1256=20]="Cp1256",F[F.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",F[F.UTF8=22]="UTF8",F[F.ASCII=23]="ASCII",F[F.Big5=24]="Big5",F[F.GB18030=25]="GB18030",F[F.EUC_KR=26]="EUC_KR"})(z||(z={}));class B{constructor(s,l,u,...p){this.valueIdentifier=s,this.name=u,typeof l=="number"?this.values=Int32Array.from([l]):this.values=l,this.otherEncodingNames=p,B.VALUE_IDENTIFIER_TO_ECI.set(s,this),B.NAME_TO_ECI.set(u,this);const g=this.values;for(let x=0,y=g.length;x!==y;x++){const C=g[x];B.VALUES_TO_ECI.set(C,this)}for(const x of p)B.NAME_TO_ECI.set(x,this)}getValueIdentifier(){return this.valueIdentifier}getName(){return this.name}getValue(){return this.values[0]}static getCharacterSetECIByValue(s){if(s<0||s>=900)throw new P("incorect value");const l=B.VALUES_TO_ECI.get(s);if(l===void 0)throw new P("incorect value");return l}static getCharacterSetECIByName(s){const l=B.NAME_TO_ECI.get(s);if(l===void 0)throw new P("incorect value");return l}equals(s){if(!(s instanceof B))return!1;const l=s;return this.getName()===l.getName()}}B.VALUE_IDENTIFIER_TO_ECI=new Map,B.VALUES_TO_ECI=new Map,B.NAME_TO_ECI=new Map,B.Cp437=new B(z.Cp437,Int32Array.from([0,2]),"Cp437"),B.ISO8859_1=new B(z.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),B.ISO8859_2=new B(z.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),B.ISO8859_3=new B(z.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),B.ISO8859_4=new B(z.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),B.ISO8859_5=new B(z.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),B.ISO8859_6=new B(z.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),B.ISO8859_7=new B(z.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),B.ISO8859_8=new B(z.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),B.ISO8859_9=new B(z.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),B.ISO8859_10=new B(z.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),B.ISO8859_11=new B(z.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),B.ISO8859_13=new B(z.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),B.ISO8859_14=new B(z.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),B.ISO8859_15=new B(z.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),B.ISO8859_16=new B(z.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),B.SJIS=new B(z.SJIS,20,"SJIS","Shift_JIS"),B.Cp1250=new B(z.Cp1250,21,"Cp1250","windows-1250"),B.Cp1251=new B(z.Cp1251,22,"Cp1251","windows-1251"),B.Cp1252=new B(z.Cp1252,23,"Cp1252","windows-1252"),B.Cp1256=new B(z.Cp1256,24,"Cp1256","windows-1256"),B.UnicodeBigUnmarked=new B(z.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),B.UTF8=new B(z.UTF8,26,"UTF8","UTF-8"),B.ASCII=new B(z.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),B.Big5=new B(z.Big5,28,"Big5"),B.GB18030=new B(z.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),B.EUC_KR=new B(z.EUC_KR,30,"EUC_KR","EUC-KR");class re extends d{}re.kind="UnsupportedOperationException";class ee{static decode(s,l){const u=this.encodingName(l);return this.customDecoder?this.customDecoder(s,u):typeof TextDecoder>"u"||this.shouldDecodeOnFallback(u)?this.decodeFallback(s,u):new TextDecoder(u).decode(s)}static shouldDecodeOnFallback(s){return!ee.isBrowser()&&s==="ISO-8859-1"}static encode(s,l){const u=this.encodingName(l);return this.customEncoder?this.customEncoder(s,u):typeof TextEncoder>"u"?this.encodeFallback(s):new TextEncoder().encode(s)}static isBrowser(){return typeof window<"u"&&{}.toString.call(window)==="[object Window]"}static encodingName(s){return typeof s=="string"?s:s.getName()}static encodingCharacterSet(s){return s instanceof B?s:B.getCharacterSetECIByName(s)}static decodeFallback(s,l){const u=this.encodingCharacterSet(l);if(ee.isDecodeFallbackSupported(u)){let p="";for(let g=0,x=s.length;g<x;g++){let y=s[g].toString(16);y.length<2&&(y="0"+y),p+="%"+y}return decodeURIComponent(p)}if(u.equals(B.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(s.buffer));throw new re(`Encoding ${this.encodingName(l)} not supported by fallback.`)}static isDecodeFallbackSupported(s){return s.equals(B.UTF8)||s.equals(B.ISO8859_1)||s.equals(B.ASCII)}static encodeFallback(s){const u=btoa(unescape(encodeURIComponent(s))).split(""),p=[];for(let g=0;g<u.length;g++)p.push(u[g].charCodeAt(0));return new Uint8Array(p)}}class V{static castAsNonUtf8Char(s,l=null){const u=l?l.getName():this.ISO88591;return ee.decode(new Uint8Array([s]),u)}static guessEncoding(s,l){if(l!=null&&l.get(R.CHARACTER_SET)!==void 0)return l.get(R.CHARACTER_SET).toString();const u=s.length;let p=!0,g=!0,x=!0,y=0,C=0,O=0,D=0,L=0,U=0,J=0,ie=0,oe=0,me=0,_e=0;const Le=s.length>3&&s[0]===239&&s[1]===187&&s[2]===191;for(let Ue=0;Ue<u&&(p||g||x);Ue++){const Pe=s[Ue]&255;x&&(y>0?Pe&128?y--:x=!1:Pe&128&&(Pe&64?(y++,Pe&32?(y++,Pe&16?(y++,Pe&8?x=!1:D++):O++):C++):x=!1)),p&&(Pe>127&&Pe<160?p=!1:Pe>159&&(Pe<192||Pe===215||Pe===247)&&_e++),g&&(L>0?Pe<64||Pe===127||Pe>252?g=!1:L--:Pe===128||Pe===160||Pe>239?g=!1:Pe>160&&Pe<224?(U++,ie=0,J++,J>oe&&(oe=J)):Pe>127?(L++,J=0,ie++,ie>me&&(me=ie)):(J=0,ie=0))}return x&&y>0&&(x=!1),g&&L>0&&(g=!1),x&&(Le||C+O+D>0)?V.UTF8:g&&(V.ASSUME_SHIFT_JIS||oe>=3||me>=3)?V.SHIFT_JIS:p&&g?oe===2&&U===2||_e*10>=u?V.SHIFT_JIS:V.ISO88591:p?V.ISO88591:g?V.SHIFT_JIS:x?V.UTF8:V.PLATFORM_DEFAULT_ENCODING}static format(s,...l){let u=-1;function p(x,y,C,O,D,L){if(x==="%%")return"%";if(l[++u]===void 0)return;x=O?parseInt(O.substr(1)):void 0;let U=D?parseInt(D.substr(1)):void 0,J;switch(L){case"s":J=l[u];break;case"c":J=l[u][0];break;case"f":J=parseFloat(l[u]).toFixed(x);break;case"p":J=parseFloat(l[u]).toPrecision(x);break;case"e":J=parseFloat(l[u]).toExponential(x);break;case"x":J=parseInt(l[u]).toString(U||16);break;case"d":J=parseFloat(parseInt(l[u],U||10).toPrecision(x)).toFixed(0);break}J=typeof J=="object"?JSON.stringify(J):(+J).toString(U);let ie=parseInt(C),oe=C&&C[0]+""=="0"?"0":" ";for(;J.length<ie;)J=y!==void 0?J+oe:oe+J;return J}let g=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return s.replace(g,p)}static getBytes(s,l){return ee.encode(s,l)}static getCharCode(s,l=0){return s.charCodeAt(l)}static getCharAt(s){return String.fromCharCode(s)}}V.SHIFT_JIS=B.SJIS.getName(),V.GB2312="GB2312",V.ISO88591=B.ISO8859_1.getName(),V.EUC_JP="EUC_JP",V.UTF8=B.UTF8.getName(),V.PLATFORM_DEFAULT_ENCODING=V.UTF8,V.ASSUME_SHIFT_JIS=!1;class de{constructor(s=""){this.value=s}enableDecoding(s){return this.encoding=s,this}append(s){return typeof s=="string"?this.value+=s.toString():this.encoding?this.value+=V.castAsNonUtf8Char(s,this.encoding):this.value+=String.fromCharCode(s),this}appendChars(s,l,u){for(let p=l;l<l+u;p++)this.append(s[p]);return this}length(){return this.value.length}charAt(s){return this.value.charAt(s)}deleteCharAt(s){this.value=this.value.substr(0,s)+this.value.substring(s+1)}setCharAt(s,l){this.value=this.value.substr(0,s)+l+this.value.substr(s+1)}substring(s,l){return this.value.substring(s,l)}setLengthToZero(){this.value=""}toString(){return this.value}insert(s,l){this.value=this.value.substr(0,s)+l+this.value.substr(s+l.length)}}class pe{constructor(s,l,u,p){if(this.width=s,this.height=l,this.rowSize=u,this.bits=p,l==null&&(l=s),this.height=l,s<1||l<1)throw new m("Both dimensions must be greater than 0");u==null&&(u=Math.floor((s+31)/32)),this.rowSize=u,p==null&&(this.bits=new Int32Array(this.rowSize*this.height))}static parseFromBooleanArray(s){const l=s.length,u=s[0].length,p=new pe(u,l);for(let g=0;g<l;g++){const x=s[g];for(let y=0;y<u;y++)x[y]&&p.set(y,g)}return p}static parseFromString(s,l,u){if(s===null)throw new m("stringRepresentation cannot be null");const p=new Array(s.length);let g=0,x=0,y=-1,C=0,O=0;for(;O<s.length;)if(s.charAt(O)===`
`||s.charAt(O)==="\r"){if(g>x){if(y===-1)y=g-x;else if(g-x!==y)throw new m("row lengths do not match");x=g,C++}O++}else if(s.substring(O,O+l.length)===l)O+=l.length,p[g]=!0,g++;else if(s.substring(O,O+u.length)===u)O+=u.length,p[g]=!1,g++;else throw new m("illegal character encountered: "+s.substring(O));if(g>x){if(y===-1)y=g-x;else if(g-x!==y)throw new m("row lengths do not match");C++}const D=new pe(y,C);for(let L=0;L<g;L++)p[L]&&D.set(Math.floor(L%y),Math.floor(L/y));return D}get(s,l){const u=l*this.rowSize+Math.floor(s/32);return(this.bits[u]>>>(s&31)&1)!==0}set(s,l){const u=l*this.rowSize+Math.floor(s/32);this.bits[u]|=1<<(s&31)&4294967295}unset(s,l){const u=l*this.rowSize+Math.floor(s/32);this.bits[u]&=~(1<<(s&31)&4294967295)}flip(s,l){const u=l*this.rowSize+Math.floor(s/32);this.bits[u]^=1<<(s&31)&4294967295}xor(s){if(this.width!==s.getWidth()||this.height!==s.getHeight()||this.rowSize!==s.getRowSize())throw new m("input matrix dimensions do not match");const l=new N(Math.floor(this.width/32)+1),u=this.rowSize,p=this.bits;for(let g=0,x=this.height;g<x;g++){const y=g*u,C=s.getRow(g,l).getBitArray();for(let O=0;O<u;O++)p[y+O]^=C[O]}}clear(){const s=this.bits,l=s.length;for(let u=0;u<l;u++)s[u]=0}setRegion(s,l,u,p){if(l<0||s<0)throw new m("Left and top must be nonnegative");if(p<1||u<1)throw new m("Height and width must be at least 1");const g=s+u,x=l+p;if(x>this.height||g>this.width)throw new m("The region must fit inside the matrix");const y=this.rowSize,C=this.bits;for(let O=l;O<x;O++){const D=O*y;for(let L=s;L<g;L++)C[D+Math.floor(L/32)]|=1<<(L&31)&4294967295}}getRow(s,l){l==null||l.getSize()<this.width?l=new N(this.width):l.clear();const u=this.rowSize,p=this.bits,g=s*u;for(let x=0;x<u;x++)l.setBulk(x*32,p[g+x]);return l}setRow(s,l){A.arraycopy(l.getBitArray(),0,this.bits,s*this.rowSize,this.rowSize)}rotate180(){const s=this.getWidth(),l=this.getHeight();let u=new N(s),p=new N(s);for(let g=0,x=Math.floor((l+1)/2);g<x;g++)u=this.getRow(g,u),p=this.getRow(l-1-g,p),u.reverse(),p.reverse(),this.setRow(g,p),this.setRow(l-1-g,u)}getEnclosingRectangle(){const s=this.width,l=this.height,u=this.rowSize,p=this.bits;let g=s,x=l,y=-1,C=-1;for(let O=0;O<l;O++)for(let D=0;D<u;D++){const L=p[O*u+D];if(L!==0){if(O<x&&(x=O),O>C&&(C=O),D*32<g){let U=0;for(;!(L<<31-U&4294967295);)U++;D*32+U<g&&(g=D*32+U)}if(D*32+31>y){let U=31;for(;!(L>>>U);)U--;D*32+U>y&&(y=D*32+U)}}}return y<g||C<x?null:Int32Array.from([g,x,y-g+1,C-x+1])}getTopLeftOnBit(){const s=this.rowSize,l=this.bits;let u=0;for(;u<l.length&&l[u]===0;)u++;if(u===l.length)return null;const p=u/s;let g=u%s*32;const x=l[u];let y=0;for(;!(x<<31-y&4294967295);)y++;return g+=y,Int32Array.from([g,p])}getBottomRightOnBit(){const s=this.rowSize,l=this.bits;let u=l.length-1;for(;u>=0&&l[u]===0;)u--;if(u<0)return null;const p=Math.floor(u/s);let g=Math.floor(u%s)*32;const x=l[u];let y=31;for(;!(x>>>y);)y--;return g+=y,Int32Array.from([g,p])}getWidth(){return this.width}getHeight(){return this.height}getRowSize(){return this.rowSize}equals(s){if(!(s instanceof pe))return!1;const l=s;return this.width===l.width&&this.height===l.height&&this.rowSize===l.rowSize&&T.equals(this.bits,l.bits)}hashCode(){let s=this.width;return s=31*s+this.width,s=31*s+this.height,s=31*s+this.rowSize,s=31*s+T.hashCode(this.bits),s}toString(s="X ",l="  ",u=`
`){return this.buildToString(s,l,u)}buildToString(s,l,u){let p=new de;for(let g=0,x=this.height;g<x;g++){for(let y=0,C=this.width;y<C;y++)p.append(this.get(y,g)?s:l);p.append(u)}return p.toString()}clone(){return new pe(this.width,this.height,this.rowSize,this.bits.slice())}}class K extends d{static getNotFoundInstance(){return new K}}K.kind="NotFoundException";class Ce extends E{constructor(s){super(s),this.luminances=Ce.EMPTY,this.buckets=new Int32Array(Ce.LUMINANCE_BUCKETS)}getBlackRow(s,l){const u=this.getLuminanceSource(),p=u.getWidth();l==null||l.getSize()<p?l=new N(p):l.clear(),this.initArrays(p);const g=u.getRow(s,this.luminances),x=this.buckets;for(let C=0;C<p;C++)x[(g[C]&255)>>Ce.LUMINANCE_SHIFT]++;const y=Ce.estimateBlackPoint(x);if(p<3)for(let C=0;C<p;C++)(g[C]&255)<y&&l.set(C);else{let C=g[0]&255,O=g[1]&255;for(let D=1;D<p-1;D++){const L=g[D+1]&255;(O*4-C-L)/2<y&&l.set(D),C=O,O=L}}return l}getBlackMatrix(){const s=this.getLuminanceSource(),l=s.getWidth(),u=s.getHeight(),p=new pe(l,u);this.initArrays(l);const g=this.buckets;for(let C=1;C<5;C++){const O=Math.floor(u*C/5),D=s.getRow(O,this.luminances),L=Math.floor(l*4/5);for(let U=Math.floor(l/5);U<L;U++){const J=D[U]&255;g[J>>Ce.LUMINANCE_SHIFT]++}}const x=Ce.estimateBlackPoint(g),y=s.getMatrix();for(let C=0;C<u;C++){const O=C*l;for(let D=0;D<l;D++)(y[O+D]&255)<x&&p.set(D,C)}return p}createBinarizer(s){return new Ce(s)}initArrays(s){this.luminances.length<s&&(this.luminances=new Uint8ClampedArray(s));const l=this.buckets;for(let u=0;u<Ce.LUMINANCE_BUCKETS;u++)l[u]=0}static estimateBlackPoint(s){const l=s.length;let u=0,p=0,g=0;for(let D=0;D<l;D++)s[D]>g&&(p=D,g=s[D]),s[D]>u&&(u=s[D]);let x=0,y=0;for(let D=0;D<l;D++){const L=D-p,U=s[D]*L*L;U>y&&(x=D,y=U)}if(p>x){const D=p;p=x,x=D}if(x-p<=l/16)throw new K;let C=x-1,O=-1;for(let D=x-1;D>p;D--){const L=D-p,U=L*L*(x-D)*(u-s[D]);U>O&&(C=D,O=U)}return C<<Ce.LUMINANCE_SHIFT}}Ce.LUMINANCE_BITS=5,Ce.LUMINANCE_SHIFT=8-Ce.LUMINANCE_BITS,Ce.LUMINANCE_BUCKETS=1<<Ce.LUMINANCE_BITS,Ce.EMPTY=Uint8ClampedArray.from([0]);class ue extends Ce{constructor(s){super(s),this.matrix=null}getBlackMatrix(){if(this.matrix!==null)return this.matrix;const s=this.getLuminanceSource(),l=s.getWidth(),u=s.getHeight();if(l>=ue.MINIMUM_DIMENSION&&u>=ue.MINIMUM_DIMENSION){const p=s.getMatrix();let g=l>>ue.BLOCK_SIZE_POWER;l&ue.BLOCK_SIZE_MASK&&g++;let x=u>>ue.BLOCK_SIZE_POWER;u&ue.BLOCK_SIZE_MASK&&x++;const y=ue.calculateBlackPoints(p,g,x,l,u),C=new pe(l,u);ue.calculateThresholdForBlock(p,g,x,l,u,y,C),this.matrix=C}else this.matrix=super.getBlackMatrix();return this.matrix}createBinarizer(s){return new ue(s)}static calculateThresholdForBlock(s,l,u,p,g,x,y){const C=g-ue.BLOCK_SIZE,O=p-ue.BLOCK_SIZE;for(let D=0;D<u;D++){let L=D<<ue.BLOCK_SIZE_POWER;L>C&&(L=C);const U=ue.cap(D,2,u-3);for(let J=0;J<l;J++){let ie=J<<ue.BLOCK_SIZE_POWER;ie>O&&(ie=O);const oe=ue.cap(J,2,l-3);let me=0;for(let Le=-2;Le<=2;Le++){const Ue=x[U+Le];me+=Ue[oe-2]+Ue[oe-1]+Ue[oe]+Ue[oe+1]+Ue[oe+2]}const _e=me/25;ue.thresholdBlock(s,ie,L,_e,p,y)}}}static cap(s,l,u){return s<l?l:s>u?u:s}static thresholdBlock(s,l,u,p,g,x){for(let y=0,C=u*g+l;y<ue.BLOCK_SIZE;y++,C+=g)for(let O=0;O<ue.BLOCK_SIZE;O++)(s[C+O]&255)<=p&&x.set(l+O,u+y)}static calculateBlackPoints(s,l,u,p,g){const x=g-ue.BLOCK_SIZE,y=p-ue.BLOCK_SIZE,C=new Array(u);for(let O=0;O<u;O++){C[O]=new Int32Array(l);let D=O<<ue.BLOCK_SIZE_POWER;D>x&&(D=x);for(let L=0;L<l;L++){let U=L<<ue.BLOCK_SIZE_POWER;U>y&&(U=y);let J=0,ie=255,oe=0;for(let _e=0,Le=D*p+U;_e<ue.BLOCK_SIZE;_e++,Le+=p){for(let Ue=0;Ue<ue.BLOCK_SIZE;Ue++){const Pe=s[Le+Ue]&255;J+=Pe,Pe<ie&&(ie=Pe),Pe>oe&&(oe=Pe)}if(oe-ie>ue.MIN_DYNAMIC_RANGE)for(_e++,Le+=p;_e<ue.BLOCK_SIZE;_e++,Le+=p)for(let Ue=0;Ue<ue.BLOCK_SIZE;Ue++)J+=s[Le+Ue]&255}let me=J>>ue.BLOCK_SIZE_POWER*2;if(oe-ie<=ue.MIN_DYNAMIC_RANGE&&(me=ie/2,O>0&&L>0)){const _e=(C[O-1][L]+2*C[O][L-1]+C[O-1][L-1])/4;ie<_e&&(me=_e)}C[O][L]=me}}return C}}ue.BLOCK_SIZE_POWER=3,ue.BLOCK_SIZE=1<<ue.BLOCK_SIZE_POWER,ue.BLOCK_SIZE_MASK=ue.BLOCK_SIZE-1,ue.MINIMUM_DIMENSION=ue.BLOCK_SIZE*5,ue.MIN_DYNAMIC_RANGE=24;class se{constructor(s,l){this.width=s,this.height=l}getWidth(){return this.width}getHeight(){return this.height}isCropSupported(){return!1}crop(s,l,u,p){throw new re("This luminance source does not support cropping.")}isRotateSupported(){return!1}rotateCounterClockwise(){throw new re("This luminance source does not support rotation by 90 degrees.")}rotateCounterClockwise45(){throw new re("This luminance source does not support rotation by 45 degrees.")}toString(){const s=new Uint8ClampedArray(this.width);let l=new de;for(let u=0;u<this.height;u++){const p=this.getRow(u,s);for(let g=0;g<this.width;g++){const x=p[g]&255;let y;x<64?y="#":x<128?y="+":x<192?y=".":y=" ",l.append(y)}l.append(`
`)}return l.toString()}}class q extends se{constructor(s){super(s.getWidth(),s.getHeight()),this.delegate=s}getRow(s,l){const u=this.delegate.getRow(s,l),p=this.getWidth();for(let g=0;g<p;g++)u[g]=255-(u[g]&255);return u}getMatrix(){const s=this.delegate.getMatrix(),l=this.getWidth()*this.getHeight(),u=new Uint8ClampedArray(l);for(let p=0;p<l;p++)u[p]=255-(s[p]&255);return u}isCropSupported(){return this.delegate.isCropSupported()}crop(s,l,u,p){return new q(this.delegate.crop(s,l,u,p))}isRotateSupported(){return this.delegate.isRotateSupported()}invert(){return this.delegate}rotateCounterClockwise(){return new q(this.delegate.rotateCounterClockwise())}rotateCounterClockwise45(){return new q(this.delegate.rotateCounterClockwise45())}}class fe extends se{constructor(s){super(s.width,s.height),this.canvas=s,this.tempCanvasElement=null,this.buffer=fe.makeBufferFromCanvasImageData(s)}static makeBufferFromCanvasImageData(s){const l=s.getContext("2d").getImageData(0,0,s.width,s.height);return fe.toGrayscaleBuffer(l.data,s.width,s.height)}static toGrayscaleBuffer(s,l,u){const p=new Uint8ClampedArray(l*u);for(let g=0,x=0,y=s.length;g<y;g+=4,x++){let C;if(s[g+3]===0)C=255;else{const D=s[g],L=s[g+1],U=s[g+2];C=306*D+601*L+117*U+512>>10}p[x]=C}return p}getRow(s,l){if(s<0||s>=this.getHeight())throw new m("Requested row is outside the image: "+s);const u=this.getWidth(),p=s*u;return l===null?l=this.buffer.slice(p,p+u):(l.length<u&&(l=new Uint8ClampedArray(u)),l.set(this.buffer.slice(p,p+u))),l}getMatrix(){return this.buffer}isCropSupported(){return!0}crop(s,l,u,p){return super.crop(s,l,u,p),this}isRotateSupported(){return!0}rotateCounterClockwise(){return this.rotate(-90),this}rotateCounterClockwise45(){return this.rotate(-45),this}getTempCanvasElement(){if(this.tempCanvasElement===null){const s=this.canvas.ownerDocument.createElement("canvas");s.width=this.canvas.width,s.height=this.canvas.height,this.tempCanvasElement=s}return this.tempCanvasElement}rotate(s){const l=this.getTempCanvasElement(),u=l.getContext("2d"),p=s*fe.DEGREE_TO_RADIANS,g=this.canvas.width,x=this.canvas.height,y=Math.ceil(Math.abs(Math.cos(p))*g+Math.abs(Math.sin(p))*x),C=Math.ceil(Math.abs(Math.sin(p))*g+Math.abs(Math.cos(p))*x);return l.width=y,l.height=C,u.translate(y/2,C/2),u.rotate(p),u.drawImage(this.canvas,g/-2,x/-2),this.buffer=fe.makeBufferFromCanvasImageData(l),this}invert(){return new q(this)}}fe.DEGREE_TO_RADIANS=Math.PI/180;class we{constructor(s,l,u){this.deviceId=s,this.label=l,this.kind="videoinput",this.groupId=u||void 0}toJSON(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}}}var G=(globalThis||mu||self||window||void 0)&&(globalThis||mu||self||window||void 0).__awaiter||function(F,s,l,u){function p(g){return g instanceof l?g:new l(function(x){x(g)})}return new(l||(l=Promise))(function(g,x){function y(D){try{O(u.next(D))}catch(L){x(L)}}function C(D){try{O(u.throw(D))}catch(L){x(L)}}function O(D){D.done?g(D.value):p(D.value).then(y,C)}O((u=u.apply(F,s||[])).next())})};class le{constructor(s,l=500,u){this.reader=s,this.timeBetweenScansMillis=l,this._hints=u,this._stopContinuousDecode=!1,this._stopAsyncDecode=!1,this._timeBetweenDecodingAttempts=0}get hasNavigator(){return typeof navigator<"u"}get isMediaDevicesSuported(){return this.hasNavigator&&!!navigator.mediaDevices}get canEnumerateDevices(){return!!(this.isMediaDevicesSuported&&navigator.mediaDevices.enumerateDevices)}get timeBetweenDecodingAttempts(){return this._timeBetweenDecodingAttempts}set timeBetweenDecodingAttempts(s){this._timeBetweenDecodingAttempts=s<0?0:s}set hints(s){this._hints=s||null}get hints(){return this._hints}listVideoInputDevices(){return G(this,void 0,void 0,function*(){if(!this.hasNavigator)throw new Error("Can't enumerate devices, navigator is not present.");if(!this.canEnumerateDevices)throw new Error("Can't enumerate devices, method not supported.");const s=yield navigator.mediaDevices.enumerateDevices(),l=[];for(const u of s){const p=u.kind==="video"?"videoinput":u.kind;if(p!=="videoinput")continue;const g=u.deviceId||u.id,x=u.label||`Video device ${l.length+1}`,y=u.groupId,C={deviceId:g,label:x,kind:p,groupId:y};l.push(C)}return l})}getVideoInputDevices(){return G(this,void 0,void 0,function*(){return(yield this.listVideoInputDevices()).map(l=>new we(l.deviceId,l.label))})}findDeviceById(s){return G(this,void 0,void 0,function*(){const l=yield this.listVideoInputDevices();return l?l.find(u=>u.deviceId===s):null})}decodeFromInputVideoDevice(s,l){return G(this,void 0,void 0,function*(){return yield this.decodeOnceFromVideoDevice(s,l)})}decodeOnceFromVideoDevice(s,l){return G(this,void 0,void 0,function*(){this.reset();let u;s?u={deviceId:{exact:s}}:u={facingMode:"environment"};const p={video:u};return yield this.decodeOnceFromConstraints(p,l)})}decodeOnceFromConstraints(s,l){return G(this,void 0,void 0,function*(){const u=yield navigator.mediaDevices.getUserMedia(s);return yield this.decodeOnceFromStream(u,l)})}decodeOnceFromStream(s,l){return G(this,void 0,void 0,function*(){this.reset();const u=yield this.attachStreamToVideo(s,l);return yield this.decodeOnce(u)})}decodeFromInputVideoDeviceContinuously(s,l,u){return G(this,void 0,void 0,function*(){return yield this.decodeFromVideoDevice(s,l,u)})}decodeFromVideoDevice(s,l,u){return G(this,void 0,void 0,function*(){let p;s?p={deviceId:{exact:s}}:p={facingMode:"environment"};const g={video:p};return yield this.decodeFromConstraints(g,l,u)})}decodeFromConstraints(s,l,u){return G(this,void 0,void 0,function*(){const p=yield navigator.mediaDevices.getUserMedia(s);return yield this.decodeFromStream(p,l,u)})}decodeFromStream(s,l,u){return G(this,void 0,void 0,function*(){this.reset();const p=yield this.attachStreamToVideo(s,l);return yield this.decodeContinuously(p,u)})}stopAsyncDecode(){this._stopAsyncDecode=!0}stopContinuousDecode(){this._stopContinuousDecode=!0}attachStreamToVideo(s,l){return G(this,void 0,void 0,function*(){const u=this.prepareVideoElement(l);return this.addVideoSource(u,s),this.videoElement=u,this.stream=s,yield this.playVideoOnLoadAsync(u),u})}playVideoOnLoadAsync(s){return new Promise((l,u)=>this.playVideoOnLoad(s,()=>l()))}playVideoOnLoad(s,l){this.videoEndedListener=()=>this.stopStreams(),this.videoCanPlayListener=()=>this.tryPlayVideo(s),s.addEventListener("ended",this.videoEndedListener),s.addEventListener("canplay",this.videoCanPlayListener),s.addEventListener("playing",l),this.tryPlayVideo(s)}isVideoPlaying(s){return s.currentTime>0&&!s.paused&&!s.ended&&s.readyState>2}tryPlayVideo(s){return G(this,void 0,void 0,function*(){if(this.isVideoPlaying(s)){console.warn("Trying to play video that is already playing.");return}try{yield s.play()}catch{console.warn("It was not possible to play the video.")}})}getMediaElement(s,l){const u=document.getElementById(s);if(!u)throw new h(`element with id '${s}' not found`);if(u.nodeName.toLowerCase()!==l.toLowerCase())throw new h(`element with id '${s}' must be an ${l} element`);return u}decodeFromImage(s,l){if(!s&&!l)throw new h("either imageElement with a src set or an url must be provided");return l&&!s?this.decodeFromImageUrl(l):this.decodeFromImageElement(s)}decodeFromVideo(s,l){if(!s&&!l)throw new h("Either an element with a src set or an URL must be provided");return l&&!s?this.decodeFromVideoUrl(l):this.decodeFromVideoElement(s)}decodeFromVideoContinuously(s,l,u){if(s===void 0&&l===void 0)throw new h("Either an element with a src set or an URL must be provided");return l&&!s?this.decodeFromVideoUrlContinuously(l,u):this.decodeFromVideoElementContinuously(s,u)}decodeFromImageElement(s){if(!s)throw new h("An image element must be provided.");this.reset();const l=this.prepareImageElement(s);this.imageElement=l;let u;return this.isImageLoaded(l)?u=this.decodeOnce(l,!1,!0):u=this._decodeOnLoadImage(l),u}decodeFromVideoElement(s){const l=this._decodeFromVideoElementSetup(s);return this._decodeOnLoadVideo(l)}decodeFromVideoElementContinuously(s,l){const u=this._decodeFromVideoElementSetup(s);return this._decodeOnLoadVideoContinuously(u,l)}_decodeFromVideoElementSetup(s){if(!s)throw new h("A video element must be provided.");this.reset();const l=this.prepareVideoElement(s);return this.videoElement=l,l}decodeFromImageUrl(s){if(!s)throw new h("An URL must be provided.");this.reset();const l=this.prepareImageElement();this.imageElement=l;const u=this._decodeOnLoadImage(l);return l.src=s,u}decodeFromVideoUrl(s){if(!s)throw new h("An URL must be provided.");this.reset();const l=this.prepareVideoElement(),u=this.decodeFromVideoElement(l);return l.src=s,u}decodeFromVideoUrlContinuously(s,l){if(!s)throw new h("An URL must be provided.");this.reset();const u=this.prepareVideoElement(),p=this.decodeFromVideoElementContinuously(u,l);return u.src=s,p}_decodeOnLoadImage(s){return new Promise((l,u)=>{this.imageLoadedListener=()=>this.decodeOnce(s,!1,!0).then(l,u),s.addEventListener("load",this.imageLoadedListener)})}_decodeOnLoadVideo(s){return G(this,void 0,void 0,function*(){return yield this.playVideoOnLoadAsync(s),yield this.decodeOnce(s)})}_decodeOnLoadVideoContinuously(s,l){return G(this,void 0,void 0,function*(){yield this.playVideoOnLoadAsync(s),this.decodeContinuously(s,l)})}isImageLoaded(s){return!(!s.complete||s.naturalWidth===0)}prepareImageElement(s){let l;return typeof s>"u"&&(l=document.createElement("img"),l.width=200,l.height=200),typeof s=="string"&&(l=this.getMediaElement(s,"img")),s instanceof HTMLImageElement&&(l=s),l}prepareVideoElement(s){let l;return!s&&typeof document<"u"&&(l=document.createElement("video"),l.width=200,l.height=200),typeof s=="string"&&(l=this.getMediaElement(s,"video")),s instanceof HTMLVideoElement&&(l=s),l.setAttribute("autoplay","true"),l.setAttribute("muted","true"),l.setAttribute("playsinline","true"),l}decodeOnce(s,l=!0,u=!0){this._stopAsyncDecode=!1;const p=(g,x)=>{if(this._stopAsyncDecode){x(new K("Video stream has ended before any code could be detected.")),this._stopAsyncDecode=void 0;return}try{const y=this.decode(s);g(y)}catch(y){const C=l&&y instanceof K,D=(y instanceof w||y instanceof P)&&u;if(C||D)return setTimeout(p,this._timeBetweenDecodingAttempts,g,x);x(y)}};return new Promise((g,x)=>p(g,x))}decodeContinuously(s,l){this._stopContinuousDecode=!1;const u=()=>{if(this._stopContinuousDecode){this._stopContinuousDecode=void 0;return}try{const p=this.decode(s);l(p,null),setTimeout(u,this.timeBetweenScansMillis)}catch(p){l(null,p);const g=p instanceof w||p instanceof P,x=p instanceof K;(g||x)&&setTimeout(u,this._timeBetweenDecodingAttempts)}};u()}decode(s){const l=this.createBinaryBitmap(s);return this.decodeBitmap(l)}_isHTMLVideoElement(s){return s.videoWidth!==0}drawFrameOnCanvas(s,l,u){l||(l={sx:0,sy:0,sWidth:s.videoWidth,sHeight:s.videoHeight,dx:0,dy:0,dWidth:s.videoWidth,dHeight:s.videoHeight}),u||(u=this.captureCanvasContext),u.drawImage(s,l.sx,l.sy,l.sWidth,l.sHeight,l.dx,l.dy,l.dWidth,l.dHeight)}drawImageOnCanvas(s,l,u=this.captureCanvasContext){l||(l={sx:0,sy:0,sWidth:s.naturalWidth,sHeight:s.naturalHeight,dx:0,dy:0,dWidth:s.naturalWidth,dHeight:s.naturalHeight}),u||(u=this.captureCanvasContext),u.drawImage(s,l.sx,l.sy,l.sWidth,l.sHeight,l.dx,l.dy,l.dWidth,l.dHeight)}createBinaryBitmap(s){this.getCaptureCanvasContext(s),this._isHTMLVideoElement(s)?this.drawFrameOnCanvas(s):this.drawImageOnCanvas(s);const l=this.getCaptureCanvas(s),u=new fe(l),p=new ue(u);return new v(p)}getCaptureCanvasContext(s){if(!this.captureCanvasContext){const u=this.getCaptureCanvas(s).getContext("2d");this.captureCanvasContext=u}return this.captureCanvasContext}getCaptureCanvas(s){if(!this.captureCanvas){const l=this.createCaptureCanvas(s);this.captureCanvas=l}return this.captureCanvas}decodeBitmap(s){return this.reader.decode(s,this._hints)}createCaptureCanvas(s){if(typeof document>"u")return this._destroyCaptureCanvas(),null;const l=document.createElement("canvas");let u,p;return typeof s<"u"&&(s instanceof HTMLVideoElement?(u=s.videoWidth,p=s.videoHeight):s instanceof HTMLImageElement&&(u=s.naturalWidth||s.width,p=s.naturalHeight||s.height)),l.style.width=u+"px",l.style.height=p+"px",l.width=u,l.height=p,l}stopStreams(){this.stream&&(this.stream.getVideoTracks().forEach(s=>s.stop()),this.stream=void 0),this._stopAsyncDecode===!1&&this.stopAsyncDecode(),this._stopContinuousDecode===!1&&this.stopContinuousDecode()}reset(){this.stopStreams(),this._destroyVideoElement(),this._destroyImageElement(),this._destroyCaptureCanvas()}_destroyVideoElement(){this.videoElement&&(typeof this.videoEndedListener<"u"&&this.videoElement.removeEventListener("ended",this.videoEndedListener),typeof this.videoPlayingEventListener<"u"&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),typeof this.videoCanPlayListener<"u"&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)}_destroyImageElement(){this.imageElement&&(this.imageLoadedListener!==void 0&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)}_destroyCaptureCanvas(){this.captureCanvasContext=void 0,this.captureCanvas=void 0}addVideoSource(s,l){try{s.srcObject=l}catch{s.src=URL.createObjectURL(l)}}cleanVideoSource(s){try{s.srcObject=null}catch{s.src=""}this.videoElement.removeAttribute("src")}}class ne{constructor(s,l,u=l==null?0:8*l.length,p,g,x=A.currentTimeMillis()){this.text=s,this.rawBytes=l,this.numBits=u,this.resultPoints=p,this.format=g,this.timestamp=x,this.text=s,this.rawBytes=l,u==null?this.numBits=l==null?0:8*l.length:this.numBits=u,this.resultPoints=p,this.format=g,this.resultMetadata=null,x==null?this.timestamp=A.currentTimeMillis():this.timestamp=x}getText(){return this.text}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}getResultPoints(){return this.resultPoints}getBarcodeFormat(){return this.format}getResultMetadata(){return this.resultMetadata}putMetadata(s,l){this.resultMetadata===null&&(this.resultMetadata=new Map),this.resultMetadata.set(s,l)}putAllMetadata(s){s!==null&&(this.resultMetadata===null?this.resultMetadata=s:this.resultMetadata=new Map(s))}addResultPoints(s){const l=this.resultPoints;if(l===null)this.resultPoints=s;else if(s!==null&&s.length>0){const u=new Array(l.length+s.length);A.arraycopy(l,0,u,0,l.length),A.arraycopy(s,0,u,l.length,s.length),this.resultPoints=u}}getTimestamp(){return this.timestamp}toString(){return this.text}}var ae;(function(F){F[F.AZTEC=0]="AZTEC",F[F.CODABAR=1]="CODABAR",F[F.CODE_39=2]="CODE_39",F[F.CODE_93=3]="CODE_93",F[F.CODE_128=4]="CODE_128",F[F.DATA_MATRIX=5]="DATA_MATRIX",F[F.EAN_8=6]="EAN_8",F[F.EAN_13=7]="EAN_13",F[F.ITF=8]="ITF",F[F.MAXICODE=9]="MAXICODE",F[F.PDF_417=10]="PDF_417",F[F.QR_CODE=11]="QR_CODE",F[F.RSS_14=12]="RSS_14",F[F.RSS_EXPANDED=13]="RSS_EXPANDED",F[F.UPC_A=14]="UPC_A",F[F.UPC_E=15]="UPC_E",F[F.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(ae||(ae={}));var he=ae,ke;(function(F){F[F.OTHER=0]="OTHER",F[F.ORIENTATION=1]="ORIENTATION",F[F.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",F[F.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",F[F.ISSUE_NUMBER=4]="ISSUE_NUMBER",F[F.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",F[F.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",F[F.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",F[F.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",F[F.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",F[F.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY"})(ke||(ke={}));var De=ke;class ce{constructor(s,l,u,p,g=-1,x=-1){this.rawBytes=s,this.text=l,this.byteSegments=u,this.ecLevel=p,this.structuredAppendSequenceNumber=g,this.structuredAppendParity=x,this.numBits=s==null?0:8*s.length}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}setNumBits(s){this.numBits=s}getText(){return this.text}getByteSegments(){return this.byteSegments}getECLevel(){return this.ecLevel}getErrorsCorrected(){return this.errorsCorrected}setErrorsCorrected(s){this.errorsCorrected=s}getErasures(){return this.erasures}setErasures(s){this.erasures=s}getOther(){return this.other}setOther(s){this.other=s}hasStructuredAppend(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0}getStructuredAppendParity(){return this.structuredAppendParity}getStructuredAppendSequenceNumber(){return this.structuredAppendSequenceNumber}}class be{exp(s){return this.expTable[s]}log(s){if(s===0)throw new m;return this.logTable[s]}static addOrSubtract(s,l){return s^l}}class ze{constructor(s,l){if(l.length===0)throw new m;this.field=s;const u=l.length;if(u>1&&l[0]===0){let p=1;for(;p<u&&l[p]===0;)p++;p===u?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(u-p),A.arraycopy(l,p,this.coefficients,0,this.coefficients.length))}else this.coefficients=l}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(s){return this.coefficients[this.coefficients.length-1-s]}evaluateAt(s){if(s===0)return this.getCoefficient(0);const l=this.coefficients;let u;if(s===1){u=0;for(let x=0,y=l.length;x!==y;x++){const C=l[x];u=be.addOrSubtract(u,C)}return u}u=l[0];const p=l.length,g=this.field;for(let x=1;x<p;x++)u=be.addOrSubtract(g.multiply(s,u),l[x]);return u}addOrSubtract(s){if(!this.field.equals(s.field))throw new m("GenericGFPolys do not have same GenericGF field");if(this.isZero())return s;if(s.isZero())return this;let l=this.coefficients,u=s.coefficients;if(l.length>u.length){const x=l;l=u,u=x}let p=new Int32Array(u.length);const g=u.length-l.length;A.arraycopy(u,0,p,0,g);for(let x=g;x<u.length;x++)p[x]=be.addOrSubtract(l[x-g],u[x]);return new ze(this.field,p)}multiply(s){if(!this.field.equals(s.field))throw new m("GenericGFPolys do not have same GenericGF field");if(this.isZero()||s.isZero())return this.field.getZero();const l=this.coefficients,u=l.length,p=s.coefficients,g=p.length,x=new Int32Array(u+g-1),y=this.field;for(let C=0;C<u;C++){const O=l[C];for(let D=0;D<g;D++)x[C+D]=be.addOrSubtract(x[C+D],y.multiply(O,p[D]))}return new ze(y,x)}multiplyScalar(s){if(s===0)return this.field.getZero();if(s===1)return this;const l=this.coefficients.length,u=this.field,p=new Int32Array(l),g=this.coefficients;for(let x=0;x<l;x++)p[x]=u.multiply(g[x],s);return new ze(u,p)}multiplyByMonomial(s,l){if(s<0)throw new m;if(l===0)return this.field.getZero();const u=this.coefficients,p=u.length,g=new Int32Array(p+s),x=this.field;for(let y=0;y<p;y++)g[y]=x.multiply(u[y],l);return new ze(x,g)}divide(s){if(!this.field.equals(s.field))throw new m("GenericGFPolys do not have same GenericGF field");if(s.isZero())throw new m("Divide by 0");const l=this.field;let u=l.getZero(),p=this;const g=s.getCoefficient(s.getDegree()),x=l.inverse(g);for(;p.getDegree()>=s.getDegree()&&!p.isZero();){const y=p.getDegree()-s.getDegree(),C=l.multiply(p.getCoefficient(p.getDegree()),x),O=s.multiplyByMonomial(y,C),D=l.buildMonomial(y,C);u=u.addOrSubtract(D),p=p.addOrSubtract(O)}return[u,p]}toString(){let s="";for(let l=this.getDegree();l>=0;l--){let u=this.getCoefficient(l);if(u!==0){if(u<0?(s+=" - ",u=-u):s.length>0&&(s+=" + "),l===0||u!==1){const p=this.field.log(u);p===0?s+="1":p===1?s+="a":(s+="a^",s+=p)}l!==0&&(l===1?s+="x":(s+="x^",s+=l))}}return s}}class W extends d{}W.kind="ArithmeticException";class He extends be{constructor(s,l,u){super(),this.primitive=s,this.size=l,this.generatorBase=u;const p=new Int32Array(l);let g=1;for(let y=0;y<l;y++)p[y]=g,g*=2,g>=l&&(g^=s,g&=l-1);this.expTable=p;const x=new Int32Array(l);for(let y=0;y<l-1;y++)x[p[y]]=y;this.logTable=x,this.zero=new ze(this,Int32Array.from([0])),this.one=new ze(this,Int32Array.from([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(s,l){if(s<0)throw new m;if(l===0)return this.zero;const u=new Int32Array(s+1);return u[0]=l,new ze(this,u)}inverse(s){if(s===0)throw new W;return this.expTable[this.size-this.logTable[s]-1]}multiply(s,l){return s===0||l===0?0:this.expTable[(this.logTable[s]+this.logTable[l])%(this.size-1)]}getSize(){return this.size}getGeneratorBase(){return this.generatorBase}toString(){return"GF(0x"+_.toHexString(this.primitive)+","+this.size+")"}equals(s){return s===this}}He.AZTEC_DATA_12=new He(4201,4096,1),He.AZTEC_DATA_10=new He(1033,1024,1),He.AZTEC_DATA_6=new He(67,64,1),He.AZTEC_PARAM=new He(19,16,1),He.QR_CODE_FIELD_256=new He(285,256,0),He.DATA_MATRIX_FIELD_256=new He(301,256,1),He.AZTEC_DATA_8=He.DATA_MATRIX_FIELD_256,He.MAXICODE_FIELD_64=He.AZTEC_DATA_6;class Ge extends d{}Ge.kind="ReedSolomonException";class et extends d{}et.kind="IllegalStateException";class Ze{constructor(s){this.field=s}decode(s,l){const u=this.field,p=new ze(u,s),g=new Int32Array(l);let x=!0;for(let J=0;J<l;J++){const ie=p.evaluateAt(u.exp(J+u.getGeneratorBase()));g[g.length-1-J]=ie,ie!==0&&(x=!1)}if(x)return;const y=new ze(u,g),C=this.runEuclideanAlgorithm(u.buildMonomial(l,1),y,l),O=C[0],D=C[1],L=this.findErrorLocations(O),U=this.findErrorMagnitudes(D,L);for(let J=0;J<L.length;J++){const ie=s.length-1-u.log(L[J]);if(ie<0)throw new Ge("Bad error location");s[ie]=He.addOrSubtract(s[ie],U[J])}}runEuclideanAlgorithm(s,l,u){if(s.getDegree()<l.getDegree()){const J=s;s=l,l=J}const p=this.field;let g=s,x=l,y=p.getZero(),C=p.getOne();for(;x.getDegree()>=(u/2|0);){let J=g,ie=y;if(g=x,y=C,g.isZero())throw new Ge("r_{i-1} was zero");x=J;let oe=p.getZero();const me=g.getCoefficient(g.getDegree()),_e=p.inverse(me);for(;x.getDegree()>=g.getDegree()&&!x.isZero();){const Le=x.getDegree()-g.getDegree(),Ue=p.multiply(x.getCoefficient(x.getDegree()),_e);oe=oe.addOrSubtract(p.buildMonomial(Le,Ue)),x=x.addOrSubtract(g.multiplyByMonomial(Le,Ue))}if(C=oe.multiply(y).addOrSubtract(ie),x.getDegree()>=g.getDegree())throw new et("Division algorithm failed to reduce polynomial?")}const O=C.getCoefficient(0);if(O===0)throw new Ge("sigmaTilde(0) was zero");const D=p.inverse(O),L=C.multiplyScalar(D),U=x.multiplyScalar(D);return[L,U]}findErrorLocations(s){const l=s.getDegree();if(l===1)return Int32Array.from([s.getCoefficient(1)]);const u=new Int32Array(l);let p=0;const g=this.field;for(let x=1;x<g.getSize()&&p<l;x++)s.evaluateAt(x)===0&&(u[p]=g.inverse(x),p++);if(p!==l)throw new Ge("Error locator degree does not match number of roots");return u}findErrorMagnitudes(s,l){const u=l.length,p=new Int32Array(u),g=this.field;for(let x=0;x<u;x++){const y=g.inverse(l[x]);let C=1;for(let O=0;O<u;O++)if(x!==O){const D=g.multiply(l[O],y),L=D&1?D&-2:D|1;C=g.multiply(C,L)}p[x]=g.multiply(s.evaluateAt(y),g.inverse(C)),g.getGeneratorBase()!==0&&(p[x]=g.multiply(p[x],y))}return p}}var Ie;(function(F){F[F.UPPER=0]="UPPER",F[F.LOWER=1]="LOWER",F[F.MIXED=2]="MIXED",F[F.DIGIT=3]="DIGIT",F[F.PUNCT=4]="PUNCT",F[F.BINARY=5]="BINARY"})(Ie||(Ie={}));class rt{decode(s){this.ddata=s;let l=s.getBits(),u=this.extractBits(l),p=this.correctBits(u),g=rt.convertBoolArrayToByteArray(p),x=rt.getEncodedData(p),y=new ce(g,x,null,null);return y.setNumBits(p.length),y}static highLevelDecode(s){return this.getEncodedData(s)}static getEncodedData(s){let l=s.length,u=Ie.UPPER,p=Ie.UPPER,g="",x=0;for(;x<l;)if(p===Ie.BINARY){if(l-x<5)break;let y=rt.readCode(s,x,5);if(x+=5,y===0){if(l-x<11)break;y=rt.readCode(s,x,11)+31,x+=11}for(let C=0;C<y;C++){if(l-x<8){x=l;break}const O=rt.readCode(s,x,8);g+=V.castAsNonUtf8Char(O),x+=8}p=u}else{let y=p===Ie.DIGIT?4:5;if(l-x<y)break;let C=rt.readCode(s,x,y);x+=y;let O=rt.getCharacter(p,C);O.startsWith("CTRL_")?(u=p,p=rt.getTable(O.charAt(5)),O.charAt(6)==="L"&&(u=p)):(g+=O,p=u)}return g}static getTable(s){switch(s){case"L":return Ie.LOWER;case"P":return Ie.PUNCT;case"M":return Ie.MIXED;case"D":return Ie.DIGIT;case"B":return Ie.BINARY;case"U":default:return Ie.UPPER}}static getCharacter(s,l){switch(s){case Ie.UPPER:return rt.UPPER_TABLE[l];case Ie.LOWER:return rt.LOWER_TABLE[l];case Ie.MIXED:return rt.MIXED_TABLE[l];case Ie.PUNCT:return rt.PUNCT_TABLE[l];case Ie.DIGIT:return rt.DIGIT_TABLE[l];default:throw new et("Bad table")}}correctBits(s){let l,u;this.ddata.getNbLayers()<=2?(u=6,l=He.AZTEC_DATA_6):this.ddata.getNbLayers()<=8?(u=8,l=He.AZTEC_DATA_8):this.ddata.getNbLayers()<=22?(u=10,l=He.AZTEC_DATA_10):(u=12,l=He.AZTEC_DATA_12);let p=this.ddata.getNbDatablocks(),g=s.length/u;if(g<p)throw new P;let x=s.length%u,y=new Int32Array(g);for(let U=0;U<g;U++,x+=u)y[U]=rt.readCode(s,x,u);try{new Ze(l).decode(y,g-p)}catch(U){throw new P(U)}let C=(1<<u)-1,O=0;for(let U=0;U<p;U++){let J=y[U];if(J===0||J===C)throw new P;(J===1||J===C-1)&&O++}let D=new Array(p*u-O),L=0;for(let U=0;U<p;U++){let J=y[U];if(J===1||J===C-1)D.fill(J>1,L,L+u-1),L+=u-1;else for(let ie=u-1;ie>=0;--ie)D[L++]=(J&1<<ie)!==0}return D}extractBits(s){let l=this.ddata.isCompact(),u=this.ddata.getNbLayers(),p=(l?11:14)+u*4,g=new Int32Array(p),x=new Array(this.totalBitsInLayer(u,l));if(l)for(let y=0;y<g.length;y++)g[y]=y;else{let y=p+1+2*_.truncDivision(_.truncDivision(p,2)-1,15),C=p/2,O=_.truncDivision(y,2);for(let D=0;D<C;D++){let L=D+_.truncDivision(D,15);g[C-D-1]=O-L-1,g[C+D]=O+L+1}}for(let y=0,C=0;y<u;y++){let O=(u-y)*4+(l?9:12),D=y*2,L=p-1-D;for(let U=0;U<O;U++){let J=U*2;for(let ie=0;ie<2;ie++)x[C+J+ie]=s.get(g[D+ie],g[D+U]),x[C+2*O+J+ie]=s.get(g[D+U],g[L-ie]),x[C+4*O+J+ie]=s.get(g[L-ie],g[L-U]),x[C+6*O+J+ie]=s.get(g[L-U],g[D+ie])}C+=O*8}return x}static readCode(s,l,u){let p=0;for(let g=l;g<l+u;g++)p<<=1,s[g]&&(p|=1);return p}static readByte(s,l){let u=s.length-l;return u>=8?rt.readCode(s,l,8):rt.readCode(s,l,u)<<8-u}static convertBoolArrayToByteArray(s){let l=new Uint8Array((s.length+7)/8);for(let u=0;u<l.length;u++)l[u]=rt.readByte(s,8*u);return l}totalBitsInLayer(s,l){return((l?88:112)+16*s)*s}}rt.UPPER_TABLE=["CTRL_PS"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","CTRL_LL","CTRL_ML","CTRL_DL","CTRL_BS"],rt.LOWER_TABLE=["CTRL_PS"," ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CTRL_US","CTRL_ML","CTRL_DL","CTRL_BS"],rt.MIXED_TABLE=["CTRL_PS"," ","\\1","\\2","\\3","\\4","\\5","\\6","\\7","\b","	",`
`,"\\13","\f","\r","\\33","\\34","\\35","\\36","\\37","@","\\","^","_","`","|","~","\\177","CTRL_LL","CTRL_UL","CTRL_PL","CTRL_BS"],rt.PUNCT_TABLE=["","\r",`\r
`,". ",", ",": ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}","CTRL_UL"],rt.DIGIT_TABLE=["CTRL_PS"," ","0","1","2","3","4","5","6","7","8","9",",",".","CTRL_UL","CTRL_US"];class at{constructor(){}static round(s){return s===NaN?0:s<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:s>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:s+(s<0?-.5:.5)|0}static distance(s,l,u,p){const g=s-u,x=l-p;return Math.sqrt(g*g+x*x)}static sum(s){let l=0;for(let u=0,p=s.length;u!==p;u++){const g=s[u];l+=g}return l}}class Br{static floatToIntBits(s){return s}}Br.MAX_VALUE=Number.MAX_SAFE_INTEGER;class $e{constructor(s,l){this.x=s,this.y=l}getX(){return this.x}getY(){return this.y}equals(s){if(s instanceof $e){const l=s;return this.x===l.x&&this.y===l.y}return!1}hashCode(){return 31*Br.floatToIntBits(this.x)+Br.floatToIntBits(this.y)}toString(){return"("+this.x+","+this.y+")"}static orderBestPatterns(s){const l=this.distance(s[0],s[1]),u=this.distance(s[1],s[2]),p=this.distance(s[0],s[2]);let g,x,y;if(u>=l&&u>=p?(x=s[0],g=s[1],y=s[2]):p>=u&&p>=l?(x=s[1],g=s[0],y=s[2]):(x=s[2],g=s[0],y=s[1]),this.crossProductZ(g,x,y)<0){const C=g;g=y,y=C}s[0]=g,s[1]=x,s[2]=y}static distance(s,l){return at.distance(s.x,s.y,l.x,l.y)}static crossProductZ(s,l,u){const p=l.x,g=l.y;return(u.x-p)*(s.y-g)-(u.y-g)*(s.x-p)}}class Pi{constructor(s,l){this.bits=s,this.points=l}getBits(){return this.bits}getPoints(){return this.points}}class Be extends Pi{constructor(s,l,u,p,g){super(s,l),this.compact=u,this.nbDatablocks=p,this.nbLayers=g}getNbLayers(){return this.nbLayers}getNbDatablocks(){return this.nbDatablocks}isCompact(){return this.compact}}class Qe{constructor(s,l,u,p){this.image=s,this.height=s.getHeight(),this.width=s.getWidth(),l==null&&(l=Qe.INIT_SIZE),u==null&&(u=s.getWidth()/2|0),p==null&&(p=s.getHeight()/2|0);const g=l/2|0;if(this.leftInit=u-g,this.rightInit=u+g,this.upInit=p-g,this.downInit=p+g,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new K}detect(){let s=this.leftInit,l=this.rightInit,u=this.upInit,p=this.downInit,g=!1,x=!0,y=!1,C=!1,O=!1,D=!1,L=!1;const U=this.width,J=this.height;for(;x;){x=!1;let ie=!0;for(;(ie||!C)&&l<U;)ie=this.containsBlackPoint(u,p,l,!1),ie?(l++,x=!0,C=!0):C||l++;if(l>=U){g=!0;break}let oe=!0;for(;(oe||!O)&&p<J;)oe=this.containsBlackPoint(s,l,p,!0),oe?(p++,x=!0,O=!0):O||p++;if(p>=J){g=!0;break}let me=!0;for(;(me||!D)&&s>=0;)me=this.containsBlackPoint(u,p,s,!1),me?(s--,x=!0,D=!0):D||s--;if(s<0){g=!0;break}let _e=!0;for(;(_e||!L)&&u>=0;)_e=this.containsBlackPoint(s,l,u,!0),_e?(u--,x=!0,L=!0):L||u--;if(u<0){g=!0;break}x&&(y=!0)}if(!g&&y){const ie=l-s;let oe=null;for(let Ue=1;oe===null&&Ue<ie;Ue++)oe=this.getBlackPointOnSegment(s,p-Ue,s+Ue,p);if(oe==null)throw new K;let me=null;for(let Ue=1;me===null&&Ue<ie;Ue++)me=this.getBlackPointOnSegment(s,u+Ue,s+Ue,u);if(me==null)throw new K;let _e=null;for(let Ue=1;_e===null&&Ue<ie;Ue++)_e=this.getBlackPointOnSegment(l,u+Ue,l-Ue,u);if(_e==null)throw new K;let Le=null;for(let Ue=1;Le===null&&Ue<ie;Ue++)Le=this.getBlackPointOnSegment(l,p-Ue,l-Ue,p);if(Le==null)throw new K;return this.centerEdges(Le,oe,_e,me)}else throw new K}getBlackPointOnSegment(s,l,u,p){const g=at.round(at.distance(s,l,u,p)),x=(u-s)/g,y=(p-l)/g,C=this.image;for(let O=0;O<g;O++){const D=at.round(s+O*x),L=at.round(l+O*y);if(C.get(D,L))return new $e(D,L)}return null}centerEdges(s,l,u,p){const g=s.getX(),x=s.getY(),y=l.getX(),C=l.getY(),O=u.getX(),D=u.getY(),L=p.getX(),U=p.getY(),J=Qe.CORR;return g<this.width/2?[new $e(L-J,U+J),new $e(y+J,C+J),new $e(O-J,D-J),new $e(g+J,x-J)]:[new $e(L+J,U+J),new $e(y+J,C-J),new $e(O-J,D+J),new $e(g-J,x-J)]}containsBlackPoint(s,l,u,p){const g=this.image;if(p){for(let x=s;x<=l;x++)if(g.get(x,u))return!0}else for(let x=s;x<=l;x++)if(g.get(u,x))return!0;return!1}}Qe.INIT_SIZE=10,Qe.CORR=1;class _t{static checkAndNudgePoints(s,l){const u=s.getWidth(),p=s.getHeight();let g=!0;for(let x=0;x<l.length&&g;x+=2){const y=Math.floor(l[x]),C=Math.floor(l[x+1]);if(y<-1||y>u||C<-1||C>p)throw new K;g=!1,y===-1?(l[x]=0,g=!0):y===u&&(l[x]=u-1,g=!0),C===-1?(l[x+1]=0,g=!0):C===p&&(l[x+1]=p-1,g=!0)}g=!0;for(let x=l.length-2;x>=0&&g;x-=2){const y=Math.floor(l[x]),C=Math.floor(l[x+1]);if(y<-1||y>u||C<-1||C>p)throw new K;g=!1,y===-1?(l[x]=0,g=!0):y===u&&(l[x]=u-1,g=!0),C===-1?(l[x+1]=0,g=!0):C===p&&(l[x+1]=p-1,g=!0)}}}class Rt{constructor(s,l,u,p,g,x,y,C,O){this.a11=s,this.a21=l,this.a31=u,this.a12=p,this.a22=g,this.a32=x,this.a13=y,this.a23=C,this.a33=O}static quadrilateralToQuadrilateral(s,l,u,p,g,x,y,C,O,D,L,U,J,ie,oe,me){const _e=Rt.quadrilateralToSquare(s,l,u,p,g,x,y,C);return Rt.squareToQuadrilateral(O,D,L,U,J,ie,oe,me).times(_e)}transformPoints(s){const l=s.length,u=this.a11,p=this.a12,g=this.a13,x=this.a21,y=this.a22,C=this.a23,O=this.a31,D=this.a32,L=this.a33;for(let U=0;U<l;U+=2){const J=s[U],ie=s[U+1],oe=g*J+C*ie+L;s[U]=(u*J+x*ie+O)/oe,s[U+1]=(p*J+y*ie+D)/oe}}transformPointsWithValues(s,l){const u=this.a11,p=this.a12,g=this.a13,x=this.a21,y=this.a22,C=this.a23,O=this.a31,D=this.a32,L=this.a33,U=s.length;for(let J=0;J<U;J++){const ie=s[J],oe=l[J],me=g*ie+C*oe+L;s[J]=(u*ie+x*oe+O)/me,l[J]=(p*ie+y*oe+D)/me}}static squareToQuadrilateral(s,l,u,p,g,x,y,C){const O=s-u+g-y,D=l-p+x-C;if(O===0&&D===0)return new Rt(u-s,g-u,s,p-l,x-p,l,0,0,1);{const L=u-g,U=y-g,J=p-x,ie=C-x,oe=L*ie-U*J,me=(O*ie-U*D)/oe,_e=(L*D-O*J)/oe;return new Rt(u-s+me*u,y-s+_e*y,s,p-l+me*p,C-l+_e*C,l,me,_e,1)}}static quadrilateralToSquare(s,l,u,p,g,x,y,C){return Rt.squareToQuadrilateral(s,l,u,p,g,x,y,C).buildAdjoint()}buildAdjoint(){return new Rt(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)}times(s){return new Rt(this.a11*s.a11+this.a21*s.a12+this.a31*s.a13,this.a11*s.a21+this.a21*s.a22+this.a31*s.a23,this.a11*s.a31+this.a21*s.a32+this.a31*s.a33,this.a12*s.a11+this.a22*s.a12+this.a32*s.a13,this.a12*s.a21+this.a22*s.a22+this.a32*s.a23,this.a12*s.a31+this.a22*s.a32+this.a32*s.a33,this.a13*s.a11+this.a23*s.a12+this.a33*s.a13,this.a13*s.a21+this.a23*s.a22+this.a33*s.a23,this.a13*s.a31+this.a23*s.a32+this.a33*s.a33)}}class Fs extends _t{sampleGrid(s,l,u,p,g,x,y,C,O,D,L,U,J,ie,oe,me,_e,Le,Ue){const Pe=Rt.quadrilateralToQuadrilateral(p,g,x,y,C,O,D,L,U,J,ie,oe,me,_e,Le,Ue);return this.sampleGridWithTransform(s,l,u,Pe)}sampleGridWithTransform(s,l,u,p){if(l<=0||u<=0)throw new K;const g=new pe(l,u),x=new Float32Array(2*l);for(let y=0;y<u;y++){const C=x.length,O=y+.5;for(let D=0;D<C;D+=2)x[D]=D/2+.5,x[D+1]=O;p.transformPoints(x),_t.checkAndNudgePoints(s,x);try{for(let D=0;D<C;D+=2)s.get(Math.floor(x[D]),Math.floor(x[D+1]))&&g.set(D/2,y)}catch{throw new K}}return g}}class sr{static setGridSampler(s){sr.gridSampler=s}static getInstance(){return sr.gridSampler}}sr.gridSampler=new Fs;class $t{constructor(s,l){this.x=s,this.y=l}toResultPoint(){return new $e(this.getX(),this.getY())}getX(){return this.x}getY(){return this.y}}class dt{constructor(s){this.EXPECTED_CORNER_BITS=new Int32Array([3808,476,2107,1799]),this.image=s}detect(){return this.detectMirror(!1)}detectMirror(s){let l=this.getMatrixCenter(),u=this.getBullsEyeCorners(l);if(s){let x=u[0];u[0]=u[2],u[2]=x}this.extractParameters(u);let p=this.sampleGrid(this.image,u[this.shift%4],u[(this.shift+1)%4],u[(this.shift+2)%4],u[(this.shift+3)%4]),g=this.getMatrixCornerPoints(u);return new Be(p,g,this.compact,this.nbDataBlocks,this.nbLayers)}extractParameters(s){if(!this.isValidPoint(s[0])||!this.isValidPoint(s[1])||!this.isValidPoint(s[2])||!this.isValidPoint(s[3]))throw new K;let l=2*this.nbCenterLayers,u=new Int32Array([this.sampleLine(s[0],s[1],l),this.sampleLine(s[1],s[2],l),this.sampleLine(s[2],s[3],l),this.sampleLine(s[3],s[0],l)]);this.shift=this.getRotation(u,l);let p=0;for(let x=0;x<4;x++){let y=u[(this.shift+x)%4];this.compact?(p<<=7,p+=y>>1&127):(p<<=10,p+=(y>>2&992)+(y>>1&31))}let g=this.getCorrectedParameterData(p,this.compact);this.compact?(this.nbLayers=(g>>6)+1,this.nbDataBlocks=(g&63)+1):(this.nbLayers=(g>>11)+1,this.nbDataBlocks=(g&2047)+1)}getRotation(s,l){let u=0;s.forEach((p,g,x)=>{let y=(p>>l-2<<1)+(p&1);u=(u<<3)+y}),u=((u&1)<<11)+(u>>1);for(let p=0;p<4;p++)if(_.bitCount(u^this.EXPECTED_CORNER_BITS[p])<=2)return p;throw new K}getCorrectedParameterData(s,l){let u,p;l?(u=7,p=2):(u=10,p=4);let g=u-p,x=new Int32Array(u);for(let C=u-1;C>=0;--C)x[C]=s&15,s>>=4;try{new Ze(He.AZTEC_PARAM).decode(x,g)}catch{throw new K}let y=0;for(let C=0;C<p;C++)y=(y<<4)+x[C];return y}getBullsEyeCorners(s){let l=s,u=s,p=s,g=s,x=!0;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){let L=this.getFirstDifferent(l,x,1,-1),U=this.getFirstDifferent(u,x,1,1),J=this.getFirstDifferent(p,x,-1,1),ie=this.getFirstDifferent(g,x,-1,-1);if(this.nbCenterLayers>2){let oe=this.distancePoint(ie,L)*this.nbCenterLayers/(this.distancePoint(g,l)*(this.nbCenterLayers+2));if(oe<.75||oe>1.25||!this.isWhiteOrBlackRectangle(L,U,J,ie))break}l=L,u=U,p=J,g=ie,x=!x}if(this.nbCenterLayers!==5&&this.nbCenterLayers!==7)throw new K;this.compact=this.nbCenterLayers===5;let y=new $e(l.getX()+.5,l.getY()-.5),C=new $e(u.getX()+.5,u.getY()+.5),O=new $e(p.getX()-.5,p.getY()+.5),D=new $e(g.getX()-.5,g.getY()-.5);return this.expandSquare([y,C,O,D],2*this.nbCenterLayers-3,2*this.nbCenterLayers)}getMatrixCenter(){let s,l,u,p;try{let y=new Qe(this.image).detect();s=y[0],l=y[1],u=y[2],p=y[3]}catch{let C=this.image.getWidth()/2,O=this.image.getHeight()/2;s=this.getFirstDifferent(new $t(C+7,O-7),!1,1,-1).toResultPoint(),l=this.getFirstDifferent(new $t(C+7,O+7),!1,1,1).toResultPoint(),u=this.getFirstDifferent(new $t(C-7,O+7),!1,-1,1).toResultPoint(),p=this.getFirstDifferent(new $t(C-7,O-7),!1,-1,-1).toResultPoint()}let g=at.round((s.getX()+p.getX()+l.getX()+u.getX())/4),x=at.round((s.getY()+p.getY()+l.getY()+u.getY())/4);try{let y=new Qe(this.image,15,g,x).detect();s=y[0],l=y[1],u=y[2],p=y[3]}catch{s=this.getFirstDifferent(new $t(g+7,x-7),!1,1,-1).toResultPoint(),l=this.getFirstDifferent(new $t(g+7,x+7),!1,1,1).toResultPoint(),u=this.getFirstDifferent(new $t(g-7,x+7),!1,-1,1).toResultPoint(),p=this.getFirstDifferent(new $t(g-7,x-7),!1,-1,-1).toResultPoint()}return g=at.round((s.getX()+p.getX()+l.getX()+u.getX())/4),x=at.round((s.getY()+p.getY()+l.getY()+u.getY())/4),new $t(g,x)}getMatrixCornerPoints(s){return this.expandSquare(s,2*this.nbCenterLayers,this.getDimension())}sampleGrid(s,l,u,p,g){let x=sr.getInstance(),y=this.getDimension(),C=y/2-this.nbCenterLayers,O=y/2+this.nbCenterLayers;return x.sampleGrid(s,y,y,C,C,O,C,O,O,C,O,l.getX(),l.getY(),u.getX(),u.getY(),p.getX(),p.getY(),g.getX(),g.getY())}sampleLine(s,l,u){let p=0,g=this.distanceResultPoint(s,l),x=g/u,y=s.getX(),C=s.getY(),O=x*(l.getX()-s.getX())/g,D=x*(l.getY()-s.getY())/g;for(let L=0;L<u;L++)this.image.get(at.round(y+L*O),at.round(C+L*D))&&(p|=1<<u-L-1);return p}isWhiteOrBlackRectangle(s,l,u,p){let g=3;s=new $t(s.getX()-g,s.getY()+g),l=new $t(l.getX()-g,l.getY()-g),u=new $t(u.getX()+g,u.getY()-g),p=new $t(p.getX()+g,p.getY()+g);let x=this.getColor(p,s);if(x===0)return!1;let y=this.getColor(s,l);return y!==x||(y=this.getColor(l,u),y!==x)?!1:(y=this.getColor(u,p),y===x)}getColor(s,l){let u=this.distancePoint(s,l),p=(l.getX()-s.getX())/u,g=(l.getY()-s.getY())/u,x=0,y=s.getX(),C=s.getY(),O=this.image.get(s.getX(),s.getY()),D=Math.ceil(u);for(let U=0;U<D;U++)y+=p,C+=g,this.image.get(at.round(y),at.round(C))!==O&&x++;let L=x/u;return L>.1&&L<.9?0:L<=.1===O?1:-1}getFirstDifferent(s,l,u,p){let g=s.getX()+u,x=s.getY()+p;for(;this.isValid(g,x)&&this.image.get(g,x)===l;)g+=u,x+=p;for(g-=u,x-=p;this.isValid(g,x)&&this.image.get(g,x)===l;)g+=u;for(g-=u;this.isValid(g,x)&&this.image.get(g,x)===l;)x+=p;return x-=p,new $t(g,x)}expandSquare(s,l,u){let p=u/(2*l),g=s[0].getX()-s[2].getX(),x=s[0].getY()-s[2].getY(),y=(s[0].getX()+s[2].getX())/2,C=(s[0].getY()+s[2].getY())/2,O=new $e(y+p*g,C+p*x),D=new $e(y-p*g,C-p*x);g=s[1].getX()-s[3].getX(),x=s[1].getY()-s[3].getY(),y=(s[1].getX()+s[3].getX())/2,C=(s[1].getY()+s[3].getY())/2;let L=new $e(y+p*g,C+p*x),U=new $e(y-p*g,C-p*x);return[O,L,D,U]}isValid(s,l){return s>=0&&s<this.image.getWidth()&&l>0&&l<this.image.getHeight()}isValidPoint(s){let l=at.round(s.getX()),u=at.round(s.getY());return this.isValid(l,u)}distancePoint(s,l){return at.distance(s.getX(),s.getY(),l.getX(),l.getY())}distanceResultPoint(s,l){return at.distance(s.getX(),s.getY(),l.getX(),l.getY())}getDimension(){return this.compact?4*this.nbLayers+11:this.nbLayers<=4?4*this.nbLayers+15:4*this.nbLayers+2*(_.truncDivision(this.nbLayers-4,8)+1)+15}}class Xt{decode(s,l=null){let u=null,p=new dt(s.getBlackMatrix()),g=null,x=null;try{let D=p.detectMirror(!1);g=D.getPoints(),this.reportFoundResultPoints(l,g),x=new rt().decode(D)}catch(D){u=D}if(x==null)try{let D=p.detectMirror(!0);g=D.getPoints(),this.reportFoundResultPoints(l,g),x=new rt().decode(D)}catch(D){throw u??D}let y=new ne(x.getText(),x.getRawBytes(),x.getNumBits(),g,he.AZTEC,A.currentTimeMillis()),C=x.getByteSegments();C!=null&&y.putMetadata(De.BYTE_SEGMENTS,C);let O=x.getECLevel();return O!=null&&y.putMetadata(De.ERROR_CORRECTION_LEVEL,O),y}reportFoundResultPoints(s,l){if(s!=null){let u=s.get(R.NEED_RESULT_POINT_CALLBACK);u!=null&&l.forEach((p,g,x)=>{u.foundPossibleResultPoint(p)})}}reset(){}}class ei extends le{constructor(s=500){super(new Xt,s)}}class ht{decode(s,l){try{return this.doDecode(s,l)}catch{if(l&&l.get(R.TRY_HARDER)===!0&&s.isRotateSupported()){const g=s.rotateCounterClockwise(),x=this.doDecode(g,l),y=x.getResultMetadata();let C=270;y!==null&&y.get(De.ORIENTATION)===!0&&(C=C+y.get(De.ORIENTATION)%360),x.putMetadata(De.ORIENTATION,C);const O=x.getResultPoints();if(O!==null){const D=g.getHeight();for(let L=0;L<O.length;L++)O[L]=new $e(D-O[L].getY()-1,O[L].getX())}return x}else throw new K}}reset(){}doDecode(s,l){const u=s.getWidth(),p=s.getHeight();let g=new N(u);const x=l&&l.get(R.TRY_HARDER)===!0,y=Math.max(1,p>>(x?8:5));let C;x?C=p:C=15;const O=Math.trunc(p/2);for(let D=0;D<C;D++){const L=Math.trunc((D+1)/2),U=(D&1)===0,J=O+y*(U?L:-L);if(J<0||J>=p)break;try{g=s.getBlackRow(J,g)}catch{continue}for(let ie=0;ie<2;ie++){if(ie===1&&(g.reverse(),l&&l.get(R.NEED_RESULT_POINT_CALLBACK)===!0)){const oe=new Map;l.forEach((me,_e)=>oe.set(_e,me)),oe.delete(R.NEED_RESULT_POINT_CALLBACK),l=oe}try{const oe=this.decodeRow(J,g,l);if(ie===1){oe.putMetadata(De.ORIENTATION,180);const me=oe.getResultPoints();me!==null&&(me[0]=new $e(u-me[0].getX()-1,me[0].getY()),me[1]=new $e(u-me[1].getX()-1,me[1].getY()))}return oe}catch{}}}throw new K}static recordPattern(s,l,u){const p=u.length;for(let O=0;O<p;O++)u[O]=0;const g=s.getSize();if(l>=g)throw new K;let x=!s.get(l),y=0,C=l;for(;C<g;){if(s.get(C)!==x)u[y]++;else{if(++y===p)break;u[y]=1,x=!x}C++}if(!(y===p||y===p-1&&C===g))throw new K}static recordPatternInReverse(s,l,u){let p=u.length,g=s.get(l);for(;l>0&&p>=0;)s.get(--l)!==g&&(p--,g=!g);if(p>=0)throw new K;ht.recordPattern(s,l+1,u)}static patternMatchVariance(s,l,u){const p=s.length;let g=0,x=0;for(let O=0;O<p;O++)g+=s[O],x+=l[O];if(g<x)return Number.POSITIVE_INFINITY;const y=g/x;u*=y;let C=0;for(let O=0;O<p;O++){const D=s[O],L=l[O]*y,U=D>L?D-L:L-D;if(U>u)return Number.POSITIVE_INFINITY;C+=U}return C/g}}class We extends ht{static findStartPattern(s){const l=s.getSize(),u=s.getNextSet(0);let p=0,g=Int32Array.from([0,0,0,0,0,0]),x=u,y=!1;const C=6;for(let O=u;O<l;O++)if(s.get(O)!==y)g[p]++;else{if(p===C-1){let D=We.MAX_AVG_VARIANCE,L=-1;for(let U=We.CODE_START_A;U<=We.CODE_START_C;U++){const J=ht.patternMatchVariance(g,We.CODE_PATTERNS[U],We.MAX_INDIVIDUAL_VARIANCE);J<D&&(D=J,L=U)}if(L>=0&&s.isRange(Math.max(0,x-(O-x)/2),x,!1))return Int32Array.from([x,O,L]);x+=g[0]+g[1],g=g.slice(2,g.length-1),g[p-1]=0,g[p]=0,p--}else p++;g[p]=1,y=!y}throw new K}static decodeCode(s,l,u){ht.recordPattern(s,u,l);let p=We.MAX_AVG_VARIANCE,g=-1;for(let x=0;x<We.CODE_PATTERNS.length;x++){const y=We.CODE_PATTERNS[x],C=this.patternMatchVariance(l,y,We.MAX_INDIVIDUAL_VARIANCE);C<p&&(p=C,g=x)}if(g>=0)return g;throw new K}decodeRow(s,l,u){const p=u&&u.get(R.ASSUME_GS1)===!0,g=We.findStartPattern(l),x=g[2];let y=0;const C=new Uint8Array(20);C[y++]=x;let O;switch(x){case We.CODE_START_A:O=We.CODE_CODE_A;break;case We.CODE_START_B:O=We.CODE_CODE_B;break;case We.CODE_START_C:O=We.CODE_CODE_C;break;default:throw new P}let D=!1,L=!1,U="",J=g[0],ie=g[1];const oe=Int32Array.from([0,0,0,0,0,0]);let me=0,_e=0,Le=x,Ue=0,Pe=!0,At=!1,ut=!1;for(;!D;){const Ul=L;switch(L=!1,me=_e,_e=We.decodeCode(l,oe,ie),C[y++]=_e,_e!==We.CODE_STOP&&(Pe=!0),_e!==We.CODE_STOP&&(Ue++,Le+=Ue*_e),J=ie,ie+=oe.reduce((oD,lD)=>oD+lD,0),_e){case We.CODE_START_A:case We.CODE_START_B:case We.CODE_START_C:throw new P}switch(O){case We.CODE_CODE_A:if(_e<64)ut===At?U+=String.fromCharCode(32+_e):U+=String.fromCharCode(32+_e+128),ut=!1;else if(_e<96)ut===At?U+=String.fromCharCode(_e-64):U+=String.fromCharCode(_e+64),ut=!1;else switch(_e!==We.CODE_STOP&&(Pe=!1),_e){case We.CODE_FNC_1:p&&(U.length===0?U+="]C1":U+="");break;case We.CODE_FNC_2:case We.CODE_FNC_3:break;case We.CODE_FNC_4_A:!At&&ut?(At=!0,ut=!1):At&&ut?(At=!1,ut=!1):ut=!0;break;case We.CODE_SHIFT:L=!0,O=We.CODE_CODE_B;break;case We.CODE_CODE_B:O=We.CODE_CODE_B;break;case We.CODE_CODE_C:O=We.CODE_CODE_C;break;case We.CODE_STOP:D=!0;break}break;case We.CODE_CODE_B:if(_e<96)ut===At?U+=String.fromCharCode(32+_e):U+=String.fromCharCode(32+_e+128),ut=!1;else switch(_e!==We.CODE_STOP&&(Pe=!1),_e){case We.CODE_FNC_1:p&&(U.length===0?U+="]C1":U+="");break;case We.CODE_FNC_2:case We.CODE_FNC_3:break;case We.CODE_FNC_4_B:!At&&ut?(At=!0,ut=!1):At&&ut?(At=!1,ut=!1):ut=!0;break;case We.CODE_SHIFT:L=!0,O=We.CODE_CODE_A;break;case We.CODE_CODE_A:O=We.CODE_CODE_A;break;case We.CODE_CODE_C:O=We.CODE_CODE_C;break;case We.CODE_STOP:D=!0;break}break;case We.CODE_CODE_C:if(_e<100)_e<10&&(U+="0"),U+=_e;else switch(_e!==We.CODE_STOP&&(Pe=!1),_e){case We.CODE_FNC_1:p&&(U.length===0?U+="]C1":U+="");break;case We.CODE_CODE_A:O=We.CODE_CODE_A;break;case We.CODE_CODE_B:O=We.CODE_CODE_B;break;case We.CODE_STOP:D=!0;break}break}Ul&&(O=O===We.CODE_CODE_A?We.CODE_CODE_B:We.CODE_CODE_A)}const ri=ie-J;if(ie=l.getNextUnset(ie),!l.isRange(ie,Math.min(l.getSize(),ie+(ie-J)/2),!1))throw new K;if(Le-=Ue*me,Le%103!==me)throw new w;const sa=U.length;if(sa===0)throw new K;sa>0&&Pe&&(O===We.CODE_CODE_C?U=U.substring(0,sa-2):U=U.substring(0,sa-1));const ni=(g[1]+g[0])/2,Vt=J+ri/2,gn=C.length,xi=new Uint8Array(gn);for(let Ul=0;Ul<gn;Ul++)xi[Ul]=C[Ul];const jl=[new $e(ni,s),new $e(Vt,s)];return new ne(U,xi,0,jl,he.CODE_128,new Date().getTime())}}We.CODE_PATTERNS=[Int32Array.from([2,1,2,2,2,2]),Int32Array.from([2,2,2,1,2,2]),Int32Array.from([2,2,2,2,2,1]),Int32Array.from([1,2,1,2,2,3]),Int32Array.from([1,2,1,3,2,2]),Int32Array.from([1,3,1,2,2,2]),Int32Array.from([1,2,2,2,1,3]),Int32Array.from([1,2,2,3,1,2]),Int32Array.from([1,3,2,2,1,2]),Int32Array.from([2,2,1,2,1,3]),Int32Array.from([2,2,1,3,1,2]),Int32Array.from([2,3,1,2,1,2]),Int32Array.from([1,1,2,2,3,2]),Int32Array.from([1,2,2,1,3,2]),Int32Array.from([1,2,2,2,3,1]),Int32Array.from([1,1,3,2,2,2]),Int32Array.from([1,2,3,1,2,2]),Int32Array.from([1,2,3,2,2,1]),Int32Array.from([2,2,3,2,1,1]),Int32Array.from([2,2,1,1,3,2]),Int32Array.from([2,2,1,2,3,1]),Int32Array.from([2,1,3,2,1,2]),Int32Array.from([2,2,3,1,1,2]),Int32Array.from([3,1,2,1,3,1]),Int32Array.from([3,1,1,2,2,2]),Int32Array.from([3,2,1,1,2,2]),Int32Array.from([3,2,1,2,2,1]),Int32Array.from([3,1,2,2,1,2]),Int32Array.from([3,2,2,1,1,2]),Int32Array.from([3,2,2,2,1,1]),Int32Array.from([2,1,2,1,2,3]),Int32Array.from([2,1,2,3,2,1]),Int32Array.from([2,3,2,1,2,1]),Int32Array.from([1,1,1,3,2,3]),Int32Array.from([1,3,1,1,2,3]),Int32Array.from([1,3,1,3,2,1]),Int32Array.from([1,1,2,3,1,3]),Int32Array.from([1,3,2,1,1,3]),Int32Array.from([1,3,2,3,1,1]),Int32Array.from([2,1,1,3,1,3]),Int32Array.from([2,3,1,1,1,3]),Int32Array.from([2,3,1,3,1,1]),Int32Array.from([1,1,2,1,3,3]),Int32Array.from([1,1,2,3,3,1]),Int32Array.from([1,3,2,1,3,1]),Int32Array.from([1,1,3,1,2,3]),Int32Array.from([1,1,3,3,2,1]),Int32Array.from([1,3,3,1,2,1]),Int32Array.from([3,1,3,1,2,1]),Int32Array.from([2,1,1,3,3,1]),Int32Array.from([2,3,1,1,3,1]),Int32Array.from([2,1,3,1,1,3]),Int32Array.from([2,1,3,3,1,1]),Int32Array.from([2,1,3,1,3,1]),Int32Array.from([3,1,1,1,2,3]),Int32Array.from([3,1,1,3,2,1]),Int32Array.from([3,3,1,1,2,1]),Int32Array.from([3,1,2,1,1,3]),Int32Array.from([3,1,2,3,1,1]),Int32Array.from([3,3,2,1,1,1]),Int32Array.from([3,1,4,1,1,1]),Int32Array.from([2,2,1,4,1,1]),Int32Array.from([4,3,1,1,1,1]),Int32Array.from([1,1,1,2,2,4]),Int32Array.from([1,1,1,4,2,2]),Int32Array.from([1,2,1,1,2,4]),Int32Array.from([1,2,1,4,2,1]),Int32Array.from([1,4,1,1,2,2]),Int32Array.from([1,4,1,2,2,1]),Int32Array.from([1,1,2,2,1,4]),Int32Array.from([1,1,2,4,1,2]),Int32Array.from([1,2,2,1,1,4]),Int32Array.from([1,2,2,4,1,1]),Int32Array.from([1,4,2,1,1,2]),Int32Array.from([1,4,2,2,1,1]),Int32Array.from([2,4,1,2,1,1]),Int32Array.from([2,2,1,1,1,4]),Int32Array.from([4,1,3,1,1,1]),Int32Array.from([2,4,1,1,1,2]),Int32Array.from([1,3,4,1,1,1]),Int32Array.from([1,1,1,2,4,2]),Int32Array.from([1,2,1,1,4,2]),Int32Array.from([1,2,1,2,4,1]),Int32Array.from([1,1,4,2,1,2]),Int32Array.from([1,2,4,1,1,2]),Int32Array.from([1,2,4,2,1,1]),Int32Array.from([4,1,1,2,1,2]),Int32Array.from([4,2,1,1,1,2]),Int32Array.from([4,2,1,2,1,1]),Int32Array.from([2,1,2,1,4,1]),Int32Array.from([2,1,4,1,2,1]),Int32Array.from([4,1,2,1,2,1]),Int32Array.from([1,1,1,1,4,3]),Int32Array.from([1,1,1,3,4,1]),Int32Array.from([1,3,1,1,4,1]),Int32Array.from([1,1,4,1,1,3]),Int32Array.from([1,1,4,3,1,1]),Int32Array.from([4,1,1,1,1,3]),Int32Array.from([4,1,1,3,1,1]),Int32Array.from([1,1,3,1,4,1]),Int32Array.from([1,1,4,1,3,1]),Int32Array.from([3,1,1,1,4,1]),Int32Array.from([4,1,1,1,3,1]),Int32Array.from([2,1,1,4,1,2]),Int32Array.from([2,1,1,2,1,4]),Int32Array.from([2,1,1,2,3,2]),Int32Array.from([2,3,3,1,1,1,2])],We.MAX_AVG_VARIANCE=.25,We.MAX_INDIVIDUAL_VARIANCE=.7,We.CODE_SHIFT=98,We.CODE_CODE_C=99,We.CODE_CODE_B=100,We.CODE_CODE_A=101,We.CODE_FNC_1=102,We.CODE_FNC_2=97,We.CODE_FNC_3=96,We.CODE_FNC_4_A=101,We.CODE_FNC_4_B=100,We.CODE_START_A=103,We.CODE_START_B=104,We.CODE_START_C=105,We.CODE_STOP=106;class vr extends ht{constructor(s=!1,l=!1){super(),this.usingCheckDigit=s,this.extendedMode=l,this.decodeRowResult="",this.counters=new Int32Array(9)}decodeRow(s,l,u){let p=this.counters;p.fill(0),this.decodeRowResult="";let g=vr.findAsteriskPattern(l,p),x=l.getNextSet(g[1]),y=l.getSize(),C,O;do{vr.recordPattern(l,x,p);let oe=vr.toNarrowWidePattern(p);if(oe<0)throw new K;C=vr.patternToChar(oe),this.decodeRowResult+=C,O=x;for(let me of p)x+=me;x=l.getNextSet(x)}while(C!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);let D=0;for(let oe of p)D+=oe;let L=x-O-D;if(x!==y&&L*2<D)throw new K;if(this.usingCheckDigit){let oe=this.decodeRowResult.length-1,me=0;for(let _e=0;_e<oe;_e++)me+=vr.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(_e));if(this.decodeRowResult.charAt(oe)!==vr.ALPHABET_STRING.charAt(me%43))throw new w;this.decodeRowResult=this.decodeRowResult.substring(0,oe)}if(this.decodeRowResult.length===0)throw new K;let U;this.extendedMode?U=vr.decodeExtended(this.decodeRowResult):U=this.decodeRowResult;let J=(g[1]+g[0])/2,ie=O+D/2;return new ne(U,null,0,[new $e(J,s),new $e(ie,s)],he.CODE_39,new Date().getTime())}static findAsteriskPattern(s,l){let u=s.getSize(),p=s.getNextSet(0),g=0,x=p,y=!1,C=l.length;for(let O=p;O<u;O++)if(s.get(O)!==y)l[g]++;else{if(g===C-1){if(this.toNarrowWidePattern(l)===vr.ASTERISK_ENCODING&&s.isRange(Math.max(0,x-Math.floor((O-x)/2)),x,!1))return[x,O];x+=l[0]+l[1],l.copyWithin(0,2,2+g-1),l[g-1]=0,l[g]=0,g--}else g++;l[g]=1,y=!y}throw new K}static toNarrowWidePattern(s){let l=s.length,u=0,p;do{let g=2147483647;for(let C of s)C<g&&C>u&&(g=C);u=g,p=0;let x=0,y=0;for(let C=0;C<l;C++){let O=s[C];O>u&&(y|=1<<l-1-C,p++,x+=O)}if(p===3){for(let C=0;C<l&&p>0;C++){let O=s[C];if(O>u&&(p--,O*2>=x))return-1}return y}}while(p>3);return-1}static patternToChar(s){for(let l=0;l<vr.CHARACTER_ENCODINGS.length;l++)if(vr.CHARACTER_ENCODINGS[l]===s)return vr.ALPHABET_STRING.charAt(l);if(s===vr.ASTERISK_ENCODING)return"*";throw new K}static decodeExtended(s){let l=s.length,u="";for(let p=0;p<l;p++){let g=s.charAt(p);if(g==="+"||g==="$"||g==="%"||g==="/"){let x=s.charAt(p+1),y="\0";switch(g){case"+":if(x>="A"&&x<="Z")y=String.fromCharCode(x.charCodeAt(0)+32);else throw new P;break;case"$":if(x>="A"&&x<="Z")y=String.fromCharCode(x.charCodeAt(0)-64);else throw new P;break;case"%":if(x>="A"&&x<="E")y=String.fromCharCode(x.charCodeAt(0)-38);else if(x>="F"&&x<="J")y=String.fromCharCode(x.charCodeAt(0)-11);else if(x>="K"&&x<="O")y=String.fromCharCode(x.charCodeAt(0)+16);else if(x>="P"&&x<="T")y=String.fromCharCode(x.charCodeAt(0)+43);else if(x==="U")y="\0";else if(x==="V")y="@";else if(x==="W")y="`";else if(x==="X"||x==="Y"||x==="Z")y="";else throw new P;break;case"/":if(x>="A"&&x<="O")y=String.fromCharCode(x.charCodeAt(0)-32);else if(x==="Z")y=":";else throw new P;break}u+=y,p++}else u+=g}return u}}vr.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%",vr.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42],vr.ASTERISK_ENCODING=148;class Mt extends ht{constructor(){super(...arguments),this.narrowLineWidth=-1}decodeRow(s,l,u){let p=this.decodeStart(l),g=this.decodeEnd(l),x=new de;Mt.decodeMiddle(l,p[1],g[0],x);let y=x.toString(),C=null;u!=null&&(C=u.get(R.ALLOWED_LENGTHS)),C==null&&(C=Mt.DEFAULT_ALLOWED_LENGTHS);let O=y.length,D=!1,L=0;for(let ie of C){if(O===ie){D=!0;break}ie>L&&(L=ie)}if(!D&&O>L&&(D=!0),!D)throw new P;const U=[new $e(p[1],s),new $e(g[0],s)];return new ne(y,null,0,U,he.ITF,new Date().getTime())}static decodeMiddle(s,l,u,p){let g=new Int32Array(10),x=new Int32Array(5),y=new Int32Array(5);for(g.fill(0),x.fill(0),y.fill(0);l<u;){ht.recordPattern(s,l,g);for(let O=0;O<5;O++){let D=2*O;x[O]=g[D],y[O]=g[D+1]}let C=Mt.decodeDigit(x);p.append(C.toString()),C=this.decodeDigit(y),p.append(C.toString()),g.forEach(function(O){l+=O})}}decodeStart(s){let l=Mt.skipWhiteSpace(s),u=Mt.findGuardPattern(s,l,Mt.START_PATTERN);return this.narrowLineWidth=(u[1]-u[0])/4,this.validateQuietZone(s,u[0]),u}validateQuietZone(s,l){let u=this.narrowLineWidth*10;u=u<l?u:l;for(let p=l-1;u>0&&p>=0&&!s.get(p);p--)u--;if(u!==0)throw new K}static skipWhiteSpace(s){const l=s.getSize(),u=s.getNextSet(0);if(u===l)throw new K;return u}decodeEnd(s){s.reverse();try{let l=Mt.skipWhiteSpace(s),u;try{u=Mt.findGuardPattern(s,l,Mt.END_PATTERN_REVERSED[0])}catch(g){g instanceof K&&(u=Mt.findGuardPattern(s,l,Mt.END_PATTERN_REVERSED[1]))}this.validateQuietZone(s,u[0]);let p=u[0];return u[0]=s.getSize()-u[1],u[1]=s.getSize()-p,u}finally{s.reverse()}}static findGuardPattern(s,l,u){let p=u.length,g=new Int32Array(p),x=s.getSize(),y=!1,C=0,O=l;g.fill(0);for(let D=l;D<x;D++)if(s.get(D)!==y)g[C]++;else{if(C===p-1){if(ht.patternMatchVariance(g,u,Mt.MAX_INDIVIDUAL_VARIANCE)<Mt.MAX_AVG_VARIANCE)return[O,D];O+=g[0]+g[1],A.arraycopy(g,2,g,0,C-1),g[C-1]=0,g[C]=0,C--}else C++;g[C]=1,y=!y}throw new K}static decodeDigit(s){let l=Mt.MAX_AVG_VARIANCE,u=-1,p=Mt.PATTERNS.length;for(let g=0;g<p;g++){let x=Mt.PATTERNS[g],y=ht.patternMatchVariance(s,x,Mt.MAX_INDIVIDUAL_VARIANCE);y<l?(l=y,u=g):y===l&&(u=-1)}if(u>=0)return u%10;throw new K}}Mt.PATTERNS=[Int32Array.from([1,1,2,2,1]),Int32Array.from([2,1,1,1,2]),Int32Array.from([1,2,1,1,2]),Int32Array.from([2,2,1,1,1]),Int32Array.from([1,1,2,1,2]),Int32Array.from([2,1,2,1,1]),Int32Array.from([1,2,2,1,1]),Int32Array.from([1,1,1,2,2]),Int32Array.from([2,1,1,2,1]),Int32Array.from([1,2,1,2,1]),Int32Array.from([1,1,3,3,1]),Int32Array.from([3,1,1,1,3]),Int32Array.from([1,3,1,1,3]),Int32Array.from([3,3,1,1,1]),Int32Array.from([1,1,3,1,3]),Int32Array.from([3,1,3,1,1]),Int32Array.from([1,3,3,1,1]),Int32Array.from([1,1,1,3,3]),Int32Array.from([3,1,1,3,1]),Int32Array.from([1,3,1,3,1])],Mt.MAX_AVG_VARIANCE=.38,Mt.MAX_INDIVIDUAL_VARIANCE=.5,Mt.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],Mt.START_PATTERN=Int32Array.from([1,1,1,1]),Mt.END_PATTERN_REVERSED=[Int32Array.from([1,1,2]),Int32Array.from([1,1,3])];class or extends ht{constructor(){super(...arguments),this.decodeRowStringBuffer=""}static findStartGuardPattern(s){let l=!1,u,p=0,g=Int32Array.from([0,0,0]);for(;!l;){g=Int32Array.from([0,0,0]),u=or.findGuardPattern(s,p,!1,this.START_END_PATTERN,g);let x=u[0];p=u[1];let y=x-(p-x);y>=0&&(l=s.isRange(y,x,!1))}return u}static checkChecksum(s){return or.checkStandardUPCEANChecksum(s)}static checkStandardUPCEANChecksum(s){let l=s.length;if(l===0)return!1;let u=parseInt(s.charAt(l-1),10);return or.getStandardUPCEANChecksum(s.substring(0,l-1))===u}static getStandardUPCEANChecksum(s){let l=s.length,u=0;for(let p=l-1;p>=0;p-=2){let g=s.charAt(p).charCodeAt(0)-48;if(g<0||g>9)throw new P;u+=g}u*=3;for(let p=l-2;p>=0;p-=2){let g=s.charAt(p).charCodeAt(0)-48;if(g<0||g>9)throw new P;u+=g}return(1e3-u)%10}static decodeEnd(s,l){return or.findGuardPattern(s,l,!1,or.START_END_PATTERN,new Int32Array(or.START_END_PATTERN.length).fill(0))}static findGuardPatternWithoutCounters(s,l,u,p){return this.findGuardPattern(s,l,u,p,new Int32Array(p.length))}static findGuardPattern(s,l,u,p,g){let x=s.getSize();l=u?s.getNextUnset(l):s.getNextSet(l);let y=0,C=l,O=p.length,D=u;for(let L=l;L<x;L++)if(s.get(L)!==D)g[y]++;else{if(y===O-1){if(ht.patternMatchVariance(g,p,or.MAX_INDIVIDUAL_VARIANCE)<or.MAX_AVG_VARIANCE)return Int32Array.from([C,L]);C+=g[0]+g[1];let U=g.slice(2,g.length-1);for(let J=0;J<y-1;J++)g[J]=U[J];g[y-1]=0,g[y]=0,y--}else y++;g[y]=1,D=!D}throw new K}static decodeDigit(s,l,u,p){this.recordPattern(s,u,l);let g=this.MAX_AVG_VARIANCE,x=-1,y=p.length;for(let C=0;C<y;C++){let O=p[C],D=ht.patternMatchVariance(l,O,or.MAX_INDIVIDUAL_VARIANCE);D<g&&(g=D,x=C)}if(x>=0)return x;throw new K}}or.MAX_AVG_VARIANCE=.48,or.MAX_INDIVIDUAL_VARIANCE=.7,or.START_END_PATTERN=Int32Array.from([1,1,1]),or.MIDDLE_PATTERN=Int32Array.from([1,1,1,1,1]),or.END_PATTERN=Int32Array.from([1,1,1,1,1,1]),or.L_PATTERNS=[Int32Array.from([3,2,1,1]),Int32Array.from([2,2,2,1]),Int32Array.from([2,1,2,2]),Int32Array.from([1,4,1,1]),Int32Array.from([1,1,3,2]),Int32Array.from([1,2,3,1]),Int32Array.from([1,1,1,4]),Int32Array.from([1,3,1,2]),Int32Array.from([1,2,1,3]),Int32Array.from([3,1,1,2])];class Ls{constructor(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5],this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(s,l,u){let p=this.decodeRowStringBuffer,g=this.decodeMiddle(l,u,p),x=p.toString(),y=Ls.parseExtensionString(x),C=[new $e((u[0]+u[1])/2,s),new $e(g,s)],O=new ne(x,null,0,C,he.UPC_EAN_EXTENSION,new Date().getTime());return y!=null&&O.putAllMetadata(y),O}decodeMiddle(s,l,u){let p=this.decodeMiddleCounters;p[0]=0,p[1]=0,p[2]=0,p[3]=0;let g=s.getSize(),x=l[1],y=0;for(let O=0;O<5&&x<g;O++){let D=or.decodeDigit(s,p,x,or.L_AND_G_PATTERNS);u+=String.fromCharCode(48+D%10);for(let L of p)x+=L;D>=10&&(y|=1<<4-O),O!==4&&(x=s.getNextSet(x),x=s.getNextUnset(x))}if(u.length!==5)throw new K;let C=this.determineCheckDigit(y);if(Ls.extensionChecksum(u.toString())!==C)throw new K;return x}static extensionChecksum(s){let l=s.length,u=0;for(let p=l-2;p>=0;p-=2)u+=s.charAt(p).charCodeAt(0)-48;u*=3;for(let p=l-1;p>=0;p-=2)u+=s.charAt(p).charCodeAt(0)-48;return u*=3,u%10}determineCheckDigit(s){for(let l=0;l<10;l++)if(s===this.CHECK_DIGIT_ENCODINGS[l])return l;throw new K}static parseExtensionString(s){if(s.length!==5)return null;let l=Ls.parseExtension5String(s);return l==null?null:new Map([[De.SUGGESTED_PRICE,l]])}static parseExtension5String(s){let l;switch(s.charAt(0)){case"0":l="";break;case"5":l="$";break;case"9":switch(s){case"90000":return null;case"99991":return"0.00";case"99990":return"Used"}l="";break;default:l="";break}let u=parseInt(s.substring(1)),p=(u/100).toString(),g=u%100,x=g<10?"0"+g:g.toString();return l+p+"."+x}}class Rl{constructor(){this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(s,l,u){let p=this.decodeRowStringBuffer,g=this.decodeMiddle(l,u,p),x=p.toString(),y=Rl.parseExtensionString(x),C=[new $e((u[0]+u[1])/2,s),new $e(g,s)],O=new ne(x,null,0,C,he.UPC_EAN_EXTENSION,new Date().getTime());return y!=null&&O.putAllMetadata(y),O}decodeMiddle(s,l,u){let p=this.decodeMiddleCounters;p[0]=0,p[1]=0,p[2]=0,p[3]=0;let g=s.getSize(),x=l[1],y=0;for(let C=0;C<2&&x<g;C++){let O=or.decodeDigit(s,p,x,or.L_AND_G_PATTERNS);u+=String.fromCharCode(48+O%10);for(let D of p)x+=D;O>=10&&(y|=1<<1-C),C!==1&&(x=s.getNextSet(x),x=s.getNextUnset(x))}if(u.length!==2)throw new K;if(parseInt(u.toString())%4!==y)throw new K;return x}static parseExtensionString(s){return s.length!==2?null:new Map([[De.ISSUE_NUMBER,parseInt(s)]])}}class au{static decodeRow(s,l,u){let p=or.findGuardPattern(l,u,!1,this.EXTENSION_START_PATTERN,new Int32Array(this.EXTENSION_START_PATTERN.length).fill(0));try{return new Ls().decodeRow(s,l,p)}catch{return new Rl().decodeRow(s,l,p)}}}au.EXTENSION_START_PATTERN=Int32Array.from([1,1,2]);class Ot extends or{constructor(){super(),this.decodeRowStringBuffer="",Ot.L_AND_G_PATTERNS=Ot.L_PATTERNS.map(s=>Int32Array.from(s));for(let s=10;s<20;s++){let l=Ot.L_PATTERNS[s-10],u=new Int32Array(l.length);for(let p=0;p<l.length;p++)u[p]=l[l.length-p-1];Ot.L_AND_G_PATTERNS[s]=u}}decodeRow(s,l,u){let p=Ot.findStartGuardPattern(l),g=u==null?null:u.get(R.NEED_RESULT_POINT_CALLBACK);if(g!=null){const Pe=new $e((p[0]+p[1])/2,s);g.foundPossibleResultPoint(Pe)}let x=this.decodeMiddle(l,p,this.decodeRowStringBuffer),y=x.rowOffset,C=x.resultString;if(g!=null){const Pe=new $e(y,s);g.foundPossibleResultPoint(Pe)}let O=this.decodeEnd(l,y);if(g!=null){const Pe=new $e((O[0]+O[1])/2,s);g.foundPossibleResultPoint(Pe)}let D=O[1],L=D+(D-O[0]);if(L>=l.getSize()||!l.isRange(D,L,!1))throw new K;let U=C.toString();if(U.length<8)throw new P;if(!Ot.checkChecksum(U))throw new w;let J=(p[1]+p[0])/2,ie=(O[1]+O[0])/2,oe=this.getBarcodeFormat(),me=[new $e(J,s),new $e(ie,s)],_e=new ne(U,null,0,me,oe,new Date().getTime()),Le=0;try{let Pe=au.decodeRow(s,l,O[1]);_e.putMetadata(De.UPC_EAN_EXTENSION,Pe.getText()),_e.putAllMetadata(Pe.getResultMetadata()),_e.addResultPoints(Pe.getResultPoints()),Le=Pe.getText().length}catch{}let Ue=u==null?null:u.get(R.ALLOWED_EAN_EXTENSIONS);if(Ue!=null){let Pe=!1;for(let At in Ue)if(Le.toString()===At){Pe=!0;break}if(!Pe)throw new K}return _e}decodeEnd(s,l){return Ot.findGuardPattern(s,l,!1,Ot.START_END_PATTERN,new Int32Array(Ot.START_END_PATTERN.length).fill(0))}static checkChecksum(s){return Ot.checkStandardUPCEANChecksum(s)}static checkStandardUPCEANChecksum(s){let l=s.length;if(l===0)return!1;let u=parseInt(s.charAt(l-1),10);return Ot.getStandardUPCEANChecksum(s.substring(0,l-1))===u}static getStandardUPCEANChecksum(s){let l=s.length,u=0;for(let p=l-1;p>=0;p-=2){let g=s.charAt(p).charCodeAt(0)-48;if(g<0||g>9)throw new P;u+=g}u*=3;for(let p=l-2;p>=0;p-=2){let g=s.charAt(p).charCodeAt(0)-48;if(g<0||g>9)throw new P;u+=g}return(1e3-u)%10}}class qa extends Ot{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(s,l,u){let p=this.decodeMiddleCounters;p[0]=0,p[1]=0,p[2]=0,p[3]=0;let g=s.getSize(),x=l[1],y=0;for(let O=0;O<6&&x<g;O++){let D=Ot.decodeDigit(s,p,x,Ot.L_AND_G_PATTERNS);u+=String.fromCharCode(48+D%10);for(let L of p)x+=L;D>=10&&(y|=1<<5-O)}u=qa.determineFirstDigit(u,y),x=Ot.findGuardPattern(s,x,!0,Ot.MIDDLE_PATTERN,new Int32Array(Ot.MIDDLE_PATTERN.length).fill(0))[1];for(let O=0;O<6&&x<g;O++){let D=Ot.decodeDigit(s,p,x,Ot.L_PATTERNS);u+=String.fromCharCode(48+D);for(let L of p)x+=L}return{rowOffset:x,resultString:u}}getBarcodeFormat(){return he.EAN_13}static determineFirstDigit(s,l){for(let u=0;u<10;u++)if(l===this.FIRST_DIGIT_ENCODINGS[u])return s=String.fromCharCode(48+u)+s,s;throw new K}}qa.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26];class Io extends Ot{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(s,l,u){const p=this.decodeMiddleCounters;p[0]=0,p[1]=0,p[2]=0,p[3]=0;let g=s.getSize(),x=l[1];for(let C=0;C<4&&x<g;C++){let O=Ot.decodeDigit(s,p,x,Ot.L_PATTERNS);u+=String.fromCharCode(48+O);for(let D of p)x+=D}x=Ot.findGuardPattern(s,x,!0,Ot.MIDDLE_PATTERN,new Int32Array(Ot.MIDDLE_PATTERN.length).fill(0))[1];for(let C=0;C<4&&x<g;C++){let O=Ot.decodeDigit(s,p,x,Ot.L_PATTERNS);u+=String.fromCharCode(48+O);for(let D of p)x+=D}return{rowOffset:x,resultString:u}}getBarcodeFormat(){return he.EAN_8}}class Rf extends Ot{constructor(){super(...arguments),this.ean13Reader=new qa}getBarcodeFormat(){return he.UPC_A}decode(s,l){return this.maybeReturnResult(this.ean13Reader.decode(s))}decodeRow(s,l,u){return this.maybeReturnResult(this.ean13Reader.decodeRow(s,l,u))}decodeMiddle(s,l,u){return this.ean13Reader.decodeMiddle(s,l,u)}maybeReturnResult(s){let l=s.getText();if(l.charAt(0)==="0"){let u=new ne(l.substring(1),null,null,s.getResultPoints(),he.UPC_A);return s.getResultMetadata()!=null&&u.putAllMetadata(s.getResultMetadata()),u}else throw new K}reset(){this.ean13Reader.reset()}}class gi extends Ot{constructor(){super(),this.decodeMiddleCounters=new Int32Array(4)}decodeMiddle(s,l,u){const p=this.decodeMiddleCounters.map(O=>O);p[0]=0,p[1]=0,p[2]=0,p[3]=0;const g=s.getSize();let x=l[1],y=0;for(let O=0;O<6&&x<g;O++){const D=gi.decodeDigit(s,p,x,gi.L_AND_G_PATTERNS);u+=String.fromCharCode(48+D%10);for(let L of p)x+=L;D>=10&&(y|=1<<5-O)}let C=gi.determineNumSysAndCheckDigit(u,y);return{rowOffset:x,resultString:C}}decodeEnd(s,l){return gi.findGuardPatternWithoutCounters(s,l,!0,gi.MIDDLE_END_PATTERN)}checkChecksum(s){return Ot.checkChecksum(gi.convertUPCEtoUPCA(s))}static determineNumSysAndCheckDigit(s,l){for(let u=0;u<=1;u++)for(let p=0;p<10;p++)if(l===this.NUMSYS_AND_CHECK_DIGIT_PATTERNS[u][p]){let g=String.fromCharCode(48+u),x=String.fromCharCode(48+p);return g+s+x}throw K.getNotFoundInstance()}getBarcodeFormat(){return he.UPC_E}static convertUPCEtoUPCA(s){const l=s.slice(1,7).split("").map(g=>g.charCodeAt(0)),u=new de;u.append(s.charAt(0));let p=l[5];switch(p){case 0:case 1:case 2:u.appendChars(l,0,2),u.append(p),u.append("0000"),u.appendChars(l,2,3);break;case 3:u.appendChars(l,0,3),u.append("00000"),u.appendChars(l,3,2);break;case 4:u.appendChars(l,0,4),u.append("00000"),u.append(l[4]);break;default:u.appendChars(l,0,5),u.append("0000"),u.append(p);break}return s.length>=8&&u.append(s.charAt(7)),u.toString()}}gi.MIDDLE_END_PATTERN=Int32Array.from([1,1,1,1,1,1]),gi.NUMSYS_AND_CHECK_DIGIT_PATTERNS=[Int32Array.from([56,52,50,49,44,38,35,42,41,37]),Int32Array.from([7,11,13,14,19,25,28,21,22,26])];class su extends ht{constructor(s){super();let l=s==null?null:s.get(R.POSSIBLE_FORMATS),u=[];n(l)?(u.push(new qa),u.push(new Rf),u.push(new Io),u.push(new gi)):(l.indexOf(he.EAN_13)>-1&&u.push(new qa),l.indexOf(he.UPC_A)>-1&&u.push(new Rf),l.indexOf(he.EAN_8)>-1&&u.push(new Io),l.indexOf(he.UPC_E)>-1&&u.push(new gi)),this.readers=u}decodeRow(s,l,u){for(let p of this.readers)try{const g=p.decodeRow(s,l,u),x=g.getBarcodeFormat()===he.EAN_13&&g.getText().charAt(0)==="0",y=u==null?null:u.get(R.POSSIBLE_FORMATS),C=y==null||y.includes(he.UPC_A);if(x&&C){const O=g.getRawBytes(),D=new ne(g.getText().substring(1),O,O?O.length:null,g.getResultPoints(),he.UPC_A);return D.putAllMetadata(g.getResultMetadata()),D}return g}catch{}throw new K}reset(){for(let s of this.readers)s.reset()}}class qr extends ht{constructor(){super(),this.decodeFinderCounters=new Int32Array(4),this.dataCharacterCounters=new Int32Array(8),this.oddRoundingErrors=new Array(4),this.evenRoundingErrors=new Array(4),this.oddCounts=new Array(this.dataCharacterCounters.length/2),this.evenCounts=new Array(this.dataCharacterCounters.length/2)}getDecodeFinderCounters(){return this.decodeFinderCounters}getDataCharacterCounters(){return this.dataCharacterCounters}getOddRoundingErrors(){return this.oddRoundingErrors}getEvenRoundingErrors(){return this.evenRoundingErrors}getOddCounts(){return this.oddCounts}getEvenCounts(){return this.evenCounts}parseFinderValue(s,l){for(let u=0;u<l.length;u++)if(ht.patternMatchVariance(s,l[u],qr.MAX_INDIVIDUAL_VARIANCE)<qr.MAX_AVG_VARIANCE)return u;throw new K}static count(s){return at.sum(new Int32Array(s))}static increment(s,l){let u=0,p=l[0];for(let g=1;g<s.length;g++)l[g]>p&&(p=l[g],u=g);s[u]++}static decrement(s,l){let u=0,p=l[0];for(let g=1;g<s.length;g++)l[g]<p&&(p=l[g],u=g);s[u]--}static isFinderPattern(s){let l=s[0]+s[1],u=l+s[2]+s[3],p=l/u;if(p>=qr.MIN_FINDER_PATTERN_RATIO&&p<=qr.MAX_FINDER_PATTERN_RATIO){let g=Number.MAX_SAFE_INTEGER,x=Number.MIN_SAFE_INTEGER;for(let y of s)y>x&&(x=y),y<g&&(g=y);return x<10*g}return!1}}qr.MAX_AVG_VARIANCE=.2,qr.MAX_INDIVIDUAL_VARIANCE=.45,qr.MIN_FINDER_PATTERN_RATIO=9.5/12,qr.MAX_FINDER_PATTERN_RATIO=12.5/14;class Bs{constructor(s,l){this.value=s,this.checksumPortion=l}getValue(){return this.value}getChecksumPortion(){return this.checksumPortion}toString(){return this.value+"("+this.checksumPortion+")"}equals(s){if(!(s instanceof Bs))return!1;const l=s;return this.value===l.value&&this.checksumPortion===l.checksumPortion}hashCode(){return this.value^this.checksumPortion}}class Ml{constructor(s,l,u,p,g){this.value=s,this.startEnd=l,this.value=s,this.startEnd=l,this.resultPoints=new Array,this.resultPoints.push(new $e(u,g)),this.resultPoints.push(new $e(p,g))}getValue(){return this.value}getStartEnd(){return this.startEnd}getResultPoints(){return this.resultPoints}equals(s){if(!(s instanceof Ml))return!1;const l=s;return this.value===l.value}hashCode(){return this.value}}class Di{constructor(){}static getRSSvalue(s,l,u){let p=0;for(let C of s)p+=C;let g=0,x=0,y=s.length;for(let C=0;C<y-1;C++){let O;for(O=1,x|=1<<C;O<s[C];O++,x&=~(1<<C)){let D=Di.combins(p-O-1,y-C-2);if(u&&x===0&&p-O-(y-C-1)>=y-C-1&&(D-=Di.combins(p-O-(y-C),y-C-2)),y-C-1>1){let L=0;for(let U=p-O-(y-C-2);U>l;U--)L+=Di.combins(p-O-U-1,y-C-3);D-=L*(y-1-C)}else p-O>l&&D--;g+=D}p-=O}return g}static combins(s,l){let u,p;s-l>l?(p=l,u=s-l):(p=s-l,u=l);let g=1,x=1;for(let y=s;y>u;y--)g*=y,x<=p&&(g/=x,x++);for(;x<=p;)g/=x,x++;return g}}class cg{static buildBitArray(s){let l=s.length*2-1;s[s.length-1].getRightChar()==null&&(l-=1);let u=12*l,p=new N(u),g=0,y=s[0].getRightChar().getValue();for(let C=11;C>=0;--C)y&1<<C&&p.set(g),g++;for(let C=1;C<s.length;++C){let O=s[C],D=O.getLeftChar().getValue();for(let L=11;L>=0;--L)D&1<<L&&p.set(g),g++;if(O.getRightChar()!=null){let L=O.getRightChar().getValue();for(let U=11;U>=0;--U)L&1<<U&&p.set(g),g++}}return p}}class aa{constructor(s,l){l?this.decodedInformation=null:(this.finished=s,this.decodedInformation=l)}getDecodedInformation(){return this.decodedInformation}isFinished(){return this.finished}}class ou{constructor(s){this.newPosition=s}getNewPosition(){return this.newPosition}}class _n extends ou{constructor(s,l){super(s),this.value=l}getValue(){return this.value}isFNC1(){return this.value===_n.FNC1}}_n.FNC1="$";class Qa extends ou{constructor(s,l,u){super(s),u?(this.remaining=!0,this.remainingValue=this.remainingValue):(this.remaining=!1,this.remainingValue=0),this.newString=l}getNewString(){return this.newString}isRemaining(){return this.remaining}getRemainingValue(){return this.remainingValue}}class j extends ou{constructor(s,l,u){if(super(s),l<0||l>10||u<0||u>10)throw new P;this.firstDigit=l,this.secondDigit=u}getFirstDigit(){return this.firstDigit}getSecondDigit(){return this.secondDigit}getValue(){return this.firstDigit*10+this.secondDigit}isFirstDigitFNC1(){return this.firstDigit===j.FNC1}isSecondDigitFNC1(){return this.secondDigit===j.FNC1}isAnyFNC1(){return this.firstDigit===j.FNC1||this.secondDigit===j.FNC1}}j.FNC1=10;class H{constructor(){}static parseFieldsInGeneralPurpose(s){if(!s)return null;if(s.length<2)throw new K;let l=s.substring(0,2);for(let g of H.TWO_DIGIT_DATA_LENGTH)if(g[0]===l)return g[1]===H.VARIABLE_LENGTH?H.processVariableAI(2,g[2],s):H.processFixedAI(2,g[1],s);if(s.length<3)throw new K;let u=s.substring(0,3);for(let g of H.THREE_DIGIT_DATA_LENGTH)if(g[0]===u)return g[1]===H.VARIABLE_LENGTH?H.processVariableAI(3,g[2],s):H.processFixedAI(3,g[1],s);for(let g of H.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH)if(g[0]===u)return g[1]===H.VARIABLE_LENGTH?H.processVariableAI(4,g[2],s):H.processFixedAI(4,g[1],s);if(s.length<4)throw new K;let p=s.substring(0,4);for(let g of H.FOUR_DIGIT_DATA_LENGTH)if(g[0]===p)return g[1]===H.VARIABLE_LENGTH?H.processVariableAI(4,g[2],s):H.processFixedAI(4,g[1],s);throw new K}static processFixedAI(s,l,u){if(u.length<s)throw new K;let p=u.substring(0,s);if(u.length<s+l)throw new K;let g=u.substring(s,s+l),x=u.substring(s+l),y="("+p+")"+g,C=H.parseFieldsInGeneralPurpose(x);return C==null?y:y+C}static processVariableAI(s,l,u){let p=u.substring(0,s),g;u.length<s+l?g=u.length:g=s+l;let x=u.substring(s,g),y=u.substring(g),C="("+p+")"+x,O=H.parseFieldsInGeneralPurpose(y);return O==null?C:C+O}}H.VARIABLE_LENGTH=[],H.TWO_DIGIT_DATA_LENGTH=[["00",18],["01",14],["02",14],["10",H.VARIABLE_LENGTH,20],["11",6],["12",6],["13",6],["15",6],["17",6],["20",2],["21",H.VARIABLE_LENGTH,20],["22",H.VARIABLE_LENGTH,29],["30",H.VARIABLE_LENGTH,8],["37",H.VARIABLE_LENGTH,8],["90",H.VARIABLE_LENGTH,30],["91",H.VARIABLE_LENGTH,30],["92",H.VARIABLE_LENGTH,30],["93",H.VARIABLE_LENGTH,30],["94",H.VARIABLE_LENGTH,30],["95",H.VARIABLE_LENGTH,30],["96",H.VARIABLE_LENGTH,30],["97",H.VARIABLE_LENGTH,3],["98",H.VARIABLE_LENGTH,30],["99",H.VARIABLE_LENGTH,30]],H.THREE_DIGIT_DATA_LENGTH=[["240",H.VARIABLE_LENGTH,30],["241",H.VARIABLE_LENGTH,30],["242",H.VARIABLE_LENGTH,6],["250",H.VARIABLE_LENGTH,30],["251",H.VARIABLE_LENGTH,30],["253",H.VARIABLE_LENGTH,17],["254",H.VARIABLE_LENGTH,20],["400",H.VARIABLE_LENGTH,30],["401",H.VARIABLE_LENGTH,30],["402",17],["403",H.VARIABLE_LENGTH,30],["410",13],["411",13],["412",13],["413",13],["414",13],["420",H.VARIABLE_LENGTH,20],["421",H.VARIABLE_LENGTH,15],["422",3],["423",H.VARIABLE_LENGTH,15],["424",3],["425",3],["426",3]],H.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[["310",6],["311",6],["312",6],["313",6],["314",6],["315",6],["316",6],["320",6],["321",6],["322",6],["323",6],["324",6],["325",6],["326",6],["327",6],["328",6],["329",6],["330",6],["331",6],["332",6],["333",6],["334",6],["335",6],["336",6],["340",6],["341",6],["342",6],["343",6],["344",6],["345",6],["346",6],["347",6],["348",6],["349",6],["350",6],["351",6],["352",6],["353",6],["354",6],["355",6],["356",6],["357",6],["360",6],["361",6],["362",6],["363",6],["364",6],["365",6],["366",6],["367",6],["368",6],["369",6],["390",H.VARIABLE_LENGTH,15],["391",H.VARIABLE_LENGTH,18],["392",H.VARIABLE_LENGTH,15],["393",H.VARIABLE_LENGTH,18],["703",H.VARIABLE_LENGTH,30]],H.FOUR_DIGIT_DATA_LENGTH=[["7001",13],["7002",H.VARIABLE_LENGTH,30],["7003",10],["8001",14],["8002",H.VARIABLE_LENGTH,20],["8003",H.VARIABLE_LENGTH,30],["8004",H.VARIABLE_LENGTH,30],["8005",6],["8006",18],["8007",H.VARIABLE_LENGTH,30],["8008",H.VARIABLE_LENGTH,12],["8018",18],["8020",H.VARIABLE_LENGTH,25],["8100",6],["8101",10],["8102",2],["8110",H.VARIABLE_LENGTH,70],["8200",H.VARIABLE_LENGTH,70]];class X{constructor(s){this.buffer=new de,this.information=s}decodeAllCodes(s,l){let u=l,p=null;do{let g=this.decodeGeneralPurposeField(u,p),x=H.parseFieldsInGeneralPurpose(g.getNewString());if(x!=null&&s.append(x),g.isRemaining()?p=""+g.getRemainingValue():p=null,u===g.getNewPosition())break;u=g.getNewPosition()}while(!0);return s.toString()}isStillNumeric(s){if(s+7>this.information.getSize())return s+4<=this.information.getSize();for(let l=s;l<s+3;++l)if(this.information.get(l))return!0;return this.information.get(s+3)}decodeNumeric(s){if(s+7>this.information.getSize()){let g=this.extractNumericValueFromBitArray(s,4);return g===0?new j(this.information.getSize(),j.FNC1,j.FNC1):new j(this.information.getSize(),g-1,j.FNC1)}let l=this.extractNumericValueFromBitArray(s,7),u=(l-8)/11,p=(l-8)%11;return new j(s+7,u,p)}extractNumericValueFromBitArray(s,l){return X.extractNumericValueFromBitArray(this.information,s,l)}static extractNumericValueFromBitArray(s,l,u){let p=0;for(let g=0;g<u;++g)s.get(l+g)&&(p|=1<<u-g-1);return p}decodeGeneralPurposeField(s,l){this.buffer.setLengthToZero(),l!=null&&this.buffer.append(l),this.current.setPosition(s);let u=this.parseBlocks();return u!=null&&u.isRemaining()?new Qa(this.current.getPosition(),this.buffer.toString(),u.getRemainingValue()):new Qa(this.current.getPosition(),this.buffer.toString())}parseBlocks(){let s,l;do{let u=this.current.getPosition();if(this.current.isAlpha()?(l=this.parseAlphaBlock(),s=l.isFinished()):this.current.isIsoIec646()?(l=this.parseIsoIec646Block(),s=l.isFinished()):(l=this.parseNumericBlock(),s=l.isFinished()),!(u!==this.current.getPosition())&&!s)break}while(!s);return l.getDecodedInformation()}parseNumericBlock(){for(;this.isStillNumeric(this.current.getPosition());){let s=this.decodeNumeric(this.current.getPosition());if(this.current.setPosition(s.getNewPosition()),s.isFirstDigitFNC1()){let l;return s.isSecondDigitFNC1()?l=new Qa(this.current.getPosition(),this.buffer.toString()):l=new Qa(this.current.getPosition(),this.buffer.toString(),s.getSecondDigit()),new aa(!0,l)}if(this.buffer.append(s.getFirstDigit()),s.isSecondDigitFNC1()){let l=new Qa(this.current.getPosition(),this.buffer.toString());return new aa(!0,l)}this.buffer.append(s.getSecondDigit())}return this.isNumericToAlphaNumericLatch(this.current.getPosition())&&(this.current.setAlpha(),this.current.incrementPosition(4)),new aa(!1)}parseIsoIec646Block(){for(;this.isStillIsoIec646(this.current.getPosition());){let s=this.decodeIsoIec646(this.current.getPosition());if(this.current.setPosition(s.getNewPosition()),s.isFNC1()){let l=new Qa(this.current.getPosition(),this.buffer.toString());return new aa(!0,l)}this.buffer.append(s.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setAlpha()),new aa(!1)}parseAlphaBlock(){for(;this.isStillAlpha(this.current.getPosition());){let s=this.decodeAlphanumeric(this.current.getPosition());if(this.current.setPosition(s.getNewPosition()),s.isFNC1()){let l=new Qa(this.current.getPosition(),this.buffer.toString());return new aa(!0,l)}this.buffer.append(s.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setIsoIec646()),new aa(!1)}isStillIsoIec646(s){if(s+5>this.information.getSize())return!1;let l=this.extractNumericValueFromBitArray(s,5);if(l>=5&&l<16)return!0;if(s+7>this.information.getSize())return!1;let u=this.extractNumericValueFromBitArray(s,7);if(u>=64&&u<116)return!0;if(s+8>this.information.getSize())return!1;let p=this.extractNumericValueFromBitArray(s,8);return p>=232&&p<253}decodeIsoIec646(s){let l=this.extractNumericValueFromBitArray(s,5);if(l===15)return new _n(s+5,_n.FNC1);if(l>=5&&l<15)return new _n(s+5,"0"+(l-5));let u=this.extractNumericValueFromBitArray(s,7);if(u>=64&&u<90)return new _n(s+7,""+(u+1));if(u>=90&&u<116)return new _n(s+7,""+(u+7));let p=this.extractNumericValueFromBitArray(s,8),g;switch(p){case 232:g="!";break;case 233:g='"';break;case 234:g="%";break;case 235:g="&";break;case 236:g="'";break;case 237:g="(";break;case 238:g=")";break;case 239:g="*";break;case 240:g="+";break;case 241:g=",";break;case 242:g="-";break;case 243:g=".";break;case 244:g="/";break;case 245:g=":";break;case 246:g=";";break;case 247:g="<";break;case 248:g="=";break;case 249:g=">";break;case 250:g="?";break;case 251:g="_";break;case 252:g=" ";break;default:throw new P}return new _n(s+8,g)}isStillAlpha(s){if(s+5>this.information.getSize())return!1;let l=this.extractNumericValueFromBitArray(s,5);if(l>=5&&l<16)return!0;if(s+6>this.information.getSize())return!1;let u=this.extractNumericValueFromBitArray(s,6);return u>=16&&u<63}decodeAlphanumeric(s){let l=this.extractNumericValueFromBitArray(s,5);if(l===15)return new _n(s+5,_n.FNC1);if(l>=5&&l<15)return new _n(s+5,"0"+(l-5));let u=this.extractNumericValueFromBitArray(s,6);if(u>=32&&u<58)return new _n(s+6,""+(u+33));let p;switch(u){case 58:p="*";break;case 59:p=",";break;case 60:p="-";break;case 61:p=".";break;case 62:p="/";break;default:throw new et("Decoding invalid alphanumeric value: "+u)}return new _n(s+6,p)}isAlphaTo646ToAlphaLatch(s){if(s+1>this.information.getSize())return!1;for(let l=0;l<5&&l+s<this.information.getSize();++l)if(l===2){if(!this.information.get(s+2))return!1}else if(this.information.get(s+l))return!1;return!0}isAlphaOr646ToNumericLatch(s){if(s+3>this.information.getSize())return!1;for(let l=s;l<s+3;++l)if(this.information.get(l))return!1;return!0}isNumericToAlphaNumericLatch(s){if(s+1>this.information.getSize())return!1;for(let l=0;l<4&&l+s<this.information.getSize();++l)if(this.information.get(s+l))return!1;return!0}}class Y{constructor(s){this.information=s,this.generalDecoder=new X(s)}getInformation(){return this.information}getGeneralDecoder(){return this.generalDecoder}}class Q extends Y{constructor(s){super(s)}encodeCompressedGtin(s,l){s.append("(01)");let u=s.length();s.append("9"),this.encodeCompressedGtinWithoutAI(s,l,u)}encodeCompressedGtinWithoutAI(s,l,u){for(let p=0;p<4;++p){let g=this.getGeneralDecoder().extractNumericValueFromBitArray(l+10*p,10);g/100===0&&s.append("0"),g/10===0&&s.append("0"),s.append(g)}Q.appendCheckDigit(s,u)}static appendCheckDigit(s,l){let u=0;for(let p=0;p<13;p++){let g=s.charAt(p+l).charCodeAt(0)-48;u+=p&1?g:3*g}u=10-u%10,u===10&&(u=0),s.append(u)}}Q.GTIN_SIZE=40;class te extends Q{constructor(s){super(s)}parseInformation(){let s=new de;s.append("(01)");let l=s.length(),u=this.getGeneralDecoder().extractNumericValueFromBitArray(te.HEADER_SIZE,4);return s.append(u),this.encodeCompressedGtinWithoutAI(s,te.HEADER_SIZE+4,l),this.getGeneralDecoder().decodeAllCodes(s,te.HEADER_SIZE+44)}}te.HEADER_SIZE=4;class ye extends Y{constructor(s){super(s)}parseInformation(){let s=new de;return this.getGeneralDecoder().decodeAllCodes(s,ye.HEADER_SIZE)}}ye.HEADER_SIZE=5;class Oe extends Q{constructor(s){super(s)}encodeCompressedWeight(s,l,u){let p=this.getGeneralDecoder().extractNumericValueFromBitArray(l,u);this.addWeightCode(s,p);let g=this.checkWeight(p),x=1e5;for(let y=0;y<5;++y)g/x===0&&s.append("0"),x/=10;s.append(g)}}class ge extends Oe{constructor(s){super(s)}parseInformation(){if(this.getInformation().getSize()!=ge.HEADER_SIZE+Oe.GTIN_SIZE+ge.WEIGHT_SIZE)throw new K;let s=new de;return this.encodeCompressedGtin(s,ge.HEADER_SIZE),this.encodeCompressedWeight(s,ge.HEADER_SIZE+Oe.GTIN_SIZE,ge.WEIGHT_SIZE),s.toString()}}ge.HEADER_SIZE=5,ge.WEIGHT_SIZE=15;class Ee extends ge{constructor(s){super(s)}addWeightCode(s,l){s.append("(3103)")}checkWeight(s){return s}}class Ae extends ge{constructor(s){super(s)}addWeightCode(s,l){l<1e4?s.append("(3202)"):s.append("(3203)")}checkWeight(s){return s<1e4?s:s-1e4}}class Ne extends Q{constructor(s){super(s)}parseInformation(){if(this.getInformation().getSize()<Ne.HEADER_SIZE+Q.GTIN_SIZE)throw new K;let s=new de;this.encodeCompressedGtin(s,Ne.HEADER_SIZE);let l=this.getGeneralDecoder().extractNumericValueFromBitArray(Ne.HEADER_SIZE+Q.GTIN_SIZE,Ne.LAST_DIGIT_SIZE);s.append("(392"),s.append(l),s.append(")");let u=this.getGeneralDecoder().decodeGeneralPurposeField(Ne.HEADER_SIZE+Q.GTIN_SIZE+Ne.LAST_DIGIT_SIZE,null);return s.append(u.getNewString()),s.toString()}}Ne.HEADER_SIZE=8,Ne.LAST_DIGIT_SIZE=2;class Re extends Q{constructor(s){super(s)}parseInformation(){if(this.getInformation().getSize()<Re.HEADER_SIZE+Q.GTIN_SIZE)throw new K;let s=new de;this.encodeCompressedGtin(s,Re.HEADER_SIZE);let l=this.getGeneralDecoder().extractNumericValueFromBitArray(Re.HEADER_SIZE+Q.GTIN_SIZE,Re.LAST_DIGIT_SIZE);s.append("(393"),s.append(l),s.append(")");let u=this.getGeneralDecoder().extractNumericValueFromBitArray(Re.HEADER_SIZE+Q.GTIN_SIZE+Re.LAST_DIGIT_SIZE,Re.FIRST_THREE_DIGITS_SIZE);u/100==0&&s.append("0"),u/10==0&&s.append("0"),s.append(u);let p=this.getGeneralDecoder().decodeGeneralPurposeField(Re.HEADER_SIZE+Q.GTIN_SIZE+Re.LAST_DIGIT_SIZE+Re.FIRST_THREE_DIGITS_SIZE,null);return s.append(p.getNewString()),s.toString()}}Re.HEADER_SIZE=8,Re.LAST_DIGIT_SIZE=2,Re.FIRST_THREE_DIGITS_SIZE=10;class Fe extends Oe{constructor(s,l,u){super(s),this.dateCode=u,this.firstAIdigits=l}parseInformation(){if(this.getInformation().getSize()!=Fe.HEADER_SIZE+Fe.GTIN_SIZE+Fe.WEIGHT_SIZE+Fe.DATE_SIZE)throw new K;let s=new de;return this.encodeCompressedGtin(s,Fe.HEADER_SIZE),this.encodeCompressedWeight(s,Fe.HEADER_SIZE+Fe.GTIN_SIZE,Fe.WEIGHT_SIZE),this.encodeCompressedDate(s,Fe.HEADER_SIZE+Fe.GTIN_SIZE+Fe.WEIGHT_SIZE),s.toString()}encodeCompressedDate(s,l){let u=this.getGeneralDecoder().extractNumericValueFromBitArray(l,Fe.DATE_SIZE);if(u==38400)return;s.append("("),s.append(this.dateCode),s.append(")");let p=u%32;u/=32;let g=u%12+1;u/=12;let x=u;x/10==0&&s.append("0"),s.append(x),g/10==0&&s.append("0"),s.append(g),p/10==0&&s.append("0"),s.append(p)}addWeightCode(s,l){s.append("("),s.append(this.firstAIdigits),s.append(l/1e5),s.append(")")}checkWeight(s){return s%1e5}}Fe.HEADER_SIZE=8,Fe.WEIGHT_SIZE=20,Fe.DATE_SIZE=16;function je(F){try{if(F.get(1))return new te(F);if(!F.get(2))return new ye(F);switch(X.extractNumericValueFromBitArray(F,1,4)){case 4:return new Ee(F);case 5:return new Ae(F)}switch(X.extractNumericValueFromBitArray(F,1,5)){case 12:return new Ne(F);case 13:return new Re(F)}switch(X.extractNumericValueFromBitArray(F,1,7)){case 56:return new Fe(F,"310","11");case 57:return new Fe(F,"320","11");case 58:return new Fe(F,"310","13");case 59:return new Fe(F,"320","13");case 60:return new Fe(F,"310","15");case 61:return new Fe(F,"320","15");case 62:return new Fe(F,"310","17");case 63:return new Fe(F,"320","17")}}catch(s){throw console.log(s),new et("unknown decoder: "+F)}}class Ve{constructor(s,l,u,p){this.leftchar=s,this.rightchar=l,this.finderpattern=u,this.maybeLast=p}mayBeLast(){return this.maybeLast}getLeftChar(){return this.leftchar}getRightChar(){return this.rightchar}getFinderPattern(){return this.finderpattern}mustBeLast(){return this.rightchar==null}toString(){return"[ "+this.leftchar+", "+this.rightchar+" : "+(this.finderpattern==null?"null":this.finderpattern.getValue())+" ]"}static equals(s,l){return s instanceof Ve?Ve.equalsOrNull(s.leftchar,l.leftchar)&&Ve.equalsOrNull(s.rightchar,l.rightchar)&&Ve.equalsOrNull(s.finderpattern,l.finderpattern):!1}static equalsOrNull(s,l){return s===null?l===null:Ve.equals(s,l)}hashCode(){return this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue()}}class lt{constructor(s,l,u){this.pairs=s,this.rowNumber=l,this.wasReversed=u}getPairs(){return this.pairs}getRowNumber(){return this.rowNumber}isReversed(){return this.wasReversed}isEquivalent(s){return this.checkEqualitity(this,s)}toString(){return"{ "+this.pairs+" }"}equals(s,l){return s instanceof lt?this.checkEqualitity(s,l)&&s.wasReversed===l.wasReversed:!1}checkEqualitity(s,l){if(!s||!l)return;let u;return s.forEach((p,g)=>{l.forEach(x=>{p.getLeftChar().getValue()===x.getLeftChar().getValue()&&p.getRightChar().getValue()===x.getRightChar().getValue()&&p.getFinderPatter().getValue()===x.getFinderPatter().getValue()&&(u=!0)})}),u}}class Te extends qr{constructor(s){super(...arguments),this.pairs=new Array(Te.MAX_PAIRS),this.rows=new Array,this.startEnd=[2],this.verbose=s===!0}decodeRow(s,l,u){this.pairs.length=0,this.startFromEven=!1;try{return Te.constructResult(this.decodeRow2pairs(s,l))}catch(p){this.verbose&&console.log(p)}return this.pairs.length=0,this.startFromEven=!0,Te.constructResult(this.decodeRow2pairs(s,l))}reset(){this.pairs.length=0,this.rows.length=0}decodeRow2pairs(s,l){let u=!1;for(;!u;)try{this.pairs.push(this.retrieveNextPair(l,this.pairs,s))}catch(g){if(g instanceof K){if(!this.pairs.length)throw new K;u=!0}}if(this.checkChecksum())return this.pairs;let p;if(this.rows.length?p=!0:p=!1,this.storeRow(s,!1),p){let g=this.checkRowsBoolean(!1);if(g!=null||(g=this.checkRowsBoolean(!0),g!=null))return g}throw new K}checkRowsBoolean(s){if(this.rows.length>25)return this.rows.length=0,null;this.pairs.length=0,s&&(this.rows=this.rows.reverse());let l=null;try{l=this.checkRows(new Array,0)}catch(u){this.verbose&&console.log(u)}return s&&(this.rows=this.rows.reverse()),l}checkRows(s,l){for(let u=l;u<this.rows.length;u++){let p=this.rows[u];this.pairs.length=0;for(let x of s)this.pairs.push(x.getPairs());if(this.pairs.push(p.getPairs()),!Te.isValidSequence(this.pairs))continue;if(this.checkChecksum())return this.pairs;let g=new Array(s);g.push(p);try{return this.checkRows(g,u+1)}catch(x){this.verbose&&console.log(x)}}throw new K}static isValidSequence(s){for(let l of Te.FINDER_PATTERN_SEQUENCES){if(s.length>l.length)continue;let u=!0;for(let p=0;p<s.length;p++)if(s[p].getFinderPattern().getValue()!=l[p]){u=!1;break}if(u)return!0}return!1}storeRow(s,l){let u=0,p=!1,g=!1;for(;u<this.rows.length;){let x=this.rows[u];if(x.getRowNumber()>s){g=x.isEquivalent(this.pairs);break}p=x.isEquivalent(this.pairs),u++}g||p||Te.isPartialRow(this.pairs,this.rows)||(this.rows.push(u,new lt(this.pairs,s,l)),this.removePartialRows(this.pairs,this.rows))}removePartialRows(s,l){for(let u of l)if(u.getPairs().length!==s.length){for(let p of u.getPairs())for(let g of s)if(Ve.equals(p,g))break}}static isPartialRow(s,l){for(let u of l){let p=!0;for(let g of s){let x=!1;for(let y of u.getPairs())if(g.equals(y)){x=!0;break}if(!x){p=!1;break}}if(p)return!0}return!1}getRows(){return this.rows}static constructResult(s){let l=cg.buildBitArray(s),p=je(l).parseInformation(),g=s[0].getFinderPattern().getResultPoints(),x=s[s.length-1].getFinderPattern().getResultPoints(),y=[g[0],g[1],x[0],x[1]];return new ne(p,null,null,y,he.RSS_EXPANDED,null)}checkChecksum(){let s=this.pairs.get(0),l=s.getLeftChar(),u=s.getRightChar();if(u==null)return!1;let p=u.getChecksumPortion(),g=2;for(let y=1;y<this.pairs.size();++y){let C=this.pairs.get(y);p+=C.getLeftChar().getChecksumPortion(),g++;let O=C.getRightChar();O!=null&&(p+=O.getChecksumPortion(),g++)}return p%=211,211*(g-4)+p==l.getValue()}static getNextSecondBar(s,l){let u;return s.get(l)?(u=s.getNextUnset(l),u=s.getNextSet(u)):(u=s.getNextSet(l),u=s.getNextUnset(u)),u}retrieveNextPair(s,l,u){let p=l.length%2==0;this.startFromEven&&(p=!p);let g,x=!0,y=-1;do this.findNextPair(s,l,y),g=this.parseFoundFinderPattern(s,u,p),g==null?y=Te.getNextSecondBar(s,this.startEnd[0]):x=!1;while(x);let C=this.decodeDataCharacter(s,g,p,!0);if(!this.isEmptyPair(l)&&l[l.length-1].mustBeLast())throw new K;let O;try{O=this.decodeDataCharacter(s,g,p,!1)}catch(D){O=null,this.verbose&&console.log(D)}return new Ve(C,O,g,!0)}isEmptyPair(s){return s.length===0}findNextPair(s,l,u){let p=this.getDecodeFinderCounters();p[0]=0,p[1]=0,p[2]=0,p[3]=0;let g=s.getSize(),x;u>=0?x=u:this.isEmptyPair(l)?x=0:x=l[l.length-1].getFinderPattern().getStartEnd()[1];let y=l.length%2!=0;this.startFromEven&&(y=!y);let C=!1;for(;x<g&&(C=!s.get(x),!!C);)x++;let O=0,D=x;for(let L=x;L<g;L++)if(s.get(L)!=C)p[O]++;else{if(O==3){if(y&&Te.reverseCounters(p),Te.isFinderPattern(p)){this.startEnd[0]=D,this.startEnd[1]=L;return}y&&Te.reverseCounters(p),D+=p[0]+p[1],p[0]=p[2],p[1]=p[3],p[2]=0,p[3]=0,O--}else O++;p[O]=1,C=!C}throw new K}static reverseCounters(s){let l=s.length;for(let u=0;u<l/2;++u){let p=s[u];s[u]=s[l-u-1],s[l-u-1]=p}}parseFoundFinderPattern(s,l,u){let p,g,x;if(u){let O=this.startEnd[0]-1;for(;O>=0&&!s.get(O);)O--;O++,p=this.startEnd[0]-O,g=O,x=this.startEnd[1]}else g=this.startEnd[0],x=s.getNextUnset(this.startEnd[1]+1),p=x-this.startEnd[1];let y=this.getDecodeFinderCounters();A.arraycopy(y,0,y,1,y.length-1),y[0]=p;let C;try{C=this.parseFinderValue(y,Te.FINDER_PATTERNS)}catch{return null}return new Ml(C,[g,x],g,x,l)}decodeDataCharacter(s,l,u,p){let g=this.getDataCharacterCounters();for(let Vt=0;Vt<g.length;Vt++)g[Vt]=0;if(p)Te.recordPatternInReverse(s,l.getStartEnd()[0],g);else{Te.recordPattern(s,l.getStartEnd()[1],g);for(let Vt=0,gn=g.length-1;Vt<gn;Vt++,gn--){let xi=g[Vt];g[Vt]=g[gn],g[gn]=xi}}let x=17,y=at.sum(new Int32Array(g))/x,C=(l.getStartEnd()[1]-l.getStartEnd()[0])/15;if(Math.abs(y-C)/C>.3)throw new K;let O=this.getOddCounts(),D=this.getEvenCounts(),L=this.getOddRoundingErrors(),U=this.getEvenRoundingErrors();for(let Vt=0;Vt<g.length;Vt++){let gn=1*g[Vt]/y,xi=gn+.5;if(xi<1){if(gn<.3)throw new K;xi=1}else if(xi>8){if(gn>8.7)throw new K;xi=8}let jl=Vt/2;Vt&1?(D[jl]=xi,U[jl]=gn-xi):(O[jl]=xi,L[jl]=gn-xi)}this.adjustOddEvenCounts(x);let J=4*l.getValue()+(u?0:2)+(p?0:1)-1,ie=0,oe=0;for(let Vt=O.length-1;Vt>=0;Vt--){if(Te.isNotA1left(l,u,p)){let gn=Te.WEIGHTS[J][2*Vt];oe+=O[Vt]*gn}ie+=O[Vt]}let me=0;for(let Vt=D.length-1;Vt>=0;Vt--)if(Te.isNotA1left(l,u,p)){let gn=Te.WEIGHTS[J][2*Vt+1];me+=D[Vt]*gn}let _e=oe+me;if(ie&1||ie>13||ie<4)throw new K;let Le=(13-ie)/2,Ue=Te.SYMBOL_WIDEST[Le],Pe=9-Ue,At=Di.getRSSvalue(O,Ue,!0),ut=Di.getRSSvalue(D,Pe,!1),ri=Te.EVEN_TOTAL_SUBSET[Le],sa=Te.GSUM[Le],ni=At*ri+ut+sa;return new Bs(ni,_e)}static isNotA1left(s,l,u){return!(s.getValue()==0&&l&&u)}adjustOddEvenCounts(s){let l=at.sum(new Int32Array(this.getOddCounts())),u=at.sum(new Int32Array(this.getEvenCounts())),p=!1,g=!1;l>13?g=!0:l<4&&(p=!0);let x=!1,y=!1;u>13?y=!0:u<4&&(x=!0);let C=l+u-s,O=(l&1)==1,D=(u&1)==0;if(C==1)if(O){if(D)throw new K;g=!0}else{if(!D)throw new K;y=!0}else if(C==-1)if(O){if(D)throw new K;p=!0}else{if(!D)throw new K;x=!0}else if(C==0){if(O){if(!D)throw new K;l<u?(p=!0,y=!0):(g=!0,x=!0)}else if(D)throw new K}else throw new K;if(p){if(g)throw new K;Te.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(g&&Te.decrement(this.getOddCounts(),this.getOddRoundingErrors()),x){if(y)throw new K;Te.increment(this.getEvenCounts(),this.getOddRoundingErrors())}y&&Te.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}Te.SYMBOL_WIDEST=[7,5,4,3,1],Te.EVEN_TOTAL_SUBSET=[4,20,52,104,204],Te.GSUM=[0,348,1388,2948,3988],Te.FINDER_PATTERNS=[Int32Array.from([1,8,4,1]),Int32Array.from([3,6,4,1]),Int32Array.from([3,4,6,1]),Int32Array.from([3,2,8,1]),Int32Array.from([2,6,5,1]),Int32Array.from([2,2,9,1])],Te.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]],Te.FINDER_PAT_A=0,Te.FINDER_PAT_B=1,Te.FINDER_PAT_C=2,Te.FINDER_PAT_D=3,Te.FINDER_PAT_E=4,Te.FINDER_PAT_F=5,Te.FINDER_PATTERN_SEQUENCES=[[Te.FINDER_PAT_A,Te.FINDER_PAT_A],[Te.FINDER_PAT_A,Te.FINDER_PAT_B,Te.FINDER_PAT_B],[Te.FINDER_PAT_A,Te.FINDER_PAT_C,Te.FINDER_PAT_B,Te.FINDER_PAT_D],[Te.FINDER_PAT_A,Te.FINDER_PAT_E,Te.FINDER_PAT_B,Te.FINDER_PAT_D,Te.FINDER_PAT_C],[Te.FINDER_PAT_A,Te.FINDER_PAT_E,Te.FINDER_PAT_B,Te.FINDER_PAT_D,Te.FINDER_PAT_D,Te.FINDER_PAT_F],[Te.FINDER_PAT_A,Te.FINDER_PAT_E,Te.FINDER_PAT_B,Te.FINDER_PAT_D,Te.FINDER_PAT_E,Te.FINDER_PAT_F,Te.FINDER_PAT_F],[Te.FINDER_PAT_A,Te.FINDER_PAT_A,Te.FINDER_PAT_B,Te.FINDER_PAT_B,Te.FINDER_PAT_C,Te.FINDER_PAT_C,Te.FINDER_PAT_D,Te.FINDER_PAT_D],[Te.FINDER_PAT_A,Te.FINDER_PAT_A,Te.FINDER_PAT_B,Te.FINDER_PAT_B,Te.FINDER_PAT_C,Te.FINDER_PAT_C,Te.FINDER_PAT_D,Te.FINDER_PAT_E,Te.FINDER_PAT_E],[Te.FINDER_PAT_A,Te.FINDER_PAT_A,Te.FINDER_PAT_B,Te.FINDER_PAT_B,Te.FINDER_PAT_C,Te.FINDER_PAT_C,Te.FINDER_PAT_D,Te.FINDER_PAT_E,Te.FINDER_PAT_F,Te.FINDER_PAT_F],[Te.FINDER_PAT_A,Te.FINDER_PAT_A,Te.FINDER_PAT_B,Te.FINDER_PAT_B,Te.FINDER_PAT_C,Te.FINDER_PAT_D,Te.FINDER_PAT_D,Te.FINDER_PAT_E,Te.FINDER_PAT_E,Te.FINDER_PAT_F,Te.FINDER_PAT_F]],Te.MAX_PAIRS=11;class Jt extends Bs{constructor(s,l,u){super(s,l),this.count=0,this.finderPattern=u}getFinderPattern(){return this.finderPattern}getCount(){return this.count}incrementCount(){this.count++}}class gt extends qr{constructor(){super(...arguments),this.possibleLeftPairs=[],this.possibleRightPairs=[]}decodeRow(s,l,u){const p=this.decodePair(l,!1,s,u);gt.addOrTally(this.possibleLeftPairs,p),l.reverse();let g=this.decodePair(l,!0,s,u);gt.addOrTally(this.possibleRightPairs,g),l.reverse();for(let x of this.possibleLeftPairs)if(x.getCount()>1){for(let y of this.possibleRightPairs)if(y.getCount()>1&&gt.checkChecksum(x,y))return gt.constructResult(x,y)}throw new K}static addOrTally(s,l){if(l==null)return;let u=!1;for(let p of s)if(p.getValue()===l.getValue()){p.incrementCount(),u=!0;break}u||s.push(l)}reset(){this.possibleLeftPairs.length=0,this.possibleRightPairs.length=0}static constructResult(s,l){let u=4537077*s.getValue()+l.getValue(),p=new String(u).toString(),g=new de;for(let O=13-p.length;O>0;O--)g.append("0");g.append(p);let x=0;for(let O=0;O<13;O++){let D=g.charAt(O).charCodeAt(0)-48;x+=O&1?D:3*D}x=10-x%10,x===10&&(x=0),g.append(x.toString());let y=s.getFinderPattern().getResultPoints(),C=l.getFinderPattern().getResultPoints();return new ne(g.toString(),null,0,[y[0],y[1],C[0],C[1]],he.RSS_14,new Date().getTime())}static checkChecksum(s,l){let u=(s.getChecksumPortion()+16*l.getChecksumPortion())%79,p=9*s.getFinderPattern().getValue()+l.getFinderPattern().getValue();return p>72&&p--,p>8&&p--,u===p}decodePair(s,l,u,p){try{let g=this.findFinderPattern(s,l),x=this.parseFoundFinderPattern(s,u,l,g),y=p==null?null:p.get(R.NEED_RESULT_POINT_CALLBACK);if(y!=null){let D=(g[0]+g[1])/2;l&&(D=s.getSize()-1-D),y.foundPossibleResultPoint(new $e(D,u))}let C=this.decodeDataCharacter(s,x,!0),O=this.decodeDataCharacter(s,x,!1);return new Jt(1597*C.getValue()+O.getValue(),C.getChecksumPortion()+4*O.getChecksumPortion(),x)}catch{return null}}decodeDataCharacter(s,l,u){let p=this.getDataCharacterCounters();for(let me=0;me<p.length;me++)p[me]=0;if(u)ht.recordPatternInReverse(s,l.getStartEnd()[0],p);else{ht.recordPattern(s,l.getStartEnd()[1]+1,p);for(let me=0,_e=p.length-1;me<_e;me++,_e--){let Le=p[me];p[me]=p[_e],p[_e]=Le}}let g=u?16:15,x=at.sum(new Int32Array(p))/g,y=this.getOddCounts(),C=this.getEvenCounts(),O=this.getOddRoundingErrors(),D=this.getEvenRoundingErrors();for(let me=0;me<p.length;me++){let _e=p[me]/x,Le=Math.floor(_e+.5);Le<1?Le=1:Le>8&&(Le=8);let Ue=Math.floor(me/2);me&1?(C[Ue]=Le,D[Ue]=_e-Le):(y[Ue]=Le,O[Ue]=_e-Le)}this.adjustOddEvenCounts(u,g);let L=0,U=0;for(let me=y.length-1;me>=0;me--)U*=9,U+=y[me],L+=y[me];let J=0,ie=0;for(let me=C.length-1;me>=0;me--)J*=9,J+=C[me],ie+=C[me];let oe=U+3*J;if(u){if(L&1||L>12||L<4)throw new K;let me=(12-L)/2,_e=gt.OUTSIDE_ODD_WIDEST[me],Le=9-_e,Ue=Di.getRSSvalue(y,_e,!1),Pe=Di.getRSSvalue(C,Le,!0),At=gt.OUTSIDE_EVEN_TOTAL_SUBSET[me],ut=gt.OUTSIDE_GSUM[me];return new Bs(Ue*At+Pe+ut,oe)}else{if(ie&1||ie>10||ie<4)throw new K;let me=(10-ie)/2,_e=gt.INSIDE_ODD_WIDEST[me],Le=9-_e,Ue=Di.getRSSvalue(y,_e,!0),Pe=Di.getRSSvalue(C,Le,!1),At=gt.INSIDE_ODD_TOTAL_SUBSET[me],ut=gt.INSIDE_GSUM[me];return new Bs(Pe*At+Ue+ut,oe)}}findFinderPattern(s,l){let u=this.getDecodeFinderCounters();u[0]=0,u[1]=0,u[2]=0,u[3]=0;let p=s.getSize(),g=!1,x=0;for(;x<p&&(g=!s.get(x),l!==g);)x++;let y=0,C=x;for(let O=x;O<p;O++)if(s.get(O)!==g)u[y]++;else{if(y===3){if(qr.isFinderPattern(u))return[C,O];C+=u[0]+u[1],u[0]=u[2],u[1]=u[3],u[2]=0,u[3]=0,y--}else y++;u[y]=1,g=!g}throw new K}parseFoundFinderPattern(s,l,u,p){let g=s.get(p[0]),x=p[0]-1;for(;x>=0&&g!==s.get(x);)x--;x++;const y=p[0]-x,C=this.getDecodeFinderCounters(),O=new Int32Array(C.length);A.arraycopy(C,0,O,1,C.length-1),O[0]=y;const D=this.parseFinderValue(O,gt.FINDER_PATTERNS);let L=x,U=p[1];return u&&(L=s.getSize()-1-L,U=s.getSize()-1-U),new Ml(D,[x,p[1]],L,U,l)}adjustOddEvenCounts(s,l){let u=at.sum(new Int32Array(this.getOddCounts())),p=at.sum(new Int32Array(this.getEvenCounts())),g=!1,x=!1,y=!1,C=!1;s?(u>12?x=!0:u<4&&(g=!0),p>12?C=!0:p<4&&(y=!0)):(u>11?x=!0:u<5&&(g=!0),p>10?C=!0:p<4&&(y=!0));let O=u+p-l,D=(u&1)===(s?1:0),L=(p&1)===1;if(O===1)if(D){if(L)throw new K;x=!0}else{if(!L)throw new K;C=!0}else if(O===-1)if(D){if(L)throw new K;g=!0}else{if(!L)throw new K;y=!0}else if(O===0){if(D){if(!L)throw new K;u<p?(g=!0,C=!0):(x=!0,y=!0)}else if(L)throw new K}else throw new K;if(g){if(x)throw new K;qr.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(x&&qr.decrement(this.getOddCounts(),this.getOddRoundingErrors()),y){if(C)throw new K;qr.increment(this.getEvenCounts(),this.getOddRoundingErrors())}C&&qr.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}gt.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126],gt.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81],gt.OUTSIDE_GSUM=[0,161,961,2015,2715],gt.INSIDE_GSUM=[0,336,1036,1516],gt.OUTSIDE_ODD_WIDEST=[8,6,4,3,1],gt.INSIDE_ODD_WIDEST=[2,4,6,8],gt.FINDER_PATTERNS=[Int32Array.from([3,8,2,1]),Int32Array.from([3,5,5,1]),Int32Array.from([3,3,7,1]),Int32Array.from([3,1,9,1]),Int32Array.from([2,7,4,1]),Int32Array.from([2,5,6,1]),Int32Array.from([2,3,8,1]),Int32Array.from([1,5,7,1]),Int32Array.from([1,3,9,1])];class Ri extends ht{constructor(s,l){super(),this.readers=[],this.verbose=l===!0;const u=s?s.get(R.POSSIBLE_FORMATS):null,p=s&&s.get(R.ASSUME_CODE_39_CHECK_DIGIT)!==void 0;u?((u.includes(he.EAN_13)||u.includes(he.UPC_A)||u.includes(he.EAN_8)||u.includes(he.UPC_E))&&this.readers.push(new su(s)),u.includes(he.CODE_39)&&this.readers.push(new vr(p)),u.includes(he.CODE_128)&&this.readers.push(new We),u.includes(he.ITF)&&this.readers.push(new Mt),u.includes(he.RSS_14)&&this.readers.push(new gt),u.includes(he.RSS_EXPANDED)&&this.readers.push(new Te(this.verbose))):(this.readers.push(new su(s)),this.readers.push(new vr),this.readers.push(new su(s)),this.readers.push(new We),this.readers.push(new Mt),this.readers.push(new gt),this.readers.push(new Te(this.verbose)))}decodeRow(s,l,u){for(let p=0;p<this.readers.length;p++)try{return this.readers[p].decodeRow(s,l,u)}catch{}throw new K}reset(){this.readers.forEach(s=>s.reset())}}class No extends le{constructor(s=500,l){super(new Ri(l),s,l)}}class Et{constructor(s,l,u){this.ecCodewords=s,this.ecBlocks=[l],u&&this.ecBlocks.push(u)}getECCodewords(){return this.ecCodewords}getECBlocks(){return this.ecBlocks}}class mt{constructor(s,l){this.count=s,this.dataCodewords=l}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class xt{constructor(s,l,u,p,g,x){this.versionNumber=s,this.symbolSizeRows=l,this.symbolSizeColumns=u,this.dataRegionSizeRows=p,this.dataRegionSizeColumns=g,this.ecBlocks=x;let y=0;const C=x.getECCodewords(),O=x.getECBlocks();for(let D of O)y+=D.getCount()*(D.getDataCodewords()+C);this.totalCodewords=y}getVersionNumber(){return this.versionNumber}getSymbolSizeRows(){return this.symbolSizeRows}getSymbolSizeColumns(){return this.symbolSizeColumns}getDataRegionSizeRows(){return this.dataRegionSizeRows}getDataRegionSizeColumns(){return this.dataRegionSizeColumns}getTotalCodewords(){return this.totalCodewords}getECBlocks(){return this.ecBlocks}static getVersionForDimensions(s,l){if(s&1||l&1)throw new P;for(let u of xt.VERSIONS)if(u.symbolSizeRows===s&&u.symbolSizeColumns===l)return u;throw new P}toString(){return""+this.versionNumber}static buildVersions(){return[new xt(1,10,10,8,8,new Et(5,new mt(1,3))),new xt(2,12,12,10,10,new Et(7,new mt(1,5))),new xt(3,14,14,12,12,new Et(10,new mt(1,8))),new xt(4,16,16,14,14,new Et(12,new mt(1,12))),new xt(5,18,18,16,16,new Et(14,new mt(1,18))),new xt(6,20,20,18,18,new Et(18,new mt(1,22))),new xt(7,22,22,20,20,new Et(20,new mt(1,30))),new xt(8,24,24,22,22,new Et(24,new mt(1,36))),new xt(9,26,26,24,24,new Et(28,new mt(1,44))),new xt(10,32,32,14,14,new Et(36,new mt(1,62))),new xt(11,36,36,16,16,new Et(42,new mt(1,86))),new xt(12,40,40,18,18,new Et(48,new mt(1,114))),new xt(13,44,44,20,20,new Et(56,new mt(1,144))),new xt(14,48,48,22,22,new Et(68,new mt(1,174))),new xt(15,52,52,24,24,new Et(42,new mt(2,102))),new xt(16,64,64,14,14,new Et(56,new mt(2,140))),new xt(17,72,72,16,16,new Et(36,new mt(4,92))),new xt(18,80,80,18,18,new Et(48,new mt(4,114))),new xt(19,88,88,20,20,new Et(56,new mt(4,144))),new xt(20,96,96,22,22,new Et(68,new mt(4,174))),new xt(21,104,104,24,24,new Et(56,new mt(6,136))),new xt(22,120,120,18,18,new Et(68,new mt(6,175))),new xt(23,132,132,20,20,new Et(62,new mt(8,163))),new xt(24,144,144,22,22,new Et(62,new mt(8,156),new mt(2,155))),new xt(25,8,18,6,16,new Et(7,new mt(1,5))),new xt(26,8,32,6,14,new Et(11,new mt(1,10))),new xt(27,12,26,10,24,new Et(14,new mt(1,16))),new xt(28,12,36,10,16,new Et(18,new mt(1,22))),new xt(29,16,36,14,16,new Et(24,new mt(1,32))),new xt(30,16,48,14,22,new Et(28,new mt(1,49)))]}}xt.VERSIONS=xt.buildVersions();class mi{constructor(s){const l=s.getHeight();if(l<8||l>144||l&1)throw new P;this.version=mi.readVersion(s),this.mappingBitMatrix=this.extractDataRegion(s),this.readMappingMatrix=new pe(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}getVersion(){return this.version}static readVersion(s){const l=s.getHeight(),u=s.getWidth();return xt.getVersionForDimensions(l,u)}readCodewords(){const s=new Int8Array(this.version.getTotalCodewords());let l=0,u=4,p=0;const g=this.mappingBitMatrix.getHeight(),x=this.mappingBitMatrix.getWidth();let y=!1,C=!1,O=!1,D=!1;do if(u===g&&p===0&&!y)s[l++]=this.readCorner1(g,x)&255,u-=2,p+=2,y=!0;else if(u===g-2&&p===0&&x&3&&!C)s[l++]=this.readCorner2(g,x)&255,u-=2,p+=2,C=!0;else if(u===g+4&&p===2&&!(x&7)&&!O)s[l++]=this.readCorner3(g,x)&255,u-=2,p+=2,O=!0;else if(u===g-2&&p===0&&(x&7)===4&&!D)s[l++]=this.readCorner4(g,x)&255,u-=2,p+=2,D=!0;else{do u<g&&p>=0&&!this.readMappingMatrix.get(p,u)&&(s[l++]=this.readUtah(u,p,g,x)&255),u-=2,p+=2;while(u>=0&&p<x);u+=1,p+=3;do u>=0&&p<x&&!this.readMappingMatrix.get(p,u)&&(s[l++]=this.readUtah(u,p,g,x)&255),u+=2,p-=2;while(u<g&&p>=0);u+=3,p+=1}while(u<g||p<x);if(l!==this.version.getTotalCodewords())throw new P;return s}readModule(s,l,u,p){return s<0&&(s+=u,l+=4-(u+4&7)),l<0&&(l+=p,s+=4-(p+4&7)),this.readMappingMatrix.set(l,s),this.mappingBitMatrix.get(l,s)}readUtah(s,l,u,p){let g=0;return this.readModule(s-2,l-2,u,p)&&(g|=1),g<<=1,this.readModule(s-2,l-1,u,p)&&(g|=1),g<<=1,this.readModule(s-1,l-2,u,p)&&(g|=1),g<<=1,this.readModule(s-1,l-1,u,p)&&(g|=1),g<<=1,this.readModule(s-1,l,u,p)&&(g|=1),g<<=1,this.readModule(s,l-2,u,p)&&(g|=1),g<<=1,this.readModule(s,l-1,u,p)&&(g|=1),g<<=1,this.readModule(s,l,u,p)&&(g|=1),g}readCorner1(s,l){let u=0;return this.readModule(s-1,0,s,l)&&(u|=1),u<<=1,this.readModule(s-1,1,s,l)&&(u|=1),u<<=1,this.readModule(s-1,2,s,l)&&(u|=1),u<<=1,this.readModule(0,l-2,s,l)&&(u|=1),u<<=1,this.readModule(0,l-1,s,l)&&(u|=1),u<<=1,this.readModule(1,l-1,s,l)&&(u|=1),u<<=1,this.readModule(2,l-1,s,l)&&(u|=1),u<<=1,this.readModule(3,l-1,s,l)&&(u|=1),u}readCorner2(s,l){let u=0;return this.readModule(s-3,0,s,l)&&(u|=1),u<<=1,this.readModule(s-2,0,s,l)&&(u|=1),u<<=1,this.readModule(s-1,0,s,l)&&(u|=1),u<<=1,this.readModule(0,l-4,s,l)&&(u|=1),u<<=1,this.readModule(0,l-3,s,l)&&(u|=1),u<<=1,this.readModule(0,l-2,s,l)&&(u|=1),u<<=1,this.readModule(0,l-1,s,l)&&(u|=1),u<<=1,this.readModule(1,l-1,s,l)&&(u|=1),u}readCorner3(s,l){let u=0;return this.readModule(s-1,0,s,l)&&(u|=1),u<<=1,this.readModule(s-1,l-1,s,l)&&(u|=1),u<<=1,this.readModule(0,l-3,s,l)&&(u|=1),u<<=1,this.readModule(0,l-2,s,l)&&(u|=1),u<<=1,this.readModule(0,l-1,s,l)&&(u|=1),u<<=1,this.readModule(1,l-3,s,l)&&(u|=1),u<<=1,this.readModule(1,l-2,s,l)&&(u|=1),u<<=1,this.readModule(1,l-1,s,l)&&(u|=1),u}readCorner4(s,l){let u=0;return this.readModule(s-3,0,s,l)&&(u|=1),u<<=1,this.readModule(s-2,0,s,l)&&(u|=1),u<<=1,this.readModule(s-1,0,s,l)&&(u|=1),u<<=1,this.readModule(0,l-2,s,l)&&(u|=1),u<<=1,this.readModule(0,l-1,s,l)&&(u|=1),u<<=1,this.readModule(1,l-1,s,l)&&(u|=1),u<<=1,this.readModule(2,l-1,s,l)&&(u|=1),u<<=1,this.readModule(3,l-1,s,l)&&(u|=1),u}extractDataRegion(s){const l=this.version.getSymbolSizeRows(),u=this.version.getSymbolSizeColumns();if(s.getHeight()!==l)throw new m("Dimension of bitMatrix must match the version size");const p=this.version.getDataRegionSizeRows(),g=this.version.getDataRegionSizeColumns(),x=l/p|0,y=u/g|0,C=x*p,O=y*g,D=new pe(O,C);for(let L=0;L<x;++L){const U=L*p;for(let J=0;J<y;++J){const ie=J*g;for(let oe=0;oe<p;++oe){const me=L*(p+2)+1+oe,_e=U+oe;for(let Le=0;Le<g;++Le){const Ue=J*(g+2)+1+Le;if(s.get(Ue,me)){const Pe=ie+Le;D.set(Pe,_e)}}}}}return D}}class ug{constructor(s,l){this.numDataCodewords=s,this.codewords=l}static getDataBlocks(s,l){const u=l.getECBlocks();let p=0;const g=u.getECBlocks();for(let oe of g)p+=oe.getCount();const x=new Array(p);let y=0;for(let oe of g)for(let me=0;me<oe.getCount();me++){const _e=oe.getDataCodewords(),Le=u.getECCodewords()+_e;x[y++]=new ug(_e,new Uint8Array(Le))}const O=x[0].codewords.length-u.getECCodewords(),D=O-1;let L=0;for(let oe=0;oe<D;oe++)for(let me=0;me<y;me++)x[me].codewords[oe]=s[L++];const U=l.getVersionNumber()===24,J=U?8:y;for(let oe=0;oe<J;oe++)x[oe].codewords[O-1]=s[L++];const ie=x[0].codewords.length;for(let oe=O;oe<ie;oe++)for(let me=0;me<y;me++){const _e=U?(me+8)%y:me,Le=U&&_e>7?oe-1:oe;x[_e].codewords[Le]=s[L++]}if(L!==s.length)throw new m;return x}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}class fg{constructor(s){this.bytes=s,this.byteOffset=0,this.bitOffset=0}getBitOffset(){return this.bitOffset}getByteOffset(){return this.byteOffset}readBits(s){if(s<1||s>32||s>this.available())throw new m(""+s);let l=0,u=this.bitOffset,p=this.byteOffset;const g=this.bytes;if(u>0){const x=8-u,y=s<x?s:x,C=x-y,O=255>>8-y<<C;l=(g[p]&O)>>C,s-=y,u+=y,u===8&&(u=0,p++)}if(s>0){for(;s>=8;)l=l<<8|g[p]&255,p++,s-=8;if(s>0){const x=8-s,y=255>>x<<x;l=l<<s|(g[p]&y)>>x,u+=s}}return this.bitOffset=u,this.byteOffset=p,l}available(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset}}var jr;(function(F){F[F.PAD_ENCODE=0]="PAD_ENCODE",F[F.ASCII_ENCODE=1]="ASCII_ENCODE",F[F.C40_ENCODE=2]="C40_ENCODE",F[F.TEXT_ENCODE=3]="TEXT_ENCODE",F[F.ANSIX12_ENCODE=4]="ANSIX12_ENCODE",F[F.EDIFACT_ENCODE=5]="EDIFACT_ENCODE",F[F.BASE256_ENCODE=6]="BASE256_ENCODE"})(jr||(jr={}));class js{static decode(s){const l=new fg(s),u=new de,p=new de,g=new Array;let x=jr.ASCII_ENCODE;do if(x===jr.ASCII_ENCODE)x=this.decodeAsciiSegment(l,u,p);else{switch(x){case jr.C40_ENCODE:this.decodeC40Segment(l,u);break;case jr.TEXT_ENCODE:this.decodeTextSegment(l,u);break;case jr.ANSIX12_ENCODE:this.decodeAnsiX12Segment(l,u);break;case jr.EDIFACT_ENCODE:this.decodeEdifactSegment(l,u);break;case jr.BASE256_ENCODE:this.decodeBase256Segment(l,u,g);break;default:throw new P}x=jr.ASCII_ENCODE}while(x!==jr.PAD_ENCODE&&l.available()>0);return p.length()>0&&u.append(p.toString()),new ce(s,u.toString(),g.length===0?null:g,null)}static decodeAsciiSegment(s,l,u){let p=!1;do{let g=s.readBits(8);if(g===0)throw new P;if(g<=128)return p&&(g+=128),l.append(String.fromCharCode(g-1)),jr.ASCII_ENCODE;if(g===129)return jr.PAD_ENCODE;if(g<=229){const x=g-130;x<10&&l.append("0"),l.append(""+x)}else switch(g){case 230:return jr.C40_ENCODE;case 231:return jr.BASE256_ENCODE;case 232:l.append("");break;case 233:case 234:break;case 235:p=!0;break;case 236:l.append("[)>05"),u.insert(0,"");break;case 237:l.append("[)>06"),u.insert(0,"");break;case 238:return jr.ANSIX12_ENCODE;case 239:return jr.TEXT_ENCODE;case 240:return jr.EDIFACT_ENCODE;case 241:break;default:if(g!==254||s.available()!==0)throw new P;break}}while(s.available()>0);return jr.ASCII_ENCODE}static decodeC40Segment(s,l){let u=!1;const p=[];let g=0;do{if(s.available()===8)return;const x=s.readBits(8);if(x===254)return;this.parseTwoBytes(x,s.readBits(8),p);for(let y=0;y<3;y++){const C=p[y];switch(g){case 0:if(C<3)g=C+1;else if(C<this.C40_BASIC_SET_CHARS.length){const O=this.C40_BASIC_SET_CHARS[C];u?(l.append(String.fromCharCode(O.charCodeAt(0)+128)),u=!1):l.append(O)}else throw new P;break;case 1:u?(l.append(String.fromCharCode(C+128)),u=!1):l.append(String.fromCharCode(C)),g=0;break;case 2:if(C<this.C40_SHIFT2_SET_CHARS.length){const O=this.C40_SHIFT2_SET_CHARS[C];u?(l.append(String.fromCharCode(O.charCodeAt(0)+128)),u=!1):l.append(O)}else switch(C){case 27:l.append("");break;case 30:u=!0;break;default:throw new P}g=0;break;case 3:u?(l.append(String.fromCharCode(C+224)),u=!1):l.append(String.fromCharCode(C+96)),g=0;break;default:throw new P}}}while(s.available()>0)}static decodeTextSegment(s,l){let u=!1,p=[],g=0;do{if(s.available()===8)return;const x=s.readBits(8);if(x===254)return;this.parseTwoBytes(x,s.readBits(8),p);for(let y=0;y<3;y++){const C=p[y];switch(g){case 0:if(C<3)g=C+1;else if(C<this.TEXT_BASIC_SET_CHARS.length){const O=this.TEXT_BASIC_SET_CHARS[C];u?(l.append(String.fromCharCode(O.charCodeAt(0)+128)),u=!1):l.append(O)}else throw new P;break;case 1:u?(l.append(String.fromCharCode(C+128)),u=!1):l.append(String.fromCharCode(C)),g=0;break;case 2:if(C<this.TEXT_SHIFT2_SET_CHARS.length){const O=this.TEXT_SHIFT2_SET_CHARS[C];u?(l.append(String.fromCharCode(O.charCodeAt(0)+128)),u=!1):l.append(O)}else switch(C){case 27:l.append("");break;case 30:u=!0;break;default:throw new P}g=0;break;case 3:if(C<this.TEXT_SHIFT3_SET_CHARS.length){const O=this.TEXT_SHIFT3_SET_CHARS[C];u?(l.append(String.fromCharCode(O.charCodeAt(0)+128)),u=!1):l.append(O),g=0}else throw new P;break;default:throw new P}}}while(s.available()>0)}static decodeAnsiX12Segment(s,l){const u=[];do{if(s.available()===8)return;const p=s.readBits(8);if(p===254)return;this.parseTwoBytes(p,s.readBits(8),u);for(let g=0;g<3;g++){const x=u[g];switch(x){case 0:l.append("\r");break;case 1:l.append("*");break;case 2:l.append(">");break;case 3:l.append(" ");break;default:if(x<14)l.append(String.fromCharCode(x+44));else if(x<40)l.append(String.fromCharCode(x+51));else throw new P;break}}}while(s.available()>0)}static parseTwoBytes(s,l,u){let p=(s<<8)+l-1,g=Math.floor(p/1600);u[0]=g,p-=g*1600,g=Math.floor(p/40),u[1]=g,u[2]=p-g*40}static decodeEdifactSegment(s,l){do{if(s.available()<=16)return;for(let u=0;u<4;u++){let p=s.readBits(6);if(p===31){const g=8-s.getBitOffset();g!==8&&s.readBits(g);return}p&32||(p|=64),l.append(String.fromCharCode(p))}}while(s.available()>0)}static decodeBase256Segment(s,l,u){let p=1+s.getByteOffset();const g=this.unrandomize255State(s.readBits(8),p++);let x;if(g===0?x=s.available()/8|0:g<250?x=g:x=250*(g-249)+this.unrandomize255State(s.readBits(8),p++),x<0)throw new P;const y=new Uint8Array(x);for(let C=0;C<x;C++){if(s.available()<8)throw new P;y[C]=this.unrandomize255State(s.readBits(8),p++)}u.push(y);try{l.append(ee.decode(y,V.ISO88591))}catch(C){throw new et("Platform does not support required encoding: "+C.message)}}static unrandomize255State(s,l){const u=149*l%255+1,p=s-u;return p>=0?p:p+256}}js.C40_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],js.C40_SHIFT2_SET_CHARS=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],js.TEXT_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],js.TEXT_SHIFT2_SET_CHARS=js.C40_SHIFT2_SET_CHARS,js.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~",""];class B5{constructor(){this.rsDecoder=new Ze(He.DATA_MATRIX_FIELD_256)}decode(s){const l=new mi(s),u=l.getVersion(),p=l.readCodewords(),g=ug.getDataBlocks(p,u);let x=0;for(let O of g)x+=O.getNumDataCodewords();const y=new Uint8Array(x),C=g.length;for(let O=0;O<C;O++){const D=g[O],L=D.getCodewords(),U=D.getNumDataCodewords();this.correctErrors(L,U);for(let J=0;J<U;J++)y[J*C+O]=L[J]}return js.decode(y)}correctErrors(s,l){const u=new Int32Array(s);try{this.rsDecoder.decode(u,s.length-l)}catch{throw new w}for(let p=0;p<l;p++)s[p]=u[p]}}class kr{constructor(s){this.image=s,this.rectangleDetector=new Qe(this.image)}detect(){const s=this.rectangleDetector.detect();let l=this.detectSolid1(s);if(l=this.detectSolid2(l),l[3]=this.correctTopRight(l),!l[3])throw new K;l=this.shiftToModuleCenter(l);const u=l[0],p=l[1],g=l[2],x=l[3];let y=this.transitionsBetween(u,x)+1,C=this.transitionsBetween(g,x)+1;(y&1)===1&&(y+=1),(C&1)===1&&(C+=1),4*y<7*C&&4*C<7*y&&(y=C=Math.max(y,C));let O=kr.sampleGrid(this.image,u,p,g,x,y,C);return new Pi(O,[u,p,g,x])}static shiftPoint(s,l,u){let p=(l.getX()-s.getX())/(u+1),g=(l.getY()-s.getY())/(u+1);return new $e(s.getX()+p,s.getY()+g)}static moveAway(s,l,u){let p=s.getX(),g=s.getY();return p<l?p-=1:p+=1,g<u?g-=1:g+=1,new $e(p,g)}detectSolid1(s){let l=s[0],u=s[1],p=s[3],g=s[2],x=this.transitionsBetween(l,u),y=this.transitionsBetween(u,p),C=this.transitionsBetween(p,g),O=this.transitionsBetween(g,l),D=x,L=[g,l,u,p];return D>y&&(D=y,L[0]=l,L[1]=u,L[2]=p,L[3]=g),D>C&&(D=C,L[0]=u,L[1]=p,L[2]=g,L[3]=l),D>O&&(L[0]=p,L[1]=g,L[2]=l,L[3]=u),L}detectSolid2(s){let l=s[0],u=s[1],p=s[2],g=s[3],x=this.transitionsBetween(l,g),y=kr.shiftPoint(u,p,(x+1)*4),C=kr.shiftPoint(p,u,(x+1)*4),O=this.transitionsBetween(y,l),D=this.transitionsBetween(C,g);return O<D?(s[0]=l,s[1]=u,s[2]=p,s[3]=g):(s[0]=u,s[1]=p,s[2]=g,s[3]=l),s}correctTopRight(s){let l=s[0],u=s[1],p=s[2],g=s[3],x=this.transitionsBetween(l,g),y=this.transitionsBetween(u,g),C=kr.shiftPoint(l,u,(y+1)*4),O=kr.shiftPoint(p,u,(x+1)*4);x=this.transitionsBetween(C,g),y=this.transitionsBetween(O,g);let D=new $e(g.getX()+(p.getX()-u.getX())/(x+1),g.getY()+(p.getY()-u.getY())/(x+1)),L=new $e(g.getX()+(l.getX()-u.getX())/(y+1),g.getY()+(l.getY()-u.getY())/(y+1));if(!this.isValid(D))return this.isValid(L)?L:null;if(!this.isValid(L))return D;let U=this.transitionsBetween(C,D)+this.transitionsBetween(O,D),J=this.transitionsBetween(C,L)+this.transitionsBetween(O,L);return U>J?D:L}shiftToModuleCenter(s){let l=s[0],u=s[1],p=s[2],g=s[3],x=this.transitionsBetween(l,g)+1,y=this.transitionsBetween(p,g)+1,C=kr.shiftPoint(l,u,y*4),O=kr.shiftPoint(p,u,x*4);x=this.transitionsBetween(C,g)+1,y=this.transitionsBetween(O,g)+1,(x&1)===1&&(x+=1),(y&1)===1&&(y+=1);let D=(l.getX()+u.getX()+p.getX()+g.getX())/4,L=(l.getY()+u.getY()+p.getY()+g.getY())/4;l=kr.moveAway(l,D,L),u=kr.moveAway(u,D,L),p=kr.moveAway(p,D,L),g=kr.moveAway(g,D,L);let U,J;return C=kr.shiftPoint(l,u,y*4),C=kr.shiftPoint(C,g,x*4),U=kr.shiftPoint(u,l,y*4),U=kr.shiftPoint(U,p,x*4),O=kr.shiftPoint(p,g,y*4),O=kr.shiftPoint(O,u,x*4),J=kr.shiftPoint(g,p,y*4),J=kr.shiftPoint(J,l,x*4),[C,U,O,J]}isValid(s){return s.getX()>=0&&s.getX()<this.image.getWidth()&&s.getY()>0&&s.getY()<this.image.getHeight()}static sampleGrid(s,l,u,p,g,x,y){return sr.getInstance().sampleGrid(s,x,y,.5,.5,x-.5,.5,x-.5,y-.5,.5,y-.5,l.getX(),l.getY(),g.getX(),g.getY(),p.getX(),p.getY(),u.getX(),u.getY())}transitionsBetween(s,l){let u=Math.trunc(s.getX()),p=Math.trunc(s.getY()),g=Math.trunc(l.getX()),x=Math.trunc(l.getY()),y=Math.abs(x-p)>Math.abs(g-u);if(y){let oe=u;u=p,p=oe,oe=g,g=x,x=oe}let C=Math.abs(g-u),O=Math.abs(x-p),D=-C/2,L=p<x?1:-1,U=u<g?1:-1,J=0,ie=this.image.get(y?p:u,y?u:p);for(let oe=u,me=p;oe!==g;oe+=U){let _e=this.image.get(y?me:oe,y?oe:me);if(_e!==ie&&(J++,ie=_e),D+=O,D>0){if(me===x)break;me+=L,D-=C}}return J}}class Us{constructor(){this.decoder=new B5}decode(s,l=null){let u,p;if(l!=null&&l.has(R.PURE_BARCODE)){const O=Us.extractPureBits(s.getBlackMatrix());u=this.decoder.decode(O),p=Us.NO_POINTS}else{const O=new kr(s.getBlackMatrix()).detect();u=this.decoder.decode(O.getBits()),p=O.getPoints()}const g=u.getRawBytes(),x=new ne(u.getText(),g,8*g.length,p,he.DATA_MATRIX,A.currentTimeMillis()),y=u.getByteSegments();y!=null&&x.putMetadata(De.BYTE_SEGMENTS,y);const C=u.getECLevel();return C!=null&&x.putMetadata(De.ERROR_CORRECTION_LEVEL,C),x}reset(){}static extractPureBits(s){const l=s.getTopLeftOnBit(),u=s.getBottomRightOnBit();if(l==null||u==null)throw new K;const p=this.moduleSize(l,s);let g=l[1];const x=u[1];let y=l[0];const O=(u[0]-y+1)/p,D=(x-g+1)/p;if(O<=0||D<=0)throw new K;const L=p/2;g+=L,y+=L;const U=new pe(O,D);for(let J=0;J<D;J++){const ie=g+J*p;for(let oe=0;oe<O;oe++)s.get(y+oe*p,ie)&&U.set(oe,J)}return U}static moduleSize(s,l){const u=l.getWidth();let p=s[0];const g=s[1];for(;p<u&&l.get(p,g);)p++;if(p===u)throw new K;const x=p-s[0];if(x===0)throw new K;return x}}Us.NO_POINTS=[];class j5 extends le{constructor(s=500){super(new Us,s)}}var Fl;(function(F){F[F.L=0]="L",F[F.M=1]="M",F[F.Q=2]="Q",F[F.H=3]="H"})(Fl||(Fl={}));class Kt{constructor(s,l,u){this.value=s,this.stringValue=l,this.bits=u,Kt.FOR_BITS.set(u,this),Kt.FOR_VALUE.set(s,this)}getValue(){return this.value}getBits(){return this.bits}static fromString(s){switch(s){case"L":return Kt.L;case"M":return Kt.M;case"Q":return Kt.Q;case"H":return Kt.H;default:throw new h(s+"not available")}}toString(){return this.stringValue}equals(s){if(!(s instanceof Kt))return!1;const l=s;return this.value===l.value}static forBits(s){if(s<0||s>=Kt.FOR_BITS.size)throw new m;return Kt.FOR_BITS.get(s)}}Kt.FOR_BITS=new Map,Kt.FOR_VALUE=new Map,Kt.L=new Kt(Fl.L,"L",1),Kt.M=new Kt(Fl.M,"M",0),Kt.Q=new Kt(Fl.Q,"Q",3),Kt.H=new Kt(Fl.H,"H",2);class bn{constructor(s){this.errorCorrectionLevel=Kt.forBits(s>>3&3),this.dataMask=s&7}static numBitsDiffering(s,l){return _.bitCount(s^l)}static decodeFormatInformation(s,l){const u=bn.doDecodeFormatInformation(s,l);return u!==null?u:bn.doDecodeFormatInformation(s^bn.FORMAT_INFO_MASK_QR,l^bn.FORMAT_INFO_MASK_QR)}static doDecodeFormatInformation(s,l){let u=Number.MAX_SAFE_INTEGER,p=0;for(const g of bn.FORMAT_INFO_DECODE_LOOKUP){const x=g[0];if(x===s||x===l)return new bn(g[1]);let y=bn.numBitsDiffering(s,x);y<u&&(p=g[1],u=y),s!==l&&(y=bn.numBitsDiffering(l,x),y<u&&(p=g[1],u=y))}return u<=3?new bn(p):null}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getDataMask(){return this.dataMask}hashCode(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask}equals(s){if(!(s instanceof bn))return!1;const l=s;return this.errorCorrectionLevel===l.errorCorrectionLevel&&this.dataMask===l.dataMask}}bn.FORMAT_INFO_MASK_QR=21522,bn.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])];class xe{constructor(s,...l){this.ecCodewordsPerBlock=s,this.ecBlocks=l}getECCodewordsPerBlock(){return this.ecCodewordsPerBlock}getNumBlocks(){let s=0;const l=this.ecBlocks;for(const u of l)s+=u.getCount();return s}getTotalECCodewords(){return this.ecCodewordsPerBlock*this.getNumBlocks()}getECBlocks(){return this.ecBlocks}}class Z{constructor(s,l){this.count=s,this.dataCodewords=l}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class tt{constructor(s,l,...u){this.versionNumber=s,this.alignmentPatternCenters=l,this.ecBlocks=u;let p=0;const g=u[0].getECCodewordsPerBlock(),x=u[0].getECBlocks();for(const y of x)p+=y.getCount()*(y.getDataCodewords()+g);this.totalCodewords=p}getVersionNumber(){return this.versionNumber}getAlignmentPatternCenters(){return this.alignmentPatternCenters}getTotalCodewords(){return this.totalCodewords}getDimensionForVersion(){return 17+4*this.versionNumber}getECBlocksForLevel(s){return this.ecBlocks[s.getValue()]}static getProvisionalVersionForDimension(s){if(s%4!==1)throw new P;try{return this.getVersionForNumber((s-17)/4)}catch{throw new P}}static getVersionForNumber(s){if(s<1||s>40)throw new m;return tt.VERSIONS[s-1]}static decodeVersionInformation(s){let l=Number.MAX_SAFE_INTEGER,u=0;for(let p=0;p<tt.VERSION_DECODE_INFO.length;p++){const g=tt.VERSION_DECODE_INFO[p];if(g===s)return tt.getVersionForNumber(p+7);const x=bn.numBitsDiffering(s,g);x<l&&(u=p+7,l=x)}return l<=3?tt.getVersionForNumber(u):null}buildFunctionPattern(){const s=this.getDimensionForVersion(),l=new pe(s);l.setRegion(0,0,9,9),l.setRegion(s-8,0,8,9),l.setRegion(0,s-8,9,8);const u=this.alignmentPatternCenters.length;for(let p=0;p<u;p++){const g=this.alignmentPatternCenters[p]-2;for(let x=0;x<u;x++)p===0&&(x===0||x===u-1)||p===u-1&&x===0||l.setRegion(this.alignmentPatternCenters[x]-2,g,5,5)}return l.setRegion(6,9,1,s-17),l.setRegion(9,6,s-17,1),this.versionNumber>6&&(l.setRegion(s-11,0,3,6),l.setRegion(0,s-11,6,3)),l}toString(){return""+this.versionNumber}}tt.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),tt.VERSIONS=[new tt(1,new Int32Array(0),new xe(7,new Z(1,19)),new xe(10,new Z(1,16)),new xe(13,new Z(1,13)),new xe(17,new Z(1,9))),new tt(2,Int32Array.from([6,18]),new xe(10,new Z(1,34)),new xe(16,new Z(1,28)),new xe(22,new Z(1,22)),new xe(28,new Z(1,16))),new tt(3,Int32Array.from([6,22]),new xe(15,new Z(1,55)),new xe(26,new Z(1,44)),new xe(18,new Z(2,17)),new xe(22,new Z(2,13))),new tt(4,Int32Array.from([6,26]),new xe(20,new Z(1,80)),new xe(18,new Z(2,32)),new xe(26,new Z(2,24)),new xe(16,new Z(4,9))),new tt(5,Int32Array.from([6,30]),new xe(26,new Z(1,108)),new xe(24,new Z(2,43)),new xe(18,new Z(2,15),new Z(2,16)),new xe(22,new Z(2,11),new Z(2,12))),new tt(6,Int32Array.from([6,34]),new xe(18,new Z(2,68)),new xe(16,new Z(4,27)),new xe(24,new Z(4,19)),new xe(28,new Z(4,15))),new tt(7,Int32Array.from([6,22,38]),new xe(20,new Z(2,78)),new xe(18,new Z(4,31)),new xe(18,new Z(2,14),new Z(4,15)),new xe(26,new Z(4,13),new Z(1,14))),new tt(8,Int32Array.from([6,24,42]),new xe(24,new Z(2,97)),new xe(22,new Z(2,38),new Z(2,39)),new xe(22,new Z(4,18),new Z(2,19)),new xe(26,new Z(4,14),new Z(2,15))),new tt(9,Int32Array.from([6,26,46]),new xe(30,new Z(2,116)),new xe(22,new Z(3,36),new Z(2,37)),new xe(20,new Z(4,16),new Z(4,17)),new xe(24,new Z(4,12),new Z(4,13))),new tt(10,Int32Array.from([6,28,50]),new xe(18,new Z(2,68),new Z(2,69)),new xe(26,new Z(4,43),new Z(1,44)),new xe(24,new Z(6,19),new Z(2,20)),new xe(28,new Z(6,15),new Z(2,16))),new tt(11,Int32Array.from([6,30,54]),new xe(20,new Z(4,81)),new xe(30,new Z(1,50),new Z(4,51)),new xe(28,new Z(4,22),new Z(4,23)),new xe(24,new Z(3,12),new Z(8,13))),new tt(12,Int32Array.from([6,32,58]),new xe(24,new Z(2,92),new Z(2,93)),new xe(22,new Z(6,36),new Z(2,37)),new xe(26,new Z(4,20),new Z(6,21)),new xe(28,new Z(7,14),new Z(4,15))),new tt(13,Int32Array.from([6,34,62]),new xe(26,new Z(4,107)),new xe(22,new Z(8,37),new Z(1,38)),new xe(24,new Z(8,20),new Z(4,21)),new xe(22,new Z(12,11),new Z(4,12))),new tt(14,Int32Array.from([6,26,46,66]),new xe(30,new Z(3,115),new Z(1,116)),new xe(24,new Z(4,40),new Z(5,41)),new xe(20,new Z(11,16),new Z(5,17)),new xe(24,new Z(11,12),new Z(5,13))),new tt(15,Int32Array.from([6,26,48,70]),new xe(22,new Z(5,87),new Z(1,88)),new xe(24,new Z(5,41),new Z(5,42)),new xe(30,new Z(5,24),new Z(7,25)),new xe(24,new Z(11,12),new Z(7,13))),new tt(16,Int32Array.from([6,26,50,74]),new xe(24,new Z(5,98),new Z(1,99)),new xe(28,new Z(7,45),new Z(3,46)),new xe(24,new Z(15,19),new Z(2,20)),new xe(30,new Z(3,15),new Z(13,16))),new tt(17,Int32Array.from([6,30,54,78]),new xe(28,new Z(1,107),new Z(5,108)),new xe(28,new Z(10,46),new Z(1,47)),new xe(28,new Z(1,22),new Z(15,23)),new xe(28,new Z(2,14),new Z(17,15))),new tt(18,Int32Array.from([6,30,56,82]),new xe(30,new Z(5,120),new Z(1,121)),new xe(26,new Z(9,43),new Z(4,44)),new xe(28,new Z(17,22),new Z(1,23)),new xe(28,new Z(2,14),new Z(19,15))),new tt(19,Int32Array.from([6,30,58,86]),new xe(28,new Z(3,113),new Z(4,114)),new xe(26,new Z(3,44),new Z(11,45)),new xe(26,new Z(17,21),new Z(4,22)),new xe(26,new Z(9,13),new Z(16,14))),new tt(20,Int32Array.from([6,34,62,90]),new xe(28,new Z(3,107),new Z(5,108)),new xe(26,new Z(3,41),new Z(13,42)),new xe(30,new Z(15,24),new Z(5,25)),new xe(28,new Z(15,15),new Z(10,16))),new tt(21,Int32Array.from([6,28,50,72,94]),new xe(28,new Z(4,116),new Z(4,117)),new xe(26,new Z(17,42)),new xe(28,new Z(17,22),new Z(6,23)),new xe(30,new Z(19,16),new Z(6,17))),new tt(22,Int32Array.from([6,26,50,74,98]),new xe(28,new Z(2,111),new Z(7,112)),new xe(28,new Z(17,46)),new xe(30,new Z(7,24),new Z(16,25)),new xe(24,new Z(34,13))),new tt(23,Int32Array.from([6,30,54,78,102]),new xe(30,new Z(4,121),new Z(5,122)),new xe(28,new Z(4,47),new Z(14,48)),new xe(30,new Z(11,24),new Z(14,25)),new xe(30,new Z(16,15),new Z(14,16))),new tt(24,Int32Array.from([6,28,54,80,106]),new xe(30,new Z(6,117),new Z(4,118)),new xe(28,new Z(6,45),new Z(14,46)),new xe(30,new Z(11,24),new Z(16,25)),new xe(30,new Z(30,16),new Z(2,17))),new tt(25,Int32Array.from([6,32,58,84,110]),new xe(26,new Z(8,106),new Z(4,107)),new xe(28,new Z(8,47),new Z(13,48)),new xe(30,new Z(7,24),new Z(22,25)),new xe(30,new Z(22,15),new Z(13,16))),new tt(26,Int32Array.from([6,30,58,86,114]),new xe(28,new Z(10,114),new Z(2,115)),new xe(28,new Z(19,46),new Z(4,47)),new xe(28,new Z(28,22),new Z(6,23)),new xe(30,new Z(33,16),new Z(4,17))),new tt(27,Int32Array.from([6,34,62,90,118]),new xe(30,new Z(8,122),new Z(4,123)),new xe(28,new Z(22,45),new Z(3,46)),new xe(30,new Z(8,23),new Z(26,24)),new xe(30,new Z(12,15),new Z(28,16))),new tt(28,Int32Array.from([6,26,50,74,98,122]),new xe(30,new Z(3,117),new Z(10,118)),new xe(28,new Z(3,45),new Z(23,46)),new xe(30,new Z(4,24),new Z(31,25)),new xe(30,new Z(11,15),new Z(31,16))),new tt(29,Int32Array.from([6,30,54,78,102,126]),new xe(30,new Z(7,116),new Z(7,117)),new xe(28,new Z(21,45),new Z(7,46)),new xe(30,new Z(1,23),new Z(37,24)),new xe(30,new Z(19,15),new Z(26,16))),new tt(30,Int32Array.from([6,26,52,78,104,130]),new xe(30,new Z(5,115),new Z(10,116)),new xe(28,new Z(19,47),new Z(10,48)),new xe(30,new Z(15,24),new Z(25,25)),new xe(30,new Z(23,15),new Z(25,16))),new tt(31,Int32Array.from([6,30,56,82,108,134]),new xe(30,new Z(13,115),new Z(3,116)),new xe(28,new Z(2,46),new Z(29,47)),new xe(30,new Z(42,24),new Z(1,25)),new xe(30,new Z(23,15),new Z(28,16))),new tt(32,Int32Array.from([6,34,60,86,112,138]),new xe(30,new Z(17,115)),new xe(28,new Z(10,46),new Z(23,47)),new xe(30,new Z(10,24),new Z(35,25)),new xe(30,new Z(19,15),new Z(35,16))),new tt(33,Int32Array.from([6,30,58,86,114,142]),new xe(30,new Z(17,115),new Z(1,116)),new xe(28,new Z(14,46),new Z(21,47)),new xe(30,new Z(29,24),new Z(19,25)),new xe(30,new Z(11,15),new Z(46,16))),new tt(34,Int32Array.from([6,34,62,90,118,146]),new xe(30,new Z(13,115),new Z(6,116)),new xe(28,new Z(14,46),new Z(23,47)),new xe(30,new Z(44,24),new Z(7,25)),new xe(30,new Z(59,16),new Z(1,17))),new tt(35,Int32Array.from([6,30,54,78,102,126,150]),new xe(30,new Z(12,121),new Z(7,122)),new xe(28,new Z(12,47),new Z(26,48)),new xe(30,new Z(39,24),new Z(14,25)),new xe(30,new Z(22,15),new Z(41,16))),new tt(36,Int32Array.from([6,24,50,76,102,128,154]),new xe(30,new Z(6,121),new Z(14,122)),new xe(28,new Z(6,47),new Z(34,48)),new xe(30,new Z(46,24),new Z(10,25)),new xe(30,new Z(2,15),new Z(64,16))),new tt(37,Int32Array.from([6,28,54,80,106,132,158]),new xe(30,new Z(17,122),new Z(4,123)),new xe(28,new Z(29,46),new Z(14,47)),new xe(30,new Z(49,24),new Z(10,25)),new xe(30,new Z(24,15),new Z(46,16))),new tt(38,Int32Array.from([6,32,58,84,110,136,162]),new xe(30,new Z(4,122),new Z(18,123)),new xe(28,new Z(13,46),new Z(32,47)),new xe(30,new Z(48,24),new Z(14,25)),new xe(30,new Z(42,15),new Z(32,16))),new tt(39,Int32Array.from([6,26,54,82,110,138,166]),new xe(30,new Z(20,117),new Z(4,118)),new xe(28,new Z(40,47),new Z(7,48)),new xe(30,new Z(43,24),new Z(22,25)),new xe(30,new Z(10,15),new Z(67,16))),new tt(40,Int32Array.from([6,30,58,86,114,142,170]),new xe(30,new Z(19,118),new Z(6,119)),new xe(28,new Z(18,47),new Z(31,48)),new xe(30,new Z(34,24),new Z(34,25)),new xe(30,new Z(20,15),new Z(61,16)))];var Qr;(function(F){F[F.DATA_MASK_000=0]="DATA_MASK_000",F[F.DATA_MASK_001=1]="DATA_MASK_001",F[F.DATA_MASK_010=2]="DATA_MASK_010",F[F.DATA_MASK_011=3]="DATA_MASK_011",F[F.DATA_MASK_100=4]="DATA_MASK_100",F[F.DATA_MASK_101=5]="DATA_MASK_101",F[F.DATA_MASK_110=6]="DATA_MASK_110",F[F.DATA_MASK_111=7]="DATA_MASK_111"})(Qr||(Qr={}));class Mi{constructor(s,l){this.value=s,this.isMasked=l}unmaskBitMatrix(s,l){for(let u=0;u<l;u++)for(let p=0;p<l;p++)this.isMasked(u,p)&&s.flip(p,u)}}Mi.values=new Map([[Qr.DATA_MASK_000,new Mi(Qr.DATA_MASK_000,(F,s)=>(F+s&1)===0)],[Qr.DATA_MASK_001,new Mi(Qr.DATA_MASK_001,(F,s)=>(F&1)===0)],[Qr.DATA_MASK_010,new Mi(Qr.DATA_MASK_010,(F,s)=>s%3===0)],[Qr.DATA_MASK_011,new Mi(Qr.DATA_MASK_011,(F,s)=>(F+s)%3===0)],[Qr.DATA_MASK_100,new Mi(Qr.DATA_MASK_100,(F,s)=>(Math.floor(F/2)+Math.floor(s/3)&1)===0)],[Qr.DATA_MASK_101,new Mi(Qr.DATA_MASK_101,(F,s)=>F*s%6===0)],[Qr.DATA_MASK_110,new Mi(Qr.DATA_MASK_110,(F,s)=>F*s%6<3)],[Qr.DATA_MASK_111,new Mi(Qr.DATA_MASK_111,(F,s)=>(F+s+F*s%3&1)===0)]]);class U5{constructor(s){const l=s.getHeight();if(l<21||(l&3)!==1)throw new P;this.bitMatrix=s}readFormatInformation(){if(this.parsedFormatInfo!==null&&this.parsedFormatInfo!==void 0)return this.parsedFormatInfo;let s=0;for(let g=0;g<6;g++)s=this.copyBit(g,8,s);s=this.copyBit(7,8,s),s=this.copyBit(8,8,s),s=this.copyBit(8,7,s);for(let g=5;g>=0;g--)s=this.copyBit(8,g,s);const l=this.bitMatrix.getHeight();let u=0;const p=l-7;for(let g=l-1;g>=p;g--)u=this.copyBit(8,g,u);for(let g=l-8;g<l;g++)u=this.copyBit(g,8,u);if(this.parsedFormatInfo=bn.decodeFormatInformation(s,u),this.parsedFormatInfo!==null)return this.parsedFormatInfo;throw new P}readVersion(){if(this.parsedVersion!==null&&this.parsedVersion!==void 0)return this.parsedVersion;const s=this.bitMatrix.getHeight(),l=Math.floor((s-17)/4);if(l<=6)return tt.getVersionForNumber(l);let u=0;const p=s-11;for(let x=5;x>=0;x--)for(let y=s-9;y>=p;y--)u=this.copyBit(y,x,u);let g=tt.decodeVersionInformation(u);if(g!==null&&g.getDimensionForVersion()===s)return this.parsedVersion=g,g;u=0;for(let x=5;x>=0;x--)for(let y=s-9;y>=p;y--)u=this.copyBit(x,y,u);if(g=tt.decodeVersionInformation(u),g!==null&&g.getDimensionForVersion()===s)return this.parsedVersion=g,g;throw new P}copyBit(s,l,u){return(this.isMirror?this.bitMatrix.get(l,s):this.bitMatrix.get(s,l))?u<<1|1:u<<1}readCodewords(){const s=this.readFormatInformation(),l=this.readVersion(),u=Mi.values.get(s.getDataMask()),p=this.bitMatrix.getHeight();u.unmaskBitMatrix(this.bitMatrix,p);const g=l.buildFunctionPattern();let x=!0;const y=new Uint8Array(l.getTotalCodewords());let C=0,O=0,D=0;for(let L=p-1;L>0;L-=2){L===6&&L--;for(let U=0;U<p;U++){const J=x?p-1-U:U;for(let ie=0;ie<2;ie++)g.get(L-ie,J)||(D++,O<<=1,this.bitMatrix.get(L-ie,J)&&(O|=1),D===8&&(y[C++]=O,D=0,O=0))}x=!x}if(C!==l.getTotalCodewords())throw new P;return y}remask(){if(this.parsedFormatInfo===null)return;const s=Mi.values[this.parsedFormatInfo.getDataMask()],l=this.bitMatrix.getHeight();s.unmaskBitMatrix(this.bitMatrix,l)}setMirror(s){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=s}mirror(){const s=this.bitMatrix;for(let l=0,u=s.getWidth();l<u;l++)for(let p=l+1,g=s.getHeight();p<g;p++)s.get(l,p)!==s.get(p,l)&&(s.flip(p,l),s.flip(l,p))}}class dg{constructor(s,l){this.numDataCodewords=s,this.codewords=l}static getDataBlocks(s,l,u){if(s.length!==l.getTotalCodewords())throw new m;const p=l.getECBlocksForLevel(u);let g=0;const x=p.getECBlocks();for(const ie of x)g+=ie.getCount();const y=new Array(g);let C=0;for(const ie of x)for(let oe=0;oe<ie.getCount();oe++){const me=ie.getDataCodewords(),_e=p.getECCodewordsPerBlock()+me;y[C++]=new dg(me,new Uint8Array(_e))}const O=y[0].codewords.length;let D=y.length-1;for(;D>=0&&y[D].codewords.length!==O;)D--;D++;const L=O-p.getECCodewordsPerBlock();let U=0;for(let ie=0;ie<L;ie++)for(let oe=0;oe<C;oe++)y[oe].codewords[ie]=s[U++];for(let ie=D;ie<C;ie++)y[ie].codewords[L]=s[U++];const J=y[0].codewords.length;for(let ie=L;ie<J;ie++)for(let oe=0;oe<C;oe++){const me=oe<D?ie:ie+1;y[oe].codewords[me]=s[U++]}return y}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}var Fi;(function(F){F[F.TERMINATOR=0]="TERMINATOR",F[F.NUMERIC=1]="NUMERIC",F[F.ALPHANUMERIC=2]="ALPHANUMERIC",F[F.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",F[F.BYTE=4]="BYTE",F[F.ECI=5]="ECI",F[F.KANJI=6]="KANJI",F[F.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",F[F.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",F[F.HANZI=9]="HANZI"})(Fi||(Fi={}));class nt{constructor(s,l,u,p){this.value=s,this.stringValue=l,this.characterCountBitsForVersions=u,this.bits=p,nt.FOR_BITS.set(p,this),nt.FOR_VALUE.set(s,this)}static forBits(s){const l=nt.FOR_BITS.get(s);if(l===void 0)throw new m;return l}getCharacterCountBits(s){const l=s.getVersionNumber();let u;return l<=9?u=0:l<=26?u=1:u=2,this.characterCountBitsForVersions[u]}getValue(){return this.value}getBits(){return this.bits}equals(s){if(!(s instanceof nt))return!1;const l=s;return this.value===l.value}toString(){return this.stringValue}}nt.FOR_BITS=new Map,nt.FOR_VALUE=new Map,nt.TERMINATOR=new nt(Fi.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),nt.NUMERIC=new nt(Fi.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),nt.ALPHANUMERIC=new nt(Fi.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),nt.STRUCTURED_APPEND=new nt(Fi.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),nt.BYTE=new nt(Fi.BYTE,"BYTE",Int32Array.from([8,16,16]),4),nt.ECI=new nt(Fi.ECI,"ECI",Int32Array.from([0,0,0]),7),nt.KANJI=new nt(Fi.KANJI,"KANJI",Int32Array.from([8,10,12]),8),nt.FNC1_FIRST_POSITION=new nt(Fi.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),nt.FNC1_SECOND_POSITION=new nt(Fi.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),nt.HANZI=new nt(Fi.HANZI,"HANZI",Int32Array.from([8,10,12]),13);class dr{static decode(s,l,u,p){const g=new fg(s);let x=new de;const y=new Array;let C=-1,O=-1;try{let D=null,L=!1,U;do{if(g.available()<4)U=nt.TERMINATOR;else{const J=g.readBits(4);U=nt.forBits(J)}switch(U){case nt.TERMINATOR:break;case nt.FNC1_FIRST_POSITION:case nt.FNC1_SECOND_POSITION:L=!0;break;case nt.STRUCTURED_APPEND:if(g.available()<16)throw new P;C=g.readBits(8),O=g.readBits(8);break;case nt.ECI:const J=dr.parseECIValue(g);if(D=B.getCharacterSetECIByValue(J),D===null)throw new P;break;case nt.HANZI:const ie=g.readBits(4),oe=g.readBits(U.getCharacterCountBits(l));ie===dr.GB2312_SUBSET&&dr.decodeHanziSegment(g,x,oe);break;default:const me=g.readBits(U.getCharacterCountBits(l));switch(U){case nt.NUMERIC:dr.decodeNumericSegment(g,x,me);break;case nt.ALPHANUMERIC:dr.decodeAlphanumericSegment(g,x,me,L);break;case nt.BYTE:dr.decodeByteSegment(g,x,me,D,y,p);break;case nt.KANJI:dr.decodeKanjiSegment(g,x,me);break;default:throw new P}break}}while(U!==nt.TERMINATOR)}catch{throw new P}return new ce(s,x.toString(),y.length===0?null:y,u===null?null:u.toString(),C,O)}static decodeHanziSegment(s,l,u){if(u*13>s.available())throw new P;const p=new Uint8Array(2*u);let g=0;for(;u>0;){const x=s.readBits(13);let y=x/96<<8&4294967295|x%96;y<959?y+=41377:y+=42657,p[g]=y>>8&255,p[g+1]=y&255,g+=2,u--}try{l.append(ee.decode(p,V.GB2312))}catch(x){throw new P(x)}}static decodeKanjiSegment(s,l,u){if(u*13>s.available())throw new P;const p=new Uint8Array(2*u);let g=0;for(;u>0;){const x=s.readBits(13);let y=x/192<<8&4294967295|x%192;y<7936?y+=33088:y+=49472,p[g]=y>>8,p[g+1]=y,g+=2,u--}try{l.append(ee.decode(p,V.SHIFT_JIS))}catch(x){throw new P(x)}}static decodeByteSegment(s,l,u,p,g,x){if(8*u>s.available())throw new P;const y=new Uint8Array(u);for(let O=0;O<u;O++)y[O]=s.readBits(8);let C;p===null?C=V.guessEncoding(y,x):C=p.getName();try{l.append(ee.decode(y,C))}catch(O){throw new P(O)}g.push(y)}static toAlphaNumericChar(s){if(s>=dr.ALPHANUMERIC_CHARS.length)throw new P;return dr.ALPHANUMERIC_CHARS[s]}static decodeAlphanumericSegment(s,l,u,p){const g=l.length();for(;u>1;){if(s.available()<11)throw new P;const x=s.readBits(11);l.append(dr.toAlphaNumericChar(Math.floor(x/45))),l.append(dr.toAlphaNumericChar(x%45)),u-=2}if(u===1){if(s.available()<6)throw new P;l.append(dr.toAlphaNumericChar(s.readBits(6)))}if(p)for(let x=g;x<l.length();x++)l.charAt(x)==="%"&&(x<l.length()-1&&l.charAt(x+1)==="%"?l.deleteCharAt(x+1):l.setCharAt(x,""))}static decodeNumericSegment(s,l,u){for(;u>=3;){if(s.available()<10)throw new P;const p=s.readBits(10);if(p>=1e3)throw new P;l.append(dr.toAlphaNumericChar(Math.floor(p/100))),l.append(dr.toAlphaNumericChar(Math.floor(p/10)%10)),l.append(dr.toAlphaNumericChar(p%10)),u-=3}if(u===2){if(s.available()<7)throw new P;const p=s.readBits(7);if(p>=100)throw new P;l.append(dr.toAlphaNumericChar(Math.floor(p/10))),l.append(dr.toAlphaNumericChar(p%10))}else if(u===1){if(s.available()<4)throw new P;const p=s.readBits(4);if(p>=10)throw new P;l.append(dr.toAlphaNumericChar(p))}}static parseECIValue(s){const l=s.readBits(8);if(!(l&128))return l&127;if((l&192)===128){const u=s.readBits(8);return(l&63)<<8&4294967295|u}if((l&224)===192){const u=s.readBits(16);return(l&31)<<16&4294967295|u}throw new P}}dr.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",dr.GB2312_SUBSET=1;class dE{constructor(s){this.mirrored=s}isMirrored(){return this.mirrored}applyMirroredCorrection(s){if(!this.mirrored||s===null||s.length<3)return;const l=s[0];s[0]=s[2],s[2]=l}}class z5{constructor(){this.rsDecoder=new Ze(He.QR_CODE_FIELD_256)}decodeBooleanArray(s,l){return this.decodeBitMatrix(pe.parseFromBooleanArray(s),l)}decodeBitMatrix(s,l){const u=new U5(s);let p=null;try{return this.decodeBitMatrixParser(u,l)}catch(g){p=g}try{u.remask(),u.setMirror(!0),u.readVersion(),u.readFormatInformation(),u.mirror();const g=this.decodeBitMatrixParser(u,l);return g.setOther(new dE(!0)),g}catch(g){throw p!==null?p:g}}decodeBitMatrixParser(s,l){const u=s.readVersion(),p=s.readFormatInformation().getErrorCorrectionLevel(),g=s.readCodewords(),x=dg.getDataBlocks(g,u,p);let y=0;for(const D of x)y+=D.getNumDataCodewords();const C=new Uint8Array(y);let O=0;for(const D of x){const L=D.getCodewords(),U=D.getNumDataCodewords();this.correctErrors(L,U);for(let J=0;J<U;J++)C[O++]=L[J]}return dr.decode(C,u,p,l)}correctErrors(s,l){const u=new Int32Array(s);try{this.rsDecoder.decode(u,s.length-l)}catch{throw new w}for(let p=0;p<l;p++)s[p]=u[p]}}class hg extends $e{constructor(s,l,u){super(s,l),this.estimatedModuleSize=u}aboutEquals(s,l,u){if(Math.abs(l-this.getY())<=s&&Math.abs(u-this.getX())<=s){const p=Math.abs(s-this.estimatedModuleSize);return p<=1||p<=this.estimatedModuleSize}return!1}combineEstimate(s,l,u){const p=(this.getX()+l)/2,g=(this.getY()+s)/2,x=(this.estimatedModuleSize+u)/2;return new hg(p,g,x)}}class Mf{constructor(s,l,u,p,g,x,y){this.image=s,this.startX=l,this.startY=u,this.width=p,this.height=g,this.moduleSize=x,this.resultPointCallback=y,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}find(){const s=this.startX,l=this.height,u=this.width,p=s+u,g=this.startY+l/2,x=new Int32Array(3),y=this.image;for(let C=0;C<l;C++){const O=g+(C&1?-Math.floor((C+1)/2):Math.floor((C+1)/2));x[0]=0,x[1]=0,x[2]=0;let D=s;for(;D<p&&!y.get(D,O);)D++;let L=0;for(;D<p;){if(y.get(D,O))if(L===1)x[1]++;else if(L===2){if(this.foundPatternCross(x)){const U=this.handlePossibleCenter(x,O,D);if(U!==null)return U}x[0]=x[2],x[1]=1,x[2]=0,L=1}else x[++L]++;else L===1&&L++,x[L]++;D++}if(this.foundPatternCross(x)){const U=this.handlePossibleCenter(x,O,p);if(U!==null)return U}}if(this.possibleCenters.length!==0)return this.possibleCenters[0];throw new K}static centerFromEnd(s,l){return l-s[2]-s[1]/2}foundPatternCross(s){const l=this.moduleSize,u=l/2;for(let p=0;p<3;p++)if(Math.abs(l-s[p])>=u)return!1;return!0}crossCheckVertical(s,l,u,p){const g=this.image,x=g.getHeight(),y=this.crossCheckStateCount;y[0]=0,y[1]=0,y[2]=0;let C=s;for(;C>=0&&g.get(l,C)&&y[1]<=u;)y[1]++,C--;if(C<0||y[1]>u)return NaN;for(;C>=0&&!g.get(l,C)&&y[0]<=u;)y[0]++,C--;if(y[0]>u)return NaN;for(C=s+1;C<x&&g.get(l,C)&&y[1]<=u;)y[1]++,C++;if(C===x||y[1]>u)return NaN;for(;C<x&&!g.get(l,C)&&y[2]<=u;)y[2]++,C++;if(y[2]>u)return NaN;const O=y[0]+y[1]+y[2];return 5*Math.abs(O-p)>=2*p?NaN:this.foundPatternCross(y)?Mf.centerFromEnd(y,C):NaN}handlePossibleCenter(s,l,u){const p=s[0]+s[1]+s[2],g=Mf.centerFromEnd(s,u),x=this.crossCheckVertical(l,g,2*s[1],p);if(!isNaN(x)){const y=(s[0]+s[1]+s[2])/3;for(const O of this.possibleCenters)if(O.aboutEquals(y,x,g))return O.combineEstimate(x,g,y);const C=new hg(g,x,y);this.possibleCenters.push(C),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(C)}return null}}class pg extends $e{constructor(s,l,u,p){super(s,l),this.estimatedModuleSize=u,this.count=p,p===void 0&&(this.count=1)}getEstimatedModuleSize(){return this.estimatedModuleSize}getCount(){return this.count}aboutEquals(s,l,u){if(Math.abs(l-this.getY())<=s&&Math.abs(u-this.getX())<=s){const p=Math.abs(s-this.estimatedModuleSize);return p<=1||p<=this.estimatedModuleSize}return!1}combineEstimate(s,l,u){const p=this.count+1,g=(this.count*this.getX()+l)/p,x=(this.count*this.getY()+s)/p,y=(this.count*this.estimatedModuleSize+u)/p;return new pg(g,x,y,p)}}class W5{constructor(s){this.bottomLeft=s[0],this.topLeft=s[1],this.topRight=s[2]}getBottomLeft(){return this.bottomLeft}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}}class Jr{constructor(s,l){this.image=s,this.resultPointCallback=l,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=l}getImage(){return this.image}getPossibleCenters(){return this.possibleCenters}find(s){const l=s!=null&&s.get(R.TRY_HARDER)!==void 0,u=s!=null&&s.get(R.PURE_BARCODE)!==void 0,p=this.image,g=p.getHeight(),x=p.getWidth();let y=Math.floor(3*g/(4*Jr.MAX_MODULES));(y<Jr.MIN_SKIP||l)&&(y=Jr.MIN_SKIP);let C=!1;const O=new Int32Array(5);for(let L=y-1;L<g&&!C;L+=y){O[0]=0,O[1]=0,O[2]=0,O[3]=0,O[4]=0;let U=0;for(let J=0;J<x;J++)if(p.get(J,L))(U&1)===1&&U++,O[U]++;else if(U&1)O[U]++;else if(U===4)if(Jr.foundPatternCross(O)){if(this.handlePossibleCenter(O,L,J,u)===!0)if(y=2,this.hasSkipped===!0)C=this.haveMultiplyConfirmedCenters();else{const oe=this.findRowSkip();oe>O[2]&&(L+=oe-O[2]-y,J=x-1)}else{O[0]=O[2],O[1]=O[3],O[2]=O[4],O[3]=1,O[4]=0,U=3;continue}U=0,O[0]=0,O[1]=0,O[2]=0,O[3]=0,O[4]=0}else O[0]=O[2],O[1]=O[3],O[2]=O[4],O[3]=1,O[4]=0,U=3;else O[++U]++;Jr.foundPatternCross(O)&&this.handlePossibleCenter(O,L,x,u)===!0&&(y=O[0],this.hasSkipped&&(C=this.haveMultiplyConfirmedCenters()))}const D=this.selectBestPatterns();return $e.orderBestPatterns(D),new W5(D)}static centerFromEnd(s,l){return l-s[4]-s[3]-s[2]/2}static foundPatternCross(s){let l=0;for(let g=0;g<5;g++){const x=s[g];if(x===0)return!1;l+=x}if(l<7)return!1;const u=l/7,p=u/2;return Math.abs(u-s[0])<p&&Math.abs(u-s[1])<p&&Math.abs(3*u-s[2])<3*p&&Math.abs(u-s[3])<p&&Math.abs(u-s[4])<p}getCrossCheckStateCount(){const s=this.crossCheckStateCount;return s[0]=0,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s}crossCheckDiagonal(s,l,u,p){const g=this.getCrossCheckStateCount();let x=0;const y=this.image;for(;s>=x&&l>=x&&y.get(l-x,s-x);)g[2]++,x++;if(s<x||l<x)return!1;for(;s>=x&&l>=x&&!y.get(l-x,s-x)&&g[1]<=u;)g[1]++,x++;if(s<x||l<x||g[1]>u)return!1;for(;s>=x&&l>=x&&y.get(l-x,s-x)&&g[0]<=u;)g[0]++,x++;if(g[0]>u)return!1;const C=y.getHeight(),O=y.getWidth();for(x=1;s+x<C&&l+x<O&&y.get(l+x,s+x);)g[2]++,x++;if(s+x>=C||l+x>=O)return!1;for(;s+x<C&&l+x<O&&!y.get(l+x,s+x)&&g[3]<u;)g[3]++,x++;if(s+x>=C||l+x>=O||g[3]>=u)return!1;for(;s+x<C&&l+x<O&&y.get(l+x,s+x)&&g[4]<u;)g[4]++,x++;if(g[4]>=u)return!1;const D=g[0]+g[1]+g[2]+g[3]+g[4];return Math.abs(D-p)<2*p&&Jr.foundPatternCross(g)}crossCheckVertical(s,l,u,p){const g=this.image,x=g.getHeight(),y=this.getCrossCheckStateCount();let C=s;for(;C>=0&&g.get(l,C);)y[2]++,C--;if(C<0)return NaN;for(;C>=0&&!g.get(l,C)&&y[1]<=u;)y[1]++,C--;if(C<0||y[1]>u)return NaN;for(;C>=0&&g.get(l,C)&&y[0]<=u;)y[0]++,C--;if(y[0]>u)return NaN;for(C=s+1;C<x&&g.get(l,C);)y[2]++,C++;if(C===x)return NaN;for(;C<x&&!g.get(l,C)&&y[3]<u;)y[3]++,C++;if(C===x||y[3]>=u)return NaN;for(;C<x&&g.get(l,C)&&y[4]<u;)y[4]++,C++;if(y[4]>=u)return NaN;const O=y[0]+y[1]+y[2]+y[3]+y[4];return 5*Math.abs(O-p)>=2*p?NaN:Jr.foundPatternCross(y)?Jr.centerFromEnd(y,C):NaN}crossCheckHorizontal(s,l,u,p){const g=this.image,x=g.getWidth(),y=this.getCrossCheckStateCount();let C=s;for(;C>=0&&g.get(C,l);)y[2]++,C--;if(C<0)return NaN;for(;C>=0&&!g.get(C,l)&&y[1]<=u;)y[1]++,C--;if(C<0||y[1]>u)return NaN;for(;C>=0&&g.get(C,l)&&y[0]<=u;)y[0]++,C--;if(y[0]>u)return NaN;for(C=s+1;C<x&&g.get(C,l);)y[2]++,C++;if(C===x)return NaN;for(;C<x&&!g.get(C,l)&&y[3]<u;)y[3]++,C++;if(C===x||y[3]>=u)return NaN;for(;C<x&&g.get(C,l)&&y[4]<u;)y[4]++,C++;if(y[4]>=u)return NaN;const O=y[0]+y[1]+y[2]+y[3]+y[4];return 5*Math.abs(O-p)>=p?NaN:Jr.foundPatternCross(y)?Jr.centerFromEnd(y,C):NaN}handlePossibleCenter(s,l,u,p){const g=s[0]+s[1]+s[2]+s[3]+s[4];let x=Jr.centerFromEnd(s,u),y=this.crossCheckVertical(l,Math.floor(x),s[2],g);if(!isNaN(y)&&(x=this.crossCheckHorizontal(Math.floor(x),Math.floor(y),s[2],g),!isNaN(x)&&(!p||this.crossCheckDiagonal(Math.floor(y),Math.floor(x),s[2],g)))){const C=g/7;let O=!1;const D=this.possibleCenters;for(let L=0,U=D.length;L<U;L++){const J=D[L];if(J.aboutEquals(C,y,x)){D[L]=J.combineEstimate(y,x,C),O=!0;break}}if(!O){const L=new pg(x,y,C);D.push(L),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(L)}return!0}return!1}findRowSkip(){if(this.possibleCenters.length<=1)return 0;let l=null;for(const u of this.possibleCenters)if(u.getCount()>=Jr.CENTER_QUORUM)if(l==null)l=u;else return this.hasSkipped=!0,Math.floor((Math.abs(l.getX()-u.getX())-Math.abs(l.getY()-u.getY()))/2);return 0}haveMultiplyConfirmedCenters(){let s=0,l=0;const u=this.possibleCenters.length;for(const x of this.possibleCenters)x.getCount()>=Jr.CENTER_QUORUM&&(s++,l+=x.getEstimatedModuleSize());if(s<3)return!1;const p=l/u;let g=0;for(const x of this.possibleCenters)g+=Math.abs(x.getEstimatedModuleSize()-p);return g<=.05*l}selectBestPatterns(){const s=this.possibleCenters.length;if(s<3)throw new K;const l=this.possibleCenters;let u;if(s>3){let p=0,g=0;for(const C of this.possibleCenters){const O=C.getEstimatedModuleSize();p+=O,g+=O*O}u=p/s;let x=Math.sqrt(g/s-u*u);l.sort((C,O)=>{const D=Math.abs(O.getEstimatedModuleSize()-u),L=Math.abs(C.getEstimatedModuleSize()-u);return D<L?-1:D>L?1:0});const y=Math.max(.2*u,x);for(let C=0;C<l.length&&l.length>3;C++){const O=l[C];Math.abs(O.getEstimatedModuleSize()-u)>y&&(l.splice(C,1),C--)}}if(l.length>3){let p=0;for(const g of l)p+=g.getEstimatedModuleSize();u=p/l.length,l.sort((g,x)=>{if(x.getCount()===g.getCount()){const y=Math.abs(x.getEstimatedModuleSize()-u),C=Math.abs(g.getEstimatedModuleSize()-u);return y<C?1:y>C?-1:0}else return x.getCount()-g.getCount()}),l.splice(3)}return[l[0],l[1],l[2]]}}Jr.CENTER_QUORUM=2,Jr.MIN_SKIP=3,Jr.MAX_MODULES=57;class lu{constructor(s){this.image=s}getImage(){return this.image}getResultPointCallback(){return this.resultPointCallback}detect(s){this.resultPointCallback=s==null?null:s.get(R.NEED_RESULT_POINT_CALLBACK);const u=new Jr(this.image,this.resultPointCallback).find(s);return this.processFinderPatternInfo(u)}processFinderPatternInfo(s){const l=s.getTopLeft(),u=s.getTopRight(),p=s.getBottomLeft(),g=this.calculateModuleSize(l,u,p);if(g<1)throw new K("No pattern found in proccess finder.");const x=lu.computeDimension(l,u,p,g),y=tt.getProvisionalVersionForDimension(x),C=y.getDimensionForVersion()-7;let O=null;if(y.getAlignmentPatternCenters().length>0){const J=u.getX()-l.getX()+p.getX(),ie=u.getY()-l.getY()+p.getY(),oe=1-3/C,me=Math.floor(l.getX()+oe*(J-l.getX())),_e=Math.floor(l.getY()+oe*(ie-l.getY()));for(let Le=4;Le<=16;Le<<=1)try{O=this.findAlignmentInRegion(g,me,_e,Le);break}catch(Ue){if(!(Ue instanceof K))throw Ue}}const D=lu.createTransform(l,u,p,O,x),L=lu.sampleGrid(this.image,D,x);let U;return O===null?U=[p,l,u]:U=[p,l,u,O],new Pi(L,U)}static createTransform(s,l,u,p,g){const x=g-3.5;let y,C,O,D;return p!==null?(y=p.getX(),C=p.getY(),O=x-3,D=O):(y=l.getX()-s.getX()+u.getX(),C=l.getY()-s.getY()+u.getY(),O=x,D=x),Rt.quadrilateralToQuadrilateral(3.5,3.5,x,3.5,O,D,3.5,x,s.getX(),s.getY(),l.getX(),l.getY(),y,C,u.getX(),u.getY())}static sampleGrid(s,l,u){return sr.getInstance().sampleGridWithTransform(s,u,u,l)}static computeDimension(s,l,u,p){const g=at.round($e.distance(s,l)/p),x=at.round($e.distance(s,u)/p);let y=Math.floor((g+x)/2)+7;switch(y&3){case 0:y++;break;case 2:y--;break;case 3:throw new K("Dimensions could be not found.")}return y}calculateModuleSize(s,l,u){return(this.calculateModuleSizeOneWay(s,l)+this.calculateModuleSizeOneWay(s,u))/2}calculateModuleSizeOneWay(s,l){const u=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(s.getX()),Math.floor(s.getY()),Math.floor(l.getX()),Math.floor(l.getY())),p=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(l.getX()),Math.floor(l.getY()),Math.floor(s.getX()),Math.floor(s.getY()));return isNaN(u)?p/7:isNaN(p)?u/7:(u+p)/14}sizeOfBlackWhiteBlackRunBothWays(s,l,u,p){let g=this.sizeOfBlackWhiteBlackRun(s,l,u,p),x=1,y=s-(u-s);y<0?(x=s/(s-y),y=0):y>=this.image.getWidth()&&(x=(this.image.getWidth()-1-s)/(y-s),y=this.image.getWidth()-1);let C=Math.floor(l-(p-l)*x);return x=1,C<0?(x=l/(l-C),C=0):C>=this.image.getHeight()&&(x=(this.image.getHeight()-1-l)/(C-l),C=this.image.getHeight()-1),y=Math.floor(s+(y-s)*x),g+=this.sizeOfBlackWhiteBlackRun(s,l,y,C),g-1}sizeOfBlackWhiteBlackRun(s,l,u,p){const g=Math.abs(p-l)>Math.abs(u-s);if(g){let J=s;s=l,l=J,J=u,u=p,p=J}const x=Math.abs(u-s),y=Math.abs(p-l);let C=-x/2;const O=s<u?1:-1,D=l<p?1:-1;let L=0;const U=u+O;for(let J=s,ie=l;J!==U;J+=O){const oe=g?ie:J,me=g?J:ie;if(L===1===this.image.get(oe,me)){if(L===2)return at.distance(J,ie,s,l);L++}if(C+=y,C>0){if(ie===p)break;ie+=D,C-=x}}return L===2?at.distance(u+O,p,s,l):NaN}findAlignmentInRegion(s,l,u,p){const g=Math.floor(p*s),x=Math.max(0,l-g),y=Math.min(this.image.getWidth()-1,l+g);if(y-x<s*3)throw new K("Alignment top exceeds estimated module size.");const C=Math.max(0,u-g),O=Math.min(this.image.getHeight()-1,u+g);if(O-C<s*3)throw new K("Alignment bottom exceeds estimated module size.");return new Mf(this.image,x,C,y-x,O-C,s,this.resultPointCallback).find()}}class zs{constructor(){this.decoder=new z5}getDecoder(){return this.decoder}decode(s,l){let u,p;if(l!=null&&l.get(R.PURE_BARCODE)!==void 0){const C=zs.extractPureBits(s.getBlackMatrix());u=this.decoder.decodeBitMatrix(C,l),p=zs.NO_POINTS}else{const C=new lu(s.getBlackMatrix()).detect(l);u=this.decoder.decodeBitMatrix(C.getBits(),l),p=C.getPoints()}u.getOther()instanceof dE&&u.getOther().applyMirroredCorrection(p);const g=new ne(u.getText(),u.getRawBytes(),void 0,p,he.QR_CODE,void 0),x=u.getByteSegments();x!==null&&g.putMetadata(De.BYTE_SEGMENTS,x);const y=u.getECLevel();return y!==null&&g.putMetadata(De.ERROR_CORRECTION_LEVEL,y),u.hasStructuredAppend()&&(g.putMetadata(De.STRUCTURED_APPEND_SEQUENCE,u.getStructuredAppendSequenceNumber()),g.putMetadata(De.STRUCTURED_APPEND_PARITY,u.getStructuredAppendParity())),g}reset(){}static extractPureBits(s){const l=s.getTopLeftOnBit(),u=s.getBottomRightOnBit();if(l===null||u===null)throw new K;const p=this.moduleSize(l,s);let g=l[1],x=u[1],y=l[0],C=u[0];if(y>=C||g>=x)throw new K;if(x-g!==C-y&&(C=y+(x-g),C>=s.getWidth()))throw new K;const O=Math.round((C-y+1)/p),D=Math.round((x-g+1)/p);if(O<=0||D<=0)throw new K;if(D!==O)throw new K;const L=Math.floor(p/2);g+=L,y+=L;const U=y+Math.floor((O-1)*p)-C;if(U>0){if(U>L)throw new K;y-=U}const J=g+Math.floor((D-1)*p)-x;if(J>0){if(J>L)throw new K;g-=J}const ie=new pe(O,D);for(let oe=0;oe<D;oe++){const me=g+Math.floor(oe*p);for(let _e=0;_e<O;_e++)s.get(y+Math.floor(_e*p),me)&&ie.set(_e,oe)}return ie}static moduleSize(s,l){const u=l.getHeight(),p=l.getWidth();let g=s[0],x=s[1],y=!0,C=0;for(;g<p&&x<u;){if(y!==l.get(g,x)){if(++C===5)break;y=!y}g++,x++}if(g===p||x===u)throw new K;return(g-s[0])/7}}zs.NO_POINTS=new Array;class st{PDF417Common(){}static getBitCountSum(s){return at.sum(s)}static toIntArray(s){if(s==null||!s.length)return st.EMPTY_INT_ARRAY;const l=new Int32Array(s.length);let u=0;for(const p of s)l[u++]=p;return l}static getCodeword(s){const l=T.binarySearch(st.SYMBOL_TABLE,s&262143);return l<0?-1:(st.CODEWORD_TABLE[l]-1)%st.NUMBER_OF_CODEWORDS}}st.NUMBER_OF_CODEWORDS=929,st.MAX_CODEWORDS_IN_BARCODE=st.NUMBER_OF_CODEWORDS-1,st.MIN_ROWS_IN_BARCODE=3,st.MAX_ROWS_IN_BARCODE=90,st.MODULES_IN_CODEWORD=17,st.MODULES_IN_STOP_PATTERN=18,st.BARS_IN_MODULE=8,st.EMPTY_INT_ARRAY=new Int32Array([]),st.SYMBOL_TABLE=Int32Array.from([66142,66170,66206,66236,66290,66292,66350,66382,66396,66454,66470,66476,66594,66600,66614,66626,66628,66632,66640,66654,66662,66668,66682,66690,66718,66720,66748,66758,66776,66798,66802,66804,66820,66824,66832,66846,66848,66876,66880,66936,66950,66956,66968,66992,67006,67022,67036,67042,67044,67048,67062,67118,67150,67164,67214,67228,67256,67294,67322,67350,67366,67372,67398,67404,67416,67438,67474,67476,67490,67492,67496,67510,67618,67624,67650,67656,67664,67678,67686,67692,67706,67714,67716,67728,67742,67744,67772,67782,67788,67800,67822,67826,67828,67842,67848,67870,67872,67900,67904,67960,67974,67992,68016,68030,68046,68060,68066,68068,68072,68086,68104,68112,68126,68128,68156,68160,68216,68336,68358,68364,68376,68400,68414,68448,68476,68494,68508,68536,68546,68548,68552,68560,68574,68582,68588,68654,68686,68700,68706,68708,68712,68726,68750,68764,68792,68802,68804,68808,68816,68830,68838,68844,68858,68878,68892,68920,68976,68990,68994,68996,69e3,69008,69022,69024,69052,69062,69068,69080,69102,69106,69108,69142,69158,69164,69190,69208,69230,69254,69260,69272,69296,69310,69326,69340,69386,69394,69396,69410,69416,69430,69442,69444,69448,69456,69470,69478,69484,69554,69556,69666,69672,69698,69704,69712,69726,69754,69762,69764,69776,69790,69792,69820,69830,69836,69848,69870,69874,69876,69890,69918,69920,69948,69952,70008,70022,70040,70064,70078,70094,70108,70114,70116,70120,70134,70152,70174,70176,70264,70384,70412,70448,70462,70496,70524,70542,70556,70584,70594,70600,70608,70622,70630,70636,70664,70672,70686,70688,70716,70720,70776,70896,71136,71180,71192,71216,71230,71264,71292,71360,71416,71452,71480,71536,71550,71554,71556,71560,71568,71582,71584,71612,71622,71628,71640,71662,71726,71732,71758,71772,71778,71780,71784,71798,71822,71836,71864,71874,71880,71888,71902,71910,71916,71930,71950,71964,71992,72048,72062,72066,72068,72080,72094,72096,72124,72134,72140,72152,72174,72178,72180,72206,72220,72248,72304,72318,72416,72444,72456,72464,72478,72480,72508,72512,72568,72588,72600,72624,72638,72654,72668,72674,72676,72680,72694,72726,72742,72748,72774,72780,72792,72814,72838,72856,72880,72894,72910,72924,72930,72932,72936,72950,72966,72972,72984,73008,73022,73056,73084,73102,73116,73144,73156,73160,73168,73182,73190,73196,73210,73226,73234,73236,73250,73252,73256,73270,73282,73284,73296,73310,73318,73324,73346,73348,73352,73360,73374,73376,73404,73414,73420,73432,73454,73498,73518,73522,73524,73550,73564,73570,73572,73576,73590,73800,73822,73858,73860,73872,73886,73888,73916,73944,73970,73972,73992,74014,74016,74044,74048,74104,74118,74136,74160,74174,74210,74212,74216,74230,74244,74256,74270,74272,74360,74480,74502,74508,74544,74558,74592,74620,74638,74652,74680,74690,74696,74704,74726,74732,74782,74784,74812,74992,75232,75288,75326,75360,75388,75456,75512,75576,75632,75646,75650,75652,75664,75678,75680,75708,75718,75724,75736,75758,75808,75836,75840,75896,76016,76256,76736,76824,76848,76862,76896,76924,76992,77048,77296,77340,77368,77424,77438,77536,77564,77572,77576,77584,77600,77628,77632,77688,77702,77708,77720,77744,77758,77774,77788,77870,77902,77916,77922,77928,77966,77980,78008,78018,78024,78032,78046,78060,78074,78094,78136,78192,78206,78210,78212,78224,78238,78240,78268,78278,78284,78296,78322,78324,78350,78364,78448,78462,78560,78588,78600,78622,78624,78652,78656,78712,78726,78744,78768,78782,78798,78812,78818,78820,78824,78838,78862,78876,78904,78960,78974,79072,79100,79296,79352,79368,79376,79390,79392,79420,79424,79480,79600,79628,79640,79664,79678,79712,79740,79772,79800,79810,79812,79816,79824,79838,79846,79852,79894,79910,79916,79942,79948,79960,79982,79988,80006,80024,80048,80062,80078,80092,80098,80100,80104,80134,80140,80176,80190,80224,80252,80270,80284,80312,80328,80336,80350,80358,80364,80378,80390,80396,80408,80432,80446,80480,80508,80576,80632,80654,80668,80696,80752,80766,80776,80784,80798,80800,80828,80844,80856,80878,80882,80884,80914,80916,80930,80932,80936,80950,80962,80968,80976,80990,80998,81004,81026,81028,81040,81054,81056,81084,81094,81100,81112,81134,81154,81156,81160,81168,81182,81184,81212,81216,81272,81286,81292,81304,81328,81342,81358,81372,81380,81384,81398,81434,81454,81458,81460,81486,81500,81506,81508,81512,81526,81550,81564,81592,81602,81604,81608,81616,81630,81638,81644,81702,81708,81722,81734,81740,81752,81774,81778,81780,82050,82078,82080,82108,82180,82184,82192,82206,82208,82236,82240,82296,82316,82328,82352,82366,82402,82404,82408,82440,82448,82462,82464,82492,82496,82552,82672,82694,82700,82712,82736,82750,82784,82812,82830,82882,82884,82888,82896,82918,82924,82952,82960,82974,82976,83004,83008,83064,83184,83424,83468,83480,83504,83518,83552,83580,83648,83704,83740,83768,83824,83838,83842,83844,83848,83856,83872,83900,83910,83916,83928,83950,83984,84e3,84028,84032,84088,84208,84448,84928,85040,85054,85088,85116,85184,85240,85488,85560,85616,85630,85728,85756,85764,85768,85776,85790,85792,85820,85824,85880,85894,85900,85912,85936,85966,85980,86048,86080,86136,86256,86496,86976,88160,88188,88256,88312,88560,89056,89200,89214,89312,89340,89536,89592,89608,89616,89632,89664,89720,89840,89868,89880,89904,89952,89980,89998,90012,90040,90190,90204,90254,90268,90296,90306,90308,90312,90334,90382,90396,90424,90480,90494,90500,90504,90512,90526,90528,90556,90566,90572,90584,90610,90612,90638,90652,90680,90736,90750,90848,90876,90884,90888,90896,90910,90912,90940,90944,91e3,91014,91020,91032,91056,91070,91086,91100,91106,91108,91112,91126,91150,91164,91192,91248,91262,91360,91388,91584,91640,91664,91678,91680,91708,91712,91768,91888,91928,91952,91966,92e3,92028,92046,92060,92088,92098,92100,92104,92112,92126,92134,92140,92188,92216,92272,92384,92412,92608,92664,93168,93200,93214,93216,93244,93248,93304,93424,93664,93720,93744,93758,93792,93820,93888,93944,93980,94008,94064,94078,94084,94088,94096,94110,94112,94140,94150,94156,94168,94246,94252,94278,94284,94296,94318,94342,94348,94360,94384,94398,94414,94428,94440,94470,94476,94488,94512,94526,94560,94588,94606,94620,94648,94658,94660,94664,94672,94686,94694,94700,94714,94726,94732,94744,94768,94782,94816,94844,94912,94968,94990,95004,95032,95088,95102,95112,95120,95134,95136,95164,95180,95192,95214,95218,95220,95244,95256,95280,95294,95328,95356,95424,95480,95728,95758,95772,95800,95856,95870,95968,95996,96008,96016,96030,96032,96060,96064,96120,96152,96176,96190,96220,96226,96228,96232,96290,96292,96296,96310,96322,96324,96328,96336,96350,96358,96364,96386,96388,96392,96400,96414,96416,96444,96454,96460,96472,96494,96498,96500,96514,96516,96520,96528,96542,96544,96572,96576,96632,96646,96652,96664,96688,96702,96718,96732,96738,96740,96744,96758,96772,96776,96784,96798,96800,96828,96832,96888,97008,97030,97036,97048,97072,97086,97120,97148,97166,97180,97208,97220,97224,97232,97246,97254,97260,97326,97330,97332,97358,97372,97378,97380,97384,97398,97422,97436,97464,97474,97476,97480,97488,97502,97510,97516,97550,97564,97592,97648,97666,97668,97672,97680,97694,97696,97724,97734,97740,97752,97774,97830,97836,97850,97862,97868,97880,97902,97906,97908,97926,97932,97944,97968,97998,98012,98018,98020,98024,98038,98618,98674,98676,98838,98854,98874,98892,98904,98926,98930,98932,98968,99006,99042,99044,99048,99062,99166,99194,99246,99286,99350,99366,99372,99386,99398,99416,99438,99442,99444,99462,99504,99518,99534,99548,99554,99556,99560,99574,99590,99596,99608,99632,99646,99680,99708,99726,99740,99768,99778,99780,99784,99792,99806,99814,99820,99834,99858,99860,99874,99880,99894,99906,99920,99934,99962,99970,99972,99976,99984,99998,1e5,100028,100038,100044,100056,100078,100082,100084,100142,100174,100188,100246,100262,100268,100306,100308,100390,100396,100410,100422,100428,100440,100462,100466,100468,100486,100504,100528,100542,100558,100572,100578,100580,100584,100598,100620,100656,100670,100704,100732,100750,100792,100802,100808,100816,100830,100838,100844,100858,100888,100912,100926,100960,100988,101056,101112,101148,101176,101232,101246,101250,101252,101256,101264,101278,101280,101308,101318,101324,101336,101358,101362,101364,101410,101412,101416,101430,101442,101448,101456,101470,101478,101498,101506,101508,101520,101534,101536,101564,101580,101618,101620,101636,101640,101648,101662,101664,101692,101696,101752,101766,101784,101838,101858,101860,101864,101934,101938,101940,101966,101980,101986,101988,101992,102030,102044,102072,102082,102084,102088,102096,102138,102166,102182,102188,102214,102220,102232,102254,102282,102290,102292,102306,102308,102312,102326,102444,102458,102470,102476,102488,102514,102516,102534,102552,102576,102590,102606,102620,102626,102632,102646,102662,102668,102704,102718,102752,102780,102798,102812,102840,102850,102856,102864,102878,102886,102892,102906,102936,102974,103008,103036,103104,103160,103224,103280,103294,103298,103300,103312,103326,103328,103356,103366,103372,103384,103406,103410,103412,103472,103486,103520,103548,103616,103672,103920,103992,104048,104062,104160,104188,104194,104196,104200,104208,104224,104252,104256,104312,104326,104332,104344,104368,104382,104398,104412,104418,104420,104424,104482,104484,104514,104520,104528,104542,104550,104570,104578,104580,104592,104606,104608,104636,104652,104690,104692,104706,104712,104734,104736,104764,104768,104824,104838,104856,104910,104930,104932,104936,104968,104976,104990,104992,105020,105024,105080,105200,105240,105278,105312,105372,105410,105412,105416,105424,105446,105518,105524,105550,105564,105570,105572,105576,105614,105628,105656,105666,105672,105680,105702,105722,105742,105756,105784,105840,105854,105858,105860,105864,105872,105888,105932,105970,105972,106006,106022,106028,106054,106060,106072,106100,106118,106124,106136,106160,106174,106190,106210,106212,106216,106250,106258,106260,106274,106276,106280,106306,106308,106312,106320,106334,106348,106394,106414,106418,106420,106566,106572,106610,106612,106630,106636,106648,106672,106686,106722,106724,106728,106742,106758,106764,106776,106800,106814,106848,106876,106894,106908,106936,106946,106948,106952,106960,106974,106982,106988,107032,107056,107070,107104,107132,107200,107256,107292,107320,107376,107390,107394,107396,107400,107408,107422,107424,107452,107462,107468,107480,107502,107506,107508,107544,107568,107582,107616,107644,107712,107768,108016,108060,108088,108144,108158,108256,108284,108290,108292,108296,108304,108318,108320,108348,108352,108408,108422,108428,108440,108464,108478,108494,108508,108514,108516,108520,108592,108640,108668,108736,108792,109040,109536,109680,109694,109792,109820,110016,110072,110084,110088,110096,110112,110140,110144,110200,110320,110342,110348,110360,110384,110398,110432,110460,110478,110492,110520,110532,110536,110544,110558,110658,110686,110714,110722,110724,110728,110736,110750,110752,110780,110796,110834,110836,110850,110852,110856,110864,110878,110880,110908,110912,110968,110982,111e3,111054,111074,111076,111080,111108,111112,111120,111134,111136,111164,111168,111224,111344,111372,111422,111456,111516,111554,111556,111560,111568,111590,111632,111646,111648,111676,111680,111736,111856,112096,112152,112224,112252,112320,112440,112514,112516,112520,112528,112542,112544,112588,112686,112718,112732,112782,112796,112824,112834,112836,112840,112848,112870,112890,112910,112924,112952,113008,113022,113026,113028,113032,113040,113054,113056,113100,113138,113140,113166,113180,113208,113264,113278,113376,113404,113416,113424,113440,113468,113472,113560,113614,113634,113636,113640,113686,113702,113708,113734,113740,113752,113778,113780,113798,113804,113816,113840,113854,113870,113890,113892,113896,113926,113932,113944,113968,113982,114016,114044,114076,114114,114116,114120,114128,114150,114170,114194,114196,114210,114212,114216,114242,114244,114248,114256,114270,114278,114306,114308,114312,114320,114334,114336,114364,114380,114420,114458,114478,114482,114484,114510,114524,114530,114532,114536,114842,114866,114868,114970,114994,114996,115042,115044,115048,115062,115130,115226,115250,115252,115278,115292,115298,115300,115304,115318,115342,115394,115396,115400,115408,115422,115430,115436,115450,115478,115494,115514,115526,115532,115570,115572,115738,115758,115762,115764,115790,115804,115810,115812,115816,115830,115854,115868,115896,115906,115912,115920,115934,115942,115948,115962,115996,116024,116080,116094,116098,116100,116104,116112,116126,116128,116156,116166,116172,116184,116206,116210,116212,116246,116262,116268,116282,116294,116300,116312,116334,116338,116340,116358,116364,116376,116400,116414,116430,116444,116450,116452,116456,116498,116500,116514,116520,116534,116546,116548,116552,116560,116574,116582,116588,116602,116654,116694,116714,116762,116782,116786,116788,116814,116828,116834,116836,116840,116854,116878,116892,116920,116930,116936,116944,116958,116966,116972,116986,117006,117048,117104,117118,117122,117124,117136,117150,117152,117180,117190,117196,117208,117230,117234,117236,117304,117360,117374,117472,117500,117506,117508,117512,117520,117536,117564,117568,117624,117638,117644,117656,117680,117694,117710,117724,117730,117732,117736,117750,117782,117798,117804,117818,117830,117848,117874,117876,117894,117936,117950,117966,117986,117988,117992,118022,118028,118040,118064,118078,118112,118140,118172,118210,118212,118216,118224,118238,118246,118266,118306,118312,118338,118352,118366,118374,118394,118402,118404,118408,118416,118430,118432,118460,118476,118514,118516,118574,118578,118580,118606,118620,118626,118628,118632,118678,118694,118700,118730,118738,118740,118830,118834,118836,118862,118876,118882,118884,118888,118902,118926,118940,118968,118978,118980,118984,118992,119006,119014,119020,119034,119068,119096,119152,119166,119170,119172,119176,119184,119198,119200,119228,119238,119244,119256,119278,119282,119284,119324,119352,119408,119422,119520,119548,119554,119556,119560,119568,119582,119584,119612,119616,119672,119686,119692,119704,119728,119742,119758,119772,119778,119780,119784,119798,119920,119934,120032,120060,120256,120312,120324,120328,120336,120352,120384,120440,120560,120582,120588,120600,120624,120638,120672,120700,120718,120732,120760,120770,120772,120776,120784,120798,120806,120812,120870,120876,120890,120902,120908,120920,120946,120948,120966,120972,120984,121008,121022,121038,121058,121060,121064,121078,121100,121112,121136,121150,121184,121212,121244,121282,121284,121288,121296,121318,121338,121356,121368,121392,121406,121440,121468,121536,121592,121656,121730,121732,121736,121744,121758,121760,121804,121842,121844,121890,121922,121924,121928,121936,121950,121958,121978,121986,121988,121992,122e3,122014,122016,122044,122060,122098,122100,122116,122120,122128,122142,122144,122172,122176,122232,122246,122264,122318,122338,122340,122344,122414,122418,122420,122446,122460,122466,122468,122472,122510,122524,122552,122562,122564,122568,122576,122598,122618,122646,122662,122668,122694,122700,122712,122738,122740,122762,122770,122772,122786,122788,122792,123018,123026,123028,123042,123044,123048,123062,123098,123146,123154,123156,123170,123172,123176,123190,123202,123204,123208,123216,123238,123244,123258,123290,123314,123316,123402,123410,123412,123426,123428,123432,123446,123458,123464,123472,123486,123494,123500,123514,123522,123524,123528,123536,123552,123580,123590,123596,123608,123630,123634,123636,123674,123698,123700,123740,123746,123748,123752,123834,123914,123922,123924,123938,123944,123958,123970,123976,123984,123998,124006,124012,124026,124034,124036,124048,124062,124064,124092,124102,124108,124120,124142,124146,124148,124162,124164,124168,124176,124190,124192,124220,124224,124280,124294,124300,124312,124336,124350,124366,124380,124386,124388,124392,124406,124442,124462,124466,124468,124494,124508,124514,124520,124558,124572,124600,124610,124612,124616,124624,124646,124666,124694,124710,124716,124730,124742,124748,124760,124786,124788,124818,124820,124834,124836,124840,124854,124946,124948,124962,124964,124968,124982,124994,124996,125e3,125008,125022,125030,125036,125050,125058,125060,125064,125072,125086,125088,125116,125126,125132,125144,125166,125170,125172,125186,125188,125192,125200,125216,125244,125248,125304,125318,125324,125336,125360,125374,125390,125404,125410,125412,125416,125430,125444,125448,125456,125472,125504,125560,125680,125702,125708,125720,125744,125758,125792,125820,125838,125852,125880,125890,125892,125896,125904,125918,125926,125932,125978,125998,126002,126004,126030,126044,126050,126052,126056,126094,126108,126136,126146,126148,126152,126160,126182,126202,126222,126236,126264,126320,126334,126338,126340,126344,126352,126366,126368,126412,126450,126452,126486,126502,126508,126522,126534,126540,126552,126574,126578,126580,126598,126604,126616,126640,126654,126670,126684,126690,126692,126696,126738,126754,126756,126760,126774,126786,126788,126792,126800,126814,126822,126828,126842,126894,126898,126900,126934,127126,127142,127148,127162,127178,127186,127188,127254,127270,127276,127290,127302,127308,127320,127342,127346,127348,127370,127378,127380,127394,127396,127400,127450,127510,127526,127532,127546,127558,127576,127598,127602,127604,127622,127628,127640,127664,127678,127694,127708,127714,127716,127720,127734,127754,127762,127764,127778,127784,127810,127812,127816,127824,127838,127846,127866,127898,127918,127922,127924,128022,128038,128044,128058,128070,128076,128088,128110,128114,128116,128134,128140,128152,128176,128190,128206,128220,128226,128228,128232,128246,128262,128268,128280,128304,128318,128352,128380,128398,128412,128440,128450,128452,128456,128464,128478,128486,128492,128506,128522,128530,128532,128546,128548,128552,128566,128578,128580,128584,128592,128606,128614,128634,128642,128644,128648,128656,128670,128672,128700,128716,128754,128756,128794,128814,128818,128820,128846,128860,128866,128868,128872,128886,128918,128934,128940,128954,128978,128980,129178,129198,129202,129204,129238,129258,129306,129326,129330,129332,129358,129372,129378,129380,129384,129398,129430,129446,129452,129466,129482,129490,129492,129562,129582,129586,129588,129614,129628,129634,129636,129640,129654,129678,129692,129720,129730,129732,129736,129744,129758,129766,129772,129814,129830,129836,129850,129862,129868,129880,129902,129906,129908,129930,129938,129940,129954,129956,129960,129974,130010]),st.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2e3,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1e3,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700]);class V5{constructor(s,l){this.bits=s,this.points=l}getBits(){return this.bits}getPoints(){return this.points}}class pt{static detectMultiple(s,l,u){let p=s.getBlackMatrix(),g=pt.detect(u,p);return g.length||(p=p.clone(),p.rotate180(),g=pt.detect(u,p)),new V5(p,g)}static detect(s,l){const u=new Array;let p=0,g=0,x=!1;for(;p<l.getHeight();){const y=pt.findVertices(l,p,g);if(y[0]==null&&y[3]==null){if(!x)break;x=!1,g=0;for(const C of u)C[1]!=null&&(p=Math.trunc(Math.max(p,C[1].getY()))),C[3]!=null&&(p=Math.max(p,Math.trunc(C[3].getY())));p+=pt.ROW_STEP;continue}if(x=!0,u.push(y),!s)break;y[2]!=null?(g=Math.trunc(y[2].getX()),p=Math.trunc(y[2].getY())):(g=Math.trunc(y[4].getX()),p=Math.trunc(y[4].getY()))}return u}static findVertices(s,l,u){const p=s.getHeight(),g=s.getWidth(),x=new Array(8);return pt.copyToResult(x,pt.findRowsWithPattern(s,p,g,l,u,pt.START_PATTERN),pt.INDEXES_START_PATTERN),x[4]!=null&&(u=Math.trunc(x[4].getX()),l=Math.trunc(x[4].getY())),pt.copyToResult(x,pt.findRowsWithPattern(s,p,g,l,u,pt.STOP_PATTERN),pt.INDEXES_STOP_PATTERN),x}static copyToResult(s,l,u){for(let p=0;p<u.length;p++)s[u[p]]=l[p]}static findRowsWithPattern(s,l,u,p,g,x){const y=new Array(4);let C=!1;const O=new Int32Array(x.length);for(;p<l;p+=pt.ROW_STEP){let L=pt.findGuardPattern(s,g,p,u,!1,x,O);if(L!=null){for(;p>0;){const U=pt.findGuardPattern(s,g,--p,u,!1,x,O);if(U!=null)L=U;else{p++;break}}y[0]=new $e(L[0],p),y[1]=new $e(L[1],p),C=!0;break}}let D=p+1;if(C){let L=0,U=Int32Array.from([Math.trunc(y[0].getX()),Math.trunc(y[1].getX())]);for(;D<l;D++){const J=pt.findGuardPattern(s,U[0],D,u,!1,x,O);if(J!=null&&Math.abs(U[0]-J[0])<pt.MAX_PATTERN_DRIFT&&Math.abs(U[1]-J[1])<pt.MAX_PATTERN_DRIFT)U=J,L=0;else{if(L>pt.SKIPPED_ROW_COUNT_MAX)break;L++}}D-=L+1,y[2]=new $e(U[0],D),y[3]=new $e(U[1],D)}return D-p<pt.BARCODE_MIN_HEIGHT&&T.fill(y,null),y}static findGuardPattern(s,l,u,p,g,x,y){T.fillWithin(y,0,y.length,0);let C=l,O=0;for(;s.get(C,u)&&C>0&&O++<pt.MAX_PIXEL_DRIFT;)C--;let D=C,L=0,U=x.length;for(let J=g;D<p;D++)if(s.get(D,u)!==J)y[L]++;else{if(L===U-1){if(pt.patternMatchVariance(y,x,pt.MAX_INDIVIDUAL_VARIANCE)<pt.MAX_AVG_VARIANCE)return new Int32Array([C,D]);C+=y[0]+y[1],A.arraycopy(y,2,y,0,L-1),y[L-1]=0,y[L]=0,L--}else L++;y[L]=1,J=!J}return L===U-1&&pt.patternMatchVariance(y,x,pt.MAX_INDIVIDUAL_VARIANCE)<pt.MAX_AVG_VARIANCE?new Int32Array([C,D-1]):null}static patternMatchVariance(s,l,u){let p=s.length,g=0,x=0;for(let O=0;O<p;O++)g+=s[O],x+=l[O];if(g<x)return 1/0;let y=g/x;u*=y;let C=0;for(let O=0;O<p;O++){let D=s[O],L=l[O]*y,U=D>L?D-L:L-D;if(U>u)return 1/0;C+=U}return C/g}}pt.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]),pt.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]),pt.MAX_AVG_VARIANCE=.42,pt.MAX_INDIVIDUAL_VARIANCE=.8,pt.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]),pt.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]),pt.MAX_PIXEL_DRIFT=3,pt.MAX_PATTERN_DRIFT=5,pt.SKIPPED_ROW_COUNT_MAX=25,pt.ROW_STEP=5,pt.BARCODE_MIN_HEIGHT=10;class hn{constructor(s,l){if(l.length===0)throw new m;this.field=s;let u=l.length;if(u>1&&l[0]===0){let p=1;for(;p<u&&l[p]===0;)p++;p===u?this.coefficients=new Int32Array([0]):(this.coefficients=new Int32Array(u-p),A.arraycopy(l,p,this.coefficients,0,this.coefficients.length))}else this.coefficients=l}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(s){return this.coefficients[this.coefficients.length-1-s]}evaluateAt(s){if(s===0)return this.getCoefficient(0);if(s===1){let p=0;for(let g of this.coefficients)p=this.field.add(p,g);return p}let l=this.coefficients[0],u=this.coefficients.length;for(let p=1;p<u;p++)l=this.field.add(this.field.multiply(s,l),this.coefficients[p]);return l}add(s){if(!this.field.equals(s.field))throw new m("ModulusPolys do not have same ModulusGF field");if(this.isZero())return s;if(s.isZero())return this;let l=this.coefficients,u=s.coefficients;if(l.length>u.length){let x=l;l=u,u=x}let p=new Int32Array(u.length),g=u.length-l.length;A.arraycopy(u,0,p,0,g);for(let x=g;x<u.length;x++)p[x]=this.field.add(l[x-g],u[x]);return new hn(this.field,p)}subtract(s){if(!this.field.equals(s.field))throw new m("ModulusPolys do not have same ModulusGF field");return s.isZero()?this:this.add(s.negative())}multiply(s){return s instanceof hn?this.multiplyOther(s):this.multiplyScalar(s)}multiplyOther(s){if(!this.field.equals(s.field))throw new m("ModulusPolys do not have same ModulusGF field");if(this.isZero()||s.isZero())return new hn(this.field,new Int32Array([0]));let l=this.coefficients,u=l.length,p=s.coefficients,g=p.length,x=new Int32Array(u+g-1);for(let y=0;y<u;y++){let C=l[y];for(let O=0;O<g;O++)x[y+O]=this.field.add(x[y+O],this.field.multiply(C,p[O]))}return new hn(this.field,x)}negative(){let s=this.coefficients.length,l=new Int32Array(s);for(let u=0;u<s;u++)l[u]=this.field.subtract(0,this.coefficients[u]);return new hn(this.field,l)}multiplyScalar(s){if(s===0)return new hn(this.field,new Int32Array([0]));if(s===1)return this;let l=this.coefficients.length,u=new Int32Array(l);for(let p=0;p<l;p++)u[p]=this.field.multiply(this.coefficients[p],s);return new hn(this.field,u)}multiplyByMonomial(s,l){if(s<0)throw new m;if(l===0)return new hn(this.field,new Int32Array([0]));let u=this.coefficients.length,p=new Int32Array(u+s);for(let g=0;g<u;g++)p[g]=this.field.multiply(this.coefficients[g],l);return new hn(this.field,p)}toString(){let s=new de;for(let l=this.getDegree();l>=0;l--){let u=this.getCoefficient(l);u!==0&&(u<0?(s.append(" - "),u=-u):s.length()>0&&s.append(" + "),(l===0||u!==1)&&s.append(u),l!==0&&(l===1?s.append("x"):(s.append("x^"),s.append(l))))}return s.toString()}}class H5{add(s,l){return(s+l)%this.modulus}subtract(s,l){return(this.modulus+s-l)%this.modulus}exp(s){return this.expTable[s]}log(s){if(s===0)throw new m;return this.logTable[s]}inverse(s){if(s===0)throw new W;return this.expTable[this.modulus-this.logTable[s]-1]}multiply(s,l){return s===0||l===0?0:this.expTable[(this.logTable[s]+this.logTable[l])%(this.modulus-1)]}getSize(){return this.modulus}equals(s){return s===this}}class gg extends H5{constructor(s,l){super(),this.modulus=s,this.expTable=new Int32Array(s),this.logTable=new Int32Array(s);let u=1;for(let p=0;p<s;p++)this.expTable[p]=u,u=u*l%s;for(let p=0;p<s-1;p++)this.logTable[this.expTable[p]]=p;this.zero=new hn(this,new Int32Array([0])),this.one=new hn(this,new Int32Array([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(s,l){if(s<0)throw new m;if(l===0)return this.zero;let u=new Int32Array(s+1);return u[0]=l,new hn(this,u)}}gg.PDF417_GF=new gg(st.NUMBER_OF_CODEWORDS,3);class hE{constructor(){this.field=gg.PDF417_GF}decode(s,l,u){let p=new hn(this.field,s),g=new Int32Array(l),x=!1;for(let ie=l;ie>0;ie--){let oe=p.evaluateAt(this.field.exp(ie));g[l-ie]=oe,oe!==0&&(x=!0)}if(!x)return 0;let y=this.field.getOne();if(u!=null)for(const ie of u){let oe=this.field.exp(s.length-1-ie),me=new hn(this.field,new Int32Array([this.field.subtract(0,oe),1]));y=y.multiply(me)}let C=new hn(this.field,g),O=this.runEuclideanAlgorithm(this.field.buildMonomial(l,1),C,l),D=O[0],L=O[1],U=this.findErrorLocations(D),J=this.findErrorMagnitudes(L,D,U);for(let ie=0;ie<U.length;ie++){let oe=s.length-1-this.field.log(U[ie]);if(oe<0)throw w.getChecksumInstance();s[oe]=this.field.subtract(s[oe],J[ie])}return U.length}runEuclideanAlgorithm(s,l,u){if(s.getDegree()<l.getDegree()){let U=s;s=l,l=U}let p=s,g=l,x=this.field.getZero(),y=this.field.getOne();for(;g.getDegree()>=Math.round(u/2);){let U=p,J=x;if(p=g,x=y,p.isZero())throw w.getChecksumInstance();g=U;let ie=this.field.getZero(),oe=p.getCoefficient(p.getDegree()),me=this.field.inverse(oe);for(;g.getDegree()>=p.getDegree()&&!g.isZero();){let _e=g.getDegree()-p.getDegree(),Le=this.field.multiply(g.getCoefficient(g.getDegree()),me);ie=ie.add(this.field.buildMonomial(_e,Le)),g=g.subtract(p.multiplyByMonomial(_e,Le))}y=ie.multiply(x).subtract(J).negative()}let C=y.getCoefficient(0);if(C===0)throw w.getChecksumInstance();let O=this.field.inverse(C),D=y.multiply(O),L=g.multiply(O);return[D,L]}findErrorLocations(s){let l=s.getDegree(),u=new Int32Array(l),p=0;for(let g=1;g<this.field.getSize()&&p<l;g++)s.evaluateAt(g)===0&&(u[p]=this.field.inverse(g),p++);if(p!==l)throw w.getChecksumInstance();return u}findErrorMagnitudes(s,l,u){let p=l.getDegree(),g=new Int32Array(p);for(let O=1;O<=p;O++)g[p-O]=this.field.multiply(O,l.getCoefficient(O));let x=new hn(this.field,g),y=u.length,C=new Int32Array(y);for(let O=0;O<y;O++){let D=this.field.inverse(u[O]),L=this.field.subtract(0,s.evaluateAt(D)),U=this.field.inverse(x.evaluateAt(D));C[O]=this.field.multiply(L,U)}return C}}class Po{constructor(s,l,u,p,g){s instanceof Po?this.constructor_2(s):this.constructor_1(s,l,u,p,g)}constructor_1(s,l,u,p,g){const x=l==null||u==null,y=p==null||g==null;if(x&&y)throw new K;x?(l=new $e(0,p.getY()),u=new $e(0,g.getY())):y&&(p=new $e(s.getWidth()-1,l.getY()),g=new $e(s.getWidth()-1,u.getY())),this.image=s,this.topLeft=l,this.bottomLeft=u,this.topRight=p,this.bottomRight=g,this.minX=Math.trunc(Math.min(l.getX(),u.getX())),this.maxX=Math.trunc(Math.max(p.getX(),g.getX())),this.minY=Math.trunc(Math.min(l.getY(),p.getY())),this.maxY=Math.trunc(Math.max(u.getY(),g.getY()))}constructor_2(s){this.image=s.image,this.topLeft=s.getTopLeft(),this.bottomLeft=s.getBottomLeft(),this.topRight=s.getTopRight(),this.bottomRight=s.getBottomRight(),this.minX=s.getMinX(),this.maxX=s.getMaxX(),this.minY=s.getMinY(),this.maxY=s.getMaxY()}static merge(s,l){return s==null?l:l==null?s:new Po(s.image,s.topLeft,s.bottomLeft,l.topRight,l.bottomRight)}addMissingRows(s,l,u){let p=this.topLeft,g=this.bottomLeft,x=this.topRight,y=this.bottomRight;if(s>0){let C=u?this.topLeft:this.topRight,O=Math.trunc(C.getY()-s);O<0&&(O=0);let D=new $e(C.getX(),O);u?p=D:x=D}if(l>0){let C=u?this.bottomLeft:this.bottomRight,O=Math.trunc(C.getY()+l);O>=this.image.getHeight()&&(O=this.image.getHeight()-1);let D=new $e(C.getX(),O);u?g=D:y=D}return new Po(this.image,p,g,x,y)}getMinX(){return this.minX}getMaxX(){return this.maxX}getMinY(){return this.minY}getMaxY(){return this.maxY}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}getBottomLeft(){return this.bottomLeft}getBottomRight(){return this.bottomRight}}class G5{constructor(s,l,u,p){this.columnCount=s,this.errorCorrectionLevel=p,this.rowCountUpperPart=l,this.rowCountLowerPart=u,this.rowCount=l+u}getColumnCount(){return this.columnCount}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getRowCount(){return this.rowCount}getRowCountUpperPart(){return this.rowCountUpperPart}getRowCountLowerPart(){return this.rowCountLowerPart}}class cu{constructor(){this.buffer=""}static form(s,l){let u=-1;function p(x,y,C,O,D,L){if(x==="%%")return"%";if(l[++u]===void 0)return;x=O?parseInt(O.substr(1)):void 0;let U=D?parseInt(D.substr(1)):void 0,J;switch(L){case"s":J=l[u];break;case"c":J=l[u][0];break;case"f":J=parseFloat(l[u]).toFixed(x);break;case"p":J=parseFloat(l[u]).toPrecision(x);break;case"e":J=parseFloat(l[u]).toExponential(x);break;case"x":J=parseInt(l[u]).toString(U||16);break;case"d":J=parseFloat(parseInt(l[u],U||10).toPrecision(x)).toFixed(0);break}J=typeof J=="object"?JSON.stringify(J):(+J).toString(U);let ie=parseInt(C),oe=C&&C[0]+""=="0"?"0":" ";for(;J.length<ie;)J=y!==void 0?J+oe:oe+J;return J}let g=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return s.replace(g,p)}format(s,...l){this.buffer+=cu.form(s,l)}toString(){return this.buffer}}class uu{constructor(s){this.boundingBox=new Po(s),this.codewords=new Array(s.getMaxY()-s.getMinY()+1)}getCodewordNearby(s){let l=this.getCodeword(s);if(l!=null)return l;for(let u=1;u<uu.MAX_NEARBY_DISTANCE;u++){let p=this.imageRowToCodewordIndex(s)-u;if(p>=0&&(l=this.codewords[p],l!=null)||(p=this.imageRowToCodewordIndex(s)+u,p<this.codewords.length&&(l=this.codewords[p],l!=null)))return l}return null}imageRowToCodewordIndex(s){return s-this.boundingBox.getMinY()}setCodeword(s,l){this.codewords[this.imageRowToCodewordIndex(s)]=l}getCodeword(s){return this.codewords[this.imageRowToCodewordIndex(s)]}getBoundingBox(){return this.boundingBox}getCodewords(){return this.codewords}toString(){const s=new cu;let l=0;for(const u of this.codewords){if(u==null){s.format("%3d:    |   %n",l++);continue}s.format("%3d: %3d|%3d%n",l++,u.getRowNumber(),u.getValue())}return s.toString()}}uu.MAX_NEARBY_DISTANCE=5;class fu{constructor(){this.values=new Map}setValue(s){s=Math.trunc(s);let l=this.values.get(s);l==null&&(l=0),l++,this.values.set(s,l)}getValue(){let s=-1,l=new Array;for(const[u,p]of this.values.entries()){const g={getKey:()=>u,getValue:()=>p};g.getValue()>s?(s=g.getValue(),l=[],l.push(g.getKey())):g.getValue()===s&&l.push(g.getKey())}return st.toIntArray(l)}getConfidence(s){return this.values.get(s)}}class pE extends uu{constructor(s,l){super(s),this._isLeft=l}setRowNumbers(){for(let s of this.getCodewords())s!=null&&s.setRowNumberAsRowIndicatorColumn()}adjustCompleteIndicatorColumnRowNumbers(s){let l=this.getCodewords();this.setRowNumbers(),this.removeIncorrectCodewords(l,s);let u=this.getBoundingBox(),p=this._isLeft?u.getTopLeft():u.getTopRight(),g=this._isLeft?u.getBottomLeft():u.getBottomRight(),x=this.imageRowToCodewordIndex(Math.trunc(p.getY())),y=this.imageRowToCodewordIndex(Math.trunc(g.getY())),C=-1,O=1,D=0;for(let L=x;L<y;L++){if(l[L]==null)continue;let U=l[L],J=U.getRowNumber()-C;if(J===0)D++;else if(J===1)O=Math.max(O,D),D=1,C=U.getRowNumber();else if(J<0||U.getRowNumber()>=s.getRowCount()||J>L)l[L]=null;else{let ie;O>2?ie=(O-2)*J:ie=J;let oe=ie>=L;for(let me=1;me<=ie&&!oe;me++)oe=l[L-me]!=null;oe?l[L]=null:(C=U.getRowNumber(),D=1)}}}getRowHeights(){let s=this.getBarcodeMetadata();if(s==null)return null;this.adjustIncompleteIndicatorColumnRowNumbers(s);let l=new Int32Array(s.getRowCount());for(let u of this.getCodewords())if(u!=null){let p=u.getRowNumber();if(p>=l.length)continue;l[p]++}return l}adjustIncompleteIndicatorColumnRowNumbers(s){let l=this.getBoundingBox(),u=this._isLeft?l.getTopLeft():l.getTopRight(),p=this._isLeft?l.getBottomLeft():l.getBottomRight(),g=this.imageRowToCodewordIndex(Math.trunc(u.getY())),x=this.imageRowToCodewordIndex(Math.trunc(p.getY())),y=this.getCodewords(),C=-1;for(let O=g;O<x;O++){if(y[O]==null)continue;let D=y[O];D.setRowNumberAsRowIndicatorColumn();let L=D.getRowNumber()-C;L===0||(L===1?C=D.getRowNumber():D.getRowNumber()>=s.getRowCount()?y[O]=null:C=D.getRowNumber())}}getBarcodeMetadata(){let s=this.getCodewords(),l=new fu,u=new fu,p=new fu,g=new fu;for(let y of s){if(y==null)continue;y.setRowNumberAsRowIndicatorColumn();let C=y.getValue()%30,O=y.getRowNumber();switch(this._isLeft||(O+=2),O%3){case 0:u.setValue(C*3+1);break;case 1:g.setValue(C/3),p.setValue(C%3);break;case 2:l.setValue(C+1);break}}if(l.getValue().length===0||u.getValue().length===0||p.getValue().length===0||g.getValue().length===0||l.getValue()[0]<1||u.getValue()[0]+p.getValue()[0]<st.MIN_ROWS_IN_BARCODE||u.getValue()[0]+p.getValue()[0]>st.MAX_ROWS_IN_BARCODE)return null;let x=new G5(l.getValue()[0],u.getValue()[0],p.getValue()[0],g.getValue()[0]);return this.removeIncorrectCodewords(s,x),x}removeIncorrectCodewords(s,l){for(let u=0;u<s.length;u++){let p=s[u];if(s[u]==null)continue;let g=p.getValue()%30,x=p.getRowNumber();if(x>l.getRowCount()){s[u]=null;continue}switch(this._isLeft||(x+=2),x%3){case 0:g*3+1!==l.getRowCountUpperPart()&&(s[u]=null);break;case 1:(Math.trunc(g/3)!==l.getErrorCorrectionLevel()||g%3!==l.getRowCountLowerPart())&&(s[u]=null);break;case 2:g+1!==l.getColumnCount()&&(s[u]=null);break}}}isLeft(){return this._isLeft}toString(){return"IsLeft: "+this._isLeft+`
`+super.toString()}}class du{constructor(s,l){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=s,this.barcodeColumnCount=s.getColumnCount(),this.boundingBox=l,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}getDetectionResultColumns(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);let s=st.MAX_CODEWORDS_IN_BARCODE,l;do l=s,s=this.adjustRowNumbersAndGetCount();while(s>0&&s<l);return this.detectionResultColumns}adjustIndicatorColumnRowNumbers(s){s!=null&&s.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)}adjustRowNumbersAndGetCount(){let s=this.adjustRowNumbersByRow();if(s===0)return 0;for(let l=1;l<this.barcodeColumnCount+1;l++){let u=this.detectionResultColumns[l].getCodewords();for(let p=0;p<u.length;p++)u[p]!=null&&(u[p].hasValidRowNumber()||this.adjustRowNumbers(l,p,u))}return s}adjustRowNumbersByRow(){return this.adjustRowNumbersFromBothRI(),this.adjustRowNumbersFromLRI()+this.adjustRowNumbersFromRRI()}adjustRowNumbersFromBothRI(){if(this.detectionResultColumns[0]==null||this.detectionResultColumns[this.barcodeColumnCount+1]==null)return;let s=this.detectionResultColumns[0].getCodewords(),l=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let u=0;u<s.length;u++)if(s[u]!=null&&l[u]!=null&&s[u].getRowNumber()===l[u].getRowNumber())for(let p=1;p<=this.barcodeColumnCount;p++){let g=this.detectionResultColumns[p].getCodewords()[u];g!=null&&(g.setRowNumber(s[u].getRowNumber()),g.hasValidRowNumber()||(this.detectionResultColumns[p].getCodewords()[u]=null))}}adjustRowNumbersFromRRI(){if(this.detectionResultColumns[this.barcodeColumnCount+1]==null)return 0;let s=0,l=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let u=0;u<l.length;u++){if(l[u]==null)continue;let p=l[u].getRowNumber(),g=0;for(let x=this.barcodeColumnCount+1;x>0&&g<this.ADJUST_ROW_NUMBER_SKIP;x--){let y=this.detectionResultColumns[x].getCodewords()[u];y!=null&&(g=du.adjustRowNumberIfValid(p,g,y),y.hasValidRowNumber()||s++)}}return s}adjustRowNumbersFromLRI(){if(this.detectionResultColumns[0]==null)return 0;let s=0,l=this.detectionResultColumns[0].getCodewords();for(let u=0;u<l.length;u++){if(l[u]==null)continue;let p=l[u].getRowNumber(),g=0;for(let x=1;x<this.barcodeColumnCount+1&&g<this.ADJUST_ROW_NUMBER_SKIP;x++){let y=this.detectionResultColumns[x].getCodewords()[u];y!=null&&(g=du.adjustRowNumberIfValid(p,g,y),y.hasValidRowNumber()||s++)}}return s}static adjustRowNumberIfValid(s,l,u){return u==null||u.hasValidRowNumber()||(u.isValidRowNumber(s)?(u.setRowNumber(s),l=0):++l),l}adjustRowNumbers(s,l,u){if(!this.detectionResultColumns[s-1])return;let p=u[l],g=this.detectionResultColumns[s-1].getCodewords(),x=g;this.detectionResultColumns[s+1]!=null&&(x=this.detectionResultColumns[s+1].getCodewords());let y=new Array(14);y[2]=g[l],y[3]=x[l],l>0&&(y[0]=u[l-1],y[4]=g[l-1],y[5]=x[l-1]),l>1&&(y[8]=u[l-2],y[10]=g[l-2],y[11]=x[l-2]),l<u.length-1&&(y[1]=u[l+1],y[6]=g[l+1],y[7]=x[l+1]),l<u.length-2&&(y[9]=u[l+2],y[12]=g[l+2],y[13]=x[l+2]);for(let C of y)if(du.adjustRowNumber(p,C))return}static adjustRowNumber(s,l){return l==null?!1:l.hasValidRowNumber()&&l.getBucket()===s.getBucket()?(s.setRowNumber(l.getRowNumber()),!0):!1}getBarcodeColumnCount(){return this.barcodeColumnCount}getBarcodeRowCount(){return this.barcodeMetadata.getRowCount()}getBarcodeECLevel(){return this.barcodeMetadata.getErrorCorrectionLevel()}setBoundingBox(s){this.boundingBox=s}getBoundingBox(){return this.boundingBox}setDetectionResultColumn(s,l){this.detectionResultColumns[s]=l}getDetectionResultColumn(s){return this.detectionResultColumns[s]}toString(){let s=this.detectionResultColumns[0];s==null&&(s=this.detectionResultColumns[this.barcodeColumnCount+1]);let l=new cu;for(let u=0;u<s.getCodewords().length;u++){l.format("CW %3d:",u);for(let p=0;p<this.barcodeColumnCount+2;p++){if(this.detectionResultColumns[p]==null){l.format("    |   ");continue}let g=this.detectionResultColumns[p].getCodewords()[u];if(g==null){l.format("    |   ");continue}l.format(" %3d|%3d",g.getRowNumber(),g.getValue())}l.format("%n")}return l.toString()}}class hu{constructor(s,l,u,p){this.rowNumber=hu.BARCODE_ROW_UNKNOWN,this.startX=Math.trunc(s),this.endX=Math.trunc(l),this.bucket=Math.trunc(u),this.value=Math.trunc(p)}hasValidRowNumber(){return this.isValidRowNumber(this.rowNumber)}isValidRowNumber(s){return s!==hu.BARCODE_ROW_UNKNOWN&&this.bucket===s%3*3}setRowNumberAsRowIndicatorColumn(){this.rowNumber=Math.trunc(Math.trunc(this.value/30)*3+Math.trunc(this.bucket/3))}getWidth(){return this.endX-this.startX}getStartX(){return this.startX}getEndX(){return this.endX}getBucket(){return this.bucket}getValue(){return this.value}getRowNumber(){return this.rowNumber}setRowNumber(s){this.rowNumber=s}toString(){return this.rowNumber+"|"+this.value}}hu.BARCODE_ROW_UNKNOWN=-1;class ti{static initialize(){for(let s=0;s<st.SYMBOL_TABLE.length;s++){let l=st.SYMBOL_TABLE[s],u=l&1;for(let p=0;p<st.BARS_IN_MODULE;p++){let g=0;for(;(l&1)===u;)g+=1,l>>=1;u=l&1,ti.RATIOS_TABLE[s]||(ti.RATIOS_TABLE[s]=new Array(st.BARS_IN_MODULE)),ti.RATIOS_TABLE[s][st.BARS_IN_MODULE-p-1]=Math.fround(g/st.MODULES_IN_CODEWORD)}}this.bSymbolTableReady=!0}static getDecodedValue(s){let l=ti.getDecodedCodewordValue(ti.sampleBitCounts(s));return l!==-1?l:ti.getClosestDecodedValue(s)}static sampleBitCounts(s){let l=at.sum(s),u=new Int32Array(st.BARS_IN_MODULE),p=0,g=0;for(let x=0;x<st.MODULES_IN_CODEWORD;x++){let y=l/(2*st.MODULES_IN_CODEWORD)+x*l/st.MODULES_IN_CODEWORD;g+s[p]<=y&&(g+=s[p],p++),u[p]++}return u}static getDecodedCodewordValue(s){let l=ti.getBitValue(s);return st.getCodeword(l)===-1?-1:l}static getBitValue(s){let l=0;for(let u=0;u<s.length;u++)for(let p=0;p<s[u];p++)l=l<<1|(u%2===0?1:0);return Math.trunc(l)}static getClosestDecodedValue(s){let l=at.sum(s),u=new Array(st.BARS_IN_MODULE);if(l>1)for(let x=0;x<u.length;x++)u[x]=Math.fround(s[x]/l);let p=Br.MAX_VALUE,g=-1;this.bSymbolTableReady||ti.initialize();for(let x=0;x<ti.RATIOS_TABLE.length;x++){let y=0,C=ti.RATIOS_TABLE[x];for(let O=0;O<st.BARS_IN_MODULE;O++){let D=Math.fround(C[O]-u[O]);if(y+=Math.fround(D*D),y>=p)break}y<p&&(p=y,g=st.SYMBOL_TABLE[x])}return g}}ti.bSymbolTableReady=!1,ti.RATIOS_TABLE=new Array(st.SYMBOL_TABLE.length).map(F=>new Array(st.BARS_IN_MODULE));class gE{constructor(){this.segmentCount=-1,this.fileSize=-1,this.timestamp=-1,this.checksum=-1}getSegmentIndex(){return this.segmentIndex}setSegmentIndex(s){this.segmentIndex=s}getFileId(){return this.fileId}setFileId(s){this.fileId=s}getOptionalData(){return this.optionalData}setOptionalData(s){this.optionalData=s}isLastSegment(){return this.lastSegment}setLastSegment(s){this.lastSegment=s}getSegmentCount(){return this.segmentCount}setSegmentCount(s){this.segmentCount=s}getSender(){return this.sender||null}setSender(s){this.sender=s}getAddressee(){return this.addressee||null}setAddressee(s){this.addressee=s}getFileName(){return this.fileName}setFileName(s){this.fileName=s}getFileSize(){return this.fileSize}setFileSize(s){this.fileSize=s}getChecksum(){return this.checksum}setChecksum(s){this.checksum=s}getTimestamp(){return this.timestamp}setTimestamp(s){this.timestamp=s}}class mE{static parseLong(s,l=void 0){return parseInt(s,l)}}class xE extends d{}xE.kind="NullPointerException";class $5{writeBytes(s){this.writeBytesOffset(s,0,s.length)}writeBytesOffset(s,l,u){if(s==null)throw new xE;if(l<0||l>s.length||u<0||l+u>s.length||l+u<0)throw new S;if(u===0)return;for(let p=0;p<u;p++)this.write(s[l+p])}flush(){}close(){}}class X5 extends d{}class K5 extends $5{constructor(s=32){if(super(),this.count=0,s<0)throw new m("Negative initial size: "+s);this.buf=new Uint8Array(s)}ensureCapacity(s){s-this.buf.length>0&&this.grow(s)}grow(s){let u=this.buf.length<<1;if(u-s<0&&(u=s),u<0){if(s<0)throw new X5;u=_.MAX_VALUE}this.buf=T.copyOfUint8Array(this.buf,u)}write(s){this.ensureCapacity(this.count+1),this.buf[this.count]=s,this.count+=1}writeBytesOffset(s,l,u){if(l<0||l>s.length||u<0||l+u-s.length>0)throw new S;this.ensureCapacity(this.count+u),A.arraycopy(s,l,this.buf,this.count,u),this.count+=u}writeTo(s){s.writeBytesOffset(this.buf,0,this.count)}reset(){this.count=0}toByteArray(){return T.copyOfUint8Array(this.buf,this.count)}size(){return this.count}toString(s){return s?typeof s=="string"?this.toString_string(s):this.toString_number(s):this.toString_void()}toString_void(){return new String(this.buf).toString()}toString_string(s){return new String(this.buf).toString()}toString_number(s){return new String(this.buf).toString()}close(){}}var jt;(function(F){F[F.ALPHA=0]="ALPHA",F[F.LOWER=1]="LOWER",F[F.MIXED=2]="MIXED",F[F.PUNCT=3]="PUNCT",F[F.ALPHA_SHIFT=4]="ALPHA_SHIFT",F[F.PUNCT_SHIFT=5]="PUNCT_SHIFT"})(jt||(jt={}));function vE(){if(typeof window<"u")return window.BigInt||null;if(typeof mu<"u")return mu.BigInt||null;if(typeof self<"u")return self.BigInt||null;throw new Error("Can't search globals for BigInt!")}let Ff;function Ws(F){if(typeof Ff>"u"&&(Ff=vE()),Ff===null)throw new Error("BigInt is not supported!");return Ff(F)}function Y5(){let F=[];F[0]=Ws(1);let s=Ws(900);F[1]=s;for(let l=2;l<16;l++)F[l]=F[l-1]*s;return F}class Se{static decode(s,l){let u=new de(""),p=B.ISO8859_1;u.enableDecoding(p);let g=1,x=s[g++],y=new gE;for(;g<s[0];){switch(x){case Se.TEXT_COMPACTION_MODE_LATCH:g=Se.textCompaction(s,g,u);break;case Se.BYTE_COMPACTION_MODE_LATCH:case Se.BYTE_COMPACTION_MODE_LATCH_6:g=Se.byteCompaction(x,s,p,g,u);break;case Se.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:u.append(s[g++]);break;case Se.NUMERIC_COMPACTION_MODE_LATCH:g=Se.numericCompaction(s,g,u);break;case Se.ECI_CHARSET:B.getCharacterSetECIByValue(s[g++]);break;case Se.ECI_GENERAL_PURPOSE:g+=2;break;case Se.ECI_USER_DEFINED:g++;break;case Se.BEGIN_MACRO_PDF417_CONTROL_BLOCK:g=Se.decodeMacroBlock(s,g,y);break;case Se.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Se.MACRO_PDF417_TERMINATOR:throw new P;default:g--,g=Se.textCompaction(s,g,u);break}if(g<s.length)x=s[g++];else throw P.getFormatInstance()}if(u.length()===0)throw P.getFormatInstance();let C=new ce(null,u.toString(),null,l);return C.setOther(y),C}static decodeMacroBlock(s,l,u){if(l+Se.NUMBER_OF_SEQUENCE_CODEWORDS>s[0])throw P.getFormatInstance();let p=new Int32Array(Se.NUMBER_OF_SEQUENCE_CODEWORDS);for(let y=0;y<Se.NUMBER_OF_SEQUENCE_CODEWORDS;y++,l++)p[y]=s[l];u.setSegmentIndex(_.parseInt(Se.decodeBase900toBase10(p,Se.NUMBER_OF_SEQUENCE_CODEWORDS)));let g=new de;l=Se.textCompaction(s,l,g),u.setFileId(g.toString());let x=-1;for(s[l]===Se.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(x=l+1);l<s[0];)switch(s[l]){case Se.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:switch(l++,s[l]){case Se.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:let y=new de;l=Se.textCompaction(s,l+1,y),u.setFileName(y.toString());break;case Se.MACRO_PDF417_OPTIONAL_FIELD_SENDER:let C=new de;l=Se.textCompaction(s,l+1,C),u.setSender(C.toString());break;case Se.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:let O=new de;l=Se.textCompaction(s,l+1,O),u.setAddressee(O.toString());break;case Se.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:let D=new de;l=Se.numericCompaction(s,l+1,D),u.setSegmentCount(_.parseInt(D.toString()));break;case Se.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:let L=new de;l=Se.numericCompaction(s,l+1,L),u.setTimestamp(mE.parseLong(L.toString()));break;case Se.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:let U=new de;l=Se.numericCompaction(s,l+1,U),u.setChecksum(_.parseInt(U.toString()));break;case Se.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:let J=new de;l=Se.numericCompaction(s,l+1,J),u.setFileSize(mE.parseLong(J.toString()));break;default:throw P.getFormatInstance()}break;case Se.MACRO_PDF417_TERMINATOR:l++,u.setLastSegment(!0);break;default:throw P.getFormatInstance()}if(x!==-1){let y=l-x;u.isLastSegment()&&y--,u.setOptionalData(T.copyOfRange(s,x,x+y))}return l}static textCompaction(s,l,u){let p=new Int32Array((s[0]-l)*2),g=new Int32Array((s[0]-l)*2),x=0,y=!1;for(;l<s[0]&&!y;){let C=s[l++];if(C<Se.TEXT_COMPACTION_MODE_LATCH)p[x]=C/30,p[x+1]=C%30,x+=2;else switch(C){case Se.TEXT_COMPACTION_MODE_LATCH:p[x++]=Se.TEXT_COMPACTION_MODE_LATCH;break;case Se.BYTE_COMPACTION_MODE_LATCH:case Se.BYTE_COMPACTION_MODE_LATCH_6:case Se.NUMERIC_COMPACTION_MODE_LATCH:case Se.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case Se.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Se.MACRO_PDF417_TERMINATOR:l--,y=!0;break;case Se.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:p[x]=Se.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,C=s[l++],g[x]=C,x++;break}}return Se.decodeTextCompaction(p,g,x,u),l}static decodeTextCompaction(s,l,u,p){let g=jt.ALPHA,x=jt.ALPHA,y=0;for(;y<u;){let C=s[y],O="";switch(g){case jt.ALPHA:if(C<26)O=String.fromCharCode(65+C);else switch(C){case 26:O=" ";break;case Se.LL:g=jt.LOWER;break;case Se.ML:g=jt.MIXED;break;case Se.PS:x=g,g=jt.PUNCT_SHIFT;break;case Se.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:p.append(l[y]);break;case Se.TEXT_COMPACTION_MODE_LATCH:g=jt.ALPHA;break}break;case jt.LOWER:if(C<26)O=String.fromCharCode(97+C);else switch(C){case 26:O=" ";break;case Se.AS:x=g,g=jt.ALPHA_SHIFT;break;case Se.ML:g=jt.MIXED;break;case Se.PS:x=g,g=jt.PUNCT_SHIFT;break;case Se.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:p.append(l[y]);break;case Se.TEXT_COMPACTION_MODE_LATCH:g=jt.ALPHA;break}break;case jt.MIXED:if(C<Se.PL)O=Se.MIXED_CHARS[C];else switch(C){case Se.PL:g=jt.PUNCT;break;case 26:O=" ";break;case Se.LL:g=jt.LOWER;break;case Se.AL:g=jt.ALPHA;break;case Se.PS:x=g,g=jt.PUNCT_SHIFT;break;case Se.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:p.append(l[y]);break;case Se.TEXT_COMPACTION_MODE_LATCH:g=jt.ALPHA;break}break;case jt.PUNCT:if(C<Se.PAL)O=Se.PUNCT_CHARS[C];else switch(C){case Se.PAL:g=jt.ALPHA;break;case Se.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:p.append(l[y]);break;case Se.TEXT_COMPACTION_MODE_LATCH:g=jt.ALPHA;break}break;case jt.ALPHA_SHIFT:if(g=x,C<26)O=String.fromCharCode(65+C);else switch(C){case 26:O=" ";break;case Se.TEXT_COMPACTION_MODE_LATCH:g=jt.ALPHA;break}break;case jt.PUNCT_SHIFT:if(g=x,C<Se.PAL)O=Se.PUNCT_CHARS[C];else switch(C){case Se.PAL:g=jt.ALPHA;break;case Se.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:p.append(l[y]);break;case Se.TEXT_COMPACTION_MODE_LATCH:g=jt.ALPHA;break}break}O!==""&&p.append(O),y++}}static byteCompaction(s,l,u,p,g){let x=new K5,y=0,C=0,O=!1;switch(s){case Se.BYTE_COMPACTION_MODE_LATCH:let D=new Int32Array(6),L=l[p++];for(;p<l[0]&&!O;)switch(D[y++]=L,C=900*C+L,L=l[p++],L){case Se.TEXT_COMPACTION_MODE_LATCH:case Se.BYTE_COMPACTION_MODE_LATCH:case Se.NUMERIC_COMPACTION_MODE_LATCH:case Se.BYTE_COMPACTION_MODE_LATCH_6:case Se.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case Se.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Se.MACRO_PDF417_TERMINATOR:p--,O=!0;break;default:if(y%5===0&&y>0){for(let U=0;U<6;++U)x.write(Number(Ws(C)>>Ws(8*(5-U))));C=0,y=0}break}p===l[0]&&L<Se.TEXT_COMPACTION_MODE_LATCH&&(D[y++]=L);for(let U=0;U<y;U++)x.write(D[U]);break;case Se.BYTE_COMPACTION_MODE_LATCH_6:for(;p<l[0]&&!O;){let U=l[p++];if(U<Se.TEXT_COMPACTION_MODE_LATCH)y++,C=900*C+U;else switch(U){case Se.TEXT_COMPACTION_MODE_LATCH:case Se.BYTE_COMPACTION_MODE_LATCH:case Se.NUMERIC_COMPACTION_MODE_LATCH:case Se.BYTE_COMPACTION_MODE_LATCH_6:case Se.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case Se.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Se.MACRO_PDF417_TERMINATOR:p--,O=!0;break}if(y%5===0&&y>0){for(let J=0;J<6;++J)x.write(Number(Ws(C)>>Ws(8*(5-J))));C=0,y=0}}break}return g.append(ee.decode(x.toByteArray(),u)),p}static numericCompaction(s,l,u){let p=0,g=!1,x=new Int32Array(Se.MAX_NUMERIC_CODEWORDS);for(;l<s[0]&&!g;){let y=s[l++];if(l===s[0]&&(g=!0),y<Se.TEXT_COMPACTION_MODE_LATCH)x[p]=y,p++;else switch(y){case Se.TEXT_COMPACTION_MODE_LATCH:case Se.BYTE_COMPACTION_MODE_LATCH:case Se.BYTE_COMPACTION_MODE_LATCH_6:case Se.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case Se.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Se.MACRO_PDF417_TERMINATOR:l--,g=!0;break}(p%Se.MAX_NUMERIC_CODEWORDS===0||y===Se.NUMERIC_COMPACTION_MODE_LATCH||g)&&p>0&&(u.append(Se.decodeBase900toBase10(x,p)),p=0)}return l}static decodeBase900toBase10(s,l){let u=Ws(0);for(let g=0;g<l;g++)u+=Se.EXP900[l-g-1]*Ws(s[g]);let p=u.toString();if(p.charAt(0)!=="1")throw new P;return p.substring(1)}}Se.TEXT_COMPACTION_MODE_LATCH=900,Se.BYTE_COMPACTION_MODE_LATCH=901,Se.NUMERIC_COMPACTION_MODE_LATCH=902,Se.BYTE_COMPACTION_MODE_LATCH_6=924,Se.ECI_USER_DEFINED=925,Se.ECI_GENERAL_PURPOSE=926,Se.ECI_CHARSET=927,Se.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928,Se.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923,Se.MACRO_PDF417_TERMINATOR=922,Se.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913,Se.MAX_NUMERIC_CODEWORDS=15,Se.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0,Se.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1,Se.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2,Se.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3,Se.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4,Se.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5,Se.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6,Se.PL=25,Se.LL=27,Se.AS=27,Se.ML=28,Se.AL=28,Se.PS=29,Se.PAL=29,Se.PUNCT_CHARS=`;<>@[\\]_\`~!\r	,:
-.$/"|*()?{}'`,Se.MIXED_CHARS="0123456789&\r	,:#-.$/+%*=^",Se.EXP900=vE()?Y5():[],Se.NUMBER_OF_SEQUENCE_CODEWORDS=2;class vt{constructor(){}static decode(s,l,u,p,g,x,y){let C=new Po(s,l,u,p,g),O=null,D=null,L;for(let ie=!0;;ie=!1){if(l!=null&&(O=vt.getRowIndicatorColumn(s,C,l,!0,x,y)),p!=null&&(D=vt.getRowIndicatorColumn(s,C,p,!1,x,y)),L=vt.merge(O,D),L==null)throw K.getNotFoundInstance();let oe=L.getBoundingBox();if(ie&&oe!=null&&(oe.getMinY()<C.getMinY()||oe.getMaxY()>C.getMaxY()))C=oe;else break}L.setBoundingBox(C);let U=L.getBarcodeColumnCount()+1;L.setDetectionResultColumn(0,O),L.setDetectionResultColumn(U,D);let J=O!=null;for(let ie=1;ie<=U;ie++){let oe=J?ie:U-ie;if(L.getDetectionResultColumn(oe)!==void 0)continue;let me;oe===0||oe===U?me=new pE(C,oe===0):me=new uu(C),L.setDetectionResultColumn(oe,me);let _e=-1,Le=_e;for(let Ue=C.getMinY();Ue<=C.getMaxY();Ue++){if(_e=vt.getStartColumn(L,oe,Ue,J),_e<0||_e>C.getMaxX()){if(Le===-1)continue;_e=Le}let Pe=vt.detectCodeword(s,C.getMinX(),C.getMaxX(),J,_e,Ue,x,y);Pe!=null&&(me.setCodeword(Ue,Pe),Le=_e,x=Math.min(x,Pe.getWidth()),y=Math.max(y,Pe.getWidth()))}}return vt.createDecoderResult(L)}static merge(s,l){if(s==null&&l==null)return null;let u=vt.getBarcodeMetadata(s,l);if(u==null)return null;let p=Po.merge(vt.adjustBoundingBox(s),vt.adjustBoundingBox(l));return new du(u,p)}static adjustBoundingBox(s){if(s==null)return null;let l=s.getRowHeights();if(l==null)return null;let u=vt.getMax(l),p=0;for(let y of l)if(p+=u-y,y>0)break;let g=s.getCodewords();for(let y=0;p>0&&g[y]==null;y++)p--;let x=0;for(let y=l.length-1;y>=0&&(x+=u-l[y],!(l[y]>0));y--);for(let y=g.length-1;x>0&&g[y]==null;y--)x--;return s.getBoundingBox().addMissingRows(p,x,s.isLeft())}static getMax(s){let l=-1;for(let u of s)l=Math.max(l,u);return l}static getBarcodeMetadata(s,l){let u;if(s==null||(u=s.getBarcodeMetadata())==null)return l==null?null:l.getBarcodeMetadata();let p;return l==null||(p=l.getBarcodeMetadata())==null?u:u.getColumnCount()!==p.getColumnCount()&&u.getErrorCorrectionLevel()!==p.getErrorCorrectionLevel()&&u.getRowCount()!==p.getRowCount()?null:u}static getRowIndicatorColumn(s,l,u,p,g,x){let y=new pE(l,p);for(let C=0;C<2;C++){let O=C===0?1:-1,D=Math.trunc(Math.trunc(u.getX()));for(let L=Math.trunc(Math.trunc(u.getY()));L<=l.getMaxY()&&L>=l.getMinY();L+=O){let U=vt.detectCodeword(s,0,s.getWidth(),p,D,L,g,x);U!=null&&(y.setCodeword(L,U),p?D=U.getStartX():D=U.getEndX())}}return y}static adjustCodewordCount(s,l){let u=l[0][1],p=u.getValue(),g=s.getBarcodeColumnCount()*s.getBarcodeRowCount()-vt.getNumberOfECCodeWords(s.getBarcodeECLevel());if(p.length===0){if(g<1||g>st.MAX_CODEWORDS_IN_BARCODE)throw K.getNotFoundInstance();u.setValue(g)}else p[0]!==g&&u.setValue(g)}static createDecoderResult(s){let l=vt.createBarcodeMatrix(s);vt.adjustCodewordCount(s,l);let u=new Array,p=new Int32Array(s.getBarcodeRowCount()*s.getBarcodeColumnCount()),g=[],x=new Array;for(let C=0;C<s.getBarcodeRowCount();C++)for(let O=0;O<s.getBarcodeColumnCount();O++){let D=l[C][O+1].getValue(),L=C*s.getBarcodeColumnCount()+O;D.length===0?u.push(L):D.length===1?p[L]=D[0]:(x.push(L),g.push(D))}let y=new Array(g.length);for(let C=0;C<y.length;C++)y[C]=g[C];return vt.createDecoderResultFromAmbiguousValues(s.getBarcodeECLevel(),p,st.toIntArray(u),st.toIntArray(x),y)}static createDecoderResultFromAmbiguousValues(s,l,u,p,g){let x=new Int32Array(p.length),y=100;for(;y-- >0;){for(let C=0;C<x.length;C++)l[p[C]]=g[C][x[C]];try{return vt.decodeCodewords(l,s,u)}catch(C){if(!(C instanceof w))throw C}if(x.length===0)throw w.getChecksumInstance();for(let C=0;C<x.length;C++)if(x[C]<g[C].length-1){x[C]++;break}else if(x[C]=0,C===x.length-1)throw w.getChecksumInstance()}throw w.getChecksumInstance()}static createBarcodeMatrix(s){let l=Array.from({length:s.getBarcodeRowCount()},()=>new Array(s.getBarcodeColumnCount()+2));for(let p=0;p<l.length;p++)for(let g=0;g<l[p].length;g++)l[p][g]=new fu;let u=0;for(let p of s.getDetectionResultColumns()){if(p!=null){for(let g of p.getCodewords())if(g!=null){let x=g.getRowNumber();if(x>=0){if(x>=l.length)continue;l[x][u].setValue(g.getValue())}}}u++}return l}static isValidBarcodeColumn(s,l){return l>=0&&l<=s.getBarcodeColumnCount()+1}static getStartColumn(s,l,u,p){let g=p?1:-1,x=null;if(vt.isValidBarcodeColumn(s,l-g)&&(x=s.getDetectionResultColumn(l-g).getCodeword(u)),x!=null)return p?x.getEndX():x.getStartX();if(x=s.getDetectionResultColumn(l).getCodewordNearby(u),x!=null)return p?x.getStartX():x.getEndX();if(vt.isValidBarcodeColumn(s,l-g)&&(x=s.getDetectionResultColumn(l-g).getCodewordNearby(u)),x!=null)return p?x.getEndX():x.getStartX();let y=0;for(;vt.isValidBarcodeColumn(s,l-g);){l-=g;for(let C of s.getDetectionResultColumn(l).getCodewords())if(C!=null)return(p?C.getEndX():C.getStartX())+g*y*(C.getEndX()-C.getStartX());y++}return p?s.getBoundingBox().getMinX():s.getBoundingBox().getMaxX()}static detectCodeword(s,l,u,p,g,x,y,C){g=vt.adjustCodewordStartColumn(s,l,u,p,g,x);let O=vt.getModuleBitCount(s,l,u,p,g,x);if(O==null)return null;let D,L=at.sum(O);if(p)D=g+L;else{for(let ie=0;ie<O.length/2;ie++){let oe=O[ie];O[ie]=O[O.length-1-ie],O[O.length-1-ie]=oe}D=g,g=D-L}if(!vt.checkCodewordSkew(L,y,C))return null;let U=ti.getDecodedValue(O),J=st.getCodeword(U);return J===-1?null:new hu(g,D,vt.getCodewordBucketNumber(U),J)}static getModuleBitCount(s,l,u,p,g,x){let y=g,C=new Int32Array(8),O=0,D=p?1:-1,L=p;for(;(p?y<u:y>=l)&&O<C.length;)s.get(y,x)===L?(C[O]++,y+=D):(O++,L=!L);return O===C.length||y===(p?u:l)&&O===C.length-1?C:null}static getNumberOfECCodeWords(s){return 2<<s}static adjustCodewordStartColumn(s,l,u,p,g,x){let y=g,C=p?-1:1;for(let O=0;O<2;O++){for(;(p?y>=l:y<u)&&p===s.get(y,x);){if(Math.abs(g-y)>vt.CODEWORD_SKEW_SIZE)return g;y+=C}C=-C,p=!p}return y}static checkCodewordSkew(s,l,u){return l-vt.CODEWORD_SKEW_SIZE<=s&&s<=u+vt.CODEWORD_SKEW_SIZE}static decodeCodewords(s,l,u){if(s.length===0)throw P.getFormatInstance();let p=1<<l+1,g=vt.correctErrors(s,u,p);vt.verifyCodewordCount(s,p);let x=Se.decode(s,""+l);return x.setErrorsCorrected(g),x.setErasures(u.length),x}static correctErrors(s,l,u){if(l!=null&&l.length>u/2+vt.MAX_ERRORS||u<0||u>vt.MAX_EC_CODEWORDS)throw w.getChecksumInstance();return vt.errorCorrection.decode(s,u,l)}static verifyCodewordCount(s,l){if(s.length<4)throw P.getFormatInstance();let u=s[0];if(u>s.length)throw P.getFormatInstance();if(u===0)if(l<s.length)s[0]=s.length-l;else throw P.getFormatInstance()}static getBitCountForCodeword(s){let l=new Int32Array(8),u=0,p=l.length-1;for(;!((s&1)!==u&&(u=s&1,p--,p<0));)l[p]++,s>>=1;return l}static getCodewordBucketNumber(s){return s instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(s):this.getCodewordBucketNumber_number(s)}static getCodewordBucketNumber_number(s){return vt.getCodewordBucketNumber(vt.getBitCountForCodeword(s))}static getCodewordBucketNumber_Int32Array(s){return(s[0]-s[2]+s[4]-s[6]+9)%9}static toString(s){let l=new cu;for(let u=0;u<s.length;u++){l.format("Row %2d: ",u);for(let p=0;p<s[u].length;p++){let g=s[u][p];g.getValue().length===0?l.format("        ",null):l.format("%4d(%2d)",g.getValue()[0],g.getConfidence(g.getValue()[0]))}l.format("%n")}return l.toString()}}vt.CODEWORD_SKEW_SIZE=2,vt.MAX_ERRORS=3,vt.MAX_EC_CODEWORDS=512,vt.errorCorrection=new hE;class pn{decode(s,l=null){let u=pn.decode(s,l,!1);if(u==null||u.length===0||u[0]==null)throw K.getNotFoundInstance();return u[0]}decodeMultiple(s,l=null){try{return pn.decode(s,l,!0)}catch(u){throw u instanceof P||u instanceof w?K.getNotFoundInstance():u}}static decode(s,l,u){const p=new Array,g=pt.detectMultiple(s,l,u);for(const x of g.getPoints()){const y=vt.decode(g.getBits(),x[4],x[5],x[6],x[7],pn.getMinCodewordWidth(x),pn.getMaxCodewordWidth(x)),C=new ne(y.getText(),y.getRawBytes(),void 0,x,he.PDF_417);C.putMetadata(De.ERROR_CORRECTION_LEVEL,y.getECLevel());const O=y.getOther();O!=null&&C.putMetadata(De.PDF417_EXTRA_METADATA,O),p.push(C)}return p.map(x=>x)}static getMaxWidth(s,l){return s==null||l==null?0:Math.trunc(Math.abs(s.getX()-l.getX()))}static getMinWidth(s,l){return s==null||l==null?_.MAX_VALUE:Math.trunc(Math.abs(s.getX()-l.getX()))}static getMaxCodewordWidth(s){return Math.floor(Math.max(Math.max(pn.getMaxWidth(s[0],s[4]),pn.getMaxWidth(s[6],s[2])*st.MODULES_IN_CODEWORD/st.MODULES_IN_STOP_PATTERN),Math.max(pn.getMaxWidth(s[1],s[5]),pn.getMaxWidth(s[7],s[3])*st.MODULES_IN_CODEWORD/st.MODULES_IN_STOP_PATTERN)))}static getMinCodewordWidth(s){return Math.floor(Math.min(Math.min(pn.getMinWidth(s[0],s[4]),pn.getMinWidth(s[6],s[2])*st.MODULES_IN_CODEWORD/st.MODULES_IN_STOP_PATTERN),Math.min(pn.getMinWidth(s[1],s[5]),pn.getMinWidth(s[7],s[3])*st.MODULES_IN_CODEWORD/st.MODULES_IN_STOP_PATTERN)))}reset(){}}class Lf extends d{}Lf.kind="ReaderException";class yE{constructor(s,l){this.verbose=s===!0,l&&this.setHints(l)}decode(s,l){return l&&this.setHints(l),this.decodeInternal(s)}decodeWithState(s){return(this.readers===null||this.readers===void 0)&&this.setHints(null),this.decodeInternal(s)}setHints(s){this.hints=s;const l=!n(s)&&s.get(R.TRY_HARDER)===!0,u=n(s)?null:s.get(R.POSSIBLE_FORMATS),p=new Array;if(!n(u)){const g=u.some(x=>x===he.UPC_A||x===he.UPC_E||x===he.EAN_13||x===he.EAN_8||x===he.CODABAR||x===he.CODE_39||x===he.CODE_93||x===he.CODE_128||x===he.ITF||x===he.RSS_14||x===he.RSS_EXPANDED);g&&!l&&p.push(new Ri(s,this.verbose)),u.includes(he.QR_CODE)&&p.push(new zs),u.includes(he.DATA_MATRIX)&&p.push(new Us),u.includes(he.AZTEC)&&p.push(new Xt),u.includes(he.PDF_417)&&p.push(new pn),g&&l&&p.push(new Ri(s,this.verbose))}p.length===0&&(l||p.push(new Ri(s,this.verbose)),p.push(new zs),p.push(new Us),p.push(new Xt),p.push(new pn),l&&p.push(new Ri(s,this.verbose))),this.readers=p}reset(){if(this.readers!==null)for(const s of this.readers)s.reset()}decodeInternal(s){if(this.readers===null)throw new Lf("No readers where selected, nothing can be read.");for(const l of this.readers)try{return l.decode(s,this.hints)}catch(u){if(u instanceof Lf)continue}throw new K("No MultiFormat Readers were able to detect the code.")}}class Z5 extends le{constructor(s=null,l=500){const u=new yE;u.setHints(s),super(u,l)}decodeBitmap(s){return this.reader.decodeWithState(s)}}class q5 extends le{constructor(s=500){super(new pn,s)}}class Q5 extends le{constructor(s=500){super(new zs,s)}}var mg;(function(F){F[F.ERROR_CORRECTION=0]="ERROR_CORRECTION",F[F.CHARACTER_SET=1]="CHARACTER_SET",F[F.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",F[F.MIN_SIZE=3]="MIN_SIZE",F[F.MAX_SIZE=4]="MAX_SIZE",F[F.MARGIN=5]="MARGIN",F[F.PDF417_COMPACT=6]="PDF417_COMPACT",F[F.PDF417_COMPACTION=7]="PDF417_COMPACTION",F[F.PDF417_DIMENSIONS=8]="PDF417_DIMENSIONS",F[F.AZTEC_LAYERS=9]="AZTEC_LAYERS",F[F.QR_VERSION=10]="QR_VERSION"})(mg||(mg={}));var Ur=mg;class xg{constructor(s){this.field=s,this.cachedGenerators=[],this.cachedGenerators.push(new ze(s,Int32Array.from([1])))}buildGenerator(s){const l=this.cachedGenerators;if(s>=l.length){let u=l[l.length-1];const p=this.field;for(let g=l.length;g<=s;g++){const x=u.multiply(new ze(p,Int32Array.from([1,p.exp(g-1+p.getGeneratorBase())])));l.push(x),u=x}}return l[s]}encode(s,l){if(l===0)throw new m("No error correction bytes");const u=s.length-l;if(u<=0)throw new m("No data bytes provided");const p=this.buildGenerator(l),g=new Int32Array(u);A.arraycopy(s,0,g,0,u);let x=new ze(this.field,g);x=x.multiplyByMonomial(l,1);const C=x.divide(p)[1].getCoefficients(),O=l-C.length;for(let D=0;D<O;D++)s[u+D]=0;A.arraycopy(C,0,s,u+O,C.length)}}class yr{constructor(){}static applyMaskPenaltyRule1(s){return yr.applyMaskPenaltyRule1Internal(s,!0)+yr.applyMaskPenaltyRule1Internal(s,!1)}static applyMaskPenaltyRule2(s){let l=0;const u=s.getArray(),p=s.getWidth(),g=s.getHeight();for(let x=0;x<g-1;x++){const y=u[x];for(let C=0;C<p-1;C++){const O=y[C];O===y[C+1]&&O===u[x+1][C]&&O===u[x+1][C+1]&&l++}}return yr.N2*l}static applyMaskPenaltyRule3(s){let l=0;const u=s.getArray(),p=s.getWidth(),g=s.getHeight();for(let x=0;x<g;x++)for(let y=0;y<p;y++){const C=u[x];y+6<p&&C[y]===1&&C[y+1]===0&&C[y+2]===1&&C[y+3]===1&&C[y+4]===1&&C[y+5]===0&&C[y+6]===1&&(yr.isWhiteHorizontal(C,y-4,y)||yr.isWhiteHorizontal(C,y+7,y+11))&&l++,x+6<g&&u[x][y]===1&&u[x+1][y]===0&&u[x+2][y]===1&&u[x+3][y]===1&&u[x+4][y]===1&&u[x+5][y]===0&&u[x+6][y]===1&&(yr.isWhiteVertical(u,y,x-4,x)||yr.isWhiteVertical(u,y,x+7,x+11))&&l++}return l*yr.N3}static isWhiteHorizontal(s,l,u){l=Math.max(l,0),u=Math.min(u,s.length);for(let p=l;p<u;p++)if(s[p]===1)return!1;return!0}static isWhiteVertical(s,l,u,p){u=Math.max(u,0),p=Math.min(p,s.length);for(let g=u;g<p;g++)if(s[g][l]===1)return!1;return!0}static applyMaskPenaltyRule4(s){let l=0;const u=s.getArray(),p=s.getWidth(),g=s.getHeight();for(let C=0;C<g;C++){const O=u[C];for(let D=0;D<p;D++)O[D]===1&&l++}const x=s.getHeight()*s.getWidth();return Math.floor(Math.abs(l*2-x)*10/x)*yr.N4}static getDataMaskBit(s,l,u){let p,g;switch(s){case 0:p=u+l&1;break;case 1:p=u&1;break;case 2:p=l%3;break;case 3:p=(u+l)%3;break;case 4:p=Math.floor(u/2)+Math.floor(l/3)&1;break;case 5:g=u*l,p=(g&1)+g%3;break;case 6:g=u*l,p=(g&1)+g%3&1;break;case 7:g=u*l,p=g%3+(u+l&1)&1;break;default:throw new m("Invalid mask pattern: "+s)}return p===0}static applyMaskPenaltyRule1Internal(s,l){let u=0;const p=l?s.getHeight():s.getWidth(),g=l?s.getWidth():s.getHeight(),x=s.getArray();for(let y=0;y<p;y++){let C=0,O=-1;for(let D=0;D<g;D++){const L=l?x[y][D]:x[D][y];L===O?C++:(C>=5&&(u+=yr.N1+(C-5)),C=1,O=L)}C>=5&&(u+=yr.N1+(C-5))}return u}}yr.N1=3,yr.N2=3,yr.N3=40,yr.N4=10;class Bf{constructor(s,l){this.width=s,this.height=l;const u=new Array(l);for(let p=0;p!==l;p++)u[p]=new Uint8Array(s);this.bytes=u}getHeight(){return this.height}getWidth(){return this.width}get(s,l){return this.bytes[l][s]}getArray(){return this.bytes}setNumber(s,l,u){this.bytes[l][s]=u}setBoolean(s,l,u){this.bytes[l][s]=u?1:0}clear(s){for(const l of this.bytes)T.fill(l,s)}equals(s){if(!(s instanceof Bf))return!1;const l=s;if(this.width!==l.width||this.height!==l.height)return!1;for(let u=0,p=this.height;u<p;++u){const g=this.bytes[u],x=l.bytes[u];for(let y=0,C=this.width;y<C;++y)if(g[y]!==x[y])return!1}return!0}toString(){const s=new de;for(let l=0,u=this.height;l<u;++l){const p=this.bytes[l];for(let g=0,x=this.width;g<x;++g)switch(p[g]){case 0:s.append(" 0");break;case 1:s.append(" 1");break;default:s.append("  ");break}s.append(`
`)}return s.toString()}}class Do{constructor(){this.maskPattern=-1}getMode(){return this.mode}getECLevel(){return this.ecLevel}getVersion(){return this.version}getMaskPattern(){return this.maskPattern}getMatrix(){return this.matrix}toString(){const s=new de;return s.append(`<<
`),s.append(" mode: "),s.append(this.mode?this.mode.toString():"null"),s.append(`
 ecLevel: `),s.append(this.ecLevel?this.ecLevel.toString():"null"),s.append(`
 version: `),s.append(this.version?this.version.toString():"null"),s.append(`
 maskPattern: `),s.append(this.maskPattern.toString()),this.matrix?(s.append(`
 matrix:
`),s.append(this.matrix.toString())):s.append(`
 matrix: null
`),s.append(`>>
`),s.toString()}setMode(s){this.mode=s}setECLevel(s){this.ecLevel=s}setVersion(s){this.version=s}setMaskPattern(s){this.maskPattern=s}setMatrix(s){this.matrix=s}static isValidMaskPattern(s){return s>=0&&s<Do.NUM_MASK_PATTERNS}}Do.NUM_MASK_PATTERNS=8;class Wt extends d{}Wt.kind="WriterException";class it{constructor(){}static clearMatrix(s){s.clear(255)}static buildMatrix(s,l,u,p,g){it.clearMatrix(g),it.embedBasicPatterns(u,g),it.embedTypeInfo(l,p,g),it.maybeEmbedVersionInfo(u,g),it.embedDataBits(s,p,g)}static embedBasicPatterns(s,l){it.embedPositionDetectionPatternsAndSeparators(l),it.embedDarkDotAtLeftBottomCorner(l),it.maybeEmbedPositionAdjustmentPatterns(s,l),it.embedTimingPatterns(l)}static embedTypeInfo(s,l,u){const p=new N;it.makeTypeInfoBits(s,l,p);for(let g=0,x=p.getSize();g<x;++g){const y=p.get(p.getSize()-1-g),C=it.TYPE_INFO_COORDINATES[g],O=C[0],D=C[1];if(u.setBoolean(O,D,y),g<8){const L=u.getWidth()-g-1;u.setBoolean(L,8,y)}else{const U=u.getHeight()-7+(g-8);u.setBoolean(8,U,y)}}}static maybeEmbedVersionInfo(s,l){if(s.getVersionNumber()<7)return;const u=new N;it.makeVersionInfoBits(s,u);let p=6*3-1;for(let g=0;g<6;++g)for(let x=0;x<3;++x){const y=u.get(p);p--,l.setBoolean(g,l.getHeight()-11+x,y),l.setBoolean(l.getHeight()-11+x,g,y)}}static embedDataBits(s,l,u){let p=0,g=-1,x=u.getWidth()-1,y=u.getHeight()-1;for(;x>0;){for(x===6&&(x-=1);y>=0&&y<u.getHeight();){for(let C=0;C<2;++C){const O=x-C;if(!it.isEmpty(u.get(O,y)))continue;let D;p<s.getSize()?(D=s.get(p),++p):D=!1,l!==255&&yr.getDataMaskBit(l,O,y)&&(D=!D),u.setBoolean(O,y,D)}y+=g}g=-g,y+=g,x-=2}if(p!==s.getSize())throw new Wt("Not all bits consumed: "+p+"/"+s.getSize())}static findMSBSet(s){return 32-_.numberOfLeadingZeros(s)}static calculateBCHCode(s,l){if(l===0)throw new m("0 polynomial");const u=it.findMSBSet(l);for(s<<=u-1;it.findMSBSet(s)>=u;)s^=l<<it.findMSBSet(s)-u;return s}static makeTypeInfoBits(s,l,u){if(!Do.isValidMaskPattern(l))throw new Wt("Invalid mask pattern");const p=s.getBits()<<3|l;u.appendBits(p,5);const g=it.calculateBCHCode(p,it.TYPE_INFO_POLY);u.appendBits(g,10);const x=new N;if(x.appendBits(it.TYPE_INFO_MASK_PATTERN,15),u.xor(x),u.getSize()!==15)throw new Wt("should not happen but we got: "+u.getSize())}static makeVersionInfoBits(s,l){l.appendBits(s.getVersionNumber(),6);const u=it.calculateBCHCode(s.getVersionNumber(),it.VERSION_INFO_POLY);if(l.appendBits(u,12),l.getSize()!==18)throw new Wt("should not happen but we got: "+l.getSize())}static isEmpty(s){return s===255}static embedTimingPatterns(s){for(let l=8;l<s.getWidth()-8;++l){const u=(l+1)%2;it.isEmpty(s.get(l,6))&&s.setNumber(l,6,u),it.isEmpty(s.get(6,l))&&s.setNumber(6,l,u)}}static embedDarkDotAtLeftBottomCorner(s){if(s.get(8,s.getHeight()-8)===0)throw new Wt;s.setNumber(8,s.getHeight()-8,1)}static embedHorizontalSeparationPattern(s,l,u){for(let p=0;p<8;++p){if(!it.isEmpty(u.get(s+p,l)))throw new Wt;u.setNumber(s+p,l,0)}}static embedVerticalSeparationPattern(s,l,u){for(let p=0;p<7;++p){if(!it.isEmpty(u.get(s,l+p)))throw new Wt;u.setNumber(s,l+p,0)}}static embedPositionAdjustmentPattern(s,l,u){for(let p=0;p<5;++p){const g=it.POSITION_ADJUSTMENT_PATTERN[p];for(let x=0;x<5;++x)u.setNumber(s+x,l+p,g[x])}}static embedPositionDetectionPattern(s,l,u){for(let p=0;p<7;++p){const g=it.POSITION_DETECTION_PATTERN[p];for(let x=0;x<7;++x)u.setNumber(s+x,l+p,g[x])}}static embedPositionDetectionPatternsAndSeparators(s){const l=it.POSITION_DETECTION_PATTERN[0].length;it.embedPositionDetectionPattern(0,0,s),it.embedPositionDetectionPattern(s.getWidth()-l,0,s),it.embedPositionDetectionPattern(0,s.getWidth()-l,s);const u=8;it.embedHorizontalSeparationPattern(0,u-1,s),it.embedHorizontalSeparationPattern(s.getWidth()-u,u-1,s),it.embedHorizontalSeparationPattern(0,s.getWidth()-u,s);const p=7;it.embedVerticalSeparationPattern(p,0,s),it.embedVerticalSeparationPattern(s.getHeight()-p-1,0,s),it.embedVerticalSeparationPattern(p,s.getHeight()-p,s)}static maybeEmbedPositionAdjustmentPatterns(s,l){if(s.getVersionNumber()<2)return;const u=s.getVersionNumber()-1,p=it.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[u];for(let g=0,x=p.length;g!==x;g++){const y=p[g];if(y>=0)for(let C=0;C!==x;C++){const O=p[C];O>=0&&it.isEmpty(l.get(O,y))&&it.embedPositionAdjustmentPattern(O-2,y-2,l)}}}}it.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),it.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),it.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),it.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),it.VERSION_INFO_POLY=7973,it.TYPE_INFO_POLY=1335,it.TYPE_INFO_MASK_PATTERN=21522;class J5{constructor(s,l){this.dataBytes=s,this.errorCorrectionBytes=l}getDataBytes(){return this.dataBytes}getErrorCorrectionBytes(){return this.errorCorrectionBytes}}class er{constructor(){}static calculateMaskPenalty(s){return yr.applyMaskPenaltyRule1(s)+yr.applyMaskPenaltyRule2(s)+yr.applyMaskPenaltyRule3(s)+yr.applyMaskPenaltyRule4(s)}static encode(s,l,u=null){let p=er.DEFAULT_BYTE_MODE_ENCODING;const g=u!==null&&u.get(Ur.CHARACTER_SET)!==void 0;g&&(p=u.get(Ur.CHARACTER_SET).toString());const x=this.chooseMode(s,p),y=new N;if(x===nt.BYTE&&(g||er.DEFAULT_BYTE_MODE_ENCODING!==p)){const Ue=B.getCharacterSetECIByName(p);Ue!==void 0&&this.appendECI(Ue,y)}this.appendModeInfo(x,y);const C=new N;this.appendBytes(s,x,C,p);let O;if(u!==null&&u.get(Ur.QR_VERSION)!==void 0){const Ue=Number.parseInt(u.get(Ur.QR_VERSION).toString(),10);O=tt.getVersionForNumber(Ue);const Pe=this.calculateBitsNeeded(x,y,C,O);if(!this.willFit(Pe,O,l))throw new Wt("Data too big for requested version")}else O=this.recommendVersion(l,x,y,C);const D=new N;D.appendBitArray(y);const L=x===nt.BYTE?C.getSizeInBytes():s.length;this.appendLengthInfo(L,O,x,D),D.appendBitArray(C);const U=O.getECBlocksForLevel(l),J=O.getTotalCodewords()-U.getTotalECCodewords();this.terminateBits(J,D);const ie=this.interleaveWithECBytes(D,O.getTotalCodewords(),J,U.getNumBlocks()),oe=new Do;oe.setECLevel(l),oe.setMode(x),oe.setVersion(O);const me=O.getDimensionForVersion(),_e=new Bf(me,me),Le=this.chooseMaskPattern(ie,l,O,_e);return oe.setMaskPattern(Le),it.buildMatrix(ie,l,O,Le,_e),oe.setMatrix(_e),oe}static recommendVersion(s,l,u,p){const g=this.calculateBitsNeeded(l,u,p,tt.getVersionForNumber(1)),x=this.chooseVersion(g,s),y=this.calculateBitsNeeded(l,u,p,x);return this.chooseVersion(y,s)}static calculateBitsNeeded(s,l,u,p){return l.getSize()+s.getCharacterCountBits(p)+u.getSize()}static getAlphanumericCode(s){return s<er.ALPHANUMERIC_TABLE.length?er.ALPHANUMERIC_TABLE[s]:-1}static chooseMode(s,l=null){if(B.SJIS.getName()===l&&this.isOnlyDoubleByteKanji(s))return nt.KANJI;let u=!1,p=!1;for(let g=0,x=s.length;g<x;++g){const y=s.charAt(g);if(er.isDigit(y))u=!0;else if(this.getAlphanumericCode(y.charCodeAt(0))!==-1)p=!0;else return nt.BYTE}return p?nt.ALPHANUMERIC:u?nt.NUMERIC:nt.BYTE}static isOnlyDoubleByteKanji(s){let l;try{l=ee.encode(s,B.SJIS)}catch{return!1}const u=l.length;if(u%2!==0)return!1;for(let p=0;p<u;p+=2){const g=l[p]&255;if((g<129||g>159)&&(g<224||g>235))return!1}return!0}static chooseMaskPattern(s,l,u,p){let g=Number.MAX_SAFE_INTEGER,x=-1;for(let y=0;y<Do.NUM_MASK_PATTERNS;y++){it.buildMatrix(s,l,u,y,p);let C=this.calculateMaskPenalty(p);C<g&&(g=C,x=y)}return x}static chooseVersion(s,l){for(let u=1;u<=40;u++){const p=tt.getVersionForNumber(u);if(er.willFit(s,p,l))return p}throw new Wt("Data too big")}static willFit(s,l,u){const p=l.getTotalCodewords(),x=l.getECBlocksForLevel(u).getTotalECCodewords(),y=p-x,C=(s+7)/8;return y>=C}static terminateBits(s,l){const u=s*8;if(l.getSize()>u)throw new Wt("data bits cannot fit in the QR Code"+l.getSize()+" > "+u);for(let x=0;x<4&&l.getSize()<u;++x)l.appendBit(!1);const p=l.getSize()&7;if(p>0)for(let x=p;x<8;x++)l.appendBit(!1);const g=s-l.getSizeInBytes();for(let x=0;x<g;++x)l.appendBits(x&1?17:236,8);if(l.getSize()!==u)throw new Wt("Bits size does not equal capacity")}static getNumDataBytesAndNumECBytesForBlockID(s,l,u,p,g,x){if(p>=u)throw new Wt("Block ID too large");const y=s%u,C=u-y,O=Math.floor(s/u),D=O+1,L=Math.floor(l/u),U=L+1,J=O-L,ie=D-U;if(J!==ie)throw new Wt("EC bytes mismatch");if(u!==C+y)throw new Wt("RS blocks mismatch");if(s!==(L+J)*C+(U+ie)*y)throw new Wt("Total bytes mismatch");p<C?(g[0]=L,x[0]=J):(g[0]=U,x[0]=ie)}static interleaveWithECBytes(s,l,u,p){if(s.getSizeInBytes()!==u)throw new Wt("Number of bits and data bytes does not match");let g=0,x=0,y=0;const C=new Array;for(let D=0;D<p;++D){const L=new Int32Array(1),U=new Int32Array(1);er.getNumDataBytesAndNumECBytesForBlockID(l,u,p,D,L,U);const J=L[0],ie=new Uint8Array(J);s.toBytes(8*g,ie,0,J);const oe=er.generateECBytes(ie,U[0]);C.push(new J5(ie,oe)),x=Math.max(x,J),y=Math.max(y,oe.length),g+=L[0]}if(u!==g)throw new Wt("Data bytes does not match offset");const O=new N;for(let D=0;D<x;++D)for(const L of C){const U=L.getDataBytes();D<U.length&&O.appendBits(U[D],8)}for(let D=0;D<y;++D)for(const L of C){const U=L.getErrorCorrectionBytes();D<U.length&&O.appendBits(U[D],8)}if(l!==O.getSizeInBytes())throw new Wt("Interleaving error: "+l+" and "+O.getSizeInBytes()+" differ.");return O}static generateECBytes(s,l){const u=s.length,p=new Int32Array(u+l);for(let x=0;x<u;x++)p[x]=s[x]&255;new xg(He.QR_CODE_FIELD_256).encode(p,l);const g=new Uint8Array(l);for(let x=0;x<l;x++)g[x]=p[u+x];return g}static appendModeInfo(s,l){l.appendBits(s.getBits(),4)}static appendLengthInfo(s,l,u,p){const g=u.getCharacterCountBits(l);if(s>=1<<g)throw new Wt(s+" is bigger than "+((1<<g)-1));p.appendBits(s,g)}static appendBytes(s,l,u,p){switch(l){case nt.NUMERIC:er.appendNumericBytes(s,u);break;case nt.ALPHANUMERIC:er.appendAlphanumericBytes(s,u);break;case nt.BYTE:er.append8BitBytes(s,u,p);break;case nt.KANJI:er.appendKanjiBytes(s,u);break;default:throw new Wt("Invalid mode: "+l)}}static getDigit(s){return s.charCodeAt(0)-48}static isDigit(s){const l=er.getDigit(s);return l>=0&&l<=9}static appendNumericBytes(s,l){const u=s.length;let p=0;for(;p<u;){const g=er.getDigit(s.charAt(p));if(p+2<u){const x=er.getDigit(s.charAt(p+1)),y=er.getDigit(s.charAt(p+2));l.appendBits(g*100+x*10+y,10),p+=3}else if(p+1<u){const x=er.getDigit(s.charAt(p+1));l.appendBits(g*10+x,7),p+=2}else l.appendBits(g,4),p++}}static appendAlphanumericBytes(s,l){const u=s.length;let p=0;for(;p<u;){const g=er.getAlphanumericCode(s.charCodeAt(p));if(g===-1)throw new Wt;if(p+1<u){const x=er.getAlphanumericCode(s.charCodeAt(p+1));if(x===-1)throw new Wt;l.appendBits(g*45+x,11),p+=2}else l.appendBits(g,6),p++}}static append8BitBytes(s,l,u){let p;try{p=ee.encode(s,u)}catch(g){throw new Wt(g)}for(let g=0,x=p.length;g!==x;g++){const y=p[g];l.appendBits(y,8)}}static appendKanjiBytes(s,l){let u;try{u=ee.encode(s,B.SJIS)}catch(g){throw new Wt(g)}const p=u.length;for(let g=0;g<p;g+=2){const x=u[g]&255,y=u[g+1]&255,C=x<<8&4294967295|y;let O=-1;if(C>=33088&&C<=40956?O=C-33088:C>=57408&&C<=60351&&(O=C-49472),O===-1)throw new Wt("Invalid byte sequence");const D=(O>>8)*192+(O&255);l.appendBits(D,13)}}static appendECI(s,l){l.appendBits(nt.ECI.getBits(),4),l.appendBits(s.getValue(),8)}}er.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),er.DEFAULT_BYTE_MODE_ENCODING=B.UTF8.getName();class Ro{write(s,l,u,p=null){if(s.length===0)throw new m("Found empty contents");if(l<0||u<0)throw new m("Requested dimensions are too small: "+l+"x"+u);let g=Kt.L,x=Ro.QUIET_ZONE_SIZE;p!==null&&(p.get(Ur.ERROR_CORRECTION)!==void 0&&(g=Kt.fromString(p.get(Ur.ERROR_CORRECTION).toString())),p.get(Ur.MARGIN)!==void 0&&(x=Number.parseInt(p.get(Ur.MARGIN).toString(),10)));const y=er.encode(s,g,p);return this.renderResult(y,l,u,x)}writeToDom(s,l,u,p,g=null){typeof s=="string"&&(s=document.querySelector(s));const x=this.write(l,u,p,g);s&&s.appendChild(x)}renderResult(s,l,u,p){const g=s.getMatrix();if(g===null)throw new et;const x=g.getWidth(),y=g.getHeight(),C=x+p*2,O=y+p*2,D=Math.max(l,C),L=Math.max(u,O),U=Math.min(Math.floor(D/C),Math.floor(L/O)),J=Math.floor((D-x*U)/2),ie=Math.floor((L-y*U)/2),oe=this.createSVGElement(D,L);for(let me=0,_e=ie;me<y;me++,_e+=U)for(let Le=0,Ue=J;Le<x;Le++,Ue+=U)if(g.get(Le,me)===1){const Pe=this.createSvgRectElement(Ue,_e,U,U);oe.appendChild(Pe)}return oe}createSVGElement(s,l){const u=document.createElementNS(Ro.SVG_NS,"svg");return u.setAttributeNS(null,"height",s.toString()),u.setAttributeNS(null,"width",l.toString()),u}createSvgRectElement(s,l,u,p){const g=document.createElementNS(Ro.SVG_NS,"rect");return g.setAttributeNS(null,"x",s.toString()),g.setAttributeNS(null,"y",l.toString()),g.setAttributeNS(null,"height",u.toString()),g.setAttributeNS(null,"width",p.toString()),g.setAttributeNS(null,"fill","#000000"),g}}Ro.QUIET_ZONE_SIZE=4,Ro.SVG_NS="http://www.w3.org/2000/svg";class Ll{encode(s,l,u,p,g){if(s.length===0)throw new m("Found empty contents");if(l!==he.QR_CODE)throw new m("Can only encode QR_CODE, but got "+l);if(u<0||p<0)throw new m(`Requested dimensions are too small: ${u}x${p}`);let x=Kt.L,y=Ll.QUIET_ZONE_SIZE;g!==null&&(g.get(Ur.ERROR_CORRECTION)!==void 0&&(x=Kt.fromString(g.get(Ur.ERROR_CORRECTION).toString())),g.get(Ur.MARGIN)!==void 0&&(y=Number.parseInt(g.get(Ur.MARGIN).toString(),10)));const C=er.encode(s,x,g);return Ll.renderResult(C,u,p,y)}static renderResult(s,l,u,p){const g=s.getMatrix();if(g===null)throw new et;const x=g.getWidth(),y=g.getHeight(),C=x+p*2,O=y+p*2,D=Math.max(l,C),L=Math.max(u,O),U=Math.min(Math.floor(D/C),Math.floor(L/O)),J=Math.floor((D-x*U)/2),ie=Math.floor((L-y*U)/2),oe=new pe(D,L);for(let me=0,_e=ie;me<y;me++,_e+=U)for(let Le=0,Ue=J;Le<x;Le++,Ue+=U)g.get(Le,me)===1&&oe.setRegion(Ue,_e,U,U);return oe}}Ll.QUIET_ZONE_SIZE=4;class eD{encode(s,l,u,p,g){let x;switch(l){case he.QR_CODE:x=new Ll;break;default:throw new m("No encoder available for format "+l)}return x.encode(s,l,u,p,g)}}class Oa extends se{constructor(s,l,u,p,g,x,y,C){if(super(x,y),this.yuvData=s,this.dataWidth=l,this.dataHeight=u,this.left=p,this.top=g,p+x>l||g+y>u)throw new m("Crop rectangle does not fit within image data.");C&&this.reverseHorizontal(x,y)}getRow(s,l){if(s<0||s>=this.getHeight())throw new m("Requested row is outside the image: "+s);const u=this.getWidth();(l==null||l.length<u)&&(l=new Uint8ClampedArray(u));const p=(s+this.top)*this.dataWidth+this.left;return A.arraycopy(this.yuvData,p,l,0,u),l}getMatrix(){const s=this.getWidth(),l=this.getHeight();if(s===this.dataWidth&&l===this.dataHeight)return this.yuvData;const u=s*l,p=new Uint8ClampedArray(u);let g=this.top*this.dataWidth+this.left;if(s===this.dataWidth)return A.arraycopy(this.yuvData,g,p,0,u),p;for(let x=0;x<l;x++){const y=x*s;A.arraycopy(this.yuvData,g,p,y,s),g+=this.dataWidth}return p}isCropSupported(){return!0}crop(s,l,u,p){return new Oa(this.yuvData,this.dataWidth,this.dataHeight,this.left+s,this.top+l,u,p,!1)}renderThumbnail(){const s=this.getWidth()/Oa.THUMBNAIL_SCALE_FACTOR,l=this.getHeight()/Oa.THUMBNAIL_SCALE_FACTOR,u=new Int32Array(s*l),p=this.yuvData;let g=this.top*this.dataWidth+this.left;for(let x=0;x<l;x++){const y=x*s;for(let C=0;C<s;C++){const O=p[g+C*Oa.THUMBNAIL_SCALE_FACTOR]&255;u[y+C]=4278190080|O*65793}g+=this.dataWidth*Oa.THUMBNAIL_SCALE_FACTOR}return u}getThumbnailWidth(){return this.getWidth()/Oa.THUMBNAIL_SCALE_FACTOR}getThumbnailHeight(){return this.getHeight()/Oa.THUMBNAIL_SCALE_FACTOR}reverseHorizontal(s,l){const u=this.yuvData;for(let p=0,g=this.top*this.dataWidth+this.left;p<l;p++,g+=this.dataWidth){const x=g+s/2;for(let y=g,C=g+s-1;y<x;y++,C--){const O=u[y];u[y]=u[C],u[C]=O}}}invert(){return new q(this)}}Oa.THUMBNAIL_SCALE_FACTOR=2;class vg extends se{constructor(s,l,u,p,g,x,y){if(super(l,u),this.dataWidth=p,this.dataHeight=g,this.left=x,this.top=y,s.BYTES_PER_ELEMENT===4){const C=l*u,O=new Uint8ClampedArray(C);for(let D=0;D<C;D++){const L=s[D],U=L>>16&255,J=L>>7&510,ie=L&255;O[D]=(U+J+ie)/4&255}this.luminances=O}else this.luminances=s;if(p===void 0&&(this.dataWidth=l),g===void 0&&(this.dataHeight=u),x===void 0&&(this.left=0),y===void 0&&(this.top=0),this.left+l>this.dataWidth||this.top+u>this.dataHeight)throw new m("Crop rectangle does not fit within image data.")}getRow(s,l){if(s<0||s>=this.getHeight())throw new m("Requested row is outside the image: "+s);const u=this.getWidth();(l==null||l.length<u)&&(l=new Uint8ClampedArray(u));const p=(s+this.top)*this.dataWidth+this.left;return A.arraycopy(this.luminances,p,l,0,u),l}getMatrix(){const s=this.getWidth(),l=this.getHeight();if(s===this.dataWidth&&l===this.dataHeight)return this.luminances;const u=s*l,p=new Uint8ClampedArray(u);let g=this.top*this.dataWidth+this.left;if(s===this.dataWidth)return A.arraycopy(this.luminances,g,p,0,u),p;for(let x=0;x<l;x++){const y=x*s;A.arraycopy(this.luminances,g,p,y,s),g+=this.dataWidth}return p}isCropSupported(){return!0}crop(s,l,u,p){return new vg(this.luminances,u,p,this.dataWidth,this.dataHeight,this.left+s,this.top+l)}invert(){return new q(this)}}class wE extends B{static forName(s){return this.getCharacterSetECIByName(s)}}class yg{}yg.ISO_8859_1=B.ISO8859_1;class EE{isCompact(){return this.compact}setCompact(s){this.compact=s}getSize(){return this.size}setSize(s){this.size=s}getLayers(){return this.layers}setLayers(s){this.layers=s}getCodeWords(){return this.codeWords}setCodeWords(s){this.codeWords=s}getMatrix(){return this.matrix}setMatrix(s){this.matrix=s}}class AE{static singletonList(s){return[s]}static min(s,l){return s.sort(l)[0]}}class tD{constructor(s){this.previous=s}getPrevious(){return this.previous}}class Bl extends tD{constructor(s,l,u){super(s),this.value=l,this.bitCount=u}appendTo(s,l){s.appendBits(this.value,this.bitCount)}add(s,l){return new Bl(this,s,l)}addBinaryShift(s,l){return console.warn("addBinaryShift on SimpleToken, this simply returns a copy of this token"),new Bl(this,s,l)}toString(){let s=this.value&(1<<this.bitCount)-1;return s|=1<<this.bitCount,"<"+_.toBinaryString(s|1<<this.bitCount).substring(1)+">"}}class wg extends Bl{constructor(s,l,u){super(s,0,0),this.binaryShiftStart=l,this.binaryShiftByteCount=u}appendTo(s,l){for(let u=0;u<this.binaryShiftByteCount;u++)(u===0||u===31&&this.binaryShiftByteCount<=62)&&(s.appendBits(31,5),this.binaryShiftByteCount>62?s.appendBits(this.binaryShiftByteCount-31,16):u===0?s.appendBits(Math.min(this.binaryShiftByteCount,31),5):s.appendBits(this.binaryShiftByteCount-31,5)),s.appendBits(l[this.binaryShiftStart+u],8)}addBinaryShift(s,l){return new wg(this,s,l)}toString(){return"<"+this.binaryShiftStart+"::"+(this.binaryShiftStart+this.binaryShiftByteCount-1)+">"}}function rD(F,s,l){return new wg(F,s,l)}function pu(F,s,l){return new Bl(F,s,l)}const nD=["UPPER","LOWER","DIGIT","MIXED","PUNCT"],Vs=0,jf=1,Li=2,CE=3,ka=4,iD=new Bl(null,0,0),Eg=[Int32Array.from([0,(5<<16)+28,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(9<<16)+480+14,0,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(4<<16)+14,(9<<16)+448+28,0,(9<<16)+448+29,932798]),Int32Array.from([(5<<16)+29,(5<<16)+28,656318,0,(5<<16)+30]),Int32Array.from([(5<<16)+31,656380,656382,656381,0])];function aD(F){for(let s of F)T.fill(s,-1);return F[Vs][ka]=0,F[jf][ka]=0,F[jf][Vs]=28,F[CE][ka]=0,F[Li][ka]=0,F[Li][Vs]=15,F}const SE=aD(T.createInt32Array(6,6));class Ia{constructor(s,l,u,p){this.token=s,this.mode=l,this.binaryShiftByteCount=u,this.bitCount=p}getMode(){return this.mode}getToken(){return this.token}getBinaryShiftByteCount(){return this.binaryShiftByteCount}getBitCount(){return this.bitCount}latchAndAppend(s,l){let u=this.bitCount,p=this.token;if(s!==this.mode){let x=Eg[this.mode][s];p=pu(p,x&65535,x>>16),u+=x>>16}let g=s===Li?4:5;return p=pu(p,l,g),new Ia(p,s,0,u+g)}shiftAndAppend(s,l){let u=this.token,p=this.mode===Li?4:5;return u=pu(u,SE[this.mode][s],p),u=pu(u,l,5),new Ia(u,this.mode,0,this.bitCount+p+5)}addBinaryShiftChar(s){let l=this.token,u=this.mode,p=this.bitCount;if(this.mode===ka||this.mode===Li){let y=Eg[u][Vs];l=pu(l,y&65535,y>>16),p+=y>>16,u=Vs}let g=this.binaryShiftByteCount===0||this.binaryShiftByteCount===31?18:this.binaryShiftByteCount===62?9:8,x=new Ia(l,u,this.binaryShiftByteCount+1,p+g);return x.binaryShiftByteCount===2078&&(x=x.endBinaryShift(s+1)),x}endBinaryShift(s){if(this.binaryShiftByteCount===0)return this;let l=this.token;return l=rD(l,s-this.binaryShiftByteCount,this.binaryShiftByteCount),new Ia(l,this.mode,0,this.bitCount)}isBetterThanOrEqualTo(s){let l=this.bitCount+(Eg[this.mode][s.mode]>>16);return this.binaryShiftByteCount<s.binaryShiftByteCount?l+=Ia.calculateBinaryShiftCost(s)-Ia.calculateBinaryShiftCost(this):this.binaryShiftByteCount>s.binaryShiftByteCount&&s.binaryShiftByteCount>0&&(l+=10),l<=s.bitCount}toBitArray(s){let l=[];for(let p=this.endBinaryShift(s.length).token;p!==null;p=p.getPrevious())l.unshift(p);let u=new N;for(const p of l)p.appendTo(u,s);return u}toString(){return V.format("%s bits=%d bytes=%d",nD[this.mode],this.bitCount,this.binaryShiftByteCount)}static calculateBinaryShiftCost(s){return s.binaryShiftByteCount>62?21:s.binaryShiftByteCount>31?20:s.binaryShiftByteCount>0?10:0}}Ia.INITIAL_STATE=new Ia(iD,Vs,0,0);function sD(F){const s=V.getCharCode(" "),l=V.getCharCode("."),u=V.getCharCode(",");F[Vs][s]=1;const p=V.getCharCode("Z"),g=V.getCharCode("A");for(let U=g;U<=p;U++)F[Vs][U]=U-g+2;F[jf][s]=1;const x=V.getCharCode("z"),y=V.getCharCode("a");for(let U=y;U<=x;U++)F[jf][U]=U-y+2;F[Li][s]=1;const C=V.getCharCode("9"),O=V.getCharCode("0");for(let U=O;U<=C;U++)F[Li][U]=U-O+2;F[Li][u]=12,F[Li][l]=13;const D=["\0"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~",""];for(let U=0;U<D.length;U++)F[CE][V.getCharCode(D[U])]=U;const L=["\0","\r","\0","\0","\0","\0","!","'","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}"];for(let U=0;U<L.length;U++)V.getCharCode(L[U])>0&&(F[ka][V.getCharCode(L[U])]=U);return F}const Ag=sD(T.createInt32Array(5,256));class gu{constructor(s){this.text=s}encode(){const s=V.getCharCode(" "),l=V.getCharCode(`
`);let u=AE.singletonList(Ia.INITIAL_STATE);for(let g=0;g<this.text.length;g++){let x,y=g+1<this.text.length?this.text[g+1]:0;switch(this.text[g]){case V.getCharCode("\r"):x=y===l?2:0;break;case V.getCharCode("."):x=y===s?3:0;break;case V.getCharCode(","):x=y===s?4:0;break;case V.getCharCode(":"):x=y===s?5:0;break;default:x=0}x>0?(u=gu.updateStateListForPair(u,g,x),g++):u=this.updateStateListForChar(u,g)}return AE.min(u,(g,x)=>g.getBitCount()-x.getBitCount()).toBitArray(this.text)}updateStateListForChar(s,l){const u=[];for(let p of s)this.updateStateForChar(p,l,u);return gu.simplifyStates(u)}updateStateForChar(s,l,u){let p=this.text[l]&255,g=Ag[s.getMode()][p]>0,x=null;for(let y=0;y<=ka;y++){let C=Ag[y][p];if(C>0){if(x==null&&(x=s.endBinaryShift(l)),!g||y===s.getMode()||y===Li){const O=x.latchAndAppend(y,C);u.push(O)}if(!g&&SE[s.getMode()][y]>=0){const O=x.shiftAndAppend(y,C);u.push(O)}}}if(s.getBinaryShiftByteCount()>0||Ag[s.getMode()][p]===0){let y=s.addBinaryShiftChar(l);u.push(y)}}static updateStateListForPair(s,l,u){const p=[];for(let g of s)this.updateStateForPair(g,l,u,p);return this.simplifyStates(p)}static updateStateForPair(s,l,u,p){let g=s.endBinaryShift(l);if(p.push(g.latchAndAppend(ka,u)),s.getMode()!==ka&&p.push(g.shiftAndAppend(ka,u)),u===3||u===4){let x=g.latchAndAppend(Li,16-u).latchAndAppend(Li,1);p.push(x)}if(s.getBinaryShiftByteCount()>0){let x=s.addBinaryShiftChar(l).addBinaryShiftChar(l+1);p.push(x)}}static simplifyStates(s){let l=[];for(const u of s){let p=!0;for(const g of l){if(g.isBetterThanOrEqualTo(u)){p=!1;break}u.isBetterThanOrEqualTo(g)&&(l=l.filter(x=>x!==g))}p&&l.push(u)}return l}}class kt{constructor(){}static encodeBytes(s){return kt.encode(s,kt.DEFAULT_EC_PERCENT,kt.DEFAULT_AZTEC_LAYERS)}static encode(s,l,u){let p=new gu(s).encode(),g=_.truncDivision(p.getSize()*l,100)+11,x=p.getSize()+g,y,C,O,D,L;if(u!==kt.DEFAULT_AZTEC_LAYERS){if(y=u<0,C=Math.abs(u),C>(y?kt.MAX_NB_BITS_COMPACT:kt.MAX_NB_BITS))throw new m(V.format("Illegal value %s for layers",u));O=kt.totalBitsInLayer(C,y),D=kt.WORD_SIZE[C];let Pe=O-O%D;if(L=kt.stuffBits(p,D),L.getSize()+g>Pe)throw new m("Data to large for user specified layer");if(y&&L.getSize()>D*64)throw new m("Data to large for user specified layer")}else{D=0,L=null;for(let Pe=0;;Pe++){if(Pe>kt.MAX_NB_BITS)throw new m("Data too large for an Aztec code");if(y=Pe<=3,C=y?Pe+1:Pe,O=kt.totalBitsInLayer(C,y),x>O)continue;(L==null||D!==kt.WORD_SIZE[C])&&(D=kt.WORD_SIZE[C],L=kt.stuffBits(p,D));let At=O-O%D;if(!(y&&L.getSize()>D*64)&&L.getSize()+g<=At)break}}let U=kt.generateCheckWords(L,O,D),J=L.getSize()/D,ie=kt.generateModeMessage(y,C,J),oe=(y?11:14)+C*4,me=new Int32Array(oe),_e;if(y){_e=oe;for(let Pe=0;Pe<me.length;Pe++)me[Pe]=Pe}else{_e=oe+1+2*_.truncDivision(_.truncDivision(oe,2)-1,15);let Pe=_.truncDivision(oe,2),At=_.truncDivision(_e,2);for(let ut=0;ut<Pe;ut++){let ri=ut+_.truncDivision(ut,15);me[Pe-ut-1]=At-ri-1,me[Pe+ut]=At+ri+1}}let Le=new pe(_e);for(let Pe=0,At=0;Pe<C;Pe++){let ut=(C-Pe)*4+(y?9:12);for(let ri=0;ri<ut;ri++){let sa=ri*2;for(let ni=0;ni<2;ni++)U.get(At+sa+ni)&&Le.set(me[Pe*2+ni],me[Pe*2+ri]),U.get(At+ut*2+sa+ni)&&Le.set(me[Pe*2+ri],me[oe-1-Pe*2-ni]),U.get(At+ut*4+sa+ni)&&Le.set(me[oe-1-Pe*2-ni],me[oe-1-Pe*2-ri]),U.get(At+ut*6+sa+ni)&&Le.set(me[oe-1-Pe*2-ri],me[Pe*2+ni])}At+=ut*8}if(kt.drawModeMessage(Le,y,_e,ie),y)kt.drawBullsEye(Le,_.truncDivision(_e,2),5);else{kt.drawBullsEye(Le,_.truncDivision(_e,2),7);for(let Pe=0,At=0;Pe<_.truncDivision(oe,2)-1;Pe+=15,At+=16)for(let ut=_.truncDivision(_e,2)&1;ut<_e;ut+=2)Le.set(_.truncDivision(_e,2)-At,ut),Le.set(_.truncDivision(_e,2)+At,ut),Le.set(ut,_.truncDivision(_e,2)-At),Le.set(ut,_.truncDivision(_e,2)+At)}let Ue=new EE;return Ue.setCompact(y),Ue.setSize(_e),Ue.setLayers(C),Ue.setCodeWords(J),Ue.setMatrix(Le),Ue}static drawBullsEye(s,l,u){for(let p=0;p<u;p+=2)for(let g=l-p;g<=l+p;g++)s.set(g,l-p),s.set(g,l+p),s.set(l-p,g),s.set(l+p,g);s.set(l-u,l-u),s.set(l-u+1,l-u),s.set(l-u,l-u+1),s.set(l+u,l-u),s.set(l+u,l-u+1),s.set(l+u,l+u-1)}static generateModeMessage(s,l,u){let p=new N;return s?(p.appendBits(l-1,2),p.appendBits(u-1,6),p=kt.generateCheckWords(p,28,4)):(p.appendBits(l-1,5),p.appendBits(u-1,11),p=kt.generateCheckWords(p,40,4)),p}static drawModeMessage(s,l,u,p){let g=_.truncDivision(u,2);if(l)for(let x=0;x<7;x++){let y=g-3+x;p.get(x)&&s.set(y,g-5),p.get(x+7)&&s.set(g+5,y),p.get(20-x)&&s.set(y,g+5),p.get(27-x)&&s.set(g-5,y)}else for(let x=0;x<10;x++){let y=g-5+x+_.truncDivision(x,5);p.get(x)&&s.set(y,g-7),p.get(x+10)&&s.set(g+7,y),p.get(29-x)&&s.set(y,g+7),p.get(39-x)&&s.set(g-7,y)}}static generateCheckWords(s,l,u){let p=s.getSize()/u,g=new xg(kt.getGF(u)),x=_.truncDivision(l,u),y=kt.bitsToWords(s,u,x);g.encode(y,x-p);let C=l%u,O=new N;O.appendBits(0,C);for(const D of Array.from(y))O.appendBits(D,u);return O}static bitsToWords(s,l,u){let p=new Int32Array(u),g,x;for(g=0,x=s.getSize()/l;g<x;g++){let y=0;for(let C=0;C<l;C++)y|=s.get(g*l+C)?1<<l-C-1:0;p[g]=y}return p}static getGF(s){switch(s){case 4:return He.AZTEC_PARAM;case 6:return He.AZTEC_DATA_6;case 8:return He.AZTEC_DATA_8;case 10:return He.AZTEC_DATA_10;case 12:return He.AZTEC_DATA_12;default:throw new m("Unsupported word size "+s)}}static stuffBits(s,l){let u=new N,p=s.getSize(),g=(1<<l)-2;for(let x=0;x<p;x+=l){let y=0;for(let C=0;C<l;C++)(x+C>=p||s.get(x+C))&&(y|=1<<l-1-C);(y&g)===g?(u.appendBits(y&g,l),x--):y&g?u.appendBits(y,l):(u.appendBits(y|1,l),x--)}return u}static totalBitsInLayer(s,l){return((l?88:112)+16*s)*s}}kt.DEFAULT_EC_PERCENT=33,kt.DEFAULT_AZTEC_LAYERS=0,kt.MAX_NB_BITS=32,kt.MAX_NB_BITS_COMPACT=4,kt.WORD_SIZE=Int32Array.from([4,6,6,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12]);class Uf{encode(s,l,u,p){return this.encodeWithHints(s,l,u,p,null)}encodeWithHints(s,l,u,p,g){let x=yg.ISO_8859_1,y=kt.DEFAULT_EC_PERCENT,C=kt.DEFAULT_AZTEC_LAYERS;return g!=null&&(g.has(Ur.CHARACTER_SET)&&(x=wE.forName(g.get(Ur.CHARACTER_SET).toString())),g.has(Ur.ERROR_CORRECTION)&&(y=_.parseInt(g.get(Ur.ERROR_CORRECTION).toString())),g.has(Ur.AZTEC_LAYERS)&&(C=_.parseInt(g.get(Ur.AZTEC_LAYERS).toString()))),Uf.encodeLayers(s,l,u,p,x,y,C)}static encodeLayers(s,l,u,p,g,x,y){if(l!==he.AZTEC)throw new m("Can only encode AZTEC, but got "+l);let C=kt.encode(V.getBytes(s,g),x,y);return Uf.renderResult(C,u,p)}static renderResult(s,l,u){let p=s.getMatrix();if(p==null)throw new et;let g=p.getWidth(),x=p.getHeight(),y=Math.max(l,g),C=Math.max(u,x),O=Math.min(y/g,C/x),D=(y-g*O)/2,L=(C-x*O)/2,U=new pe(y,C);for(let J=0,ie=L;J<x;J++,ie+=O)for(let oe=0,me=D;oe<g;oe++,me+=O)p.get(oe,J)&&U.setRegion(me,ie,O,O);return U}}r.AbstractExpandedDecoder=Y,r.ArgumentException=h,r.ArithmeticException=W,r.AztecCode=EE,r.AztecCodeReader=Xt,r.AztecCodeWriter=Uf,r.AztecDecoder=rt,r.AztecDetector=dt,r.AztecDetectorResult=Be,r.AztecEncoder=kt,r.AztecHighLevelEncoder=gu,r.AztecPoint=$t,r.BarcodeFormat=he,r.Binarizer=E,r.BinaryBitmap=v,r.BitArray=N,r.BitMatrix=pe,r.BitSource=fg,r.BrowserAztecCodeReader=ei,r.BrowserBarcodeReader=No,r.BrowserCodeReader=le,r.BrowserDatamatrixCodeReader=j5,r.BrowserMultiFormatReader=Z5,r.BrowserPDF417Reader=q5,r.BrowserQRCodeReader=Q5,r.BrowserQRCodeSvgWriter=Ro,r.CharacterSetECI=B,r.ChecksumException=w,r.Code128Reader=We,r.Code39Reader=vr,r.DataMatrixDecodedBitStreamParser=js,r.DataMatrixReader=Us,r.DecodeHintType=R,r.DecoderResult=ce,r.DefaultGridSampler=Fs,r.DetectorResult=Pi,r.EAN13Reader=qa,r.EncodeHintType=Ur,r.Exception=d,r.FormatException=P,r.GenericGF=He,r.GenericGFPoly=ze,r.GlobalHistogramBinarizer=Ce,r.GridSampler=_t,r.GridSamplerInstance=sr,r.HTMLCanvasElementLuminanceSource=fe,r.HybridBinarizer=ue,r.ITFReader=Mt,r.IllegalArgumentException=m,r.IllegalStateException=et,r.InvertedLuminanceSource=q,r.LuminanceSource=se,r.MathUtils=at,r.MultiFormatOneDReader=Ri,r.MultiFormatReader=yE,r.MultiFormatWriter=eD,r.NotFoundException=K,r.OneDReader=ht,r.PDF417DecodedBitStreamParser=Se,r.PDF417DecoderErrorCorrection=hE,r.PDF417Reader=pn,r.PDF417ResultMetadata=gE,r.PerspectiveTransform=Rt,r.PlanarYUVLuminanceSource=Oa,r.QRCodeByteMatrix=Bf,r.QRCodeDataMask=Mi,r.QRCodeDecodedBitStreamParser=dr,r.QRCodeDecoderErrorCorrectionLevel=Kt,r.QRCodeDecoderFormatInformation=bn,r.QRCodeEncoder=er,r.QRCodeEncoderQRCode=Do,r.QRCodeMaskUtil=yr,r.QRCodeMatrixUtil=it,r.QRCodeMode=nt,r.QRCodeReader=zs,r.QRCodeVersion=tt,r.QRCodeWriter=Ll,r.RGBLuminanceSource=vg,r.RSS14Reader=gt,r.RSSExpandedReader=Te,r.ReaderException=Lf,r.ReedSolomonDecoder=Ze,r.ReedSolomonEncoder=xg,r.ReedSolomonException=Ge,r.Result=ne,r.ResultMetadataType=De,r.ResultPoint=$e,r.StringUtils=V,r.UnsupportedOperationException=re,r.VideoInputDevice=we,r.WhiteRectangleDetector=Qe,r.WriterException=Wt,r.ZXingArrays=T,r.ZXingCharset=wE,r.ZXingInteger=_,r.ZXingStandardCharsets=yg,r.ZXingStringBuilder=de,r.ZXingStringEncoding=ee,r.ZXingSystem=A,r.createAbstractExpandedDecoder=je,Object.defineProperty(r,"__esModule",{value:!0})})})(Tx,Tx.exports);var hr=Tx.exports;const dF=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));var VA=function(){function e(t,r,n){if(this.formatMap=new Map([[Xe.QR_CODE,hr.BarcodeFormat.QR_CODE],[Xe.AZTEC,hr.BarcodeFormat.AZTEC],[Xe.CODABAR,hr.BarcodeFormat.CODABAR],[Xe.CODE_39,hr.BarcodeFormat.CODE_39],[Xe.CODE_93,hr.BarcodeFormat.CODE_93],[Xe.CODE_128,hr.BarcodeFormat.CODE_128],[Xe.DATA_MATRIX,hr.BarcodeFormat.DATA_MATRIX],[Xe.MAXICODE,hr.BarcodeFormat.MAXICODE],[Xe.ITF,hr.BarcodeFormat.ITF],[Xe.EAN_13,hr.BarcodeFormat.EAN_13],[Xe.EAN_8,hr.BarcodeFormat.EAN_8],[Xe.PDF_417,hr.BarcodeFormat.PDF_417],[Xe.RSS_14,hr.BarcodeFormat.RSS_14],[Xe.RSS_EXPANDED,hr.BarcodeFormat.RSS_EXPANDED],[Xe.UPC_A,hr.BarcodeFormat.UPC_A],[Xe.UPC_E,hr.BarcodeFormat.UPC_E],[Xe.UPC_EAN_EXTENSION,hr.BarcodeFormat.UPC_EAN_EXTENSION]]),this.reverseFormatMap=this.createReverseFormatMap(),!dF)throw"Use html5qrcode.min.js without edit, ZXing not found.";this.verbose=r,this.logger=n;var i=this.createZXingFormats(t),a=new Map;a.set(hr.DecodeHintType.POSSIBLE_FORMATS,i),a.set(hr.DecodeHintType.TRY_HARDER,!1),this.hints=a}return e.prototype.decodeAsync=function(t){var r=this;return new Promise(function(n,i){try{n(r.decode(t))}catch(a){i(a)}})},e.prototype.decode=function(t){var r=new hr.MultiFormatReader(this.verbose,this.hints),n=new hr.HTMLCanvasElementLuminanceSource(t),i=new hr.BinaryBitmap(new hr.HybridBinarizer(n)),a=r.decode(i);return{text:a.text,format:T8.create(this.toHtml5QrcodeSupportedFormats(a.format)),debugData:this.createDebugData()}},e.prototype.createReverseFormatMap=function(){var t=new Map;return this.formatMap.forEach(function(r,n,i){t.set(r,n)}),t},e.prototype.toHtml5QrcodeSupportedFormats=function(t){if(!this.reverseFormatMap.has(t))throw"reverseFormatMap doesn't have ".concat(t);return this.reverseFormatMap.get(t)},e.prototype.createZXingFormats=function(t){for(var r=[],n=0,i=t;n<i.length;n++){var a=i[n];this.formatMap.has(a)?r.push(this.formatMap.get(a)):this.logger.logError("".concat(a," is not supported by")+"ZXingHtml5QrcodeShim")}return r},e.prototype.createDebugData=function(){return{decoderName:"zxing-js"}},e}(),hF=function(e,t,r,n){function i(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function c(h){try{d(n.next(h))}catch(m){o(m)}}function f(h){try{d(n.throw(h))}catch(m){o(m)}}function d(h){h.done?a(h.value):i(h.value).then(c,f)}d((n=n.apply(e,t||[])).next())})},pF=function(e,t){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,i,a,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(d){return function(h){return f([d,h])}}function f(d){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,d[0]&&(r=0)),r;)try{if(n=1,i&&(a=d[0]&2?i.return:d[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,d[1])).done)return a;switch(i=0,a&&(d=[d[0]&2,a.value]),d[0]){case 0:case 1:a=d;break;case 4:return r.label++,{value:d[1],done:!1};case 5:r.label++,i=d[1],d=[0];continue;case 7:d=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(d[0]===6||d[0]===2)){r=0;continue}if(d[0]===3&&(!a||d[1]>a[0]&&d[1]<a[3])){r.label=d[1];break}if(d[0]===6&&r.label<a[1]){r.label=a[1],a=d;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(d);break}a[2]&&r.ops.pop(),r.trys.pop();continue}d=t.call(e,r)}catch(h){d=[6,h],i=0}finally{n=a=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}},HA=function(){function e(t,r,n){if(this.formatMap=new Map([[Xe.QR_CODE,"qr_code"],[Xe.AZTEC,"aztec"],[Xe.CODABAR,"codabar"],[Xe.CODE_39,"code_39"],[Xe.CODE_93,"code_93"],[Xe.CODE_128,"code_128"],[Xe.DATA_MATRIX,"data_matrix"],[Xe.ITF,"itf"],[Xe.EAN_13,"ean_13"],[Xe.EAN_8,"ean_8"],[Xe.PDF_417,"pdf417"],[Xe.UPC_A,"upc_a"],[Xe.UPC_E,"upc_e"]]),this.reverseFormatMap=this.createReverseFormatMap(),!e.isSupported())throw"Use html5qrcode.min.js without edit, Use BarcodeDetectorDelegate only if it isSupported();";this.verbose=r,this.logger=n;var i=this.createBarcodeDetectorFormats(t);if(this.detector=new BarcodeDetector(i),!this.detector)throw"BarcodeDetector detector not supported"}return e.isSupported=function(){if(!("BarcodeDetector"in window))return!1;var t=new BarcodeDetector({formats:["qr_code"]});return typeof t<"u"},e.prototype.decodeAsync=function(t){return hF(this,void 0,void 0,function(){var r,n;return pF(this,function(i){switch(i.label){case 0:return[4,this.detector.detect(t)];case 1:if(r=i.sent(),!r||r.length===0)throw"No barcode or QR code detected.";return n=this.selectLargestBarcode(r),[2,{text:n.rawValue,format:T8.create(this.toHtml5QrcodeSupportedFormats(n.format)),debugData:this.createDebugData()}]}})})},e.prototype.selectLargestBarcode=function(t){for(var r=null,n=0,i=0,a=t;i<a.length;i++){var o=a[i],c=o.boundingBox.width*o.boundingBox.height;c>n&&(n=c,r=o)}if(!r)throw"No largest barcode found";return r},e.prototype.createBarcodeDetectorFormats=function(t){for(var r=[],n=0,i=t;n<i.length;n++){var a=i[n];this.formatMap.has(a)?r.push(this.formatMap.get(a)):this.logger.warn("".concat(a," is not supported by")+"BarcodeDetectorDelegate")}return{formats:r}},e.prototype.toHtml5QrcodeSupportedFormats=function(t){if(!this.reverseFormatMap.has(t))throw"reverseFormatMap doesn't have ".concat(t);return this.reverseFormatMap.get(t)},e.prototype.createReverseFormatMap=function(){var t=new Map;return this.formatMap.forEach(function(r,n,i){t.set(r,n)}),t},e.prototype.createDebugData=function(){return{decoderName:"BarcodeDetector"}},e}(),GA=function(e,t,r,n){function i(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function c(h){try{d(n.next(h))}catch(m){o(m)}}function f(h){try{d(n.throw(h))}catch(m){o(m)}}function d(h){h.done?a(h.value):i(h.value).then(c,f)}d((n=n.apply(e,t||[])).next())})},$A=function(e,t){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,i,a,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(d){return function(h){return f([d,h])}}function f(d){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,d[0]&&(r=0)),r;)try{if(n=1,i&&(a=d[0]&2?i.return:d[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,d[1])).done)return a;switch(i=0,a&&(d=[d[0]&2,a.value]),d[0]){case 0:case 1:a=d;break;case 4:return r.label++,{value:d[1],done:!1};case 5:r.label++,i=d[1],d=[0];continue;case 7:d=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(d[0]===6||d[0]===2)){r=0;continue}if(d[0]===3&&(!a||d[1]>a[0]&&d[1]<a[3])){r.label=d[1];break}if(d[0]===6&&r.label<a[1]){r.label=a[1],a=d;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(d);break}a[2]&&r.ops.pop(),r.trys.pop();continue}d=t.call(e,r)}catch(h){d=[6,h],i=0}finally{n=a=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}},gF=function(){function e(t,r,n,i){this.EXECUTIONS_TO_REPORT_PERFORMANCE=100,this.executions=0,this.executionResults=[],this.wasPrimaryDecoderUsedInLastDecode=!1,this.verbose=n,r&&HA.isSupported()?(this.primaryDecoder=new HA(t,n,i),this.secondaryDecoder=new VA(t,n,i)):this.primaryDecoder=new VA(t,n,i)}return e.prototype.decodeAsync=function(t){return GA(this,void 0,void 0,function(){var r;return $A(this,function(n){switch(n.label){case 0:r=performance.now(),n.label=1;case 1:return n.trys.push([1,,3,4]),[4,this.getDecoder().decodeAsync(t)];case 2:return[2,n.sent()];case 3:return this.possiblyLogPerformance(r),[7];case 4:return[2]}})})},e.prototype.decodeRobustlyAsync=function(t){return GA(this,void 0,void 0,function(){var r,n;return $A(this,function(i){switch(i.label){case 0:r=performance.now(),i.label=1;case 1:return i.trys.push([1,3,4,5]),[4,this.primaryDecoder.decodeAsync(t)];case 2:return[2,i.sent()];case 3:if(n=i.sent(),this.secondaryDecoder)return[2,this.secondaryDecoder.decodeAsync(t)];throw n;case 4:return this.possiblyLogPerformance(r),[7];case 5:return[2]}})})},e.prototype.getDecoder=function(){return this.secondaryDecoder?this.wasPrimaryDecoderUsedInLastDecode===!1?(this.wasPrimaryDecoderUsedInLastDecode=!0,this.primaryDecoder):(this.wasPrimaryDecoderUsedInLastDecode=!1,this.secondaryDecoder):this.primaryDecoder},e.prototype.possiblyLogPerformance=function(t){if(this.verbose){var r=performance.now()-t;this.executionResults.push(r),this.executions++,this.possiblyFlushPerformanceReport()}},e.prototype.possiblyFlushPerformanceReport=function(){if(!(this.executions<this.EXECUTIONS_TO_REPORT_PERFORMANCE)){for(var t=0,r=0,n=this.executionResults;r<n.length;r++){var i=n[r];t+=i}var a=t/this.executionResults.length;console.log("".concat(a," ms for ").concat(this.executionResults.length," last runs.")),this.executions=0,this.executionResults=[]}},e}(),M2=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Sh=function(e,t,r,n){function i(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function c(h){try{d(n.next(h))}catch(m){o(m)}}function f(h){try{d(n.throw(h))}catch(m){o(m)}}function d(h){h.done?a(h.value):i(h.value).then(c,f)}d((n=n.apply(e,t||[])).next())})},_h=function(e,t){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,i,a,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(d){return function(h){return f([d,h])}}function f(d){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,d[0]&&(r=0)),r;)try{if(n=1,i&&(a=d[0]&2?i.return:d[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,d[1])).done)return a;switch(i=0,a&&(d=[d[0]&2,a.value]),d[0]){case 0:case 1:a=d;break;case 4:return r.label++,{value:d[1],done:!1};case 5:r.label++,i=d[1],d=[0];continue;case 7:d=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(d[0]===6||d[0]===2)){r=0;continue}if(d[0]===3&&(!a||d[1]>a[0]&&d[1]<a[3])){r.label=d[1];break}if(d[0]===6&&r.label<a[1]){r.label=a[1],a=d;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(d);break}a[2]&&r.ops.pop(),r.trys.pop();continue}d=t.call(e,r)}catch(h){d=[6,h],i=0}finally{n=a=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}},k8=function(){function e(t,r){this.name=t,this.track=r}return e.prototype.isSupported=function(){return this.track.getCapabilities?this.name in this.track.getCapabilities():!1},e.prototype.apply=function(t){var r={};r[this.name]=t;var n={advanced:[r]};return this.track.applyConstraints(n)},e.prototype.value=function(){var t=this.track.getSettings();if(this.name in t){var r=t[this.name];return r}return null},e}(),mF=function(e){M2(t,e);function t(r,n){return e.call(this,r,n)||this}return t.prototype.min=function(){return this.getCapabilities().min},t.prototype.max=function(){return this.getCapabilities().max},t.prototype.step=function(){return this.getCapabilities().step},t.prototype.apply=function(r){var n={};n[this.name]=r;var i={advanced:[n]};return this.track.applyConstraints(i)},t.prototype.getCapabilities=function(){this.failIfNotSupported();var r=this.track.getCapabilities(),n=r[this.name];return{min:n.min,max:n.max,step:n.step}},t.prototype.failIfNotSupported=function(){if(!this.isSupported())throw new Error("".concat(this.name," capability not supported"))},t}(k8),xF=function(e){M2(t,e);function t(r){return e.call(this,"zoom",r)||this}return t}(mF),vF=function(e){M2(t,e);function t(r){return e.call(this,"torch",r)||this}return t}(k8),yF=function(){function e(t){this.track=t}return e.prototype.zoomFeature=function(){return new xF(this.track)},e.prototype.torchFeature=function(){return new vF(this.track)},e}(),wF=function(){function e(t,r,n){this.isClosed=!1,this.parentElement=t,this.mediaStream=r,this.callbacks=n,this.surface=this.createVideoElement(this.parentElement.clientWidth),t.append(this.surface)}return e.prototype.createVideoElement=function(t){var r=document.createElement("video");return r.style.width="".concat(t,"px"),r.style.display="block",r.muted=!0,r.setAttribute("muted","true"),r.playsInline=!0,r},e.prototype.setupSurface=function(){var t=this;this.surface.onabort=function(){throw"RenderedCameraImpl video surface onabort() called"},this.surface.onerror=function(){throw"RenderedCameraImpl video surface onerror() called"};var r=function(){var n=t.surface.clientWidth,i=t.surface.clientHeight;t.callbacks.onRenderSurfaceReady(n,i),t.surface.removeEventListener("playing",r)};this.surface.addEventListener("playing",r),this.surface.srcObject=this.mediaStream,this.surface.play()},e.create=function(t,r,n,i){return Sh(this,void 0,void 0,function(){var a,o;return _h(this,function(c){switch(c.label){case 0:return a=new e(t,r,i),n.aspectRatio?(o={aspectRatio:n.aspectRatio},[4,a.getFirstTrackOrFail().applyConstraints(o)]):[3,2];case 1:c.sent(),c.label=2;case 2:return a.setupSurface(),[2,a]}})})},e.prototype.failIfClosed=function(){if(this.isClosed)throw"The RenderedCamera has already been closed."},e.prototype.getFirstTrackOrFail=function(){if(this.failIfClosed(),this.mediaStream.getVideoTracks().length===0)throw"No video tracks found";return this.mediaStream.getVideoTracks()[0]},e.prototype.pause=function(){this.failIfClosed(),this.surface.pause()},e.prototype.resume=function(t){this.failIfClosed();var r=this,n=function(){setTimeout(t,200),r.surface.removeEventListener("playing",n)};this.surface.addEventListener("playing",n),this.surface.play()},e.prototype.isPaused=function(){return this.failIfClosed(),this.surface.paused},e.prototype.getSurface=function(){return this.failIfClosed(),this.surface},e.prototype.getRunningTrackCapabilities=function(){return this.getFirstTrackOrFail().getCapabilities()},e.prototype.getRunningTrackSettings=function(){return this.getFirstTrackOrFail().getSettings()},e.prototype.applyVideoConstraints=function(t){return Sh(this,void 0,void 0,function(){return _h(this,function(r){if("aspectRatio"in t)throw"Changing 'aspectRatio' in run-time is not yet supported.";return[2,this.getFirstTrackOrFail().applyConstraints(t)]})})},e.prototype.close=function(){if(this.isClosed)return Promise.resolve();var t=this;return new Promise(function(r,n){var i=t.mediaStream.getVideoTracks(),a=i.length,o=0;t.mediaStream.getVideoTracks().forEach(function(c){t.mediaStream.removeTrack(c),c.stop(),++o,o>=a&&(t.isClosed=!0,t.parentElement.removeChild(t.surface),r())})})},e.prototype.getCapabilities=function(){return new yF(this.getFirstTrackOrFail())},e}(),EF=function(){function e(t){this.mediaStream=t}return e.prototype.render=function(t,r,n){return Sh(this,void 0,void 0,function(){return _h(this,function(i){return[2,wF.create(t,this.mediaStream,r,n)]})})},e.create=function(t){return Sh(this,void 0,void 0,function(){var r,n;return _h(this,function(i){switch(i.label){case 0:if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return r={audio:!1,video:t},[4,navigator.mediaDevices.getUserMedia(r)];case 1:return n=i.sent(),[2,new e(n)]}})})},e}(),XA=function(e,t,r,n){function i(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function c(h){try{d(n.next(h))}catch(m){o(m)}}function f(h){try{d(n.throw(h))}catch(m){o(m)}}function d(h){h.done?a(h.value):i(h.value).then(c,f)}d((n=n.apply(e,t||[])).next())})},KA=function(e,t){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,i,a,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(d){return function(h){return f([d,h])}}function f(d){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,d[0]&&(r=0)),r;)try{if(n=1,i&&(a=d[0]&2?i.return:d[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,d[1])).done)return a;switch(i=0,a&&(d=[d[0]&2,a.value]),d[0]){case 0:case 1:a=d;break;case 4:return r.label++,{value:d[1],done:!1};case 5:r.label++,i=d[1],d=[0];continue;case 7:d=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(d[0]===6||d[0]===2)){r=0;continue}if(d[0]===3&&(!a||d[1]>a[0]&&d[1]<a[3])){r.label=d[1];break}if(d[0]===6&&r.label<a[1]){r.label=a[1],a=d;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(d);break}a[2]&&r.ops.pop(),r.trys.pop();continue}d=t.call(e,r)}catch(h){d=[6,h],i=0}finally{n=a=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}},AF=function(){function e(){}return e.failIfNotSupported=function(){return XA(this,void 0,void 0,function(){return KA(this,function(t){if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return[2,new e]})})},e.prototype.create=function(t){return XA(this,void 0,void 0,function(){return KA(this,function(r){return[2,EF.create(t)]})})},e}(),CF=function(e,t,r,n){function i(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function c(h){try{d(n.next(h))}catch(m){o(m)}}function f(h){try{d(n.throw(h))}catch(m){o(m)}}function d(h){h.done?a(h.value):i(h.value).then(c,f)}d((n=n.apply(e,t||[])).next())})},SF=function(e,t){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,i,a,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(d){return function(h){return f([d,h])}}function f(d){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,d[0]&&(r=0)),r;)try{if(n=1,i&&(a=d[0]&2?i.return:d[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,d[1])).done)return a;switch(i=0,a&&(d=[d[0]&2,a.value]),d[0]){case 0:case 1:a=d;break;case 4:return r.label++,{value:d[1],done:!1};case 5:r.label++,i=d[1],d=[0];continue;case 7:d=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(d[0]===6||d[0]===2)){r=0;continue}if(d[0]===3&&(!a||d[1]>a[0]&&d[1]<a[3])){r.label=d[1];break}if(d[0]===6&&r.label<a[1]){r.label=a[1],a=d;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(d);break}a[2]&&r.ops.pop(),r.trys.pop();continue}d=t.call(e,r)}catch(h){d=[6,h],i=0}finally{n=a=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}},_F=function(){function e(){}return e.retrieve=function(){if(navigator.mediaDevices)return e.getCamerasFromMediaDevices();var t=MediaStreamTrack;return MediaStreamTrack&&t.getSources?e.getCamerasFromMediaStreamTrack():e.rejectWithError()},e.rejectWithError=function(){var t=lc.unableToQuerySupportedDevices();return e.isHttpsOrLocalhost()||(t=lc.insecureContextCameraQueryError()),Promise.reject(t)},e.isHttpsOrLocalhost=function(){if(location.protocol==="https:")return!0;var t=location.host.split(":")[0];return t==="127.0.0.1"||t==="localhost"},e.getCamerasFromMediaDevices=function(){return CF(this,void 0,void 0,function(){var t,r,n,i,a,o,c;return SF(this,function(f){switch(f.label){case 0:return t=function(d){for(var h=d.getVideoTracks(),m=0,v=h;m<v.length;m++){var w=v[m];w.enabled=!1,w.stop(),d.removeTrack(w)}},[4,navigator.mediaDevices.getUserMedia({audio:!1,video:!0})];case 1:return r=f.sent(),[4,navigator.mediaDevices.enumerateDevices()];case 2:for(n=f.sent(),i=[],a=0,o=n;a<o.length;a++)c=o[a],c.kind==="videoinput"&&i.push({id:c.deviceId,label:c.label});return t(r),[2,i]}})})},e.getCamerasFromMediaStreamTrack=function(){return new Promise(function(t,r){var n=function(a){for(var o=[],c=0,f=a;c<f.length;c++){var d=f[c];d.kind==="video"&&o.push({id:d.id,label:d.label})}t(o)},i=MediaStreamTrack;i.getSources(n)})},e}(),Er;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.NOT_STARTED=1]="NOT_STARTED",e[e.SCANNING=2]="SCANNING",e[e.PAUSED=3]="PAUSED"})(Er||(Er={}));var bF=function(){function e(){this.state=Er.NOT_STARTED,this.onGoingTransactionNewState=Er.UNKNOWN}return e.prototype.directTransition=function(t){this.failIfTransitionOngoing(),this.validateTransition(t),this.state=t},e.prototype.startTransition=function(t){return this.failIfTransitionOngoing(),this.validateTransition(t),this.onGoingTransactionNewState=t,this},e.prototype.execute=function(){if(this.onGoingTransactionNewState===Er.UNKNOWN)throw"Transaction is already cancelled, cannot execute().";var t=this.onGoingTransactionNewState;this.onGoingTransactionNewState=Er.UNKNOWN,this.directTransition(t)},e.prototype.cancel=function(){if(this.onGoingTransactionNewState===Er.UNKNOWN)throw"Transaction is already cancelled, cannot cancel().";this.onGoingTransactionNewState=Er.UNKNOWN},e.prototype.getState=function(){return this.state},e.prototype.failIfTransitionOngoing=function(){if(this.onGoingTransactionNewState!==Er.UNKNOWN)throw"Cannot transition to a new state, already under transition"},e.prototype.validateTransition=function(t){switch(this.state){case Er.UNKNOWN:throw"Transition from unknown is not allowed";case Er.NOT_STARTED:this.failIfNewStateIs(t,[Er.PAUSED]);break;case Er.SCANNING:break;case Er.PAUSED:break}},e.prototype.failIfNewStateIs=function(t,r){for(var n=0,i=r;n<i.length;n++){var a=i[n];if(t===a)throw"Cannot transition from ".concat(this.state," to ").concat(t)}},e}(),TF=function(){function e(t){this.stateManager=t}return e.prototype.startTransition=function(t){return this.stateManager.startTransition(t)},e.prototype.directTransition=function(t){this.stateManager.directTransition(t)},e.prototype.getState=function(){return this.stateManager.getState()},e.prototype.canScanFile=function(){return this.stateManager.getState()===Er.NOT_STARTED},e.prototype.isScanning=function(){return this.stateManager.getState()!==Er.NOT_STARTED},e.prototype.isStrictlyScanning=function(){return this.stateManager.getState()===Er.SCANNING},e.prototype.isPaused=function(){return this.stateManager.getState()===Er.PAUSED},e}(),OF=function(){function e(){}return e.create=function(){return new TF(new bF)},e}(),kF=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),vi=function(e){kF(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.DEFAULT_WIDTH=300,t.DEFAULT_WIDTH_OFFSET=2,t.FILE_SCAN_MIN_HEIGHT=300,t.FILE_SCAN_HIDDEN_CANVAS_PADDING=100,t.MIN_QR_BOX_SIZE=50,t.SHADED_LEFT=1,t.SHADED_RIGHT=2,t.SHADED_TOP=3,t.SHADED_BOTTOM=4,t.SHADED_REGION_ELEMENT_ID="qr-shaded-region",t.VERBOSE=!1,t.BORDER_SHADER_DEFAULT_COLOR="#ffffff",t.BORDER_SHADER_MATCH_COLOR="rgb(90, 193, 56)",t}(cF),IF=function(){function e(t,r){this.logger=r,this.fps=vi.SCAN_DEFAULT_FPS,t?(t.fps&&(this.fps=t.fps),this.disableFlip=t.disableFlip===!0,this.qrbox=t.qrbox,this.aspectRatio=t.aspectRatio,this.videoConstraints=t.videoConstraints):this.disableFlip=vi.DEFAULT_DISABLE_FLIP}return e.prototype.isMediaStreamConstraintsValid=function(){return this.videoConstraints?O8.isMediaStreamConstraintsValid(this.videoConstraints,this.logger):(this.logger.logError("Empty videoConstraints",!0),!1)},e.prototype.isShadedBoxEnabled=function(){return!Ja(this.qrbox)},e.create=function(t,r){return new e(t,r)},e}(),YA=function(){function e(t,r){if(this.element=null,this.canvasElement=null,this.scannerPausedUiElement=null,this.hasBorderShaders=null,this.borderShaders=null,this.qrMatch=null,this.renderedCamera=null,this.qrRegion=null,this.context=null,this.lastScanImageFile=null,this.isScanning=!1,!document.getElementById(t))throw"HTML Element with id=".concat(t," not found");this.elementId=t,this.verbose=!1;var n;typeof r=="boolean"?this.verbose=r===!0:r&&(n=r,this.verbose=n.verbose===!0,n.experimentalFeatures),this.logger=new fF(this.verbose),this.qrcode=new gF(this.getSupportedFormats(r),this.getUseBarCodeDetectorIfSupported(n),this.verbose,this.logger),this.foreverScanTimeout,this.shouldScan=!0,this.stateManagerProxy=OF.create()}return e.prototype.start=function(t,r,n,i){var a=this;if(!t)throw"cameraIdOrConfig is required";if(!n||typeof n!="function")throw"qrCodeSuccessCallback is required and should be a function.";var o;i?o=i:o=this.verbose?this.logger.log:function(){};var c=IF.create(r,this.logger);this.clearElement();var f=!1;c.videoConstraints&&(c.isMediaStreamConstraintsValid()?f=!0:this.logger.logError("'videoConstraints' is not valid 'MediaStreamConstraints, it will be ignored.'",!0));var d=f,h=document.getElementById(this.elementId);h.clientWidth?h.clientWidth:vi.DEFAULT_WIDTH,h.style.position="relative",this.shouldScan=!0,this.element=h;var m=this,v=this.stateManagerProxy.startTransition(Er.SCANNING);return new Promise(function(w,E){var A=d?c.videoConstraints:m.createVideoConstraints(t);if(!A){v.cancel(),E("videoConstraints should be defined");return}var S={};(!d||c.aspectRatio)&&(S.aspectRatio=c.aspectRatio);var b={onRenderSurfaceReady:function(T,_){m.setupUi(T,_,c),m.isScanning=!0,m.foreverScan(c,n,o)}};AF.failIfNotSupported().then(function(T){T.create(A).then(function(_){return _.render(a.element,S,b).then(function(N){m.renderedCamera=N,v.execute(),w(null)}).catch(function(N){v.cancel(),E(N)})}).catch(function(_){v.cancel(),E(lc.errorGettingUserMedia(_))})}).catch(function(T){v.cancel(),E(lc.cameraStreamingNotSupported())})})},e.prototype.pause=function(t){if(!this.stateManagerProxy.isStrictlyScanning())throw"Cannot pause, scanner is not scanning.";this.stateManagerProxy.directTransition(Er.PAUSED),this.showPausedState(),(Ja(t)||t!==!0)&&(t=!1),t&&this.renderedCamera&&this.renderedCamera.pause()},e.prototype.resume=function(){if(!this.stateManagerProxy.isPaused())throw"Cannot result, scanner is not paused.";if(!this.renderedCamera)throw"renderedCamera doesn't exist while trying resume()";var t=this,r=function(){t.stateManagerProxy.directTransition(Er.SCANNING),t.hidePausedState()};if(!this.renderedCamera.isPaused()){r();return}this.renderedCamera.resume(function(){r()})},e.prototype.getState=function(){return this.stateManagerProxy.getState()},e.prototype.stop=function(){var t=this;if(!this.stateManagerProxy.isScanning())throw"Cannot stop, scanner is not running or paused.";var r=this.stateManagerProxy.startTransition(Er.NOT_STARTED);this.shouldScan=!1,this.foreverScanTimeout&&clearTimeout(this.foreverScanTimeout);var n=function(){if(t.element){var a=document.getElementById(vi.SHADED_REGION_ELEMENT_ID);a&&t.element.removeChild(a)}},i=this;return this.renderedCamera.close().then(function(){return i.renderedCamera=null,i.element&&(i.element.removeChild(i.canvasElement),i.canvasElement=null),n(),i.qrRegion&&(i.qrRegion=null),i.context&&(i.context=null),r.execute(),i.hidePausedState(),i.isScanning=!1,Promise.resolve()})},e.prototype.scanFile=function(t,r){return this.scanFileV2(t,r).then(function(n){return n.decodedText})},e.prototype.scanFileV2=function(t,r){var n=this;if(!t||!(t instanceof File))throw"imageFile argument is mandatory and should be instance of File. Use 'event.target.files[0]'.";if(Ja(r)&&(r=!0),!this.stateManagerProxy.canScanFile())throw"Cannot start file scan - ongoing camera scan";return new Promise(function(i,a){n.possiblyCloseLastScanImageFile(),n.clearElement(),n.lastScanImageFile=URL.createObjectURL(t);var o=new Image;o.onload=function(){var c=o.width,f=o.height,d=document.getElementById(n.elementId),h=d.clientWidth?d.clientWidth:vi.DEFAULT_WIDTH,m=Math.max(d.clientHeight?d.clientHeight:f,vi.FILE_SCAN_MIN_HEIGHT),v=n.computeCanvasDrawConfig(c,f,h,m);if(r){var w=n.createCanvasElement(h,m,"qr-canvas-visible");w.style.display="inline-block",d.appendChild(w);var E=w.getContext("2d");if(!E)throw"Unable to get 2d context from canvas";E.canvas.width=h,E.canvas.height=m,E.drawImage(o,0,0,c,f,v.x,v.y,v.width,v.height)}var A=vi.FILE_SCAN_HIDDEN_CANVAS_PADDING,S=Math.max(o.width,v.width),b=Math.max(o.height,v.height),T=S+2*A,_=b+2*A,N=n.createCanvasElement(T,_);d.appendChild(N);var M=N.getContext("2d");if(!M)throw"Unable to get 2d context from canvas";M.canvas.width=T,M.canvas.height=_,M.drawImage(o,0,0,c,f,A,A,S,b);try{n.qrcode.decodeRobustlyAsync(N).then(function(R){i(WA.createFromQrcodeResult(R))}).catch(a)}catch(R){a("QR code parse error, error = ".concat(R))}},o.onerror=a,o.onabort=a,o.onstalled=a,o.onsuspend=a,o.src=URL.createObjectURL(t)})},e.prototype.clear=function(){this.clearElement()},e.getCameras=function(){return _F.retrieve()},e.prototype.getRunningTrackCapabilities=function(){return this.getRenderedCameraOrFail().getRunningTrackCapabilities()},e.prototype.getRunningTrackSettings=function(){return this.getRenderedCameraOrFail().getRunningTrackSettings()},e.prototype.getRunningTrackCameraCapabilities=function(){return this.getRenderedCameraOrFail().getCapabilities()},e.prototype.applyVideoConstraints=function(t){if(t){if(!O8.isMediaStreamConstraintsValid(t,this.logger))throw"invalid videoConstaints passed, check logs for more details"}else throw"videoConstaints is required argument.";return this.getRenderedCameraOrFail().applyVideoConstraints(t)},e.prototype.getRenderedCameraOrFail=function(){if(this.renderedCamera==null)throw"Scanning is not in running state, call this API only when QR code scanning using camera is in running state.";return this.renderedCamera},e.prototype.getSupportedFormats=function(t){var r=[Xe.QR_CODE,Xe.AZTEC,Xe.CODABAR,Xe.CODE_39,Xe.CODE_93,Xe.CODE_128,Xe.DATA_MATRIX,Xe.MAXICODE,Xe.ITF,Xe.EAN_13,Xe.EAN_8,Xe.PDF_417,Xe.RSS_14,Xe.RSS_EXPANDED,Xe.UPC_A,Xe.UPC_E,Xe.UPC_EAN_EXTENSION];if(!t||typeof t=="boolean"||!t.formatsToSupport)return r;if(!Array.isArray(t.formatsToSupport))throw"configOrVerbosityFlag.formatsToSupport should be undefined or an array.";if(t.formatsToSupport.length===0)throw"Atleast 1 formatsToSupport is needed.";for(var n=[],i=0,a=t.formatsToSupport;i<a.length;i++){var o=a[i];lF(o)?n.push(o):this.logger.warn("Invalid format: ".concat(o," passed in config, ignoring."))}if(n.length===0)throw"None of formatsToSupport match supported values.";return n},e.prototype.getUseBarCodeDetectorIfSupported=function(t){if(Ja(t))return!0;if(!Ja(t.useBarCodeDetectorIfSupported))return t.useBarCodeDetectorIfSupported!==!1;if(Ja(t.experimentalFeatures))return!0;var r=t.experimentalFeatures;return Ja(r.useBarCodeDetectorIfSupported)?!0:r.useBarCodeDetectorIfSupported!==!1},e.prototype.validateQrboxSize=function(t,r,n){var i=this,a=n.qrbox;this.validateQrboxConfig(a);var o=this.toQrdimensions(t,r,a),c=function(d){if(d<vi.MIN_QR_BOX_SIZE)throw"minimum size of 'config.qrbox' dimension value is"+" ".concat(vi.MIN_QR_BOX_SIZE,"px.")},f=function(d){return d>t&&(i.logger.warn("`qrbox.width` or `qrbox` is larger than the width of the root element. The width will be truncated to the width of root element."),d=t),d};c(o.width),c(o.height),o.width=f(o.width)},e.prototype.validateQrboxConfig=function(t){if(typeof t!="number"&&typeof t!="function"&&(t.width===void 0||t.height===void 0))throw"Invalid instance of QrDimensions passed for 'config.qrbox'. Both 'width' and 'height' should be set."},e.prototype.toQrdimensions=function(t,r,n){if(typeof n=="number")return{width:n,height:n};if(typeof n=="function")try{return n(t,r)}catch(i){throw new Error("qrbox config was passed as a function but it failed with unknown error"+i)}return n},e.prototype.setupUi=function(t,r,n){n.isShadedBoxEnabled()&&this.validateQrboxSize(t,r,n);var i=Ja(n.qrbox)?{width:t,height:r}:n.qrbox;this.validateQrboxConfig(i);var a=this.toQrdimensions(t,r,i);a.height>r&&this.logger.warn("[Html5Qrcode] config.qrbox has height that isgreater than the height of the video stream. Shading will be ignored");var o=n.isShadedBoxEnabled()&&a.height<=r,c={x:0,y:0,width:t,height:r},f=o?this.getShadedRegionBounds(t,r,a):c,d=this.createCanvasElement(f.width,f.height),h={willReadFrequently:!0},m=d.getContext("2d",h);m.canvas.width=f.width,m.canvas.height=f.height,this.element.append(d),o&&this.possiblyInsertShadingElement(this.element,t,r,a),this.createScannerPausedUiElement(this.element),this.qrRegion=f,this.context=m,this.canvasElement=d},e.prototype.createScannerPausedUiElement=function(t){var r=document.createElement("div");r.innerText=lc.scannerPaused(),r.style.display="none",r.style.position="absolute",r.style.top="0px",r.style.zIndex="1",r.style.background="rgba(9, 9, 9, 0.46)",r.style.color="#FFECEC",r.style.textAlign="center",r.style.width="100%",t.appendChild(r),this.scannerPausedUiElement=r},e.prototype.scanContext=function(t,r){var n=this;return this.stateManagerProxy.isPaused()?Promise.resolve(!1):this.qrcode.decodeAsync(this.canvasElement).then(function(i){return t(i.text,WA.createFromQrcodeResult(i)),n.possiblyUpdateShaders(!0),!0}).catch(function(i){n.possiblyUpdateShaders(!1);var a=lc.codeParseError(i);return r(a,uF.createFrom(a)),!1})},e.prototype.foreverScan=function(t,r,n){var i=this;if(this.shouldScan&&this.renderedCamera){var a=this.renderedCamera.getSurface(),o=a.videoWidth/a.clientWidth,c=a.videoHeight/a.clientHeight;if(!this.qrRegion)throw"qrRegion undefined when localMediaStream is ready.";var f=this.qrRegion.width*o,d=this.qrRegion.height*c,h=this.qrRegion.x*o,m=this.qrRegion.y*c;this.context.drawImage(a,h,m,f,d,0,0,this.qrRegion.width,this.qrRegion.height);var v=function(){i.foreverScanTimeout=setTimeout(function(){i.foreverScan(t,r,n)},i.getTimeoutFps(t.fps))};this.scanContext(r,n).then(function(w){!w&&t.disableFlip!==!0?(i.context.translate(i.context.canvas.width,0),i.context.scale(-1,1),i.scanContext(r,n).finally(function(){v()})):v()}).catch(function(w){i.logger.logError("Error happend while scanning context",w),v()})}},e.prototype.createVideoConstraints=function(t){if(typeof t=="string")return{deviceId:{exact:t}};if(typeof t=="object"){var r="facingMode",n="deviceId",i={user:!0,environment:!0},a="exact",o=function(E){if(E in i)return!0;throw"config has invalid 'facingMode' value = "+"'".concat(E,"'")},c=Object.keys(t);if(c.length!==1)throw"'cameraIdOrConfig' object should have exactly 1 key,"+" if passed as an object, found ".concat(c.length," keys");var f=Object.keys(t)[0];if(f!==r&&f!==n)throw"Only '".concat(r,"' and '").concat(n,"' ")+" are supported for 'cameraIdOrConfig'";if(f===r){var d=t.facingMode;if(typeof d=="string"){if(o(d))return{facingMode:d}}else if(typeof d=="object")if(a in d){if(o(d["".concat(a)]))return{facingMode:{exact:d["".concat(a)]}}}else throw"'facingMode' should be string or object with"+" ".concat(a," as key.");else{var h=typeof d;throw"Invalid type of 'facingMode' = ".concat(h)}}else{var m=t.deviceId;if(typeof m=="string")return{deviceId:m};if(typeof m=="object"){if(a in m)return{deviceId:{exact:m["".concat(a)]}};throw"'deviceId' should be string or object with"+" ".concat(a," as key.")}else{var v=typeof m;throw"Invalid type of 'deviceId' = ".concat(v)}}}var w=typeof t;throw"Invalid type of 'cameraIdOrConfig' = ".concat(w)},e.prototype.computeCanvasDrawConfig=function(t,r,n,i){if(t<=n&&r<=i){var a=(n-t)/2,o=(i-r)/2;return{x:a,y:o,width:t,height:r}}else{var c=t,f=r;return t>n&&(r=n/t*r,t=n),r>i&&(t=i/r*t,r=i),this.logger.log("Image downsampled from "+"".concat(c,"X").concat(f)+" to ".concat(t,"X").concat(r,".")),this.computeCanvasDrawConfig(t,r,n,i)}},e.prototype.clearElement=function(){if(this.stateManagerProxy.isScanning())throw"Cannot clear while scan is ongoing, close it first.";var t=document.getElementById(this.elementId);t&&(t.innerHTML="")},e.prototype.possiblyUpdateShaders=function(t){this.qrMatch!==t&&(this.hasBorderShaders&&this.borderShaders&&this.borderShaders.length&&this.borderShaders.forEach(function(r){r.style.backgroundColor=t?vi.BORDER_SHADER_MATCH_COLOR:vi.BORDER_SHADER_DEFAULT_COLOR}),this.qrMatch=t)},e.prototype.possiblyCloseLastScanImageFile=function(){this.lastScanImageFile&&(URL.revokeObjectURL(this.lastScanImageFile),this.lastScanImageFile=null)},e.prototype.createCanvasElement=function(t,r,n){var i=t,a=r,o=document.createElement("canvas");return o.style.width="".concat(i,"px"),o.style.height="".concat(a,"px"),o.style.display="none",o.id=Ja(n)?"qr-canvas":n,o},e.prototype.getShadedRegionBounds=function(t,r,n){if(n.width>t||n.height>r)throw"'config.qrbox' dimensions should not be greater than the dimensions of the root HTML element.";return{x:(t-n.width)/2,y:(r-n.height)/2,width:n.width,height:n.height}},e.prototype.possiblyInsertShadingElement=function(t,r,n,i){if(!(r-i.width<1||n-i.height<1)){var a=document.createElement("div");a.style.position="absolute";var o=(r-i.width)/2,c=(n-i.height)/2;if(a.style.borderLeft="".concat(o,"px solid rgba(0, 0, 0, 0.48)"),a.style.borderRight="".concat(o,"px solid rgba(0, 0, 0, 0.48)"),a.style.borderTop="".concat(c,"px solid rgba(0, 0, 0, 0.48)"),a.style.borderBottom="".concat(c,"px solid rgba(0, 0, 0, 0.48)"),a.style.boxSizing="border-box",a.style.top="0px",a.style.bottom="0px",a.style.left="0px",a.style.right="0px",a.id="".concat(vi.SHADED_REGION_ELEMENT_ID),r-i.width<11||n-i.height<11)this.hasBorderShaders=!1;else{var f=5,d=40;this.insertShaderBorders(a,d,f,-f,null,0,!0),this.insertShaderBorders(a,d,f,-f,null,0,!1),this.insertShaderBorders(a,d,f,null,-f,0,!0),this.insertShaderBorders(a,d,f,null,-f,0,!1),this.insertShaderBorders(a,f,d+f,-f,null,-f,!0),this.insertShaderBorders(a,f,d+f,null,-f,-f,!0),this.insertShaderBorders(a,f,d+f,-f,null,-f,!1),this.insertShaderBorders(a,f,d+f,null,-f,-f,!1),this.hasBorderShaders=!0}t.append(a)}},e.prototype.insertShaderBorders=function(t,r,n,i,a,o,c){var f=document.createElement("div");f.style.position="absolute",f.style.backgroundColor=vi.BORDER_SHADER_DEFAULT_COLOR,f.style.width="".concat(r,"px"),f.style.height="".concat(n,"px"),i!==null&&(f.style.top="".concat(i,"px")),a!==null&&(f.style.bottom="".concat(a,"px")),c?f.style.left="".concat(o,"px"):f.style.right="".concat(o,"px"),this.borderShaders||(this.borderShaders=[]),this.borderShaders.push(f),t.appendChild(f)},e.prototype.showPausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="block"},e.prototype.hidePausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="none"},e.prototype.getTimeoutFps=function(t){return 1e3/t},e}(),ZA;(function(e){e[e.STATUS_DEFAULT=0]="STATUS_DEFAULT",e[e.STATUS_SUCCESS=1]="STATUS_SUCCESS",e[e.STATUS_WARNING=2]="STATUS_WARNING",e[e.STATUS_REQUESTING_PERMISSION=3]="STATUS_REQUESTING_PERMISSION"})(ZA||(ZA={}));const qA="qr-barcode-scanner",NF=["No Uniform","Late Entry","No ID Card","Misconduct"],PF=()=>{const{addToast:e}=Cl(),[t,r]=I.useState(null),[n,i]=I.useState(null),[a,o]=I.useState(null),[c,f]=I.useState(!1),[d,h]=I.useState(null),[m,v]=I.useState(!1),[w,E]=I.useState(""),[A,S]=I.useState(!1),[b,T]=I.useState(!1),[_,N]=I.useState(!1),M=I.useRef(null),R=I.useRef(null),P=I.useRef(null),z=I.useRef(!1),B=I.useRef(null),re=()=>{var fe;(fe=M.current)==null||fe.focus()},[ee,V]=I.useState(!1),de=async fe=>{var we;if(!(!fe||z.current)){o(null),i(null),T(!1),V(!0);try{const G=await fetch(`${Ut}/students/scan?code=${encodeURIComponent(fe)}`),le=await G.json();if(G.ok)r({student:le.student,time:new Date(le.log.entryTime),duplicate:!1}),i("success"),o({type:"success",message:"Entry recorded."}),T(A),e({message:`${le.student.name}  Entry recorded`,type:"success",size:"big",title:"Entry Recorded"});else if(le.duplicate)r({student:le.student,time:(we=le.existingLog)!=null&&we.entryTime?new Date(le.existingLog.entryTime):new Date,duplicate:!0}),i("duplicate"),o({type:"error",message:"Already scanned today"}),e({message:`${le.student.name}  Already scanned today`,type:"error",size:"big",title:"Duplicate Scan"});else throw new Error(le.message||"Scan failed");P.current=fe,z.current=!0,setTimeout(()=>{z.current=!1},2500)}catch(G){r(null),i("error"),o({type:"error",message:G.message||"Student not registered"}),e({message:G.message||"Student not registered",type:"error",size:"small"}),z.current=!0,setTimeout(()=>{z.current=!1},1500)}finally{V(!1)}}},pe=async(fe,we=500)=>{if(t!=null&&t.student){N(!0);try{const G=await fetch(`${Ut}/fines/scan`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({studentId:t.student.studentId,fineType:fe,amount:we,reason:"Added during scan"})}),le=await G.json();if(!G.ok)throw new Error(le.message||"Failed to add fine");e({message:`Fine of Rs.${we} added for ${t.student.name}`,type:"success",size:"small"}),T(!1)}catch(G){e({message:G.message||"Failed to add fine",type:"error",size:"small"})}finally{N(!1)}}},K=fe=>{let we=String(fe||"").replace(/[\x00-\x1F\x7F]/g,"").trim();we&&(B.current&&(clearTimeout(B.current),B.current=null),E(we),M.current&&(M.current.value=""),de(we))},Ce=fe=>{if(fe.key==="Enter"||fe.keyCode===13){const we=fe.target.value.trim();fe.preventDefault(),fe.stopPropagation(),we&&K(we)}},ue=fe=>{const we=fe.target.value;B.current&&clearTimeout(B.current),B.current=setTimeout(()=>{we&&we.length>=3&&!we.includes(`
`)&&K(we),B.current=null},350)},se=async()=>{h(null),o(null),v(!0)};I.useEffect(()=>{if(!m)return;let fe=!0,we;const le=setTimeout(async()=>{try{const ne=YA.getCameras(),ae=new Promise((ce,be)=>{we=setTimeout(()=>be(new Error("Camera took too long to start. Try again.")),15e3)}),he=await Promise.race([ne,ae]);if(clearTimeout(we),!fe)return;if(!he||he.length===0)throw new Error("No camera found. Please connect a camera and try again.");const ke=he[0].id,De=new YA(qA);R.current=De,await De.start(ke,{fps:10,qrbox:{width:250,height:250}},ce=>{ce&&ce!==P.current&&de(ce)},()=>{}),fe&&f(!0)}catch(ne){fe&&(h(ne.message||"Failed to start camera. Check permissions."),v(!1))}},100);return()=>{fe=!1,clearTimeout(le),we&&clearTimeout(we)}},[m]);const q=async()=>{if(R.current&&R.current.isScanning){try{await R.current.stop()}catch{}R.current=null}f(!1),h(null),v(!1)};return I.useEffect(()=>()=>{R.current&&R.current.isScanning&&R.current.stop().catch(()=>{})},[]),k.jsxs("div",{className:"student-scanner",children:[k.jsx("div",{className:"scan-options",style:{marginBottom:"0.75rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:k.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.35rem",cursor:"pointer"},children:[k.jsx("input",{type:"checkbox",checked:A,onChange:fe=>S(fe.target.checked)}),k.jsx("span",{children:"Add fine during scan"})]})}),k.jsxs("div",{className:"scan-button-section",title:"USB scanner input area",children:[k.jsx("span",{className:"scan-ready-badge",children:"Ready"}),k.jsx("button",{type:"button",className:"btn-scan-qr",onClick:re,disabled:ee,children:ee?k.jsxs(k.Fragment,{children:[k.jsx(FA,{size:"sm"}),k.jsx("span",{children:"Processing..."})]}):k.jsxs(k.Fragment,{children:[k.jsx(T0,{className:"scan-icon",size:20,strokeWidth:2}),k.jsx("span",{children:"Scan QR Code"})]})}),k.jsx("p",{className:"scan-instruction",children:"Click the button above, then scan the student card with your USB scanner."}),w&&k.jsxs("span",{className:"scan-raw",children:["Last scanned: ",w]})]}),k.jsx("input",{ref:M,type:"text",className:"scan-input-hidden","aria-label":"QR scan input",onKeyDown:Ce,onInput:ue,autoComplete:"off"}),k.jsxs("div",{className:"camera-section",children:[m?k.jsxs("div",{className:"camera-view",children:[k.jsxs("div",{className:"qr-scanner-wrapper",children:[!c&&!d&&k.jsxs("div",{className:"camera-loading",children:[k.jsx(FA,{size:"lg"}),k.jsx("span",{children:"Starting camera..."})]}),k.jsx("div",{id:qA,className:"qr-scanner-container"})]}),k.jsx("button",{type:"button",className:"btn-small danger",onClick:q,style:{marginTop:"0.75rem"},children:"Stop Camera"})]}):k.jsx("button",{type:"button",className:"btn-secondary",onClick:se,children:k.jsxs(k.Fragment,{children:[k.jsx(T0,{size:16,strokeWidth:2,style:{marginRight:6,verticalAlign:"middle"}})," Use Laptop Camera"]})}),d&&k.jsx("div",{className:"status error",style:{marginTop:"0.75rem"},children:d})]}),a&&k.jsxs("div",{className:`status ${a.type==="success"?"success":"error"} ${n==="duplicate"?"status-duplicate":""}`,children:[n==="success"&&"Entry Recorded",n==="duplicate"&&"Already Scanned",n==="error"&&a.message,n==="success"&&a.message,n==="duplicate"&&"  "+a.message]}),t&&k.jsxs("div",{className:`scan-result ${t.duplicate?"scan-result-duplicate":"scan-result-success"}`,children:[k.jsx("h4",{children:t.duplicate?"Already Scanned":"Entry Recorded"}),k.jsxs("p",{children:[k.jsx("strong",{children:"ID:"})," ",t.student.studentId]}),k.jsxs("p",{children:[k.jsx("strong",{children:"Name:"})," ",t.student.name]}),k.jsxs("p",{children:[k.jsx("strong",{children:"Department:"})," ",t.student.department]}),k.jsxs("p",{children:[k.jsx("strong",{children:"Time:"})," ",t.time?t.time.toLocaleTimeString():""]}),b&&!t.duplicate&&k.jsx("div",{className:"quick-fine-buttons",style:{marginTop:"0.75rem",display:"flex",flexWrap:"wrap",gap:"0.5rem"},children:NF.map(fe=>k.jsx("button",{type:"button",className:"btn-small",onClick:()=>pe(fe),disabled:_,children:_?"...":`+ ${fe}`},fe))})]})]})},DF=()=>{const[e,t]=I.useState(null),[r,n]=I.useState(!0),[i,a]=I.useState(!1);if(I.useEffect(()=>{const c=async()=>{try{const d=await fetch(`${Ut}/reports/today`),h=await d.json();d.ok?(t(h),a(!1)):(t({visitorCount:0,studentEntryCount:0,activeVisitors:0}),a(!0))}catch{t({visitorCount:0,studentEntryCount:0,activeVisitors:0}),a(!0)}finally{n(!1)}};c();const f=setInterval(c,3e4);return()=>clearInterval(f)},[]),r||!e)return k.jsx("div",{className:"metrics-row",children:[1,2,3].map(c=>k.jsx("div",{className:"metric-card metric-skeleton"},c))});const o=[{title:"Active Visitors",value:e.activeVisitors,subtitle:"Currently in building",gradient:"pink",Icon:R2},{title:"Today's Visitors",value:e.visitorCount,subtitle:"Checked in today",gradient:"blue",Icon:Y1},{title:"Student Entries",value:e.studentEntryCount,subtitle:"QR scans today",gradient:"teal",Icon:T0}];return k.jsxs(k.Fragment,{children:[i&&k.jsxs("div",{className:"api-status-banner",role:"alert",children:[k.jsx(O7,{className:"api-status-icon",size:20,strokeWidth:2}),k.jsxs("span",{children:["Unable to connect to server. Please ensure the backend is running (",k.jsx("code",{children:"cd backend && npm start"}),")."]})]}),k.jsx("div",{className:"metrics-row",children:o.map((c,f)=>k.jsxs("div",{className:`metric-card metric-${c.gradient}`,style:{animationDelay:`${f*.1}s`},children:[k.jsx("div",{className:"metric-pattern"}),k.jsx("div",{className:"metric-icon",children:rr.createElement(c.Icon,{size:24,strokeWidth:2})}),k.jsxs("div",{className:"metric-content",children:[k.jsx("span",{className:"metric-title",children:c.title}),k.jsx("span",{className:"metric-value",children:c.value}),k.jsx("span",{className:"metric-subtitle",children:c.subtitle})]})]},c.title))})]})};function I8(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var i=e.length;for(t=0;t<i;t++)e[t]&&(r=I8(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function Bt(){for(var e,t,r=0,n="",i=arguments.length;r<i;r++)(e=arguments[r])&&(t=I8(e))&&(n&&(n+=" "),n+=t);return n}var RF=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function F2(e){if(typeof e!="string")return!1;var t=RF;return t.includes(e)}var MF=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],FF=new Set(MF);function N8(e){return typeof e!="string"?!1:FF.has(e)}function P8(e){return typeof e=="string"&&e.startsWith("data-")}function Sa(e){if(typeof e!="object"||e===null)return{};var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(N8(r)||P8(r))&&(t[r]=e[r]);return t}function O0(e){if(e==null)return null;if(I.isValidElement(e)&&typeof e.props=="object"&&e.props!==null){var t=e.props;return Sa(t)}return typeof e=="object"&&!Array.isArray(e)?Sa(e):null}function Qi(e){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(N8(r)||P8(r)||F2(r))&&(t[r]=e[r]);return t}var LF=["children","width","height","viewBox","className","style","title","desc"];function Ox(){return Ox=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ox.apply(null,arguments)}function BF(e,t){if(e==null)return{};var r,n,i=jF(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function jF(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var L2=I.forwardRef((e,t)=>{var{children:r,width:n,height:i,viewBox:a,className:o,style:c,title:f,desc:d}=e,h=BF(e,LF),m=a||{width:n,height:i,x:0,y:0},v=Bt("recharts-surface",o);return I.createElement("svg",Ox({},Qi(h),{className:v,width:n,height:i,style:c,viewBox:"".concat(m.x," ").concat(m.y," ").concat(m.width," ").concat(m.height),ref:t}),I.createElement("title",null,f),I.createElement("desc",null,d),r)}),UF=["children","className"];function kx(){return kx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},kx.apply(null,arguments)}function zF(e,t){if(e==null)return{};var r,n,i=WF(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function WF(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Yn=I.forwardRef((e,t)=>{var{children:r,className:n}=e,i=zF(e,UF),a=Bt("recharts-layer",n);return I.createElement("g",kx({className:a},Qi(i),{ref:t}),r)}),D8=I.createContext(null),VF=()=>I.useContext(D8);function Yt(e){return function(){return e}}const R8=Math.cos,bh=Math.sin,ba=Math.sqrt,Th=Math.PI,Z1=2*Th,Ix=Math.PI,Nx=2*Ix,Bo=1e-6,HF=Nx-Bo;function M8(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function GF(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return M8;const r=10**t;return function(n){this._+=n[0];for(let i=1,a=n.length;i<a;++i)this._+=Math.round(arguments[i]*r)/r+n[i]}}class $F{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?M8:GF(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,i){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+i}`}bezierCurveTo(t,r,n,i,a,o){this._append`C${+t},${+r},${+n},${+i},${this._x1=+a},${this._y1=+o}`}arcTo(t,r,n,i,a){if(t=+t,r=+r,n=+n,i=+i,a=+a,a<0)throw new Error(`negative radius: ${a}`);let o=this._x1,c=this._y1,f=n-t,d=i-r,h=o-t,m=c-r,v=h*h+m*m;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(v>Bo)if(!(Math.abs(m*f-d*h)>Bo)||!a)this._append`L${this._x1=t},${this._y1=r}`;else{let w=n-o,E=i-c,A=f*f+d*d,S=w*w+E*E,b=Math.sqrt(A),T=Math.sqrt(v),_=a*Math.tan((Ix-Math.acos((A+v-S)/(2*b*T)))/2),N=_/T,M=_/b;Math.abs(N-1)>Bo&&this._append`L${t+N*h},${r+N*m}`,this._append`A${a},${a},0,0,${+(m*w>h*E)},${this._x1=t+M*f},${this._y1=r+M*d}`}}arc(t,r,n,i,a,o){if(t=+t,r=+r,n=+n,o=!!o,n<0)throw new Error(`negative radius: ${n}`);let c=n*Math.cos(i),f=n*Math.sin(i),d=t+c,h=r+f,m=1^o,v=o?i-a:a-i;this._x1===null?this._append`M${d},${h}`:(Math.abs(this._x1-d)>Bo||Math.abs(this._y1-h)>Bo)&&this._append`L${d},${h}`,n&&(v<0&&(v=v%Nx+Nx),v>HF?this._append`A${n},${n},0,1,${m},${t-c},${r-f}A${n},${n},0,1,${m},${this._x1=d},${this._y1=h}`:v>Bo&&this._append`A${n},${n},0,${+(v>=Ix)},${m},${this._x1=t+n*Math.cos(a)},${this._y1=r+n*Math.sin(a)}`)}rect(t,r,n,i){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+i}h${-n}Z`}toString(){return this._}}function B2(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new $F(t)}function j2(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function F8(e){this._context=e}F8.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function q1(e){return new F8(e)}function L8(e){return e[0]}function B8(e){return e[1]}function j8(e,t){var r=Yt(!0),n=null,i=q1,a=null,o=B2(c);e=typeof e=="function"?e:e===void 0?L8:Yt(e),t=typeof t=="function"?t:t===void 0?B8:Yt(t);function c(f){var d,h=(f=j2(f)).length,m,v=!1,w;for(n==null&&(a=i(w=o())),d=0;d<=h;++d)!(d<h&&r(m=f[d],d,f))===v&&((v=!v)?a.lineStart():a.lineEnd()),v&&a.point(+e(m,d,f),+t(m,d,f));if(w)return a=null,w+""||null}return c.x=function(f){return arguments.length?(e=typeof f=="function"?f:Yt(+f),c):e},c.y=function(f){return arguments.length?(t=typeof f=="function"?f:Yt(+f),c):t},c.defined=function(f){return arguments.length?(r=typeof f=="function"?f:Yt(!!f),c):r},c.curve=function(f){return arguments.length?(i=f,n!=null&&(a=i(n)),c):i},c.context=function(f){return arguments.length?(f==null?n=a=null:a=i(n=f),c):n},c}function id(e,t,r){var n=null,i=Yt(!0),a=null,o=q1,c=null,f=B2(d);e=typeof e=="function"?e:e===void 0?L8:Yt(+e),t=typeof t=="function"?t:Yt(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?B8:Yt(+r);function d(m){var v,w,E,A=(m=j2(m)).length,S,b=!1,T,_=new Array(A),N=new Array(A);for(a==null&&(c=o(T=f())),v=0;v<=A;++v){if(!(v<A&&i(S=m[v],v,m))===b)if(b=!b)w=v,c.areaStart(),c.lineStart();else{for(c.lineEnd(),c.lineStart(),E=v-1;E>=w;--E)c.point(_[E],N[E]);c.lineEnd(),c.areaEnd()}b&&(_[v]=+e(S,v,m),N[v]=+t(S,v,m),c.point(n?+n(S,v,m):_[v],r?+r(S,v,m):N[v]))}if(T)return c=null,T+""||null}function h(){return j8().defined(i).curve(o).context(a)}return d.x=function(m){return arguments.length?(e=typeof m=="function"?m:Yt(+m),n=null,d):e},d.x0=function(m){return arguments.length?(e=typeof m=="function"?m:Yt(+m),d):e},d.x1=function(m){return arguments.length?(n=m==null?null:typeof m=="function"?m:Yt(+m),d):n},d.y=function(m){return arguments.length?(t=typeof m=="function"?m:Yt(+m),r=null,d):t},d.y0=function(m){return arguments.length?(t=typeof m=="function"?m:Yt(+m),d):t},d.y1=function(m){return arguments.length?(r=m==null?null:typeof m=="function"?m:Yt(+m),d):r},d.lineX0=d.lineY0=function(){return h().x(e).y(t)},d.lineY1=function(){return h().x(e).y(r)},d.lineX1=function(){return h().x(n).y(t)},d.defined=function(m){return arguments.length?(i=typeof m=="function"?m:Yt(!!m),d):i},d.curve=function(m){return arguments.length?(o=m,a!=null&&(c=o(a)),d):o},d.context=function(m){return arguments.length?(m==null?a=c=null:c=o(a=m),d):a},d}class U8{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function XF(e){return new U8(e,!0)}function KF(e){return new U8(e,!1)}const U2={draw(e,t){const r=ba(t/Th);e.moveTo(r,0),e.arc(0,0,r,0,Z1)}},YF={draw(e,t){const r=ba(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},z8=ba(1/3),ZF=z8*2,qF={draw(e,t){const r=ba(t/ZF),n=r*z8;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}},QF={draw(e,t){const r=ba(t),n=-r/2;e.rect(n,n,r,r)}},JF=.8908130915292852,W8=bh(Th/10)/bh(7*Th/10),e9=bh(Z1/10)*W8,t9=-R8(Z1/10)*W8,r9={draw(e,t){const r=ba(t*JF),n=e9*r,i=t9*r;e.moveTo(0,-r),e.lineTo(n,i);for(let a=1;a<5;++a){const o=Z1*a/5,c=R8(o),f=bh(o);e.lineTo(f*r,-c*r),e.lineTo(c*n-f*i,f*n+c*i)}e.closePath()}},qg=ba(3),n9={draw(e,t){const r=-ba(t/(qg*3));e.moveTo(0,r*2),e.lineTo(-qg*r,-r),e.lineTo(qg*r,-r),e.closePath()}},Bi=-.5,ji=ba(3)/2,Px=1/ba(12),i9=(Px/2+1)*3,a9={draw(e,t){const r=ba(t/i9),n=r/2,i=r*Px,a=n,o=r*Px+r,c=-a,f=o;e.moveTo(n,i),e.lineTo(a,o),e.lineTo(c,f),e.lineTo(Bi*n-ji*i,ji*n+Bi*i),e.lineTo(Bi*a-ji*o,ji*a+Bi*o),e.lineTo(Bi*c-ji*f,ji*c+Bi*f),e.lineTo(Bi*n+ji*i,Bi*i-ji*n),e.lineTo(Bi*a+ji*o,Bi*o-ji*a),e.lineTo(Bi*c+ji*f,Bi*f-ji*c),e.closePath()}};function s9(e,t){let r=null,n=B2(i);e=typeof e=="function"?e:Yt(e||U2),t=typeof t=="function"?t:Yt(t===void 0?64:+t);function i(){let a;if(r||(r=a=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),a)return r=null,a+""||null}return i.type=function(a){return arguments.length?(e=typeof a=="function"?a:Yt(a),i):e},i.size=function(a){return arguments.length?(t=typeof a=="function"?a:Yt(+a),i):t},i.context=function(a){return arguments.length?(r=a??null,i):r},i}function Oh(){}function kh(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function V8(e){this._context=e}V8.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:kh(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:kh(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function o9(e){return new V8(e)}function H8(e){this._context=e}H8.prototype={areaStart:Oh,areaEnd:Oh,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:kh(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function l9(e){return new H8(e)}function G8(e){this._context=e}G8.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:kh(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function c9(e){return new G8(e)}function $8(e){this._context=e}$8.prototype={areaStart:Oh,areaEnd:Oh,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function u9(e){return new $8(e)}function QA(e){return e<0?-1:1}function JA(e,t,r){var n=e._x1-e._x0,i=t-e._x1,a=(e._y1-e._y0)/(n||i<0&&-0),o=(r-e._y1)/(i||n<0&&-0),c=(a*i+o*n)/(n+i);return(QA(a)+QA(o))*Math.min(Math.abs(a),Math.abs(o),.5*Math.abs(c))||0}function e3(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function Qg(e,t,r){var n=e._x0,i=e._y0,a=e._x1,o=e._y1,c=(a-n)/3;e._context.bezierCurveTo(n+c,i+c*t,a-c,o-c*r,a,o)}function Ih(e){this._context=e}Ih.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Qg(this,this._t0,e3(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,Qg(this,e3(this,r=JA(this,e,t)),r);break;default:Qg(this,this._t0,r=JA(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function X8(e){this._context=new K8(e)}(X8.prototype=Object.create(Ih.prototype)).point=function(e,t){Ih.prototype.point.call(this,t,e)};function K8(e){this._context=e}K8.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,i,a){this._context.bezierCurveTo(t,e,n,r,a,i)}};function f9(e){return new Ih(e)}function d9(e){return new X8(e)}function Y8(e){this._context=e}Y8.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=t3(e),i=t3(t),a=0,o=1;o<r;++a,++o)this._context.bezierCurveTo(n[0][a],i[0][a],n[1][a],i[1][a],e[o],t[o]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function t3(e){var t,r=e.length-1,n,i=new Array(r),a=new Array(r),o=new Array(r);for(i[0]=0,a[0]=2,o[0]=e[0]+2*e[1],t=1;t<r-1;++t)i[t]=1,a[t]=4,o[t]=4*e[t]+2*e[t+1];for(i[r-1]=2,a[r-1]=7,o[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=i[t]/a[t-1],a[t]-=n,o[t]-=n*o[t-1];for(i[r-1]=o[r-1]/a[r-1],t=r-2;t>=0;--t)i[t]=(o[t]-i[t+1])/a[t];for(a[r-1]=(e[r]+i[r-1])/2,t=0;t<r-1;++t)a[t]=2*e[t+1]-i[t+1];return[i,a]}function h9(e){return new Y8(e)}function Q1(e,t){this._context=e,this._t=t}Q1.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function p9(e){return new Q1(e,.5)}function g9(e){return new Q1(e,0)}function m9(e){return new Q1(e,1)}function cl(e,t){if((o=e.length)>1)for(var r=1,n,i,a=e[t[0]],o,c=a.length;r<o;++r)for(i=a,a=e[t[r]],n=0;n<c;++n)a[n][1]+=a[n][0]=isNaN(i[n][1])?i[n][0]:i[n][1]}function Dx(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function x9(e,t){return e[t]}function v9(e){const t=[];return t.key=e,t}function y9(){var e=Yt([]),t=Dx,r=cl,n=x9;function i(a){var o=Array.from(e.apply(this,arguments),v9),c,f=o.length,d=-1,h;for(const m of a)for(c=0,++d;c<f;++c)(o[c][d]=[0,+n(m,o[c].key,d,a)]).data=m;for(c=0,h=j2(t(o));c<f;++c)o[h[c]].index=c;return r(o,h),o}return i.keys=function(a){return arguments.length?(e=typeof a=="function"?a:Yt(Array.from(a)),i):e},i.value=function(a){return arguments.length?(n=typeof a=="function"?a:Yt(+a),i):n},i.order=function(a){return arguments.length?(t=a==null?Dx:typeof a=="function"?a:Yt(Array.from(a)),i):t},i.offset=function(a){return arguments.length?(r=a??cl,i):r},i}function w9(e,t){if((n=e.length)>0){for(var r,n,i=0,a=e[0].length,o;i<a;++i){for(o=r=0;r<n;++r)o+=e[r][i][1]||0;if(o)for(r=0;r<n;++r)e[r][i][1]/=o}cl(e,t)}}function E9(e,t){if((i=e.length)>0){for(var r=0,n=e[t[0]],i,a=n.length;r<a;++r){for(var o=0,c=0;o<i;++o)c+=e[o][r][1]||0;n[r][1]+=n[r][0]=-c/2}cl(e,t)}}function A9(e,t){if(!(!((o=e.length)>0)||!((a=(i=e[t[0]]).length)>0))){for(var r=0,n=1,i,a,o;n<a;++n){for(var c=0,f=0,d=0;c<o;++c){for(var h=e[t[c]],m=h[n][1]||0,v=h[n-1][1]||0,w=(m-v)/2,E=0;E<c;++E){var A=e[t[E]],S=A[n][1]||0,b=A[n-1][1]||0;w+=S-b}f+=m,d+=w*m}i[n-1][1]+=i[n-1][0]=r,f&&(r-=d/f)}i[n-1][1]+=i[n-1][0]=r,cl(e,t)}}var J1={},Z8={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==="__proto__"}e.isUnsafeProperty=t})(Z8);var z2={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){switch(typeof r){case"number":case"symbol":return!1;case"string":return r.includes(".")||r.includes("[")||r.includes("]")}}e.isDeepKey=t})(z2);var ep={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){var n;return typeof r=="string"||typeof r=="symbol"?r:Object.is((n=r==null?void 0:r.valueOf)==null?void 0:n.call(r),-0)?"-0":String(r)}e.toKey=t})(ep);var tp={},q8={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){if(r==null)return"";if(typeof r=="string")return r;if(Array.isArray(r))return r.map(t).join(",");const n=String(r);return n==="0"&&Object.is(Number(r),-0)?"-0":n}e.toString=t})(q8);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=q8,r=ep;function n(i){if(Array.isArray(i))return i.map(r.toKey);if(typeof i=="symbol")return[i];i=t.toString(i);const a=[],o=i.length;if(o===0)return a;let c=0,f="",d="",h=!1;for(i.charCodeAt(0)===46&&(a.push(""),c++);c<o;){const m=i[c];d?m==="\\"&&c+1<o?(c++,f+=i[c]):m===d?d="":f+=m:h?m==='"'||m==="'"?d=m:m==="]"?(h=!1,a.push(f),f=""):f+=m:m==="["?(h=!0,f&&(a.push(f),f="")):m==="."?f&&(a.push(f),f=""):f+=m,c++}return f&&a.push(f),a}e.toPath=n})(tp);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Z8,r=z2,n=ep,i=tp;function a(c,f,d){if(c==null)return d;switch(typeof f){case"string":{if(t.isUnsafeProperty(f))return d;const h=c[f];return h===void 0?r.isDeepKey(f)?a(c,i.toPath(f),d):d:h}case"number":case"symbol":{typeof f=="number"&&(f=n.toKey(f));const h=c[f];return h===void 0?d:h}default:{if(Array.isArray(f))return o(c,f,d);if(Object.is(f==null?void 0:f.valueOf(),-0)?f="-0":f=String(f),t.isUnsafeProperty(f))return d;const h=c[f];return h===void 0?d:h}}}function o(c,f,d){if(f.length===0)return d;let h=c;for(let m=0;m<f.length;m++){if(h==null||t.isUnsafeProperty(f[m]))return d;h=h[f[m]]}return h===void 0?d:h}e.get=a})(J1);var C9=J1.get;const ul=bs(C9);var S9=4;function ro(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:S9,r=10**t,n=Math.round(e*r)/r;return Object.is(n,-0)?0:n}function Cr(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return e.reduce((i,a,o)=>{var c=r[o-1];return typeof c=="string"?i+c+a:c!==void 0?i+ro(c)+a:i+a},"")}var sn=e=>e===0?0:e>0?1:-1,Ha=e=>typeof e=="number"&&e!=+e,fl=e=>typeof e=="string"&&e.indexOf("%")===e.length-1,qe=e=>(typeof e=="number"||e instanceof Number)&&!Ha(e),Ga=e=>qe(e)||typeof e=="string",_9=0,k0=e=>{var t=++_9;return"".concat(e||"").concat(t)},Fn=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!qe(t)&&typeof t!="string")return n;var a;if(fl(t)){if(r==null)return n;var o=t.indexOf("%");a=r*parseFloat(t.slice(0,o))/100}else a=+t;return Ha(a)&&(a=n),i&&r!=null&&a>r&&(a=r),a},Q8=e=>{if(!Array.isArray(e))return!1;for(var t=e.length,r={},n=0;n<t;n++)if(!r[String(e[n])])r[String(e[n])]=!0;else return!0;return!1};function Vr(e,t,r){return qe(e)&&qe(t)?ro(e+r*(t-e)):t}function b9(e,t,r){if(!(!e||!e.length))return e.find(n=>n&&(typeof t=="function"?t(n):ul(n,t))===r)}var cn=e=>e===null||typeof e>"u",of=e=>cn(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1));function li(e){return e!=null}function Gc(){}var T9=["type","size","sizeType"];function Rx(){return Rx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Rx.apply(null,arguments)}function r3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function n3(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?r3(Object(r),!0).forEach(function(n){O9(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):r3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function O9(e,t,r){return(t=k9(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function k9(e){var t=I9(e,"string");return typeof t=="symbol"?t:t+""}function I9(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function N9(e,t){if(e==null)return{};var r,n,i=P9(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function P9(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var J8={symbolCircle:U2,symbolCross:YF,symbolDiamond:qF,symbolSquare:QF,symbolStar:r9,symbolTriangle:n9,symbolWye:a9},D9=Math.PI/180,R9=e=>{var t="symbol".concat(of(e));return J8[t]||U2},M9=(e,t,r)=>{if(t==="area")return e;switch(r){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var n=18*D9;return 1.25*e*e*(Math.tan(n)-Math.tan(n*2)*Math.tan(n)**2)}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},F9=(e,t)=>{J8["symbol".concat(of(e))]=t},W2=e=>{var{type:t="circle",size:r=64,sizeType:n="area"}=e,i=N9(e,T9),a=n3(n3({},i),{},{type:t,size:r,sizeType:n}),o="circle";typeof t=="string"&&(o=t);var c=()=>{var v=R9(o),w=s9().type(v).size(M9(r,n,o)),E=w();if(E!==null)return E},{className:f,cx:d,cy:h}=a,m=Qi(a);return qe(d)&&qe(h)&&qe(r)?I.createElement("path",Rx({},m,{className:Bt("recharts-symbols",f),transform:"translate(".concat(d,", ").concat(h,")"),d:c()})):null};W2.registerSymbol=F9;var eO=e=>"radius"in e&&"startAngle"in e&&"endAngle"in e,L9=(e,t)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var r=e;if(I.isValidElement(e)&&(r=e.props),typeof r!="object"&&typeof r!="function")return null;var n={};return Object.keys(r).forEach(i=>{F2(i)&&(n[i]=a=>r[i](r,a))}),n},B9=(e,t,r)=>n=>(e(t,r,n),null),lf=(e,t,r)=>{if(e===null||typeof e!="object"&&typeof e!="function")return null;var n=null;return Object.keys(e).forEach(i=>{var a=e[i];F2(i)&&typeof a=="function"&&(n||(n={}),n[i]=B9(a,t,r))}),n};function i3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function j9(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?i3(Object(r),!0).forEach(function(n){U9(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function U9(e,t,r){return(t=z9(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function z9(e){var t=W9(e,"string");return typeof t=="symbol"?t:t+""}function W9(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function un(e,t){var r=j9({},e),n=t,i=Object.keys(t),a=i.reduce((o,c)=>(o[c]===void 0&&n[c]!==void 0&&(o[c]=n[c]),o),r);return a}function Nh(){return Nh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Nh.apply(null,arguments)}function a3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function V9(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?a3(Object(r),!0).forEach(function(n){H9(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function H9(e,t,r){return(t=G9(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function G9(e){var t=$9(e,"string");return typeof t=="symbol"?t:t+""}function $9(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Vi=32,X9={align:"center",iconSize:14,inactiveColor:"#ccc",layout:"horizontal",verticalAlign:"middle"};function K9(e){var{data:t,iconType:r,inactiveColor:n}=e,i=Vi/2,a=Vi/6,o=Vi/3,c=t.inactive?n:t.color,f=r??t.type;if(f==="none")return null;if(f==="plainline"){var d;return I.createElement("line",{strokeWidth:4,fill:"none",stroke:c,strokeDasharray:(d=t.payload)===null||d===void 0?void 0:d.strokeDasharray,x1:0,y1:i,x2:Vi,y2:i,className:"recharts-legend-icon"})}if(f==="line")return I.createElement("path",{strokeWidth:4,fill:"none",stroke:c,d:"M0,".concat(i,"h").concat(o,`
            A`).concat(a,",").concat(a,",0,1,1,").concat(2*o,",").concat(i,`
            H`).concat(Vi,"M").concat(2*o,",").concat(i,`
            A`).concat(a,",").concat(a,",0,1,1,").concat(o,",").concat(i),className:"recharts-legend-icon"});if(f==="rect")return I.createElement("path",{stroke:"none",fill:c,d:"M0,".concat(Vi/8,"h").concat(Vi,"v").concat(Vi*3/4,"h").concat(-Vi,"z"),className:"recharts-legend-icon"});if(I.isValidElement(t.legendIcon)){var h=V9({},t);return delete h.legendIcon,I.cloneElement(t.legendIcon,h)}return I.createElement(W2,{fill:c,cx:i,cy:i,size:Vi,sizeType:"diameter",type:f})}function Y9(e){var{payload:t,iconSize:r,layout:n,formatter:i,inactiveColor:a,iconType:o}=e,c={x:0,y:0,width:Vi,height:Vi},f={display:n==="horizontal"?"inline-block":"block",marginRight:10},d={display:"inline-block",verticalAlign:"middle",marginRight:4};return t.map((h,m)=>{var v=h.formatter||i,w=Bt({"recharts-legend-item":!0,["legend-item-".concat(m)]:!0,inactive:h.inactive});if(h.type==="none")return null;var E=h.inactive?a:h.color,A=v?v(h.value,h,m):h.value;return I.createElement("li",Nh({className:w,style:f,key:"legend-item-".concat(m)},lf(e,h,m)),I.createElement(L2,{width:r,height:r,viewBox:c,style:d,"aria-label":"".concat(A," legend icon")},I.createElement(K9,{data:h,iconType:o,inactiveColor:a})),I.createElement("span",{className:"recharts-legend-item-text",style:{color:E}},A))})}var Z9=e=>{var t=un(e,X9),{payload:r,layout:n,align:i}=t;if(!r||!r.length)return null;var a={padding:0,margin:0,textAlign:n==="horizontal"?i:"left"};return I.createElement("ul",{className:"recharts-default-legend",style:a},I.createElement(Y9,Nh({},t,{payload:r})))},tO={},rO={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){const i=new Map;for(let a=0;a<r.length;a++){const o=r[a],c=n(o,a,r);i.has(c)||i.set(c,o)}return Array.from(i.values())}e.uniqBy=t})(rO);var nO={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){return function(...i){return r.apply(this,i.slice(0,n))}}e.ary=t})(nO);var V2={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r}e.identity=t})(V2);var iO={},rp={},aO={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Number.isSafeInteger(r)&&r>=0}e.isLength=t})(aO);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=aO;function r(n){return n!=null&&typeof n!="function"&&t.isLength(n.length)}e.isArrayLike=r})(rp);var sO={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="object"&&r!==null}e.isObjectLike=t})(sO);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=rp,r=sO;function n(i){return r.isObjectLike(i)&&t.isArrayLike(i)}e.isArrayLikeObject=n})(iO);var oO={},lO={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=J1;function r(n){return function(i){return t.get(i,n)}}e.property=r})(lO);var cO={},H2={},uO={},G2={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r!==null&&(typeof r=="object"||typeof r=="function")}e.isObject=t})(G2);var $2={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null||typeof r!="object"&&typeof r!="function"}e.isPrimitive=t})($2);var X2={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){return r===n||Number.isNaN(r)&&Number.isNaN(n)}e.isEqualsSameValueZero=t})(X2);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=G2,r=$2,n=X2;function i(h,m,v){return typeof v!="function"?i(h,m,()=>{}):a(h,m,function w(E,A,S,b,T,_){const N=v(E,A,S,b,T,_);return N!==void 0?!!N:a(E,A,w,_)},new Map)}function a(h,m,v,w){if(m===h)return!0;switch(typeof m){case"object":return o(h,m,v,w);case"function":return Object.keys(m).length>0?a(h,{...m},v,w):n.isEqualsSameValueZero(h,m);default:return t.isObject(h)?typeof m=="string"?m==="":!0:n.isEqualsSameValueZero(h,m)}}function o(h,m,v,w){if(m==null)return!0;if(Array.isArray(m))return f(h,m,v,w);if(m instanceof Map)return c(h,m,v,w);if(m instanceof Set)return d(h,m,v,w);const E=Object.keys(m);if(h==null||r.isPrimitive(h))return E.length===0;if(E.length===0)return!0;if(w!=null&&w.has(m))return w.get(m)===h;w==null||w.set(m,h);try{for(let A=0;A<E.length;A++){const S=E[A];if(!r.isPrimitive(h)&&!(S in h)||m[S]===void 0&&h[S]!==void 0||m[S]===null&&h[S]!==null||!v(h[S],m[S],S,h,m,w))return!1}return!0}finally{w==null||w.delete(m)}}function c(h,m,v,w){if(m.size===0)return!0;if(!(h instanceof Map))return!1;for(const[E,A]of m.entries()){const S=h.get(E);if(v(S,A,E,h,m,w)===!1)return!1}return!0}function f(h,m,v,w){if(m.length===0)return!0;if(!Array.isArray(h))return!1;const E=new Set;for(let A=0;A<m.length;A++){const S=m[A];let b=!1;for(let T=0;T<h.length;T++){if(E.has(T))continue;const _=h[T];let N=!1;if(v(_,S,A,h,m,w)&&(N=!0),N){E.add(T),b=!0;break}}if(!b)return!1}return!0}function d(h,m,v,w){return m.size===0?!0:h instanceof Set?f([...h],[...m],v,w):!1}e.isMatchWith=i,e.isSetMatch=d})(uO);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=uO;function r(n,i){return t.isMatchWith(n,i,()=>{})}e.isMatch=r})(H2);var fO={},K2={},dO={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Object.getOwnPropertySymbols(r).filter(n=>Object.prototype.propertyIsEnumerable.call(r,n))}e.getSymbols=t})(dO);var np={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}e.getTag=t})(np);var Y2={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t="[object RegExp]",r="[object String]",n="[object Number]",i="[object Boolean]",a="[object Arguments]",o="[object Symbol]",c="[object Date]",f="[object Map]",d="[object Set]",h="[object Array]",m="[object Function]",v="[object ArrayBuffer]",w="[object Object]",E="[object Error]",A="[object DataView]",S="[object Uint8Array]",b="[object Uint8ClampedArray]",T="[object Uint16Array]",_="[object Uint32Array]",N="[object BigUint64Array]",M="[object Int8Array]",R="[object Int16Array]",P="[object Int32Array]",z="[object BigInt64Array]",B="[object Float32Array]",re="[object Float64Array]";e.argumentsTag=a,e.arrayBufferTag=v,e.arrayTag=h,e.bigInt64ArrayTag=z,e.bigUint64ArrayTag=N,e.booleanTag=i,e.dataViewTag=A,e.dateTag=c,e.errorTag=E,e.float32ArrayTag=B,e.float64ArrayTag=re,e.functionTag=m,e.int16ArrayTag=R,e.int32ArrayTag=P,e.int8ArrayTag=M,e.mapTag=f,e.numberTag=n,e.objectTag=w,e.regexpTag=t,e.setTag=d,e.stringTag=r,e.symbolTag=o,e.uint16ArrayTag=T,e.uint32ArrayTag=_,e.uint8ArrayTag=S,e.uint8ClampedArrayTag=b})(Y2);var hO={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}e.isTypedArray=t})(hO);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=dO,r=np,n=Y2,i=$2,a=hO;function o(h,m){return c(h,void 0,h,new Map,m)}function c(h,m,v,w=new Map,E=void 0){const A=E==null?void 0:E(h,m,v,w);if(A!==void 0)return A;if(i.isPrimitive(h))return h;if(w.has(h))return w.get(h);if(Array.isArray(h)){const S=new Array(h.length);w.set(h,S);for(let b=0;b<h.length;b++)S[b]=c(h[b],b,v,w,E);return Object.hasOwn(h,"index")&&(S.index=h.index),Object.hasOwn(h,"input")&&(S.input=h.input),S}if(h instanceof Date)return new Date(h.getTime());if(h instanceof RegExp){const S=new RegExp(h.source,h.flags);return S.lastIndex=h.lastIndex,S}if(h instanceof Map){const S=new Map;w.set(h,S);for(const[b,T]of h)S.set(b,c(T,b,v,w,E));return S}if(h instanceof Set){const S=new Set;w.set(h,S);for(const b of h)S.add(c(b,void 0,v,w,E));return S}if(typeof Buffer<"u"&&Buffer.isBuffer(h))return h.subarray();if(a.isTypedArray(h)){const S=new(Object.getPrototypeOf(h)).constructor(h.length);w.set(h,S);for(let b=0;b<h.length;b++)S[b]=c(h[b],b,v,w,E);return S}if(h instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&h instanceof SharedArrayBuffer)return h.slice(0);if(h instanceof DataView){const S=new DataView(h.buffer.slice(0),h.byteOffset,h.byteLength);return w.set(h,S),f(S,h,v,w,E),S}if(typeof File<"u"&&h instanceof File){const S=new File([h],h.name,{type:h.type});return w.set(h,S),f(S,h,v,w,E),S}if(typeof Blob<"u"&&h instanceof Blob){const S=new Blob([h],{type:h.type});return w.set(h,S),f(S,h,v,w,E),S}if(h instanceof Error){const S=new h.constructor;return w.set(h,S),S.message=h.message,S.name=h.name,S.stack=h.stack,S.cause=h.cause,f(S,h,v,w,E),S}if(h instanceof Boolean){const S=new Boolean(h.valueOf());return w.set(h,S),f(S,h,v,w,E),S}if(h instanceof Number){const S=new Number(h.valueOf());return w.set(h,S),f(S,h,v,w,E),S}if(h instanceof String){const S=new String(h.valueOf());return w.set(h,S),f(S,h,v,w,E),S}if(typeof h=="object"&&d(h)){const S=Object.create(Object.getPrototypeOf(h));return w.set(h,S),f(S,h,v,w,E),S}return h}function f(h,m,v=h,w,E){const A=[...Object.keys(m),...t.getSymbols(m)];for(let S=0;S<A.length;S++){const b=A[S],T=Object.getOwnPropertyDescriptor(h,b);(T==null||T.writable)&&(h[b]=c(m[b],b,v,w,E))}}function d(h){switch(r.getTag(h)){case n.argumentsTag:case n.arrayTag:case n.arrayBufferTag:case n.dataViewTag:case n.booleanTag:case n.dateTag:case n.float32ArrayTag:case n.float64ArrayTag:case n.int8ArrayTag:case n.int16ArrayTag:case n.int32ArrayTag:case n.mapTag:case n.numberTag:case n.objectTag:case n.regexpTag:case n.setTag:case n.stringTag:case n.symbolTag:case n.uint8ArrayTag:case n.uint8ClampedArrayTag:case n.uint16ArrayTag:case n.uint32ArrayTag:return!0;default:return!1}}e.cloneDeepWith=o,e.cloneDeepWithImpl=c,e.copyProperties=f})(K2);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=K2;function r(n){return t.cloneDeepWithImpl(n,void 0,n,new Map,void 0)}e.cloneDeep=r})(fO);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=H2,r=fO;function n(i){return i=r.cloneDeep(i),a=>t.isMatch(a,i)}e.matches=n})(cO);var pO={},gO={},mO={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=K2,r=np,n=Y2;function i(a,o){return t.cloneDeepWith(a,(c,f,d,h)=>{const m=o==null?void 0:o(c,f,d,h);if(m!==void 0)return m;if(typeof a=="object"){if(r.getTag(a)===n.objectTag&&typeof a.constructor!="function"){const v={};return h.set(a,v),t.copyProperties(v,a,d,h),v}switch(Object.prototype.toString.call(a)){case n.numberTag:case n.stringTag:case n.booleanTag:{const v=new a.constructor(a==null?void 0:a.valueOf());return t.copyProperties(v,a),v}case n.argumentsTag:{const v={};return t.copyProperties(v,a),v.length=a.length,v[Symbol.iterator]=a[Symbol.iterator],v}default:return}}})}e.cloneDeepWith=i})(mO);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=mO;function r(n){return t.cloneDeepWith(n)}e.cloneDeep=r})(gO);var xO={},Z2={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=/^(?:0|[1-9]\d*)$/;function r(n,i=Number.MAX_SAFE_INTEGER){switch(typeof n){case"number":return Number.isInteger(n)&&n>=0&&n<i;case"symbol":return!1;case"string":return t.test(n)}}e.isIndex=r})(Z2);var vO={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=np;function r(n){return n!==null&&typeof n=="object"&&t.getTag(n)==="[object Arguments]"}e.isArguments=r})(vO);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=z2,r=Z2,n=vO,i=tp;function a(o,c){let f;if(Array.isArray(c)?f=c:typeof c=="string"&&t.isDeepKey(c)&&(o==null?void 0:o[c])==null?f=i.toPath(c):f=[c],f.length===0)return!1;let d=o;for(let h=0;h<f.length;h++){const m=f[h];if((d==null||!Object.hasOwn(d,m))&&!((Array.isArray(d)||n.isArguments(d))&&r.isIndex(m)&&m<d.length))return!1;d=d[m]}return!0}e.has=a})(xO);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=H2,r=ep,n=gO,i=J1,a=xO;function o(c,f){switch(typeof c){case"object":{Object.is(c==null?void 0:c.valueOf(),-0)&&(c="-0");break}case"number":{c=r.toKey(c);break}}return f=n.cloneDeep(f),function(d){const h=i.get(d,c);return h===void 0?a.has(d,c):f===void 0?h===void 0:t.isMatch(h,f)}}e.matchesProperty=o})(pO);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=V2,r=lO,n=cO,i=pO;function a(o){if(o==null)return t.identity;switch(typeof o){case"function":return o;case"object":return Array.isArray(o)&&o.length===2?i.matchesProperty(o[0],o[1]):n.matches(o);case"string":case"symbol":case"number":return r.property(o)}}e.iteratee=a})(oO);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=rO,r=nO,n=V2,i=iO,a=oO;function o(c,f=n.identity){return i.isArrayLikeObject(c)?t.uniqBy(Array.from(c),r.ary(a.iteratee(f),1)):[]}e.uniqBy=o})(tO);var q9=tO.uniqBy;const s3=bs(q9);function yO(e,t,r){return t===!0?s3(e,r):typeof t=="function"?s3(e,t):e}var wO={exports:{}},EO={},AO={exports:{}},CO={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Nc=I;function Q9(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var J9=typeof Object.is=="function"?Object.is:Q9,eL=Nc.useState,tL=Nc.useEffect,rL=Nc.useLayoutEffect,nL=Nc.useDebugValue;function iL(e,t){var r=t(),n=eL({inst:{value:r,getSnapshot:t}}),i=n[0].inst,a=n[1];return rL(function(){i.value=r,i.getSnapshot=t,Jg(i)&&a({inst:i})},[e,r,t]),tL(function(){return Jg(i)&&a({inst:i}),e(function(){Jg(i)&&a({inst:i})})},[e]),nL(r),r}function Jg(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!J9(e,r)}catch{return!0}}function aL(e,t){return t()}var sL=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?aL:iL;CO.useSyncExternalStore=Nc.useSyncExternalStore!==void 0?Nc.useSyncExternalStore:sL;AO.exports=CO;var oL=AO.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ip=I,lL=oL;function cL(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var uL=typeof Object.is=="function"?Object.is:cL,fL=lL.useSyncExternalStore,dL=ip.useRef,hL=ip.useEffect,pL=ip.useMemo,gL=ip.useDebugValue;EO.useSyncExternalStoreWithSelector=function(e,t,r,n,i){var a=dL(null);if(a.current===null){var o={hasValue:!1,value:null};a.current=o}else o=a.current;a=pL(function(){function f(w){if(!d){if(d=!0,h=w,w=n(w),i!==void 0&&o.hasValue){var E=o.value;if(i(E,w))return m=E}return m=w}if(E=m,uL(h,w))return E;var A=n(w);return i!==void 0&&i(E,A)?(h=w,E):(h=w,m=A)}var d=!1,h,m,v=r===void 0?null:r;return[function(){return f(t())},v===null?void 0:function(){return f(v())}]},[t,r,n,i]);var c=fL(e,a[0],a[1]);return hL(function(){o.hasValue=!0,o.value=c},[c]),gL(c),c};wO.exports=EO;var mL=wO.exports,q2=I.createContext(null),xL=e=>e,Qt=()=>{var e=I.useContext(q2);return e?e.store.dispatch:xL},Vd=()=>{},vL=()=>Vd,yL=(e,t)=>e===t;function Je(e){var t=I.useContext(q2),r=I.useMemo(()=>t?n=>{if(n!=null)return e(n)}:Vd,[t,e]);return mL.useSyncExternalStoreWithSelector(t?t.subscription.addNestedSub:vL,t?t.store.getState:Vd,t?t.store.getState:Vd,r,yL)}function wL(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function EL(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function AL(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(r=>typeof r=="function")){const r=e.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${t}[${r}]`)}}var o3=e=>Array.isArray(e)?e:[e];function CL(e){const t=Array.isArray(e[0])?e[0]:e;return AL(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function SL(e,t){const r=[],{length:n}=e;for(let i=0;i<n;i++)r.push(e[i].apply(null,t));return r}var _L=class{constructor(e){this.value=e}deref(){return this.value}},bL=typeof WeakRef<"u"?WeakRef:_L,TL=0,l3=1;function ad(){return{s:TL,v:void 0,o:null,p:null}}function SO(e,t={}){let r=ad();const{resultEqualityCheck:n}=t;let i,a=0;function o(){var m;let c=r;const{length:f}=arguments;for(let v=0,w=f;v<w;v++){const E=arguments[v];if(typeof E=="function"||typeof E=="object"&&E!==null){let A=c.o;A===null&&(c.o=A=new WeakMap);const S=A.get(E);S===void 0?(c=ad(),A.set(E,c)):c=S}else{let A=c.p;A===null&&(c.p=A=new Map);const S=A.get(E);S===void 0?(c=ad(),A.set(E,c)):c=S}}const d=c;let h;if(c.s===l3)h=c.v;else if(h=e.apply(null,arguments),a++,n){const v=((m=i==null?void 0:i.deref)==null?void 0:m.call(i))??i;v!=null&&n(v,h)&&(h=v,a!==0&&a--),i=typeof h=="object"&&h!==null||typeof h=="function"?new bL(h):h}return d.s=l3,d.v=h,h}return o.clearCache=()=>{r=ad(),o.resetResultsCount()},o.resultsCount=()=>a,o.resetResultsCount=()=>{a=0},o}function OL(e,...t){const r=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,n=(...i)=>{let a=0,o=0,c,f={},d=i.pop();typeof d=="object"&&(f=d,d=i.pop()),wL(d,`createSelector expects an output function after the inputs, but received: [${typeof d}]`);const h={...r,...f},{memoize:m,memoizeOptions:v=[],argsMemoize:w=SO,argsMemoizeOptions:E=[]}=h,A=o3(v),S=o3(E),b=CL(i),T=m(function(){return a++,d.apply(null,arguments)},...A),_=w(function(){o++;const M=SL(b,arguments);return c=T.apply(null,M),c},...S);return Object.assign(_,{resultFunc:d,memoizedResultFunc:T,dependencies:b,dependencyRecomputations:()=>o,resetDependencyRecomputations:()=>{o=0},lastResult:()=>c,recomputations:()=>a,resetRecomputations:()=>{a=0},memoize:m,argsMemoize:w})};return Object.assign(n,{withTypes:()=>n}),n}var ve=OL(SO),kL=Object.assign((e,t=ve)=>{EL(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);const r=Object.keys(e),n=r.map(a=>e[a]);return t(n,(...a)=>a.reduce((o,c,f)=>(o[r[f]]=c,o),{}))},{withTypes:()=>kL}),_O={},bO={},TO={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return typeof n=="symbol"?1:n===null?2:n===void 0?3:n!==n?4:0}const r=(n,i,a)=>{if(n!==i){const o=t(n),c=t(i);if(o===c&&o===0){if(n<i)return a==="desc"?1:-1;if(n>i)return a==="desc"?-1:1}return a==="desc"?c-o:o-c}return 0};e.compareValues=r})(TO);var OO={},Q2={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="symbol"||r instanceof Symbol}e.isSymbol=t})(Q2);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Q2,r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function i(a,o){return Array.isArray(a)?!1:typeof a=="number"||typeof a=="boolean"||a==null||t.isSymbol(a)?!0:typeof a=="string"&&(n.test(a)||!r.test(a))||o!=null&&Object.hasOwn(o,a)}e.isKey=i})(OO);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=TO,r=OO,n=tp;function i(a,o,c,f){if(a==null)return[];c=f?void 0:c,Array.isArray(a)||(a=Object.values(a)),Array.isArray(o)||(o=o==null?[null]:[o]),o.length===0&&(o=[null]),Array.isArray(c)||(c=c==null?[]:[c]),c=c.map(w=>String(w));const d=(w,E)=>{let A=w;for(let S=0;S<E.length&&A!=null;++S)A=A[E[S]];return A},h=(w,E)=>E==null||w==null?E:typeof w=="object"&&"key"in w?Object.hasOwn(E,w.key)?E[w.key]:d(E,w.path):typeof w=="function"?w(E):Array.isArray(w)?d(E,w):typeof E=="object"?E[w]:E,m=o.map(w=>(Array.isArray(w)&&w.length===1&&(w=w[0]),w==null||typeof w=="function"||Array.isArray(w)||r.isKey(w)?w:{key:w,path:n.toPath(w)}));return a.map(w=>({original:w,criteria:m.map(E=>h(E,w))})).slice().sort((w,E)=>{for(let A=0;A<m.length;A++){const S=t.compareValues(w.criteria[A],E.criteria[A],c[A]);if(S!==0)return S}return 0}).map(w=>w.original)}e.orderBy=i})(bO);var kO={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n=1){const i=[],a=Math.floor(n),o=(c,f)=>{for(let d=0;d<c.length;d++){const h=c[d];Array.isArray(h)&&f<a?o(h,f+1):i.push(h)}};return o(r,0),i}e.flatten=t})(kO);var J2={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Z2,r=rp,n=G2,i=X2;function a(o,c,f){return n.isObject(f)&&(typeof c=="number"&&r.isArrayLike(f)&&t.isIndex(c)&&c<f.length||typeof c=="string"&&c in f)?i.isEqualsSameValueZero(f[c],o):!1}e.isIterateeCall=a})(J2);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=bO,r=kO,n=J2;function i(a,...o){const c=o.length;return c>1&&n.isIterateeCall(a,o[0],o[1])?o=[]:c>2&&n.isIterateeCall(o[0],o[1],o[2])&&(o=[o[0]]),t.orderBy(a,r.flatten(o),["asc"])}e.sortBy=i})(_O);var IL=_O.sortBy;const ap=bs(IL);var IO=e=>e.legend.settings,NL=e=>e.legend.size,PL=e=>e.legend.payload,DL=ve([PL,IO],(e,t)=>{var{itemSorter:r}=t,n=e.flat(1);return r?ap(n,r):n});function RL(){return Je(DL)}var sd=1;function NO(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[t,r]=I.useState({height:0,left:0,top:0,width:0}),n=I.useCallback(i=>{if(i!=null){var a=i.getBoundingClientRect(),o={height:a.height,left:a.left,top:a.top,width:a.width};(Math.abs(o.height-t.height)>sd||Math.abs(o.left-t.left)>sd||Math.abs(o.top-t.top)>sd||Math.abs(o.width-t.width)>sd)&&r({height:o.height,left:o.left,top:o.top,width:o.width})}},[t.width,t.height,t.top,t.left,...e]);return[t,n]}function mn(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var ML=typeof Symbol=="function"&&Symbol.observable||"@@observable",c3=ML,em=()=>Math.random().toString(36).substring(7).split("").join("."),FL={INIT:`@@redux/INIT${em()}`,REPLACE:`@@redux/REPLACE${em()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${em()}`},Ph=FL;function ey(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function PO(e,t,r){if(typeof e!="function")throw new Error(mn(2));if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(mn(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(mn(1));return r(PO)(e,t)}let n=e,i=t,a=new Map,o=a,c=0,f=!1;function d(){o===a&&(o=new Map,a.forEach((S,b)=>{o.set(b,S)}))}function h(){if(f)throw new Error(mn(3));return i}function m(S){if(typeof S!="function")throw new Error(mn(4));if(f)throw new Error(mn(5));let b=!0;d();const T=c++;return o.set(T,S),function(){if(b){if(f)throw new Error(mn(6));b=!1,d(),o.delete(T),a=null}}}function v(S){if(!ey(S))throw new Error(mn(7));if(typeof S.type>"u")throw new Error(mn(8));if(typeof S.type!="string")throw new Error(mn(17));if(f)throw new Error(mn(9));try{f=!0,i=n(i,S)}finally{f=!1}return(a=o).forEach(T=>{T()}),S}function w(S){if(typeof S!="function")throw new Error(mn(10));n=S,v({type:Ph.REPLACE})}function E(){const S=m;return{subscribe(b){if(typeof b!="object"||b===null)throw new Error(mn(11));function T(){const N=b;N.next&&N.next(h())}return T(),{unsubscribe:S(T)}},[c3](){return this}}}return v({type:Ph.INIT}),{dispatch:v,subscribe:m,getState:h,replaceReducer:w,[c3]:E}}function LL(e){Object.keys(e).forEach(t=>{const r=e[t];if(typeof r(void 0,{type:Ph.INIT})>"u")throw new Error(mn(12));if(typeof r(void 0,{type:Ph.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(mn(13))})}function DO(e){const t=Object.keys(e),r={};for(let a=0;a<t.length;a++){const o=t[a];typeof e[o]=="function"&&(r[o]=e[o])}const n=Object.keys(r);let i;try{LL(r)}catch(a){i=a}return function(o={},c){if(i)throw i;let f=!1;const d={};for(let h=0;h<n.length;h++){const m=n[h],v=r[m],w=o[m],E=v(w,c);if(typeof E>"u")throw c&&c.type,new Error(mn(14));d[m]=E,f=f||E!==w}return f=f||n.length!==Object.keys(o).length,f?d:o}}function Dh(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,r)=>(...n)=>t(r(...n)))}function BL(...e){return t=>(r,n)=>{const i=t(r,n);let a=()=>{throw new Error(mn(15))};const o={getState:i.getState,dispatch:(f,...d)=>a(f,...d)},c=e.map(f=>f(o));return a=Dh(...c)(i.dispatch),{...i,dispatch:a}}}function RO(e){return ey(e)&&"type"in e&&typeof e.type=="string"}var MO=Symbol.for("immer-nothing"),u3=Symbol.for("immer-draftable"),Zn=Symbol.for("immer-state");function ha(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var Si=Object,Pc=Si.getPrototypeOf,Rh="constructor",sp="prototype",Mx="configurable",Mh="enumerable",Hd="writable",I0="value",vs=e=>!!e&&!!e[Zn];function _a(e){var t;return e?FO(e)||lp(e)||!!e[u3]||!!((t=e[Rh])!=null&&t[u3])||cp(e)||up(e):!1}var jL=Si[sp][Rh].toString(),f3=new WeakMap;function FO(e){if(!e||!ty(e))return!1;const t=Pc(e);if(t===null||t===Si[sp])return!0;const r=Si.hasOwnProperty.call(t,Rh)&&t[Rh];if(r===Object)return!0;if(!Xl(r))return!1;let n=f3.get(r);return n===void 0&&(n=Function.toString.call(r),f3.set(r,n)),n===jL}function op(e,t,r=!0){cf(e)===0?(r?Reflect.ownKeys(e):Si.keys(e)).forEach(i=>{t(i,e[i],e)}):e.forEach((n,i)=>t(i,n,e))}function cf(e){const t=e[Zn];return t?t.type_:lp(e)?1:cp(e)?2:up(e)?3:0}var d3=(e,t,r=cf(e))=>r===2?e.has(t):Si[sp].hasOwnProperty.call(e,t),Fx=(e,t,r=cf(e))=>r===2?e.get(t):e[t],Fh=(e,t,r,n=cf(e))=>{n===2?e.set(t,r):n===3?e.add(r):e[t]=r};function UL(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}var lp=Array.isArray,cp=e=>e instanceof Map,up=e=>e instanceof Set,ty=e=>typeof e=="object",Xl=e=>typeof e=="function",tm=e=>typeof e=="boolean";function zL(e){const t=+e;return Number.isInteger(t)&&String(t)===e}var rs=e=>e.copy_||e.base_,ry=e=>e.modified_?e.copy_:e.base_;function Lx(e,t){if(cp(e))return new Map(e);if(up(e))return new Set(e);if(lp(e))return Array[sp].slice.call(e);const r=FO(e);if(t===!0||t==="class_only"&&!r){const n=Si.getOwnPropertyDescriptors(e);delete n[Zn];let i=Reflect.ownKeys(n);for(let a=0;a<i.length;a++){const o=i[a],c=n[o];c[Hd]===!1&&(c[Hd]=!0,c[Mx]=!0),(c.get||c.set)&&(n[o]={[Mx]:!0,[Hd]:!0,[Mh]:c[Mh],[I0]:e[o]})}return Si.create(Pc(e),n)}else{const n=Pc(e);if(n!==null&&r)return{...e};const i=Si.create(n);return Si.assign(i,e)}}function ny(e,t=!1){return fp(e)||vs(e)||!_a(e)||(cf(e)>1&&Si.defineProperties(e,{set:od,add:od,clear:od,delete:od}),Si.freeze(e),t&&op(e,(r,n)=>{ny(n,!0)},!1)),e}function WL(){ha(2)}var od={[I0]:WL};function fp(e){return e===null||!ty(e)?!0:Si.isFrozen(e)}var Lh="MapSet",Bx="Patches",h3="ArrayMethods",LO={};function dl(e){const t=LO[e];return t||ha(0,e),t}var p3=e=>!!LO[e],N0,BO=()=>N0,VL=(e,t)=>({drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0,handledSet_:new Set,processedForPatches_:new Set,mapSetPlugin_:p3(Lh)?dl(Lh):void 0,arrayMethodsPlugin_:p3(h3)?dl(h3):void 0});function g3(e,t){t&&(e.patchPlugin_=dl(Bx),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function jx(e){Ux(e),e.drafts_.forEach(HL),e.drafts_=null}function Ux(e){e===N0&&(N0=e.parent_)}var m3=e=>N0=VL(N0,e);function HL(e){const t=e[Zn];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function x3(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];if(e!==void 0&&e!==r){r[Zn].modified_&&(jx(t),ha(4)),_a(e)&&(e=v3(t,e));const{patchPlugin_:i}=t;i&&i.generateReplacementPatches_(r[Zn].base_,e,t)}else e=v3(t,r);return GL(t,e,!0),jx(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==MO?e:void 0}function v3(e,t){if(fp(t))return t;const r=t[Zn];if(!r)return Bh(t,e.handledSet_,e);if(!dp(r,e))return t;if(!r.modified_)return r.base_;if(!r.finalized_){const{callbacks_:n}=r;if(n)for(;n.length>0;)n.pop()(e);zO(r,e)}return r.copy_}function GL(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&ny(t,r)}function jO(e){e.finalized_=!0,e.scope_.unfinalizedDrafts_--}var dp=(e,t)=>e.scope_===t,$L=[];function UO(e,t,r,n){const i=rs(e),a=e.type_;if(n!==void 0&&Fx(i,n,a)===t){Fh(i,n,r,a);return}if(!e.draftLocations_){const c=e.draftLocations_=new Map;op(i,(f,d)=>{if(vs(d)){const h=c.get(d)||[];h.push(f),c.set(d,h)}})}const o=e.draftLocations_.get(t)??$L;for(const c of o)Fh(i,c,r,a)}function XL(e,t,r){e.callbacks_.push(function(i){var c;const a=t;if(!a||!dp(a,i))return;(c=i.mapSetPlugin_)==null||c.fixSetContents(a);const o=ry(a);UO(e,a.draft_??a,o,r),zO(a,i)})}function zO(e,t){var n;if(e.modified_&&!e.finalized_&&(e.type_===3||e.type_===1&&e.allIndicesReassigned_||(((n=e.assigned_)==null?void 0:n.size)??0)>0)){const{patchPlugin_:i}=t;if(i){const a=i.getPath(e);a&&i.generatePatches_(e,a,t)}jO(e)}}function KL(e,t,r){const{scope_:n}=e;if(vs(r)){const i=r[Zn];dp(i,n)&&i.callbacks_.push(function(){Gd(e);const o=ry(i);UO(e,r,o,t)})}else _a(r)&&e.callbacks_.push(function(){const a=rs(e);e.type_===3?a.has(r)&&Bh(r,n.handledSet_,n):Fx(a,t,e.type_)===r&&n.drafts_.length>1&&(e.assigned_.get(t)??!1)===!0&&e.copy_&&Bh(Fx(e.copy_,t,e.type_),n.handledSet_,n)})}function Bh(e,t,r){return!r.immer_.autoFreeze_&&r.unfinalizedDrafts_<1||vs(e)||t.has(e)||!_a(e)||fp(e)||(t.add(e),op(e,(n,i)=>{if(vs(i)){const a=i[Zn];if(dp(a,r)){const o=ry(a);Fh(e,n,o,e.type_),jO(a)}}else _a(i)&&Bh(i,t,r)})),e}function YL(e,t){const r=lp(e),n={type_:r?1:0,scope_:t?t.scope_:BO(),modified_:!1,finalized_:!1,assigned_:void 0,parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1,callbacks_:void 0};let i=n,a=jh;r&&(i=[n],a=P0);const{revoke:o,proxy:c}=Proxy.revocable(i,a);return n.draft_=c,n.revoke_=o,[c,n]}var jh={get(e,t){if(t===Zn)return e;let r=e.scope_.arrayMethodsPlugin_;const n=e.type_===1&&typeof t=="string";if(n&&r!=null&&r.isArrayOperationMethod(t))return r.createMethodInterceptor(e,t);const i=rs(e);if(!d3(i,t,e.type_))return ZL(e,i,t);const a=i[t];if(e.finalized_||!_a(a)||n&&e.operationMethod&&(r!=null&&r.isMutatingArrayMethod(e.operationMethod))&&zL(t))return a;if(a===rm(e.base_,t)){Gd(e);const o=e.type_===1?+t:t,c=Wx(e.scope_,a,e,o);return e.copy_[o]=c}return a},has(e,t){return t in rs(e)},ownKeys(e){return Reflect.ownKeys(rs(e))},set(e,t,r){const n=WO(rs(e),t);if(n!=null&&n.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const i=rm(rs(e),t),a=i==null?void 0:i[Zn];if(a&&a.base_===r)return e.copy_[t]=r,e.assigned_.set(t,!1),!0;if(UL(r,i)&&(r!==void 0||d3(e.base_,t,e.type_)))return!0;Gd(e),zx(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_.set(t,!0),KL(e,t,r)),!0},deleteProperty(e,t){return Gd(e),rm(e.base_,t)!==void 0||t in e.base_?(e.assigned_.set(t,!1),zx(e)):e.assigned_.delete(t),e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=rs(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{[Hd]:!0,[Mx]:e.type_!==1||t!=="length",[Mh]:n[Mh],[I0]:r[t]}},defineProperty(){ha(11)},getPrototypeOf(e){return Pc(e.base_)},setPrototypeOf(){ha(12)}},P0={};for(let e in jh){let t=jh[e];P0[e]=function(){const r=arguments;return r[0]=r[0][0],t.apply(this,r)}}P0.deleteProperty=function(e,t){return P0.set.call(this,e,t,void 0)};P0.set=function(e,t,r){return jh.set.call(this,e[0],t,r,e[0])};function rm(e,t){const r=e[Zn];return(r?rs(r):e)[t]}function ZL(e,t,r){var i;const n=WO(t,r);return n?I0 in n?n[I0]:(i=n.get)==null?void 0:i.call(e.draft_):void 0}function WO(e,t){if(!(t in e))return;let r=Pc(e);for(;r;){const n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=Pc(r)}}function zx(e){e.modified_||(e.modified_=!0,e.parent_&&zx(e.parent_))}function Gd(e){e.copy_||(e.assigned_=new Map,e.copy_=Lx(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var qL=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!1,this.produce=(r,n,i)=>{if(Xl(r)&&!Xl(n)){const o=n;n=r;const c=this;return function(d=o,...h){return c.produce(d,m=>n.call(this,m,...h))}}Xl(n)||ha(6),i!==void 0&&!Xl(i)&&ha(7);let a;if(_a(r)){const o=m3(this),c=Wx(o,r,void 0);let f=!0;try{a=n(c),f=!1}finally{f?jx(o):Ux(o)}return g3(o,i),x3(a,o)}else if(!r||!ty(r)){if(a=n(r),a===void 0&&(a=r),a===MO&&(a=void 0),this.autoFreeze_&&ny(a,!0),i){const o=[],c=[];dl(Bx).generateReplacementPatches_(r,a,{patches_:o,inversePatches_:c}),i(o,c)}return a}else ha(1,r)},this.produceWithPatches=(r,n)=>{if(Xl(r))return(c,...f)=>this.produceWithPatches(c,d=>r(d,...f));let i,a;return[this.produce(r,n,(c,f)=>{i=c,a=f}),i,a]},tm(t==null?void 0:t.autoFreeze)&&this.setAutoFreeze(t.autoFreeze),tm(t==null?void 0:t.useStrictShallowCopy)&&this.setUseStrictShallowCopy(t.useStrictShallowCopy),tm(t==null?void 0:t.useStrictIteration)&&this.setUseStrictIteration(t.useStrictIteration)}createDraft(t){_a(t)||ha(8),vs(t)&&(t=Ea(t));const r=m3(this),n=Wx(r,t,void 0);return n[Zn].isManual_=!0,Ux(r),n}finishDraft(t,r){const n=t&&t[Zn];(!n||!n.isManual_)&&ha(9);const{scope_:i}=n;return g3(i,r),x3(void 0,i)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}setUseStrictIteration(t){this.useStrictIteration_=t}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(t,r){let n;for(n=r.length-1;n>=0;n--){const a=r[n];if(a.path.length===0&&a.op==="replace"){t=a.value;break}}n>-1&&(r=r.slice(n+1));const i=dl(Bx).applyPatches_;return vs(t)?i(t,r):this.produce(t,a=>i(a,r))}};function Wx(e,t,r,n){const[i,a]=cp(t)?dl(Lh).proxyMap_(t,r):up(t)?dl(Lh).proxySet_(t,r):YL(t,r);return((r==null?void 0:r.scope_)??BO()).drafts_.push(i),a.callbacks_=(r==null?void 0:r.callbacks_)??[],a.key_=n,r&&n!==void 0?XL(r,a,n):a.callbacks_.push(function(f){var h;(h=f.mapSetPlugin_)==null||h.fixSetContents(a);const{patchPlugin_:d}=f;a.modified_&&d&&d.generatePatches_(a,[],f)}),i}function Ea(e){return vs(e)||ha(10,e),VO(e)}function VO(e){if(!_a(e)||fp(e))return e;const t=e[Zn];let r,n=!0;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=Lx(e,t.scope_.immer_.useStrictShallowCopy_),n=t.scope_.immer_.shouldUseStrictIteration()}else r=Lx(e,!0);return op(r,(i,a)=>{Fh(r,i,VO(a))},n),t&&(t.finalized_=!1),r}var QL=new qL,HO=QL.produce;function GO(e){return({dispatch:r,getState:n})=>i=>a=>typeof a=="function"?a(r,n,e):i(a)}var JL=GO(),eB=GO,tB=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?Dh:Dh.apply(null,arguments)};function Ji(e,t){function r(...n){if(t){let i=t(...n);if(!i)throw new Error(bi(0));return{type:e,payload:i.payload,..."meta"in i&&{meta:i.meta},..."error"in i&&{error:i.error}}}return{type:e,payload:n[0]}}return r.toString=()=>`${e}`,r.type=e,r.match=n=>RO(n)&&n.type===e,r}var $O=class Bu extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,Bu.prototype)}static get[Symbol.species](){return Bu}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new Bu(...t[0].concat(this)):new Bu(...t.concat(this))}};function y3(e){return _a(e)?HO(e,()=>{}):e}function ld(e,t,r){return e.has(t)?e.get(t):e.set(t,r(t)).get(t)}function rB(e){return typeof e=="boolean"}var nB=()=>function(t){const{thunk:r=!0,immutableCheck:n=!0,serializableCheck:i=!0,actionCreatorCheck:a=!0}=t??{};let o=new $O;return r&&(rB(r)?o.push(JL):o.push(eB(r.extraArgument))),o},XO="RTK_autoBatch",lr=()=>e=>({payload:e,meta:{[XO]:!0}}),w3=e=>t=>{setTimeout(t,e)},KO=(e={type:"raf"})=>t=>(...r)=>{const n=t(...r);let i=!0,a=!1,o=!1;const c=new Set,f=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:w3(10):e.type==="callback"?e.queueNotification:w3(e.timeout),d=()=>{o=!1,a&&(a=!1,c.forEach(h=>h()))};return Object.assign({},n,{subscribe(h){const m=()=>i&&h(),v=n.subscribe(m);return c.add(h),()=>{v(),c.delete(h)}},dispatch(h){var m;try{return i=!((m=h==null?void 0:h.meta)!=null&&m[XO]),a=!i,a&&(o||(o=!0,f(d))),n.dispatch(h)}finally{i=!0}}})},iB=e=>function(r){const{autoBatch:n=!0}=r??{};let i=new $O(e);return n&&i.push(KO(typeof n=="object"?n:void 0)),i};function aB(e){const t=nB(),{reducer:r=void 0,middleware:n,devTools:i=!0,preloadedState:a=void 0,enhancers:o=void 0}=e||{};let c;if(typeof r=="function")c=r;else if(ey(r))c=DO(r);else throw new Error(bi(1));let f;typeof n=="function"?f=n(t):f=t();let d=Dh;i&&(d=tB({trace:!1,...typeof i=="object"&&i}));const h=BL(...f),m=iB(h);let v=typeof o=="function"?o(m):m();const w=d(...v);return PO(c,a,w)}function YO(e){const t={},r=[];let n;const i={addCase(a,o){const c=typeof a=="string"?a:a.type;if(!c)throw new Error(bi(28));if(c in t)throw new Error(bi(29));return t[c]=o,i},addAsyncThunk(a,o){return o.pending&&(t[a.pending.type]=o.pending),o.rejected&&(t[a.rejected.type]=o.rejected),o.fulfilled&&(t[a.fulfilled.type]=o.fulfilled),o.settled&&r.push({matcher:a.settled,reducer:o.settled}),i},addMatcher(a,o){return r.push({matcher:a,reducer:o}),i},addDefaultCase(a){return n=a,i}};return e(i),[t,r,n]}function sB(e){return typeof e=="function"}function oB(e,t){let[r,n,i]=YO(t),a;if(sB(e))a=()=>y3(e());else{const c=y3(e);a=()=>c}function o(c=a(),f){let d=[r[f.type],...n.filter(({matcher:h})=>h(f)).map(({reducer:h})=>h)];return d.filter(h=>!!h).length===0&&(d=[i]),d.reduce((h,m)=>{if(m)if(vs(h)){const w=m(h,f);return w===void 0?h:w}else{if(_a(h))return HO(h,v=>m(v,f));{const v=m(h,f);if(v===void 0){if(h===null)return h;throw Error("A case reducer on a non-draftable value must not return undefined")}return v}}return h},c)}return o.getInitialState=a,o}var lB="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",cB=(e=21)=>{let t="",r=e;for(;r--;)t+=lB[Math.random()*64|0];return t},uB=Symbol.for("rtk-slice-createasyncthunk");function fB(e,t){return`${e}/${t}`}function dB({creators:e}={}){var r;const t=(r=e==null?void 0:e.asyncThunk)==null?void 0:r[uB];return function(i){const{name:a,reducerPath:o=a}=i;if(!a)throw new Error(bi(11));const c=(typeof i.reducers=="function"?i.reducers(pB()):i.reducers)||{},f=Object.keys(c),d={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},h={addCase(N,M){const R=typeof N=="string"?N:N.type;if(!R)throw new Error(bi(12));if(R in d.sliceCaseReducersByType)throw new Error(bi(13));return d.sliceCaseReducersByType[R]=M,h},addMatcher(N,M){return d.sliceMatchers.push({matcher:N,reducer:M}),h},exposeAction(N,M){return d.actionCreators[N]=M,h},exposeCaseReducer(N,M){return d.sliceCaseReducersByName[N]=M,h}};f.forEach(N=>{const M=c[N],R={reducerName:N,type:fB(a,N),createNotation:typeof i.reducers=="function"};mB(M)?vB(R,M,h,t):gB(R,M,h)});function m(){const[N={},M=[],R=void 0]=typeof i.extraReducers=="function"?YO(i.extraReducers):[i.extraReducers],P={...N,...d.sliceCaseReducersByType};return oB(i.initialState,z=>{for(let B in P)z.addCase(B,P[B]);for(let B of d.sliceMatchers)z.addMatcher(B.matcher,B.reducer);for(let B of M)z.addMatcher(B.matcher,B.reducer);R&&z.addDefaultCase(R)})}const v=N=>N,w=new Map,E=new WeakMap;let A;function S(N,M){return A||(A=m()),A(N,M)}function b(){return A||(A=m()),A.getInitialState()}function T(N,M=!1){function R(z){let B=z[N];return typeof B>"u"&&M&&(B=ld(E,R,b)),B}function P(z=v){const B=ld(w,M,()=>new WeakMap);return ld(B,z,()=>{const re={};for(const[ee,V]of Object.entries(i.selectors??{}))re[ee]=hB(V,z,()=>ld(E,z,b),M);return re})}return{reducerPath:N,getSelectors:P,get selectors(){return P(R)},selectSlice:R}}const _={name:a,reducer:S,actions:d.actionCreators,caseReducers:d.sliceCaseReducersByName,getInitialState:b,...T(o),injectInto(N,{reducerPath:M,...R}={}){const P=M??o;return N.inject({reducerPath:P,reducer:S},R),{..._,...T(P,!0)}}};return _}}function hB(e,t,r,n){function i(a,...o){let c=t(a);return typeof c>"u"&&n&&(c=r()),e(c,...o)}return i.unwrapped=e,i}var hi=dB();function pB(){function e(t,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:t,...r}}return e.withTypes=()=>e,{reducer(t){return Object.assign({[t.name](...r){return t(...r)}}[t.name],{_reducerDefinitionType:"reducer"})},preparedReducer(t,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:r}},asyncThunk:e}}function gB({type:e,reducerName:t,createNotation:r},n,i){let a,o;if("reducer"in n){if(r&&!xB(n))throw new Error(bi(17));a=n.reducer,o=n.prepare}else a=n;i.addCase(e,a).exposeCaseReducer(t,a).exposeAction(t,o?Ji(e,o):Ji(e))}function mB(e){return e._reducerDefinitionType==="asyncThunk"}function xB(e){return e._reducerDefinitionType==="reducerWithPrepare"}function vB({type:e,reducerName:t},r,n,i){if(!i)throw new Error(bi(18));const{payloadCreator:a,fulfilled:o,pending:c,rejected:f,settled:d,options:h}=r,m=i(e,a,h);n.exposeAction(t,m),o&&n.addCase(m.fulfilled,o),c&&n.addCase(m.pending,c),f&&n.addCase(m.rejected,f),d&&n.addMatcher(m.settled,d),n.exposeCaseReducer(t,{fulfilled:o||cd,pending:c||cd,rejected:f||cd,settled:d||cd})}function cd(){}var yB="task",ZO="listener",qO="completed",iy="cancelled",wB=`task-${iy}`,EB=`task-${qO}`,Vx=`${ZO}-${iy}`,AB=`${ZO}-${qO}`,hp=class{constructor(e){Cg(this,"name","TaskAbortError");Cg(this,"message");this.code=e,this.message=`${yB} ${iy} (reason: ${e})`}},ay=(e,t)=>{if(typeof e!="function")throw new TypeError(bi(32))},Uh=()=>{},QO=(e,t=Uh)=>(e.catch(t),e),JO=(e,t)=>(e.addEventListener("abort",t,{once:!0}),()=>e.removeEventListener("abort",t)),Qo=e=>{if(e.aborted)throw new hp(e.reason)};function ek(e,t){let r=Uh;return new Promise((n,i)=>{const a=()=>i(new hp(e.reason));if(e.aborted){a();return}r=JO(e,a),t.finally(()=>r()).then(n,i)}).finally(()=>{r=Uh})}var CB=async(e,t)=>{try{return await Promise.resolve(),{status:"ok",value:await e()}}catch(r){return{status:r instanceof hp?"cancelled":"rejected",error:r}}finally{t==null||t()}},zh=e=>t=>QO(ek(e,t).then(r=>(Qo(e),r))),tk=e=>{const t=zh(e);return r=>t(new Promise(n=>setTimeout(n,r)))},{assign:vc}=Object,E3={},pp="listenerMiddleware",SB=(e,t)=>{const r=n=>JO(e,()=>n.abort(e.reason));return(n,i)=>{ay(n);const a=new AbortController;r(a);const o=CB(async()=>{Qo(e),Qo(a.signal);const c=await n({pause:zh(a.signal),delay:tk(a.signal),signal:a.signal});return Qo(a.signal),c},()=>a.abort(EB));return i!=null&&i.autoJoin&&t.push(o.catch(Uh)),{result:zh(e)(o),cancel(){a.abort(wB)}}}},_B=(e,t)=>{const r=async(n,i)=>{Qo(t);let a=()=>{};const c=[new Promise((f,d)=>{let h=e({predicate:n,effect:(m,v)=>{v.unsubscribe(),f([m,v.getState(),v.getOriginalState()])}});a=()=>{h(),d()}})];i!=null&&c.push(new Promise(f=>setTimeout(f,i,null)));try{const f=await ek(t,Promise.race(c));return Qo(t),f}finally{a()}};return(n,i)=>QO(r(n,i))},rk=e=>{let{type:t,actionCreator:r,matcher:n,predicate:i,effect:a}=e;if(t)i=Ji(t).match;else if(r)t=r.type,i=r.match;else if(n)i=n;else if(!i)throw new Error(bi(21));return ay(a),{predicate:i,type:t,effect:a}},nk=vc(e=>{const{type:t,predicate:r,effect:n}=rk(e);return{id:cB(),effect:n,type:t,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(bi(22))}}},{withTypes:()=>nk}),A3=(e,t)=>{const{type:r,effect:n,predicate:i}=rk(t);return Array.from(e.values()).find(a=>(typeof r=="string"?a.type===r:a.predicate===i)&&a.effect===n)},Hx=e=>{e.pending.forEach(t=>{t.abort(Vx)})},bB=(e,t)=>()=>{for(const r of t.keys())Hx(r);e.clear()},C3=(e,t,r)=>{try{e(t,r)}catch(n){setTimeout(()=>{throw n},0)}},ik=vc(Ji(`${pp}/add`),{withTypes:()=>ik}),TB=Ji(`${pp}/removeAll`),ak=vc(Ji(`${pp}/remove`),{withTypes:()=>ak}),OB=(...e)=>{console.error(`${pp}/error`,...e)},uf=(e={})=>{const t=new Map,r=new Map,n=w=>{const E=r.get(w)??0;r.set(w,E+1)},i=w=>{const E=r.get(w)??1;E===1?r.delete(w):r.set(w,E-1)},{extra:a,onError:o=OB}=e;ay(o);const c=w=>(w.unsubscribe=()=>t.delete(w.id),t.set(w.id,w),E=>{w.unsubscribe(),E!=null&&E.cancelActive&&Hx(w)}),f=w=>{const E=A3(t,w)??nk(w);return c(E)};vc(f,{withTypes:()=>f});const d=w=>{const E=A3(t,w);return E&&(E.unsubscribe(),w.cancelActive&&Hx(E)),!!E};vc(d,{withTypes:()=>d});const h=async(w,E,A,S)=>{const b=new AbortController,T=_B(f,b.signal),_=[];try{w.pending.add(b),n(w),await Promise.resolve(w.effect(E,vc({},A,{getOriginalState:S,condition:(N,M)=>T(N,M).then(Boolean),take:T,delay:tk(b.signal),pause:zh(b.signal),extra:a,signal:b.signal,fork:SB(b.signal,_),unsubscribe:w.unsubscribe,subscribe:()=>{t.set(w.id,w)},cancelActiveListeners:()=>{w.pending.forEach((N,M,R)=>{N!==b&&(N.abort(Vx),R.delete(N))})},cancel:()=>{b.abort(Vx),w.pending.delete(b)},throwIfCancelled:()=>{Qo(b.signal)}})))}catch(N){N instanceof hp||C3(o,N,{raisedBy:"effect"})}finally{await Promise.all(_),b.abort(AB),i(w),w.pending.delete(b)}},m=bB(t,r);return{middleware:w=>E=>A=>{if(!RO(A))return E(A);if(ik.match(A))return f(A.payload);if(TB.match(A)){m();return}if(ak.match(A))return d(A.payload);let S=w.getState();const b=()=>{if(S===E3)throw new Error(bi(23));return S};let T;try{if(T=E(A),t.size>0){const _=w.getState(),N=Array.from(t.values());for(const M of N){let R=!1;try{R=M.predicate(A,_,S)}catch(P){R=!1,C3(o,P,{raisedBy:"predicate"})}R&&h(M,A,w,b)}}}finally{S=E3}return T},startListening:f,stopListening:d,clearListeners:m}};function bi(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var kB={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},sk=hi({name:"chartLayout",initialState:kB,reducers:{setLayout(e,t){e.layoutType=t.payload},setChartSize(e,t){e.width=t.payload.width,e.height=t.payload.height},setMargin(e,t){var r,n,i,a;e.margin.top=(r=t.payload.top)!==null&&r!==void 0?r:0,e.margin.right=(n=t.payload.right)!==null&&n!==void 0?n:0,e.margin.bottom=(i=t.payload.bottom)!==null&&i!==void 0?i:0,e.margin.left=(a=t.payload.left)!==null&&a!==void 0?a:0},setScale(e,t){e.scale=t.payload}}}),{setMargin:IB,setLayout:NB,setChartSize:PB,setScale:DB}=sk.actions,RB=sk.reducer;function ok(e,t,r){return Array.isArray(e)&&e&&t+r!==0?e.slice(t,r+1):e}function St(e){return Number.isFinite(e)}function $a(e){return typeof e=="number"&&e>0&&Number.isFinite(e)}function S3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function cc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?S3(Object(r),!0).forEach(function(n){MB(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function MB(e,t,r){return(t=FB(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function FB(e){var t=LB(e,"string");return typeof t=="symbol"?t:t+""}function LB(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ar(e,t,r){return cn(e)||cn(t)?r:Ga(t)?ul(e,t,r):typeof t=="function"?t(e):r}var BB=(e,t,r)=>{if(t&&r){var{width:n,height:i}=r,{align:a,verticalAlign:o,layout:c}=t;if((c==="vertical"||c==="horizontal"&&o==="middle")&&a!=="center"&&qe(e[a]))return cc(cc({},e),{},{[a]:e[a]+(n||0)});if((c==="horizontal"||c==="vertical"&&a==="center")&&o!=="middle"&&qe(e[o]))return cc(cc({},e),{},{[o]:e[o]+(i||0)})}return e},_o=(e,t)=>e==="horizontal"&&t==="xAxis"||e==="vertical"&&t==="yAxis"||e==="centric"&&t==="angleAxis"||e==="radial"&&t==="radiusAxis",lk=(e,t,r,n)=>{if(n)return e.map(c=>c.coordinate);var i,a,o=e.map(c=>(c.coordinate===t&&(i=!0),c.coordinate===r&&(a=!0),c.coordinate));return i||o.push(t),a||o.push(r),o},ck=(e,t,r)=>{if(!e)return null;var{duplicateDomain:n,type:i,range:a,scale:o,realScaleType:c,isCategorical:f,categoricalDomain:d,tickCount:h,ticks:m,niceTicks:v,axisType:w}=e;if(!o)return null;var E=c==="scaleBand"&&o.bandwidth?o.bandwidth()/2:2,A=i==="category"&&o.bandwidth?o.bandwidth()/E:0;if(A=w==="angleAxis"&&a&&a.length>=2?sn(a[0]-a[1])*2*A:A,m||v){var S=(m||v||[]).map((b,T)=>{var _=n?n.indexOf(b):b,N=o.map(_);return St(N)?{coordinate:N+A,value:b,offset:A,index:T}:null}).filter(li);return S}return f&&d?d.map((b,T)=>{var _=o.map(b);return St(_)?{coordinate:_+A,value:b,index:T,offset:A}:null}).filter(li):o.ticks&&h!=null?o.ticks(h).map((b,T)=>{var _=o.map(b);return St(_)?{coordinate:_+A,value:b,index:T,offset:A}:null}).filter(li):o.domain().map((b,T)=>{var _=o.map(b);return St(_)?{coordinate:_+A,value:n?n[b]:b,index:T,offset:A}:null}).filter(li)},jB=(e,t)=>{if(!t||t.length!==2||!qe(t[0])||!qe(t[1]))return e;var r=Math.min(t[0],t[1]),n=Math.max(t[0],t[1]),i=[e[0],e[1]];return(!qe(e[0])||e[0]<r)&&(i[0]=r),(!qe(e[1])||e[1]>n)&&(i[1]=n),i[0]>n&&(i[0]=n),i[1]<r&&(i[1]=r),i},UB=e=>{var t,r=e.length;if(!(r<=0)){var n=(t=e[0])===null||t===void 0?void 0:t.length;if(!(n==null||n<=0))for(var i=0;i<n;++i)for(var a=0,o=0,c=0;c<r;++c){var f=e[c],d=f==null?void 0:f[i];if(d!=null){var h=d[1],m=d[0],v=Ha(h)?m:h;v>=0?(d[0]=a,a+=v,d[1]=a):(d[0]=o,o+=v,d[1]=o)}}}},zB=e=>{var t,r=e.length;if(!(r<=0)){var n=(t=e[0])===null||t===void 0?void 0:t.length;if(!(n==null||n<=0))for(var i=0;i<n;++i)for(var a=0,o=0;o<r;++o){var c=e[o],f=c==null?void 0:c[i];if(f!=null){var d=Ha(f[1])?f[0]:f[1];d>=0?(f[0]=a,a+=d,f[1]=a):(f[0]=0,f[1]=0)}}}},WB={sign:UB,expand:w9,none:cl,silhouette:E9,wiggle:A9,positive:zB},VB=(e,t,r)=>{var n,i=(n=WB[r])!==null&&n!==void 0?n:cl,a=y9().keys(t).value((c,f)=>Number(ar(c,f,0))).order(Dx).offset(i),o=a(e);return o.forEach((c,f)=>{c.forEach((d,h)=>{var m=ar(e[h],t[f],0);Array.isArray(m)&&m.length===2&&qe(m[0])&&qe(m[1])&&(d[0]=m[0],d[1]=m[1])})}),o};function HB(e){return e==null?void 0:String(e)}var _3=e=>{var{axis:t,ticks:r,offset:n,bandSize:i,entry:a,index:o}=e;if(t.type==="category")return r[o]?r[o].coordinate+n:null;var c=ar(a,t.dataKey,t.scale.domain()[o]);if(cn(c))return null;var f=t.scale.map(c);return qe(f)?f-i/2+n:null},GB=e=>{var{numericAxis:t}=e,r=t.scale.domain();if(t.type==="number"){var n=Math.min(r[0],r[1]),i=Math.max(r[0],r[1]);return n<=0&&i>=0?0:i<0?i:n}return r[0]},$B=e=>{var t=e.flat(2).filter(qe);return[Math.min(...t),Math.max(...t)]},XB=e=>[e[0]===1/0?0:e[0],e[1]===-1/0?0:e[1]],KB=(e,t,r)=>{if(e!=null)return XB(Object.keys(e).reduce((n,i)=>{var a=e[i];if(!a)return n;var{stackedData:o}=a,c=o.reduce((f,d)=>{var h=ok(d,t,r),m=$B(h);return!St(m[0])||!St(m[1])?f:[Math.min(f[0],m[0]),Math.max(f[1],m[1])]},[1/0,-1/0]);return[Math.min(c[0],n[0]),Math.max(c[1],n[1])]},[1/0,-1/0]))},b3=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,T3=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Wh=(e,t,r)=>{if(e&&e.scale&&e.scale.bandwidth){var n=e.scale.bandwidth();if(!r||n>0)return n}if(e&&t&&t.length>=2){for(var i=ap(t,h=>h.coordinate),a=1/0,o=1,c=i.length;o<c;o++){var f=i[o],d=i[o-1];a=Math.min(((f==null?void 0:f.coordinate)||0)-((d==null?void 0:d.coordinate)||0),a)}return a===1/0?0:a}return r?void 0:0};function O3(e){var{tooltipEntrySettings:t,dataKey:r,payload:n,value:i,name:a}=e;return cc(cc({},t),{},{dataKey:r,payload:n,value:i,name:a})}function gp(e,t){if(e)return String(e);if(typeof t=="string")return t}var YB=(e,t)=>{if(t==="horizontal")return e.chartX;if(t==="vertical")return e.chartY},ZB=(e,t)=>t==="centric"?e.angle:e.radius,Os=e=>e.layout.width,ks=e=>e.layout.height,qB=e=>e.layout.scale,uk=e=>e.layout.margin,mp=ve(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),xp=ve(e=>e.cartesianAxis.yAxis,e=>Object.values(e)),fk="data-recharts-item-index",dk="data-recharts-item-id",ff=60;function k3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function ud(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?k3(Object(r),!0).forEach(function(n){QB(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function QB(e,t,r){return(t=JB(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function JB(e){var t=ej(e,"string");return typeof t=="symbol"?t:t+""}function ej(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var tj=e=>e.brush.height;function rj(e){var t=xp(e);return t.reduce((r,n)=>{if(n.orientation==="left"&&!n.mirror&&!n.hide){var i=typeof n.width=="number"?n.width:ff;return r+i}return r},0)}function nj(e){var t=xp(e);return t.reduce((r,n)=>{if(n.orientation==="right"&&!n.mirror&&!n.hide){var i=typeof n.width=="number"?n.width:ff;return r+i}return r},0)}function ij(e){var t=mp(e);return t.reduce((r,n)=>n.orientation==="top"&&!n.mirror&&!n.hide?r+n.height:r,0)}function aj(e){var t=mp(e);return t.reduce((r,n)=>n.orientation==="bottom"&&!n.mirror&&!n.hide?r+n.height:r,0)}var Kr=ve([Os,ks,uk,tj,rj,nj,ij,aj,IO,NL],(e,t,r,n,i,a,o,c,f,d)=>{var h={left:(r.left||0)+i,right:(r.right||0)+a},m={top:(r.top||0)+o,bottom:(r.bottom||0)+c},v=ud(ud({},m),h),w=v.bottom;v.bottom+=n,v=BB(v,f,d);var E=e-v.left-v.right,A=t-v.top-v.bottom;return ud(ud({brushBottom:w},v),{},{width:Math.max(E,0),height:Math.max(A,0)})}),sj=ve(Kr,e=>({x:e.left,y:e.top,width:e.width,height:e.height})),sy=ve(Os,ks,(e,t)=>({x:0,y:0,width:e,height:t})),oj=I.createContext(null),pi=()=>I.useContext(oj)!=null,vp=e=>e.brush,yp=ve([vp,Kr,uk],(e,t,r)=>({height:e.height,x:qe(e.x)?e.x:t.left,y:qe(e.y)?e.y:t.top+t.height+t.brushBottom-((r==null?void 0:r.bottom)||0),width:qe(e.width)?e.width:t.width})),hk={},pk={},gk={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n,{signal:i,edges:a}={}){let o,c=null;const f=a!=null&&a.includes("leading"),d=a==null||a.includes("trailing"),h=()=>{c!==null&&(r.apply(o,c),o=void 0,c=null)},m=()=>{d&&h(),A()};let v=null;const w=()=>{v!=null&&clearTimeout(v),v=setTimeout(()=>{v=null,m()},n)},E=()=>{v!==null&&(clearTimeout(v),v=null)},A=()=>{E(),o=void 0,c=null},S=()=>{h()},b=function(...T){if(i!=null&&i.aborted)return;o=this,c=T;const _=v==null;w(),f&&_&&h()};return b.schedule=w,b.cancel=A,b.flush=S,i==null||i.addEventListener("abort",A,{once:!0}),b}e.debounce=t})(gk);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=gk;function r(n,i=0,a={}){typeof a!="object"&&(a={});const{leading:o=!1,trailing:c=!0,maxWait:f}=a,d=Array(2);o&&(d[0]="leading"),c&&(d[1]="trailing");let h,m=null;const v=t.debounce(function(...A){h=n.apply(this,A),m=null},i,{edges:d}),w=function(...A){return f!=null&&(m===null&&(m=Date.now()),Date.now()-m>=f)?(h=n.apply(this,A),m=Date.now(),v.cancel(),v.schedule(),h):(v.apply(this,A),h)},E=()=>(v.flush(),h);return w.cancel=v.cancel,w.flush=E,w}e.debounce=r})(pk);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=pk;function r(n,i=0,a={}){const{leading:o=!0,trailing:c=!0}=a;return t.debounce(n,i,{leading:o,maxWait:i,trailing:c})}e.throttle=r})(hk);var lj=hk.throttle;const cj=bs(lj);var Vh=function(t,r){for(var n=arguments.length,i=new Array(n>2?n-2:0),a=2;a<n;a++)i[a-2]=arguments[a];if(typeof console<"u"&&console.warn&&(r===void 0&&console.warn("LogUtils requires an error message argument"),!t))if(r===void 0)console.warn("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var o=0;console.warn(r.replace(/%s/g,()=>i[o++]))}},ja={width:"100%",height:"100%",debounce:0,minWidth:0,initialDimension:{width:-1,height:-1}},mk=(e,t,r)=>{var{width:n=ja.width,height:i=ja.height,aspect:a,maxHeight:o}=r,c=fl(n)?e:Number(n),f=fl(i)?t:Number(i);return a&&a>0&&(c?f=c/a:f&&(c=f*a),o&&f!=null&&f>o&&(f=o)),{calculatedWidth:c,calculatedHeight:f}},uj={width:0,height:0,overflow:"visible"},fj={width:0,overflowX:"visible"},dj={height:0,overflowY:"visible"},hj={},pj=e=>{var{width:t,height:r}=e,n=fl(t),i=fl(r);return n&&i?uj:n?fj:i?dj:hj};function gj(e){var{width:t,height:r,aspect:n}=e,i=t,a=r;return i===void 0&&a===void 0?(i=ja.width,a=ja.height):i===void 0?i=n&&n>0?void 0:ja.width:a===void 0&&(a=n&&n>0?void 0:ja.height),{width:i,height:a}}function Gx(){return Gx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Gx.apply(null,arguments)}function I3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function N3(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?I3(Object(r),!0).forEach(function(n){mj(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):I3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function mj(e,t,r){return(t=xj(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xj(e){var t=vj(e,"string");return typeof t=="symbol"?t:t+""}function vj(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var xk=I.createContext(ja.initialDimension);function yj(e){return $a(e.width)&&$a(e.height)}function vk(e){var{children:t,width:r,height:n}=e,i=I.useMemo(()=>({width:r,height:n}),[r,n]);return yj(i)?I.createElement(xk.Provider,{value:i},t):null}var oy=()=>I.useContext(xk),wj=I.forwardRef((e,t)=>{var{aspect:r,initialDimension:n=ja.initialDimension,width:i,height:a,minWidth:o=ja.minWidth,minHeight:c,maxHeight:f,children:d,debounce:h=ja.debounce,id:m,className:v,onResize:w,style:E={}}=e,A=I.useRef(null),S=I.useRef();S.current=w,I.useImperativeHandle(t,()=>A.current);var[b,T]=I.useState({containerWidth:n.width,containerHeight:n.height}),_=I.useCallback((z,B)=>{T(re=>{var ee=Math.round(z),V=Math.round(B);return re.containerWidth===ee&&re.containerHeight===V?re:{containerWidth:ee,containerHeight:V}})},[]);I.useEffect(()=>{if(A.current==null||typeof ResizeObserver>"u")return Gc;var z=V=>{var de,pe=V[0];if(pe!=null){var{width:K,height:Ce}=pe.contentRect;_(K,Ce),(de=S.current)===null||de===void 0||de.call(S,K,Ce)}};h>0&&(z=cj(z,h,{trailing:!0,leading:!1}));var B=new ResizeObserver(z),{width:re,height:ee}=A.current.getBoundingClientRect();return _(re,ee),B.observe(A.current),()=>{B.disconnect()}},[_,h]);var{containerWidth:N,containerHeight:M}=b;Vh(!r||r>0,"The aspect(%s) must be greater than zero.",r);var{calculatedWidth:R,calculatedHeight:P}=mk(N,M,{width:i,height:a,aspect:r,maxHeight:f});return Vh(R!=null&&R>0||P!=null&&P>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,R,P,i,a,o,c,r),I.createElement("div",{id:m?"".concat(m):void 0,className:Bt("recharts-responsive-container",v),style:N3(N3({},E),{},{width:i,height:a,minWidth:o,minHeight:c,maxHeight:f}),ref:A},I.createElement("div",{style:pj({width:i,height:a})},I.createElement(vk,{width:R,height:P},d)))}),P3=I.forwardRef((e,t)=>{var r=oy();if($a(r.width)&&$a(r.height))return e.children;var{width:n,height:i}=gj({width:e.width,height:e.height,aspect:e.aspect}),{calculatedWidth:a,calculatedHeight:o}=mk(void 0,void 0,{width:n,height:i,aspect:e.aspect,maxHeight:e.maxHeight});return qe(a)&&qe(o)?I.createElement(vk,{width:a,height:o},e.children):I.createElement(wj,Gx({},e,{width:n,height:i,ref:t}))});function ly(e){if(e)return{x:e.x,y:e.y,upperWidth:"upperWidth"in e?e.upperWidth:e.width,lowerWidth:"lowerWidth"in e?e.lowerWidth:e.width,width:e.width,height:e.height}}var wp=()=>{var e,t=pi(),r=Je(sj),n=Je(yp),i=(e=Je(vp))===null||e===void 0?void 0:e.padding;return!t||!n||!i?r:{width:n.width-i.left-i.right,height:n.height-i.top-i.bottom,x:i.left,y:i.top}},Ej={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},yk=()=>{var e;return(e=Je(Kr))!==null&&e!==void 0?e:Ej},cy=()=>Je(Os),uy=()=>Je(ks),Aj=()=>Je(e=>e.layout.margin),Dt=e=>e.layout.layoutType,$c=()=>Je(Dt),wk=()=>{var e=$c();if(e==="horizontal"||e==="vertical")return e},Ek=e=>{var t=e.layout.layoutType;if(t==="centric"||t==="radial")return t},Cj=()=>{var e=$c();return e!==void 0},df=e=>{var t=Qt(),r=pi(),{width:n,height:i}=e,a=oy(),o=n,c=i;return a&&(o=a.width>0?a.width:n,c=a.height>0?a.height:i),I.useEffect(()=>{!r&&$a(o)&&$a(c)&&t(PB({width:o,height:c}))},[t,r,o,c]),null},Ak=Symbol.for("immer-nothing"),D3=Symbol.for("immer-draftable"),Oi=Symbol.for("immer-state");function pa(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var D0=Object.getPrototypeOf;function Dc(e){return!!e&&!!e[Oi]}function hl(e){var t;return e?Ck(e)||Array.isArray(e)||!!e[D3]||!!((t=e.constructor)!=null&&t[D3])||hf(e)||Ap(e):!1}var Sj=Object.prototype.constructor.toString(),R3=new WeakMap;function Ck(e){if(!e||typeof e!="object")return!1;const t=Object.getPrototypeOf(e);if(t===null||t===Object.prototype)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;if(r===Object)return!0;if(typeof r!="function")return!1;let n=R3.get(r);return n===void 0&&(n=Function.toString.call(r),R3.set(r,n)),n===Sj}function Hh(e,t,r=!0){Ep(e)===0?(r?Reflect.ownKeys(e):Object.keys(e)).forEach(i=>{t(i,e[i],e)}):e.forEach((n,i)=>t(i,n,e))}function Ep(e){const t=e[Oi];return t?t.type_:Array.isArray(e)?1:hf(e)?2:Ap(e)?3:0}function $x(e,t){return Ep(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function Sk(e,t,r){const n=Ep(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r}function _j(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function hf(e){return e instanceof Map}function Ap(e){return e instanceof Set}function jo(e){return e.copy_||e.base_}function Xx(e,t){if(hf(e))return new Map(e);if(Ap(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=Ck(e);if(t===!0||t==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(e);delete n[Oi];let i=Reflect.ownKeys(n);for(let a=0;a<i.length;a++){const o=i[a],c=n[o];c.writable===!1&&(c.writable=!0,c.configurable=!0),(c.get||c.set)&&(n[o]={configurable:!0,writable:!0,enumerable:c.enumerable,value:e[o]})}return Object.create(D0(e),n)}else{const n=D0(e);if(n!==null&&r)return{...e};const i=Object.create(n);return Object.assign(i,e)}}function fy(e,t=!1){return Cp(e)||Dc(e)||!hl(e)||(Ep(e)>1&&Object.defineProperties(e,{set:fd,add:fd,clear:fd,delete:fd}),Object.freeze(e),t&&Object.values(e).forEach(r=>fy(r,!0))),e}function bj(){pa(2)}var fd={value:bj};function Cp(e){return e===null||typeof e!="object"?!0:Object.isFrozen(e)}var Tj={};function pl(e){const t=Tj[e];return t||pa(0,e),t}var R0;function _k(){return R0}function Oj(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function M3(e,t){t&&(pl("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function Kx(e){Yx(e),e.drafts_.forEach(kj),e.drafts_=null}function Yx(e){e===R0&&(R0=e.parent_)}function F3(e){return R0=Oj(R0,e)}function kj(e){const t=e[Oi];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function L3(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return e!==void 0&&e!==r?(r[Oi].modified_&&(Kx(t),pa(4)),hl(e)&&(e=Gh(t,e),t.parent_||$h(t,e)),t.patches_&&pl("Patches").generateReplacementPatches_(r[Oi].base_,e,t.patches_,t.inversePatches_)):e=Gh(t,r,[]),Kx(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==Ak?e:void 0}function Gh(e,t,r){if(Cp(t))return t;const n=e.immer_.shouldUseStrictIteration(),i=t[Oi];if(!i)return Hh(t,(a,o)=>B3(e,i,t,a,o,r),n),t;if(i.scope_!==e)return t;if(!i.modified_)return $h(e,i.base_,!0),i.base_;if(!i.finalized_){i.finalized_=!0,i.scope_.unfinalizedDrafts_--;const a=i.copy_;let o=a,c=!1;i.type_===3&&(o=new Set(a),a.clear(),c=!0),Hh(o,(f,d)=>B3(e,i,a,f,d,r,c),n),$h(e,a,!1),r&&e.patches_&&pl("Patches").generatePatches_(i,r,e.patches_,e.inversePatches_)}return i.copy_}function B3(e,t,r,n,i,a,o){if(i==null||typeof i!="object"&&!o)return;const c=Cp(i);if(!(c&&!o)){if(Dc(i)){const f=a&&t&&t.type_!==3&&!$x(t.assigned_,n)?a.concat(n):void 0,d=Gh(e,i,f);if(Sk(r,n,d),Dc(d))e.canAutoFreeze_=!1;else return}else o&&r.add(i);if(hl(i)&&!c){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1||t&&t.base_&&t.base_[n]===i&&c)return;Gh(e,i),(!t||!t.scope_.parent_)&&typeof n!="symbol"&&(hf(r)?r.has(n):Object.prototype.propertyIsEnumerable.call(r,n))&&$h(e,i)}}}function $h(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&fy(t,r)}function Ij(e,t){const r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:_k(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let i=n,a=dy;r&&(i=[n],a=M0);const{revoke:o,proxy:c}=Proxy.revocable(i,a);return n.draft_=c,n.revoke_=o,c}var dy={get(e,t){if(t===Oi)return e;const r=jo(e);if(!$x(r,t))return Nj(e,r,t);const n=r[t];return e.finalized_||!hl(n)?n:n===nm(e.base_,t)?(im(e),e.copy_[t]=qx(n,e)):n},has(e,t){return t in jo(e)},ownKeys(e){return Reflect.ownKeys(jo(e))},set(e,t,r){const n=bk(jo(e),t);if(n!=null&&n.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const i=nm(jo(e),t),a=i==null?void 0:i[Oi];if(a&&a.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(_j(r,i)&&(r!==void 0||$x(e.base_,t)))return!0;im(e),Zx(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return nm(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,im(e),Zx(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=jo(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty(){pa(11)},getPrototypeOf(e){return D0(e.base_)},setPrototypeOf(){pa(12)}},M0={};Hh(dy,(e,t)=>{M0[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});M0.deleteProperty=function(e,t){return M0.set.call(this,e,t,void 0)};M0.set=function(e,t,r){return dy.set.call(this,e[0],t,r,e[0])};function nm(e,t){const r=e[Oi];return(r?jo(r):e)[t]}function Nj(e,t,r){var i;const n=bk(t,r);return n?"value"in n?n.value:(i=n.get)==null?void 0:i.call(e.draft_):void 0}function bk(e,t){if(!(t in e))return;let r=D0(e);for(;r;){const n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=D0(r)}}function Zx(e){e.modified_||(e.modified_=!0,e.parent_&&Zx(e.parent_))}function im(e){e.copy_||(e.copy_=Xx(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var Pj=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(t,r,n)=>{if(typeof t=="function"&&typeof r!="function"){const a=r;r=t;const o=this;return function(f=a,...d){return o.produce(f,h=>r.call(this,h,...d))}}typeof r!="function"&&pa(6),n!==void 0&&typeof n!="function"&&pa(7);let i;if(hl(t)){const a=F3(this),o=qx(t,void 0);let c=!0;try{i=r(o),c=!1}finally{c?Kx(a):Yx(a)}return M3(a,n),L3(i,a)}else if(!t||typeof t!="object"){if(i=r(t),i===void 0&&(i=t),i===Ak&&(i=void 0),this.autoFreeze_&&fy(i,!0),n){const a=[],o=[];pl("Patches").generateReplacementPatches_(t,i,a,o),n(a,o)}return i}else pa(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(o,...c)=>this.produceWithPatches(o,f=>t(f,...c));let n,i;return[this.produce(t,r,(o,c)=>{n=o,i=c}),n,i]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy),typeof(e==null?void 0:e.useStrictIteration)=="boolean"&&this.setUseStrictIteration(e.useStrictIteration)}createDraft(e){hl(e)||pa(8),Dc(e)&&(e=Dj(e));const t=F3(this),r=qx(e,void 0);return r[Oi].isManual_=!0,Yx(t),r}finishDraft(e,t){const r=e&&e[Oi];(!r||!r.isManual_)&&pa(9);const{scope_:n}=r;return M3(n,t),L3(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}setUseStrictIteration(e){this.useStrictIteration_=e}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const i=t[r];if(i.path.length===0&&i.op==="replace"){e=i.value;break}}r>-1&&(t=t.slice(r+1));const n=pl("Patches").applyPatches_;return Dc(e)?n(e,t):this.produce(e,i=>n(i,t))}};function qx(e,t){const r=hf(e)?pl("MapSet").proxyMap_(e,t):Ap(e)?pl("MapSet").proxySet_(e,t):Ij(e,t);return(t?t.scope_:_k()).drafts_.push(r),r}function Dj(e){return Dc(e)||pa(10,e),Tk(e)}function Tk(e){if(!hl(e)||Cp(e))return e;const t=e[Oi];let r,n=!0;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=Xx(e,t.scope_.immer_.useStrictShallowCopy_),n=t.scope_.immer_.shouldUseStrictIteration()}else r=Xx(e,!0);return Hh(r,(i,a)=>{Sk(r,i,Tk(a))},n),t&&(t.finalized_=!1),r}var Rj=new Pj;Rj.produce;var Mj={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},Ok=hi({name:"legend",initialState:Mj,reducers:{setLegendSize(e,t){e.size.width=t.payload.width,e.size.height=t.payload.height},setLegendSettings(e,t){e.settings.align=t.payload.align,e.settings.layout=t.payload.layout,e.settings.verticalAlign=t.payload.verticalAlign,e.settings.itemSorter=t.payload.itemSorter},addLegendPayload:{reducer(e,t){e.payload.push(t.payload)},prepare:lr()},replaceLegendPayload:{reducer(e,t){var{prev:r,next:n}=t.payload,i=Ea(e).payload.indexOf(r);i>-1&&(e.payload[i]=n)},prepare:lr()},removeLegendPayload:{reducer(e,t){var r=Ea(e).payload.indexOf(t.payload);r>-1&&e.payload.splice(r,1)},prepare:lr()}}}),{setLegendSize:j3,setLegendSettings:Fj,addLegendPayload:kk,replaceLegendPayload:Ik,removeLegendPayload:Nk}=Ok.actions,Lj=Ok.reducer,Bj=["contextPayload"];function Qx(){return Qx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Qx.apply(null,arguments)}function U3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Rc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?U3(Object(r),!0).forEach(function(n){jj(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):U3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function jj(e,t,r){return(t=Uj(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Uj(e){var t=zj(e,"string");return typeof t=="symbol"?t:t+""}function zj(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Wj(e,t){if(e==null)return{};var r,n,i=Vj(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function Vj(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Hj(e){return e.value}function Gj(e){var{contextPayload:t}=e,r=Wj(e,Bj),n=yO(t,e.payloadUniqBy,Hj),i=Rc(Rc({},r),{},{payload:n});return I.isValidElement(e.content)?I.cloneElement(e.content,i):typeof e.content=="function"?I.createElement(e.content,i):I.createElement(Z9,i)}function $j(e,t,r,n,i,a){var{layout:o,align:c,verticalAlign:f}=t,d,h;return(!e||(e.left===void 0||e.left===null)&&(e.right===void 0||e.right===null))&&(c==="center"&&o==="vertical"?d={left:((n||0)-a.width)/2}:d=c==="right"?{right:r&&r.right||0}:{left:r&&r.left||0}),(!e||(e.top===void 0||e.top===null)&&(e.bottom===void 0||e.bottom===null))&&(f==="middle"?h={top:((i||0)-a.height)/2}:h=f==="bottom"?{bottom:r&&r.bottom||0}:{top:r&&r.top||0}),Rc(Rc({},d),h)}function Xj(e){var t=Qt();return I.useEffect(()=>{t(Fj(e))},[t,e]),null}function Kj(e){var t=Qt();return I.useEffect(()=>(t(j3(e)),()=>{t(j3({width:0,height:0}))}),[t,e]),null}function Yj(e,t,r,n){return e==="vertical"&&t!=null?{height:t}:e==="horizontal"?{width:r||n}:null}var Zj={align:"center",iconSize:14,inactiveColor:"#ccc",itemSorter:"value",layout:"horizontal",verticalAlign:"bottom"};function Pk(e){var t=un(e,Zj),r=RL(),n=VF(),i=Aj(),{width:a,height:o,wrapperStyle:c,portal:f}=t,[d,h]=NO([r]),m=cy(),v=uy();if(m==null||v==null)return null;var w=m-((i==null?void 0:i.left)||0)-((i==null?void 0:i.right)||0),E=Yj(t.layout,o,a,w),A=f?c:Rc(Rc({position:"absolute",width:(E==null?void 0:E.width)||a||"auto",height:(E==null?void 0:E.height)||o||"auto"},$j(c,t,i,m,v,d)),c),S=f??n;if(S==null||r==null)return null;var b=I.createElement("div",{className:"recharts-legend-wrapper",style:A,ref:h},I.createElement(Xj,{layout:t.layout,align:t.align,verticalAlign:t.verticalAlign,itemSorter:t.itemSorter}),!f&&I.createElement(Kj,{width:d.width,height:d.height}),I.createElement(Gj,Qx({},t,E,{margin:i,chartWidth:m,chartHeight:v,contextPayload:r})));return af.createPortal(b,S)}Pk.displayName="Legend";function Jx(){return Jx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Jx.apply(null,arguments)}function z3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function _u(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?z3(Object(r),!0).forEach(function(n){qj(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):z3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function qj(e,t,r){return(t=Qj(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Qj(e){var t=Jj(e,"string");return typeof t=="symbol"?t:t+""}function Jj(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function eU(e){return Array.isArray(e)&&Ga(e[0])&&Ga(e[1])?e.join(" ~ "):e}var Wl={separator:" : ",contentStyle:{margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},itemStyle:{display:"block",paddingTop:4,paddingBottom:4,color:"#000"},labelStyle:{},accessibilityLayer:!1},tU=e=>{var{separator:t=Wl.separator,contentStyle:r,itemStyle:n,labelStyle:i=Wl.labelStyle,payload:a,formatter:o,itemSorter:c,wrapperClassName:f,labelClassName:d,label:h,labelFormatter:m,accessibilityLayer:v=Wl.accessibilityLayer}=e,w=()=>{if(a&&a.length){var M={padding:0,margin:0},R=(c?ap(a,c):a).map((P,z)=>{if(P.type==="none")return null;var B=P.formatter||o||eU,{value:re,name:ee}=P,V=re,de=ee;if(B){var pe=B(re,ee,P,z,a);if(Array.isArray(pe))[V,de]=pe;else if(pe!=null)V=pe;else return null}var K=_u(_u({},Wl.itemStyle),{},{color:P.color||Wl.itemStyle.color},n);return I.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(z),style:K},Ga(de)?I.createElement("span",{className:"recharts-tooltip-item-name"},de):null,Ga(de)?I.createElement("span",{className:"recharts-tooltip-item-separator"},t):null,I.createElement("span",{className:"recharts-tooltip-item-value"},V),I.createElement("span",{className:"recharts-tooltip-item-unit"},P.unit||""))});return I.createElement("ul",{className:"recharts-tooltip-item-list",style:M},R)}return null},E=_u(_u({},Wl.contentStyle),r),A=_u({margin:0},i),S=!cn(h),b=S?h:"",T=Bt("recharts-default-tooltip",f),_=Bt("recharts-tooltip-label",d);S&&m&&a!==void 0&&a!==null&&(b=m(h,a));var N=v?{role:"status","aria-live":"assertive"}:{};return I.createElement("div",Jx({className:T,style:E},N),I.createElement("p",{className:_,style:A},I.isValidElement(b)?b:"".concat(b)),w())},bu="recharts-tooltip-wrapper",rU={visibility:"hidden"};function nU(e){var{coordinate:t,translateX:r,translateY:n}=e;return Bt(bu,{["".concat(bu,"-right")]:qe(r)&&t&&qe(t.x)&&r>=t.x,["".concat(bu,"-left")]:qe(r)&&t&&qe(t.x)&&r<t.x,["".concat(bu,"-bottom")]:qe(n)&&t&&qe(t.y)&&n>=t.y,["".concat(bu,"-top")]:qe(n)&&t&&qe(t.y)&&n<t.y})}function W3(e){var{allowEscapeViewBox:t,coordinate:r,key:n,offset:i,position:a,reverseDirection:o,tooltipDimension:c,viewBox:f,viewBoxDimension:d}=e;if(a&&qe(a[n]))return a[n];var h=r[n]-c-(i>0?i:0),m=r[n]+i;if(t[n])return o[n]?h:m;var v=f[n];if(v==null)return 0;if(o[n]){var w=h,E=v;return w<E?Math.max(m,v):Math.max(h,v)}if(d==null)return 0;var A=m+c,S=v+d;return A>S?Math.max(h,v):Math.max(m,v)}function iU(e){var{translateX:t,translateY:r,useTranslate3d:n}=e;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function aU(e){var{allowEscapeViewBox:t,coordinate:r,offsetTop:n,offsetLeft:i,position:a,reverseDirection:o,tooltipBox:c,useTranslate3d:f,viewBox:d}=e,h,m,v;return c.height>0&&c.width>0&&r?(m=W3({allowEscapeViewBox:t,coordinate:r,key:"x",offset:i,position:a,reverseDirection:o,tooltipDimension:c.width,viewBox:d,viewBoxDimension:d.width}),v=W3({allowEscapeViewBox:t,coordinate:r,key:"y",offset:n,position:a,reverseDirection:o,tooltipDimension:c.height,viewBox:d,viewBoxDimension:d.height}),h=iU({translateX:m,translateY:v,useTranslate3d:f})):h=rU,{cssProperties:h,cssClasses:nU({translateX:m,translateY:v,coordinate:r})}}function V3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function dd(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?V3(Object(r),!0).forEach(function(n){ev(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):V3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ev(e,t,r){return(t=sU(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function sU(e){var t=oU(e,"string");return typeof t=="symbol"?t:t+""}function oU(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class lU extends I.PureComponent{constructor(){super(...arguments),ev(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),ev(this,"handleKeyDown",t=>{if(t.key==="Escape"){var r,n,i,a;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(r=(n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==null&&r!==void 0?r:0,y:(i=(a=this.props.coordinate)===null||a===void 0?void 0:a.y)!==null&&i!==void 0?i:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var t,r;this.state.dismissed&&(((t=this.props.coordinate)===null||t===void 0?void 0:t.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:t,allowEscapeViewBox:r,animationDuration:n,animationEasing:i,children:a,coordinate:o,hasPayload:c,isAnimationActive:f,offset:d,position:h,reverseDirection:m,useTranslate3d:v,viewBox:w,wrapperStyle:E,lastBoundingBox:A,innerRef:S,hasPortalFromProps:b}=this.props,T=typeof d=="number"?d:d.x,_=typeof d=="number"?d:d.y,{cssClasses:N,cssProperties:M}=aU({allowEscapeViewBox:r,coordinate:o,offsetLeft:T,offsetTop:_,position:h,reverseDirection:m,tooltipBox:{height:A.height,width:A.width},useTranslate3d:v,viewBox:w}),R=b?{}:dd(dd({transition:f&&t?"transform ".concat(n,"ms ").concat(i):void 0},M),{},{pointerEvents:"none",visibility:!this.state.dismissed&&t&&c?"visible":"hidden",position:"absolute",top:0,left:0}),P=dd(dd({},R),{},{visibility:!this.state.dismissed&&t&&c?"visible":"hidden"},E);return I.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:N,style:P,ref:S},a)}}var Dk=()=>{var e;return(e=Je(t=>t.rootProps.accessibilityLayer))!==null&&e!==void 0?e:!0};function tv(){return tv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},tv.apply(null,arguments)}function H3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function G3(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?H3(Object(r),!0).forEach(function(n){cU(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):H3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function cU(e,t,r){return(t=uU(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function uU(e){var t=fU(e,"string");return typeof t=="symbol"?t:t+""}function fU(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var $3={curveBasisClosed:l9,curveBasisOpen:c9,curveBasis:o9,curveBumpX:XF,curveBumpY:KF,curveLinearClosed:u9,curveLinear:q1,curveMonotoneX:f9,curveMonotoneY:d9,curveNatural:h9,curveStep:p9,curveStepAfter:m9,curveStepBefore:g9},Xh=e=>St(e.x)&&St(e.y),X3=e=>e.base!=null&&Xh(e.base)&&Xh(e),Tu=e=>e.x,Ou=e=>e.y,dU=(e,t)=>{if(typeof e=="function")return e;var r="curve".concat(of(e));if((r==="curveMonotone"||r==="curveBump")&&t){var n=$3["".concat(r).concat(t==="vertical"?"Y":"X")];if(n)return n}return $3[r]||q1},K3={connectNulls:!1,type:"linear"},hU=e=>{var{type:t=K3.type,points:r=[],baseLine:n,layout:i,connectNulls:a=K3.connectNulls}=e,o=dU(t,i),c=a?r.filter(Xh):r;if(Array.isArray(n)){var f,d=r.map((E,A)=>G3(G3({},E),{},{base:n[A]}));i==="vertical"?f=id().y(Ou).x1(Tu).x0(E=>E.base.x):f=id().x(Tu).y1(Ou).y0(E=>E.base.y);var h=f.defined(X3).curve(o),m=a?d.filter(X3):d;return h(m)}var v;i==="vertical"&&qe(n)?v=id().y(Ou).x1(Tu).x0(n):qe(n)?v=id().x(Tu).y1(Ou).y0(n):v=j8().x(Tu).y(Ou);var w=v.defined(Xh).curve(o);return w(c)},hy=e=>{var{className:t,points:r,path:n,pathRef:i}=e,a=$c();if((!r||!r.length)&&!n)return null;var o={type:e.type,points:e.points,baseLine:e.baseLine,layout:e.layout||a,connectNulls:e.connectNulls},c=r&&r.length?hU(o):n;return I.createElement("path",tv({},Sa(e),L9(e),{className:Bt("recharts-curve",t),d:c===null?void 0:c,ref:i}))},pU=["x","y","top","left","width","height","className"];function rv(){return rv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},rv.apply(null,arguments)}function Y3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function gU(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Y3(Object(r),!0).forEach(function(n){mU(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Y3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function mU(e,t,r){return(t=xU(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xU(e){var t=vU(e,"string");return typeof t=="symbol"?t:t+""}function vU(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yU(e,t){if(e==null)return{};var r,n,i=wU(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function wU(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var EU=(e,t,r,n,i,a)=>"M".concat(e,",").concat(i,"v").concat(n,"M").concat(a,",").concat(t,"h").concat(r),AU=e=>{var{x:t=0,y:r=0,top:n=0,left:i=0,width:a=0,height:o=0,className:c}=e,f=yU(e,pU),d=gU({x:t,y:r,top:n,left:i,width:a,height:o},f);return!qe(t)||!qe(r)||!qe(a)||!qe(o)||!qe(n)||!qe(i)?null:I.createElement("path",rv({},Qi(d),{className:Bt("recharts-cross",c),d:EU(t,r,a,o,n,i)}))};function CU(e,t,r,n){var i=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-i:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-i,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}function Z3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function q3(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Z3(Object(r),!0).forEach(function(n){SU(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Z3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function SU(e,t,r){return(t=_U(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _U(e){var t=bU(e,"string");return typeof t=="symbol"?t:t+""}function bU(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var TU=e=>e.replace(/([A-Z])/g,t=>"-".concat(t.toLowerCase())),Rk=(e,t,r)=>e.map(n=>"".concat(TU(n)," ").concat(t,"ms ").concat(r)).join(","),OU=(e,t)=>[Object.keys(e),Object.keys(t)].reduce((r,n)=>r.filter(i=>n.includes(i))),F0=(e,t)=>Object.keys(t).reduce((r,n)=>q3(q3({},r),{},{[n]:e(n,t[n])}),{});function Q3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Hr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Q3(Object(r),!0).forEach(function(n){kU(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Q3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function kU(e,t,r){return(t=IU(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function IU(e){var t=NU(e,"string");return typeof t=="symbol"?t:t+""}function NU(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Kh=(e,t,r)=>e+(t-e)*r,nv=e=>{var{from:t,to:r}=e;return t!==r},Mk=(e,t,r)=>{var n=F0((i,a)=>{if(nv(a)){var[o,c]=e(a.from,a.to,a.velocity);return Hr(Hr({},a),{},{from:o,velocity:c})}return a},t);return r<1?F0((i,a)=>nv(a)&&n[i]!=null?Hr(Hr({},a),{},{velocity:Kh(a.velocity,n[i].velocity,r),from:Kh(a.from,n[i].from,r)}):a,t):Mk(e,n,r-1)};function PU(e,t,r,n,i,a){var o,c=n.reduce((v,w)=>Hr(Hr({},v),{},{[w]:{from:e[w],velocity:0,to:t[w]}}),{}),f=()=>F0((v,w)=>w.from,c),d=()=>!Object.values(c).filter(nv).length,h=null,m=v=>{o||(o=v);var w=v-o,E=w/r.dt;c=Mk(r,c,E),i(Hr(Hr(Hr({},e),t),f())),o=v,d()||(h=a.setTimeout(m))};return()=>(h=a.setTimeout(m),()=>{var v;(v=h)===null||v===void 0||v()})}function DU(e,t,r,n,i,a,o){var c=null,f=i.reduce((m,v)=>{var w=e[v],E=t[v];return w==null||E==null?m:Hr(Hr({},m),{},{[v]:[w,E]})},{}),d,h=m=>{d||(d=m);var v=(m-d)/n,w=F0((A,S)=>Kh(...S,r(v)),f);if(a(Hr(Hr(Hr({},e),t),w)),v<1)c=o.setTimeout(h);else{var E=F0((A,S)=>Kh(...S,r(1)),f);a(Hr(Hr(Hr({},e),t),E))}};return()=>(c=o.setTimeout(h),()=>{var m;(m=c)===null||m===void 0||m()})}const RU=(e,t,r,n,i,a)=>{var o=OU(e,t);return r==null?()=>(i(Hr(Hr({},e),t)),()=>{}):r.isStepper===!0?PU(e,t,r,o,i,a):DU(e,t,r,n,o,i,a)};var Yh=1e-4,Fk=(e,t)=>[0,3*e,3*t-6*e,3*e-3*t+1],Lk=(e,t)=>e.map((r,n)=>r*t**n).reduce((r,n)=>r+n),J3=(e,t)=>r=>{var n=Fk(e,t);return Lk(n,r)},MU=(e,t)=>r=>{var n=Fk(e,t),i=[...n.map((a,o)=>a*o).slice(1),0];return Lk(i,r)},FU=e=>{var t,r=e.split("(");if(r.length!==2||r[0]!=="cubic-bezier")return null;var n=(t=r[1])===null||t===void 0||(t=t.split(")")[0])===null||t===void 0?void 0:t.split(",");if(n==null||n.length!==4)return null;var i=n.map(a=>parseFloat(a));return[i[0],i[1],i[2],i[3]]},LU=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(r.length===1)switch(r[0]){case"linear":return[0,0,1,1];case"ease":return[.25,.1,.25,1];case"ease-in":return[.42,0,1,1];case"ease-out":return[.42,0,.58,1];case"ease-in-out":return[0,0,.58,1];default:{var i=FU(r[0]);if(i)return i}}return r.length===4?r:[0,0,1,1]},BU=(e,t,r,n)=>{var i=J3(e,r),a=J3(t,n),o=MU(e,r),c=d=>d>1?1:d<0?0:d,f=d=>{for(var h=d>1?1:d,m=h,v=0;v<8;++v){var w=i(m)-h,E=o(m);if(Math.abs(w-h)<Yh||E<Yh)return a(m);m=c(m-w/E)}return a(m)};return f.isStepper=!1,f},eC=function(){return BU(...LU(...arguments))},jU=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:r=100,damping:n=8,dt:i=17}=t,a=(o,c,f)=>{var d=-(o-c)*r,h=f*n,m=f+(d-h)*i/1e3,v=f*i/1e3+o;return Math.abs(v-c)<Yh&&Math.abs(m)<Yh?[c,0]:[v,m]};return a.isStepper=!0,a.dt=i,a},UU=e=>{if(typeof e=="string")switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return eC(e);case"spring":return jU();default:if(e.split("(")[0]==="cubic-bezier")return eC(e)}return typeof e=="function"?e:null};function zU(e){var t,r=()=>null,n=!1,i=null,a=o=>{if(!n){if(Array.isArray(o)){if(!o.length)return;var c=o,[f,...d]=c;if(typeof f=="number"){i=e.setTimeout(a.bind(null,d),f);return}a(f),i=e.setTimeout(a.bind(null,d));return}typeof o=="string"&&(t=o,r(t)),typeof o=="object"&&(t=o,r(t)),typeof o=="function"&&o()}};return{stop:()=>{n=!0},start:o=>{n=!1,i&&(i(),i=null),a(o)},subscribe:o=>(r=o,()=>{r=()=>null}),getTimeoutController:()=>e}}class WU{setTimeout(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=performance.now(),i=null,a=o=>{o-n>=r?t(o):typeof requestAnimationFrame=="function"&&(i=requestAnimationFrame(a))};return i=requestAnimationFrame(a),()=>{i!=null&&cancelAnimationFrame(i)}}}function VU(){return zU(new WU)}var HU=I.createContext(VU);function GU(e,t){var r=I.useContext(HU);return I.useMemo(()=>t??r(e),[e,t,r])}var $U=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),Sp={isSsr:$U()},XU={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},tC={t:0},am={t:1};function _p(e){var t=un(e,XU),{isActive:r,canBegin:n,duration:i,easing:a,begin:o,onAnimationEnd:c,onAnimationStart:f,children:d}=t,h=r==="auto"?!Sp.isSsr:r,m=GU(t.animationId,t.animationManager),[v,w]=I.useState(h?tC:am),E=I.useRef(null);return I.useEffect(()=>{h||w(am)},[h]),I.useEffect(()=>{if(!h||!n)return Gc;var A=RU(tC,am,UU(a),i,w,m.getTimeoutController()),S=()=>{E.current=A()};return m.start([f,o,S,i,c]),()=>{m.stop(),E.current&&E.current(),c()}},[h,n,i,a,o,f,c,m]),d(v.t)}function bp(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",r=I.useRef(k0(t)),n=I.useRef(e);return n.current!==e&&(r.current=k0(t),n.current=e),r.current}var KU=["radius"],YU=["radius"],rC,nC,iC,aC,sC,oC,lC,cC,uC,fC;function dC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function hC(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?dC(Object(r),!0).forEach(function(n){ZU(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ZU(e,t,r){return(t=qU(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qU(e){var t=QU(e,"string");return typeof t=="symbol"?t:t+""}function QU(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Zh(){return Zh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Zh.apply(null,arguments)}function pC(e,t){if(e==null)return{};var r,n,i=JU(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function JU(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Pa(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var gC=(e,t,r,n,i)=>{var a=ro(r),o=ro(n),c=Math.min(Math.abs(a)/2,Math.abs(o)/2),f=o>=0?1:-1,d=a>=0?1:-1,h=o>=0&&a>=0||o<0&&a<0?1:0,m;if(c>0&&Array.isArray(i)){for(var v=[0,0,0,0],w=0,E=4;w<E;w++){var A,S=(A=i[w])!==null&&A!==void 0?A:0;v[w]=S>c?c:S}m=Cr(rC||(rC=Pa(["M",",",""])),e,t+f*v[0]),v[0]>0&&(m+=Cr(nC||(nC=Pa(["A ",",",",0,0,",",",",",""])),v[0],v[0],h,e+d*v[0],t)),m+=Cr(iC||(iC=Pa(["L ",",",""])),e+r-d*v[1],t),v[1]>0&&(m+=Cr(aC||(aC=Pa(["A ",",",",0,0,",`,
        `,",",""])),v[1],v[1],h,e+r,t+f*v[1])),m+=Cr(sC||(sC=Pa(["L ",",",""])),e+r,t+n-f*v[2]),v[2]>0&&(m+=Cr(oC||(oC=Pa(["A ",",",",0,0,",`,
        `,",",""])),v[2],v[2],h,e+r-d*v[2],t+n)),m+=Cr(lC||(lC=Pa(["L ",",",""])),e+d*v[3],t+n),v[3]>0&&(m+=Cr(cC||(cC=Pa(["A ",",",",0,0,",`,
        `,",",""])),v[3],v[3],h,e,t+n-f*v[3])),m+="Z"}else if(c>0&&i===+i&&i>0){var b=Math.min(c,i);m=Cr(uC||(uC=Pa(["M ",",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",","," Z"])),e,t+f*b,b,b,h,e+d*b,t,e+r-d*b,t,b,b,h,e+r,t+f*b,e+r,t+n-f*b,b,b,h,e+r-d*b,t+n,e+d*b,t+n,b,b,h,e,t+n-f*b)}else m=Cr(fC||(fC=Pa(["M ",","," h "," v "," h "," Z"])),e,t,r,n,-r);return m},mC={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},Bk=e=>{var t=un(e,mC),r=I.useRef(null),[n,i]=I.useState(-1);I.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var ue=r.current.getTotalLength();ue&&i(ue)}catch{}},[]);var{x:a,y:o,width:c,height:f,radius:d,className:h}=t,{animationEasing:m,animationDuration:v,animationBegin:w,isAnimationActive:E,isUpdateAnimationActive:A}=t,S=I.useRef(c),b=I.useRef(f),T=I.useRef(a),_=I.useRef(o),N=I.useMemo(()=>({x:a,y:o,width:c,height:f,radius:d}),[a,o,c,f,d]),M=bp(N,"rectangle-");if(a!==+a||o!==+o||c!==+c||f!==+f||c===0||f===0)return null;var R=Bt("recharts-rectangle",h);if(!A){var P=Qi(t),{radius:z}=P,B=pC(P,KU);return I.createElement("path",Zh({},B,{x:ro(a),y:ro(o),width:ro(c),height:ro(f),radius:typeof d=="number"?d:void 0,className:R,d:gC(a,o,c,f,d)}))}var re=S.current,ee=b.current,V=T.current,de=_.current,pe="0px ".concat(n===-1?1:n,"px"),K="".concat(n,"px 0px"),Ce=Rk(["strokeDasharray"],v,typeof m=="string"?m:mC.animationEasing);return I.createElement(_p,{animationId:M,key:M,canBegin:n>0,duration:v,easing:m,isActive:A,begin:w},ue=>{var se=Vr(re,c,ue),q=Vr(ee,f,ue),fe=Vr(V,a,ue),we=Vr(de,o,ue);r.current&&(S.current=se,b.current=q,T.current=fe,_.current=we);var G;E?ue>0?G={transition:Ce,strokeDasharray:K}:G={strokeDasharray:pe}:G={strokeDasharray:K};var le=Qi(t),{radius:ne}=le,ae=pC(le,YU);return I.createElement("path",Zh({},ae,{radius:typeof d=="number"?d:void 0,className:R,d:gC(fe,we,se,q,d),ref:r,style:hC(hC({},G),t.style)}))})};function xC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function vC(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?xC(Object(r),!0).forEach(function(n){ez(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ez(e,t,r){return(t=tz(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tz(e){var t=rz(e,"string");return typeof t=="symbol"?t:t+""}function rz(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var qh=Math.PI/180,nz=e=>e*180/Math.PI,Fr=(e,t,r,n)=>({x:e+Math.cos(-qh*n)*r,y:t+Math.sin(-qh*n)*r}),jk=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},iz=(e,t)=>{var{x:r,y:n}=e,{x:i,y:a}=t;return Math.sqrt((r-i)**2+(n-a)**2)},az=(e,t)=>{var{x:r,y:n}=e,{cx:i,cy:a}=t,o=iz({x:r,y:n},{x:i,y:a});if(o<=0)return{radius:o,angle:0};var c=(r-i)/o,f=Math.acos(c);return n>a&&(f=2*Math.PI-f),{radius:o,angle:nz(f),angleInRadian:f}},sz=e=>{var{startAngle:t,endAngle:r}=e,n=Math.floor(t/360),i=Math.floor(r/360),a=Math.min(n,i);return{startAngle:t-a*360,endAngle:r-a*360}},oz=(e,t)=>{var{startAngle:r,endAngle:n}=t,i=Math.floor(r/360),a=Math.floor(n/360),o=Math.min(i,a);return e+o*360},lz=(e,t)=>{var{chartX:r,chartY:n}=e,{radius:i,angle:a}=az({x:r,y:n},t),{innerRadius:o,outerRadius:c}=t;if(i<o||i>c||i===0)return null;var{startAngle:f,endAngle:d}=sz(t),h=a,m;if(f<=d){for(;h>d;)h-=360;for(;h<f;)h+=360;m=h>=f&&h<=d}else{for(;h>f;)h-=360;for(;h<d;)h+=360;m=h>=d&&h<=f}return m?vC(vC({},t),{},{radius:i,angle:oz(h,t)}):null};function Uk(e){var{cx:t,cy:r,radius:n,startAngle:i,endAngle:a}=e,o=Fr(t,r,n,i),c=Fr(t,r,n,a);return{points:[o,c],cx:t,cy:r,radius:n,startAngle:i,endAngle:a}}var yC,wC,EC,AC,CC,SC,_C;function iv(){return iv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},iv.apply(null,arguments)}function Go(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var cz=(e,t)=>{var r=sn(t-e),n=Math.min(Math.abs(t-e),359.999);return r*n},hd=e=>{var{cx:t,cy:r,radius:n,angle:i,sign:a,isExternal:o,cornerRadius:c,cornerIsExternal:f}=e,d=c*(o?1:-1)+n,h=Math.asin(c/d)/qh,m=f?i:i+a*h,v=Fr(t,r,d,m),w=Fr(t,r,n,m),E=f?i-a*h:i,A=Fr(t,r,d*Math.cos(h*qh),E);return{center:v,circleTangency:w,lineTangency:A,theta:h}},zk=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:i,startAngle:a,endAngle:o}=e,c=cz(a,o),f=a+c,d=Fr(t,r,i,a),h=Fr(t,r,i,f),m=Cr(yC||(yC=Go(["M ",",",`
    A `,",",`,0,
    `,",",`,
    `,",",`
  `])),d.x,d.y,i,i,+(Math.abs(c)>180),+(a>f),h.x,h.y);if(n>0){var v=Fr(t,r,n,a),w=Fr(t,r,n,f);m+=Cr(wC||(wC=Go(["L ",",",`
            A `,",",`,0,
            `,",",`,
            `,","," Z"])),w.x,w.y,n,n,+(Math.abs(c)>180),+(a<=f),v.x,v.y)}else m+=Cr(EC||(EC=Go(["L ",","," Z"])),t,r);return m},uz=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:i,cornerRadius:a,forceCornerRadius:o,cornerIsExternal:c,startAngle:f,endAngle:d}=e,h=sn(d-f),{circleTangency:m,lineTangency:v,theta:w}=hd({cx:t,cy:r,radius:i,angle:f,sign:h,cornerRadius:a,cornerIsExternal:c}),{circleTangency:E,lineTangency:A,theta:S}=hd({cx:t,cy:r,radius:i,angle:d,sign:-h,cornerRadius:a,cornerIsExternal:c}),b=c?Math.abs(f-d):Math.abs(f-d)-w-S;if(b<0)return o?Cr(AC||(AC=Go(["M ",",",`
        a`,",",",0,0,1,",`,0
        a`,",",",0,0,1,",`,0
      `])),v.x,v.y,a,a,a*2,a,a,-a*2):zk({cx:t,cy:r,innerRadius:n,outerRadius:i,startAngle:f,endAngle:d});var T=Cr(CC||(CC=Go(["M ",",",`
    A`,",",",0,0,",",",",",`
    A`,",",",0,",",",",",",",`
    A`,",",",0,0,",",",",",`
  `])),v.x,v.y,a,a,+(h<0),m.x,m.y,i,i,+(b>180),+(h<0),E.x,E.y,a,a,+(h<0),A.x,A.y);if(n>0){var{circleTangency:_,lineTangency:N,theta:M}=hd({cx:t,cy:r,radius:n,angle:f,sign:h,isExternal:!0,cornerRadius:a,cornerIsExternal:c}),{circleTangency:R,lineTangency:P,theta:z}=hd({cx:t,cy:r,radius:n,angle:d,sign:-h,isExternal:!0,cornerRadius:a,cornerIsExternal:c}),B=c?Math.abs(f-d):Math.abs(f-d)-M-z;if(B<0&&a===0)return"".concat(T,"L").concat(t,",").concat(r,"Z");T+=Cr(SC||(SC=Go(["L",",",`
      A`,",",",0,0,",",",",",`
      A`,",",",0,",",",",",",",`
      A`,",",",0,0,",",",",","Z"])),P.x,P.y,a,a,+(h<0),R.x,R.y,n,n,+(B>180),+(h>0),_.x,_.y,a,a,+(h<0),N.x,N.y)}else T+=Cr(_C||(_C=Go(["L",",","Z"])),t,r);return T},fz={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},Wk=e=>{var t=un(e,fz),{cx:r,cy:n,innerRadius:i,outerRadius:a,cornerRadius:o,forceCornerRadius:c,cornerIsExternal:f,startAngle:d,endAngle:h,className:m}=t;if(a<i||d===h)return null;var v=Bt("recharts-sector",m),w=a-i,E=Fn(o,w,0,!0),A;return E>0&&Math.abs(d-h)<360?A=uz({cx:r,cy:n,innerRadius:i,outerRadius:a,cornerRadius:Math.min(E,w/2),forceCornerRadius:c,cornerIsExternal:f,startAngle:d,endAngle:h}):A=zk({cx:r,cy:n,innerRadius:i,outerRadius:a,startAngle:d,endAngle:h}),I.createElement("path",iv({},Qi(t),{className:v,d:A}))};function dz(e,t,r){if(e==="horizontal")return[{x:t.x,y:r.top},{x:t.x,y:r.top+r.height}];if(e==="vertical")return[{x:r.left,y:t.y},{x:r.left+r.width,y:t.y}];if(eO(t)){if(e==="centric"){var{cx:n,cy:i,innerRadius:a,outerRadius:o,angle:c}=t,f=Fr(n,i,a,c),d=Fr(n,i,o,c);return[{x:f.x,y:f.y},{x:d.x,y:d.y}]}return Uk(t)}}var Vk={},Hk={},Gk={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Q2;function r(n){return t.isSymbol(n)?NaN:Number(n)}e.toNumber=r})(Gk);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Gk;function r(n){return n?(n=t.toNumber(n),n===1/0||n===-1/0?(n<0?-1:1)*Number.MAX_VALUE:n===n?n:0):n===0?n:0}e.toFinite=r})(Hk);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=J2,r=Hk;function n(i,a,o){o&&typeof o!="number"&&t.isIterateeCall(i,a,o)&&(a=o=void 0),i=r.toFinite(i),a===void 0?(a=i,i=0):a=r.toFinite(a),o=o===void 0?i<a?1:-1:r.toFinite(o);const c=Math.max(Math.ceil((a-i)/(o||1)),0),f=new Array(c);for(let d=0;d<c;d++)f[d]=i,i+=o;return f}e.range=n})(Vk);var hz=Vk.range;const $k=bs(hz);function po(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function pz(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function py(e){let t,r,n;e.length!==2?(t=po,r=(c,f)=>po(e(c),f),n=(c,f)=>e(c)-f):(t=e===po||e===pz?e:gz,r=e,n=e);function i(c,f,d=0,h=c.length){if(d<h){if(t(f,f)!==0)return h;do{const m=d+h>>>1;r(c[m],f)<0?d=m+1:h=m}while(d<h)}return d}function a(c,f,d=0,h=c.length){if(d<h){if(t(f,f)!==0)return h;do{const m=d+h>>>1;r(c[m],f)<=0?d=m+1:h=m}while(d<h)}return d}function o(c,f,d=0,h=c.length){const m=i(c,f,d,h-1);return m>d&&n(c[m-1],f)>-n(c[m],f)?m-1:m}return{left:i,center:o,right:a}}function gz(){return 0}function Xk(e){return e===null?NaN:+e}function*mz(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const xz=py(po),pf=xz.right;py(Xk).center;class bC extends Map{constructor(t,r=wz){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,i]of t)this.set(n,i)}get(t){return super.get(TC(this,t))}has(t){return super.has(TC(this,t))}set(t,r){return super.set(vz(this,t),r)}delete(t){return super.delete(yz(this,t))}}function TC({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function vz({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function yz({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function wz(e){return e!==null&&typeof e=="object"?e.valueOf():e}function Ez(e=po){if(e===po)return Kk;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function Kk(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const Az=Math.sqrt(50),Cz=Math.sqrt(10),Sz=Math.sqrt(2);function Qh(e,t,r){const n=(t-e)/Math.max(0,r),i=Math.floor(Math.log10(n)),a=n/Math.pow(10,i),o=a>=Az?10:a>=Cz?5:a>=Sz?2:1;let c,f,d;return i<0?(d=Math.pow(10,-i)/o,c=Math.round(e*d),f=Math.round(t*d),c/d<e&&++c,f/d>t&&--f,d=-d):(d=Math.pow(10,i)*o,c=Math.round(e/d),f=Math.round(t/d),c*d<e&&++c,f*d>t&&--f),f<c&&.5<=r&&r<2?Qh(e,t,r*2):[c,f,d]}function av(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[i,a,o]=n?Qh(t,e,r):Qh(e,t,r);if(!(a>=i))return[];const c=a-i+1,f=new Array(c);if(n)if(o<0)for(let d=0;d<c;++d)f[d]=(a-d)/-o;else for(let d=0;d<c;++d)f[d]=(a-d)*o;else if(o<0)for(let d=0;d<c;++d)f[d]=(i+d)/-o;else for(let d=0;d<c;++d)f[d]=(i+d)*o;return f}function sv(e,t,r){return t=+t,e=+e,r=+r,Qh(e,t,r)[2]}function ov(e,t,r){t=+t,e=+e,r=+r;const n=t<e,i=n?sv(t,e,r):sv(e,t,r);return(n?-1:1)*(i<0?1/-i:i)}function OC(e,t){let r;for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function kC(e,t){let r;for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function Yk(e,t,r=0,n=1/0,i){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(i=i===void 0?Kk:Ez(i);n>r;){if(n-r>600){const f=n-r+1,d=t-r+1,h=Math.log(f),m=.5*Math.exp(2*h/3),v=.5*Math.sqrt(h*m*(f-m)/f)*(d-f/2<0?-1:1),w=Math.max(r,Math.floor(t-d*m/f+v)),E=Math.min(n,Math.floor(t+(f-d)*m/f+v));Yk(e,t,w,E,i)}const a=e[t];let o=r,c=n;for(ku(e,r,t),i(e[n],a)>0&&ku(e,r,n);o<c;){for(ku(e,o,c),++o,--c;i(e[o],a)<0;)++o;for(;i(e[c],a)>0;)--c}i(e[r],a)===0?ku(e,r,c):(++c,ku(e,c,n)),c<=t&&(r=c+1),t<=c&&(n=c-1)}return e}function ku(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function _z(e,t,r){if(e=Float64Array.from(mz(e)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return kC(e);if(t>=1)return OC(e);var n,i=(n-1)*t,a=Math.floor(i),o=OC(Yk(e,a).subarray(0,a+1)),c=kC(e.subarray(a+1));return o+(c-o)*(i-a)}}function bz(e,t,r=Xk){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,i=(n-1)*t,a=Math.floor(i),o=+r(e[a],a,e),c=+r(e[a+1],a+1,e);return o+(c-o)*(i-a)}}function Tz(e,t,r){e=+e,t=+t,r=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+r;for(var n=-1,i=Math.max(0,Math.ceil((t-e)/r))|0,a=new Array(i);++n<i;)a[n]=e+n*r;return a}function ra(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Is(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const lv=Symbol("implicit");function gy(){var e=new bC,t=[],r=[],n=lv;function i(a){let o=e.get(a);if(o===void 0){if(n!==lv)return n;e.set(a,o=t.push(a)-1)}return r[o%r.length]}return i.domain=function(a){if(!arguments.length)return t.slice();t=[],e=new bC;for(const o of a)e.has(o)||e.set(o,t.push(o)-1);return i},i.range=function(a){return arguments.length?(r=Array.from(a),i):r.slice()},i.unknown=function(a){return arguments.length?(n=a,i):n},i.copy=function(){return gy(t,r).unknown(n)},ra.apply(i,arguments),i}function my(){var e=gy().unknown(void 0),t=e.domain,r=e.range,n=0,i=1,a,o,c=!1,f=0,d=0,h=.5;delete e.unknown;function m(){var v=t().length,w=i<n,E=w?i:n,A=w?n:i;a=(A-E)/Math.max(1,v-f+d*2),c&&(a=Math.floor(a)),E+=(A-E-a*(v-f))*h,o=a*(1-f),c&&(E=Math.round(E),o=Math.round(o));var S=Tz(v).map(function(b){return E+a*b});return r(w?S.reverse():S)}return e.domain=function(v){return arguments.length?(t(v),m()):t()},e.range=function(v){return arguments.length?([n,i]=v,n=+n,i=+i,m()):[n,i]},e.rangeRound=function(v){return[n,i]=v,n=+n,i=+i,c=!0,m()},e.bandwidth=function(){return o},e.step=function(){return a},e.round=function(v){return arguments.length?(c=!!v,m()):c},e.padding=function(v){return arguments.length?(f=Math.min(1,d=+v),m()):f},e.paddingInner=function(v){return arguments.length?(f=Math.min(1,v),m()):f},e.paddingOuter=function(v){return arguments.length?(d=+v,m()):d},e.align=function(v){return arguments.length?(h=Math.max(0,Math.min(1,v)),m()):h},e.copy=function(){return my(t(),[n,i]).round(c).paddingInner(f).paddingOuter(d).align(h)},ra.apply(m(),arguments)}function Zk(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return Zk(t())},e}function Oz(){return Zk(my.apply(null,arguments).paddingInner(1))}function xy(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function qk(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function gf(){}var L0=.7,Jh=1/L0,yc="\\s*([+-]?\\d+)\\s*",B0="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Va="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",kz=/^#([0-9a-f]{3,8})$/,Iz=new RegExp(`^rgb\\(${yc},${yc},${yc}\\)$`),Nz=new RegExp(`^rgb\\(${Va},${Va},${Va}\\)$`),Pz=new RegExp(`^rgba\\(${yc},${yc},${yc},${B0}\\)$`),Dz=new RegExp(`^rgba\\(${Va},${Va},${Va},${B0}\\)$`),Rz=new RegExp(`^hsl\\(${B0},${Va},${Va}\\)$`),Mz=new RegExp(`^hsla\\(${B0},${Va},${Va},${B0}\\)$`),IC={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};xy(gf,j0,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:NC,formatHex:NC,formatHex8:Fz,formatHsl:Lz,formatRgb:PC,toString:PC});function NC(){return this.rgb().formatHex()}function Fz(){return this.rgb().formatHex8()}function Lz(){return Qk(this).formatHsl()}function PC(){return this.rgb().formatRgb()}function j0(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=kz.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?DC(t):r===3?new ci(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?pd(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?pd(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Iz.exec(e))?new ci(t[1],t[2],t[3],1):(t=Nz.exec(e))?new ci(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Pz.exec(e))?pd(t[1],t[2],t[3],t[4]):(t=Dz.exec(e))?pd(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Rz.exec(e))?FC(t[1],t[2]/100,t[3]/100,1):(t=Mz.exec(e))?FC(t[1],t[2]/100,t[3]/100,t[4]):IC.hasOwnProperty(e)?DC(IC[e]):e==="transparent"?new ci(NaN,NaN,NaN,0):null}function DC(e){return new ci(e>>16&255,e>>8&255,e&255,1)}function pd(e,t,r,n){return n<=0&&(e=t=r=NaN),new ci(e,t,r,n)}function Bz(e){return e instanceof gf||(e=j0(e)),e?(e=e.rgb(),new ci(e.r,e.g,e.b,e.opacity)):new ci}function cv(e,t,r,n){return arguments.length===1?Bz(e):new ci(e,t,r,n??1)}function ci(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}xy(ci,cv,qk(gf,{brighter(e){return e=e==null?Jh:Math.pow(Jh,e),new ci(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?L0:Math.pow(L0,e),new ci(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new ci(Jo(this.r),Jo(this.g),Jo(this.b),e1(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:RC,formatHex:RC,formatHex8:jz,formatRgb:MC,toString:MC}));function RC(){return`#${$o(this.r)}${$o(this.g)}${$o(this.b)}`}function jz(){return`#${$o(this.r)}${$o(this.g)}${$o(this.b)}${$o((isNaN(this.opacity)?1:this.opacity)*255)}`}function MC(){const e=e1(this.opacity);return`${e===1?"rgb(":"rgba("}${Jo(this.r)}, ${Jo(this.g)}, ${Jo(this.b)}${e===1?")":`, ${e})`}`}function e1(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Jo(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function $o(e){return e=Jo(e),(e<16?"0":"")+e.toString(16)}function FC(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new ga(e,t,r,n)}function Qk(e){if(e instanceof ga)return new ga(e.h,e.s,e.l,e.opacity);if(e instanceof gf||(e=j0(e)),!e)return new ga;if(e instanceof ga)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,i=Math.min(t,r,n),a=Math.max(t,r,n),o=NaN,c=a-i,f=(a+i)/2;return c?(t===a?o=(r-n)/c+(r<n)*6:r===a?o=(n-t)/c+2:o=(t-r)/c+4,c/=f<.5?a+i:2-a-i,o*=60):c=f>0&&f<1?0:o,new ga(o,c,f,e.opacity)}function Uz(e,t,r,n){return arguments.length===1?Qk(e):new ga(e,t,r,n??1)}function ga(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}xy(ga,Uz,qk(gf,{brighter(e){return e=e==null?Jh:Math.pow(Jh,e),new ga(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?L0:Math.pow(L0,e),new ga(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,i=2*r-n;return new ci(sm(e>=240?e-240:e+120,i,n),sm(e,i,n),sm(e<120?e+240:e-120,i,n),this.opacity)},clamp(){return new ga(LC(this.h),gd(this.s),gd(this.l),e1(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=e1(this.opacity);return`${e===1?"hsl(":"hsla("}${LC(this.h)}, ${gd(this.s)*100}%, ${gd(this.l)*100}%${e===1?")":`, ${e})`}`}}));function LC(e){return e=(e||0)%360,e<0?e+360:e}function gd(e){return Math.max(0,Math.min(1,e||0))}function sm(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const vy=e=>()=>e;function zz(e,t){return function(r){return e+r*t}}function Wz(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function Vz(e){return(e=+e)==1?Jk:function(t,r){return r-t?Wz(t,r,e):vy(isNaN(t)?r:t)}}function Jk(e,t){var r=t-e;return r?zz(e,r):vy(isNaN(e)?t:e)}const BC=function e(t){var r=Vz(t);function n(i,a){var o=r((i=cv(i)).r,(a=cv(a)).r),c=r(i.g,a.g),f=r(i.b,a.b),d=Jk(i.opacity,a.opacity);return function(h){return i.r=o(h),i.g=c(h),i.b=f(h),i.opacity=d(h),i+""}}return n.gamma=e,n}(1);function Hz(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),i;return function(a){for(i=0;i<r;++i)n[i]=e[i]*(1-a)+t[i]*a;return n}}function Gz(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function $z(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,i=new Array(n),a=new Array(r),o;for(o=0;o<n;++o)i[o]=Xc(e[o],t[o]);for(;o<r;++o)a[o]=t[o];return function(c){for(o=0;o<n;++o)a[o]=i[o](c);return a}}function Xz(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function t1(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function Kz(e,t){var r={},n={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?r[i]=Xc(e[i],t[i]):n[i]=t[i];return function(a){for(i in r)n[i]=r[i](a);return n}}var uv=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,om=new RegExp(uv.source,"g");function Yz(e){return function(){return e}}function Zz(e){return function(t){return e(t)+""}}function qz(e,t){var r=uv.lastIndex=om.lastIndex=0,n,i,a,o=-1,c=[],f=[];for(e=e+"",t=t+"";(n=uv.exec(e))&&(i=om.exec(t));)(a=i.index)>r&&(a=t.slice(r,a),c[o]?c[o]+=a:c[++o]=a),(n=n[0])===(i=i[0])?c[o]?c[o]+=i:c[++o]=i:(c[++o]=null,f.push({i:o,x:t1(n,i)})),r=om.lastIndex;return r<t.length&&(a=t.slice(r),c[o]?c[o]+=a:c[++o]=a),c.length<2?f[0]?Zz(f[0].x):Yz(t):(t=f.length,function(d){for(var h=0,m;h<t;++h)c[(m=f[h]).i]=m.x(d);return c.join("")})}function Xc(e,t){var r=typeof t,n;return t==null||r==="boolean"?vy(t):(r==="number"?t1:r==="string"?(n=j0(t))?(t=n,BC):qz:t instanceof j0?BC:t instanceof Date?Xz:Gz(t)?Hz:Array.isArray(t)?$z:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?Kz:t1)(e,t)}function yy(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function Qz(e,t){t===void 0&&(t=e,e=Xc);for(var r=0,n=t.length-1,i=t[0],a=new Array(n<0?0:n);r<n;)a[r]=e(i,i=t[++r]);return function(o){var c=Math.max(0,Math.min(n-1,Math.floor(o*=n)));return a[c](o-c)}}function Jz(e){return function(){return e}}function r1(e){return+e}var jC=[0,1];function Gn(e){return e}function fv(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:Jz(isNaN(t)?NaN:.5)}function eW(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function tW(e,t,r){var n=e[0],i=e[1],a=t[0],o=t[1];return i<n?(n=fv(i,n),a=r(o,a)):(n=fv(n,i),a=r(a,o)),function(c){return a(n(c))}}function rW(e,t,r){var n=Math.min(e.length,t.length)-1,i=new Array(n),a=new Array(n),o=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<n;)i[o]=fv(e[o],e[o+1]),a[o]=r(t[o],t[o+1]);return function(c){var f=pf(e,c,1,n)-1;return a[f](i[f](c))}}function mf(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function Tp(){var e=jC,t=jC,r=Xc,n,i,a,o=Gn,c,f,d;function h(){var v=Math.min(e.length,t.length);return o!==Gn&&(o=eW(e[0],e[v-1])),c=v>2?rW:tW,f=d=null,m}function m(v){return v==null||isNaN(v=+v)?a:(f||(f=c(e.map(n),t,r)))(n(o(v)))}return m.invert=function(v){return o(i((d||(d=c(t,e.map(n),t1)))(v)))},m.domain=function(v){return arguments.length?(e=Array.from(v,r1),h()):e.slice()},m.range=function(v){return arguments.length?(t=Array.from(v),h()):t.slice()},m.rangeRound=function(v){return t=Array.from(v),r=yy,h()},m.clamp=function(v){return arguments.length?(o=v?!0:Gn,h()):o!==Gn},m.interpolate=function(v){return arguments.length?(r=v,h()):r},m.unknown=function(v){return arguments.length?(a=v,m):a},function(v,w){return n=v,i=w,h()}}function wy(){return Tp()(Gn,Gn)}function nW(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function n1(e,t){if(!isFinite(e)||e===0)return null;var r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"),n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function Mc(e){return e=n1(Math.abs(e)),e?e[1]:NaN}function iW(e,t){return function(r,n){for(var i=r.length,a=[],o=0,c=e[0],f=0;i>0&&c>0&&(f+c+1>n&&(c=Math.max(1,n-f)),a.push(r.substring(i-=c,i+c)),!((f+=c+1)>n));)c=e[o=(o+1)%e.length];return a.reverse().join(t)}}function aW(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var sW=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function U0(e){if(!(t=sW.exec(e)))throw new Error("invalid format: "+e);var t;return new Ey({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}U0.prototype=Ey.prototype;function Ey(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}Ey.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function oW(e){e:for(var t=e.length,r=1,n=-1,i;r<t;++r)switch(e[r]){case".":n=i=r;break;case"0":n===0&&(n=r),i=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(i+1):e}var i1;function lW(e,t){var r=n1(e,t);if(!r)return i1=void 0,e.toPrecision(t);var n=r[0],i=r[1],a=i-(i1=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,o=n.length;return a===o?n:a>o?n+new Array(a-o+1).join("0"):a>0?n.slice(0,a)+"."+n.slice(a):"0."+new Array(1-a).join("0")+n1(e,Math.max(0,t+a-1))[0]}function UC(e,t){var r=n1(e,t);if(!r)return e+"";var n=r[0],i=r[1];return i<0?"0."+new Array(-i).join("0")+n:n.length>i+1?n.slice(0,i+1)+"."+n.slice(i+1):n+new Array(i-n.length+2).join("0")}const zC={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:nW,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>UC(e*100,t),r:UC,s:lW,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function WC(e){return e}var VC=Array.prototype.map,HC=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function cW(e){var t=e.grouping===void 0||e.thousands===void 0?WC:iW(VC.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",a=e.numerals===void 0?WC:aW(VC.call(e.numerals,String)),o=e.percent===void 0?"%":e.percent+"",c=e.minus===void 0?"":e.minus+"",f=e.nan===void 0?"NaN":e.nan+"";function d(m,v){m=U0(m);var w=m.fill,E=m.align,A=m.sign,S=m.symbol,b=m.zero,T=m.width,_=m.comma,N=m.precision,M=m.trim,R=m.type;R==="n"?(_=!0,R="g"):zC[R]||(N===void 0&&(N=12),M=!0,R="g"),(b||w==="0"&&E==="=")&&(b=!0,w="0",E="=");var P=(v&&v.prefix!==void 0?v.prefix:"")+(S==="$"?r:S==="#"&&/[boxX]/.test(R)?"0"+R.toLowerCase():""),z=(S==="$"?n:/[%p]/.test(R)?o:"")+(v&&v.suffix!==void 0?v.suffix:""),B=zC[R],re=/[defgprs%]/.test(R);N=N===void 0?6:/[gprs]/.test(R)?Math.max(1,Math.min(21,N)):Math.max(0,Math.min(20,N));function ee(V){var de=P,pe=z,K,Ce,ue;if(R==="c")pe=B(V)+pe,V="";else{V=+V;var se=V<0||1/V<0;if(V=isNaN(V)?f:B(Math.abs(V),N),M&&(V=oW(V)),se&&+V==0&&A!=="+"&&(se=!1),de=(se?A==="("?A:c:A==="-"||A==="("?"":A)+de,pe=(R==="s"&&!isNaN(V)&&i1!==void 0?HC[8+i1/3]:"")+pe+(se&&A==="("?")":""),re){for(K=-1,Ce=V.length;++K<Ce;)if(ue=V.charCodeAt(K),48>ue||ue>57){pe=(ue===46?i+V.slice(K+1):V.slice(K))+pe,V=V.slice(0,K);break}}}_&&!b&&(V=t(V,1/0));var q=de.length+V.length+pe.length,fe=q<T?new Array(T-q+1).join(w):"";switch(_&&b&&(V=t(fe+V,fe.length?T-pe.length:1/0),fe=""),E){case"<":V=de+V+pe+fe;break;case"=":V=de+fe+V+pe;break;case"^":V=fe.slice(0,q=fe.length>>1)+de+V+pe+fe.slice(q);break;default:V=fe+de+V+pe;break}return a(V)}return ee.toString=function(){return m+""},ee}function h(m,v){var w=Math.max(-8,Math.min(8,Math.floor(Mc(v)/3)))*3,E=Math.pow(10,-w),A=d((m=U0(m),m.type="f",m),{suffix:HC[8+w/3]});return function(S){return A(E*S)}}return{format:d,formatPrefix:h}}var md,Ay,eI;uW({thousands:",",grouping:[3],currency:["$",""]});function uW(e){return md=cW(e),Ay=md.format,eI=md.formatPrefix,md}function fW(e){return Math.max(0,-Mc(Math.abs(e)))}function dW(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Mc(t)/3)))*3-Mc(Math.abs(e)))}function hW(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Mc(t)-Mc(e))+1}function tI(e,t,r,n){var i=ov(e,t,r),a;switch(n=U0(n??",f"),n.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(a=dW(i,o))&&(n.precision=a),eI(n,o)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(a=hW(i,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=a-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(a=fW(i))&&(n.precision=a-(n.type==="%")*2);break}}return Ay(n)}function bo(e){var t=e.domain;return e.ticks=function(r){var n=t();return av(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var i=t();return tI(i[0],i[i.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),i=0,a=n.length-1,o=n[i],c=n[a],f,d,h=10;for(c<o&&(d=o,o=c,c=d,d=i,i=a,a=d);h-- >0;){if(d=sv(o,c,r),d===f)return n[i]=o,n[a]=c,t(n);if(d>0)o=Math.floor(o/d)*d,c=Math.ceil(c/d)*d;else if(d<0)o=Math.ceil(o*d)/d,c=Math.floor(c*d)/d;else break;f=d}return e},e}function rI(){var e=wy();return e.copy=function(){return mf(e,rI())},ra.apply(e,arguments),bo(e)}function nI(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,r1),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return nI(e).unknown(t)},e=arguments.length?Array.from(e,r1):[0,1],bo(r)}function iI(e,t){e=e.slice();var r=0,n=e.length-1,i=e[r],a=e[n],o;return a<i&&(o=r,r=n,n=o,o=i,i=a,a=o),e[r]=t.floor(i),e[n]=t.ceil(a),e}function GC(e){return Math.log(e)}function $C(e){return Math.exp(e)}function pW(e){return-Math.log(-e)}function gW(e){return-Math.exp(-e)}function mW(e){return isFinite(e)?+("1e"+e):e<0?0:e}function xW(e){return e===10?mW:e===Math.E?Math.exp:t=>Math.pow(e,t)}function vW(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function XC(e){return(t,r)=>-e(-t,r)}function Cy(e){const t=e(GC,$C),r=t.domain;let n=10,i,a;function o(){return i=vW(n),a=xW(n),r()[0]<0?(i=XC(i),a=XC(a),e(pW,gW)):e(GC,$C),t}return t.base=function(c){return arguments.length?(n=+c,o()):n},t.domain=function(c){return arguments.length?(r(c),o()):r()},t.ticks=c=>{const f=r();let d=f[0],h=f[f.length-1];const m=h<d;m&&([d,h]=[h,d]);let v=i(d),w=i(h),E,A;const S=c==null?10:+c;let b=[];if(!(n%1)&&w-v<S){if(v=Math.floor(v),w=Math.ceil(w),d>0){for(;v<=w;++v)for(E=1;E<n;++E)if(A=v<0?E/a(-v):E*a(v),!(A<d)){if(A>h)break;b.push(A)}}else for(;v<=w;++v)for(E=n-1;E>=1;--E)if(A=v>0?E/a(-v):E*a(v),!(A<d)){if(A>h)break;b.push(A)}b.length*2<S&&(b=av(d,h,S))}else b=av(v,w,Math.min(w-v,S)).map(a);return m?b.reverse():b},t.tickFormat=(c,f)=>{if(c==null&&(c=10),f==null&&(f=n===10?"s":","),typeof f!="function"&&(!(n%1)&&(f=U0(f)).precision==null&&(f.trim=!0),f=Ay(f)),c===1/0)return f;const d=Math.max(1,n*c/t.ticks().length);return h=>{let m=h/a(Math.round(i(h)));return m*n<n-.5&&(m*=n),m<=d?f(h):""}},t.nice=()=>r(iI(r(),{floor:c=>a(Math.floor(i(c))),ceil:c=>a(Math.ceil(i(c)))})),t}function aI(){const e=Cy(Tp()).domain([1,10]);return e.copy=()=>mf(e,aI()).base(e.base()),ra.apply(e,arguments),e}function KC(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function YC(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function Sy(e){var t=1,r=e(KC(t),YC(t));return r.constant=function(n){return arguments.length?e(KC(t=+n),YC(t)):t},bo(r)}function sI(){var e=Sy(Tp());return e.copy=function(){return mf(e,sI()).constant(e.constant())},ra.apply(e,arguments)}function ZC(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function yW(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function wW(e){return e<0?-e*e:e*e}function _y(e){var t=e(Gn,Gn),r=1;function n(){return r===1?e(Gn,Gn):r===.5?e(yW,wW):e(ZC(r),ZC(1/r))}return t.exponent=function(i){return arguments.length?(r=+i,n()):r},bo(t)}function by(){var e=_y(Tp());return e.copy=function(){return mf(e,by()).exponent(e.exponent())},ra.apply(e,arguments),e}function EW(){return by.apply(null,arguments).exponent(.5)}function qC(e){return Math.sign(e)*e*e}function AW(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function oI(){var e=wy(),t=[0,1],r=!1,n;function i(a){var o=AW(e(a));return isNaN(o)?n:r?Math.round(o):o}return i.invert=function(a){return e.invert(qC(a))},i.domain=function(a){return arguments.length?(e.domain(a),i):e.domain()},i.range=function(a){return arguments.length?(e.range((t=Array.from(a,r1)).map(qC)),i):t.slice()},i.rangeRound=function(a){return i.range(a).round(!0)},i.round=function(a){return arguments.length?(r=!!a,i):r},i.clamp=function(a){return arguments.length?(e.clamp(a),i):e.clamp()},i.unknown=function(a){return arguments.length?(n=a,i):n},i.copy=function(){return oI(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},ra.apply(i,arguments),bo(i)}function lI(){var e=[],t=[],r=[],n;function i(){var o=0,c=Math.max(1,t.length);for(r=new Array(c-1);++o<c;)r[o-1]=bz(e,o/c);return a}function a(o){return o==null||isNaN(o=+o)?n:t[pf(r,o)]}return a.invertExtent=function(o){var c=t.indexOf(o);return c<0?[NaN,NaN]:[c>0?r[c-1]:e[0],c<r.length?r[c]:e[e.length-1]]},a.domain=function(o){if(!arguments.length)return e.slice();e=[];for(let c of o)c!=null&&!isNaN(c=+c)&&e.push(c);return e.sort(po),i()},a.range=function(o){return arguments.length?(t=Array.from(o),i()):t.slice()},a.unknown=function(o){return arguments.length?(n=o,a):n},a.quantiles=function(){return r.slice()},a.copy=function(){return lI().domain(e).range(t).unknown(n)},ra.apply(a,arguments)}function cI(){var e=0,t=1,r=1,n=[.5],i=[0,1],a;function o(f){return f!=null&&f<=f?i[pf(n,f,0,r)]:a}function c(){var f=-1;for(n=new Array(r);++f<r;)n[f]=((f+1)*t-(f-r)*e)/(r+1);return o}return o.domain=function(f){return arguments.length?([e,t]=f,e=+e,t=+t,c()):[e,t]},o.range=function(f){return arguments.length?(r=(i=Array.from(f)).length-1,c()):i.slice()},o.invertExtent=function(f){var d=i.indexOf(f);return d<0?[NaN,NaN]:d<1?[e,n[0]]:d>=r?[n[r-1],t]:[n[d-1],n[d]]},o.unknown=function(f){return arguments.length&&(a=f),o},o.thresholds=function(){return n.slice()},o.copy=function(){return cI().domain([e,t]).range(i).unknown(a)},ra.apply(bo(o),arguments)}function uI(){var e=[.5],t=[0,1],r,n=1;function i(a){return a!=null&&a<=a?t[pf(e,a,0,n)]:r}return i.domain=function(a){return arguments.length?(e=Array.from(a),n=Math.min(e.length,t.length-1),i):e.slice()},i.range=function(a){return arguments.length?(t=Array.from(a),n=Math.min(e.length,t.length-1),i):t.slice()},i.invertExtent=function(a){var o=t.indexOf(a);return[e[o-1],e[o]]},i.unknown=function(a){return arguments.length?(r=a,i):r},i.copy=function(){return uI().domain(e).range(t).unknown(r)},ra.apply(i,arguments)}const lm=new Date,cm=new Date;function Yr(e,t,r,n){function i(a){return e(a=arguments.length===0?new Date:new Date(+a)),a}return i.floor=a=>(e(a=new Date(+a)),a),i.ceil=a=>(e(a=new Date(a-1)),t(a,1),e(a),a),i.round=a=>{const o=i(a),c=i.ceil(a);return a-o<c-a?o:c},i.offset=(a,o)=>(t(a=new Date(+a),o==null?1:Math.floor(o)),a),i.range=(a,o,c)=>{const f=[];if(a=i.ceil(a),c=c==null?1:Math.floor(c),!(a<o)||!(c>0))return f;let d;do f.push(d=new Date(+a)),t(a,c),e(a);while(d<a&&a<o);return f},i.filter=a=>Yr(o=>{if(o>=o)for(;e(o),!a(o);)o.setTime(o-1)},(o,c)=>{if(o>=o)if(c<0)for(;++c<=0;)for(;t(o,-1),!a(o););else for(;--c>=0;)for(;t(o,1),!a(o););}),r&&(i.count=(a,o)=>(lm.setTime(+a),cm.setTime(+o),e(lm),e(cm),Math.floor(r(lm,cm))),i.every=a=>(a=Math.floor(a),!isFinite(a)||!(a>0)?null:a>1?i.filter(n?o=>n(o)%a===0:o=>i.count(0,o)%a===0):i)),i}const a1=Yr(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);a1.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Yr(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):a1);a1.range;const ss=1e3,Ki=ss*60,os=Ki*60,ys=os*24,Ty=ys*7,QC=ys*30,um=ys*365,Xo=Yr(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*ss)},(e,t)=>(t-e)/ss,e=>e.getUTCSeconds());Xo.range;const Oy=Yr(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*ss)},(e,t)=>{e.setTime(+e+t*Ki)},(e,t)=>(t-e)/Ki,e=>e.getMinutes());Oy.range;const ky=Yr(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Ki)},(e,t)=>(t-e)/Ki,e=>e.getUTCMinutes());ky.range;const Iy=Yr(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*ss-e.getMinutes()*Ki)},(e,t)=>{e.setTime(+e+t*os)},(e,t)=>(t-e)/os,e=>e.getHours());Iy.range;const Ny=Yr(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*os)},(e,t)=>(t-e)/os,e=>e.getUTCHours());Ny.range;const xf=Yr(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Ki)/ys,e=>e.getDate()-1);xf.range;const Op=Yr(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/ys,e=>e.getUTCDate()-1);Op.range;const fI=Yr(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/ys,e=>Math.floor(e/ys));fI.range;function Sl(e){return Yr(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*Ki)/Ty)}const kp=Sl(0),s1=Sl(1),CW=Sl(2),SW=Sl(3),Fc=Sl(4),_W=Sl(5),bW=Sl(6);kp.range;s1.range;CW.range;SW.range;Fc.range;_W.range;bW.range;function _l(e){return Yr(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/Ty)}const Ip=_l(0),o1=_l(1),TW=_l(2),OW=_l(3),Lc=_l(4),kW=_l(5),IW=_l(6);Ip.range;o1.range;TW.range;OW.range;Lc.range;kW.range;IW.range;const Py=Yr(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());Py.range;const Dy=Yr(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());Dy.range;const ws=Yr(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());ws.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Yr(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});ws.range;const Es=Yr(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Es.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Yr(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});Es.range;function dI(e,t,r,n,i,a){const o=[[Xo,1,ss],[Xo,5,5*ss],[Xo,15,15*ss],[Xo,30,30*ss],[a,1,Ki],[a,5,5*Ki],[a,15,15*Ki],[a,30,30*Ki],[i,1,os],[i,3,3*os],[i,6,6*os],[i,12,12*os],[n,1,ys],[n,2,2*ys],[r,1,Ty],[t,1,QC],[t,3,3*QC],[e,1,um]];function c(d,h,m){const v=h<d;v&&([d,h]=[h,d]);const w=m&&typeof m.range=="function"?m:f(d,h,m),E=w?w.range(d,+h+1):[];return v?E.reverse():E}function f(d,h,m){const v=Math.abs(h-d)/m,w=py(([,,S])=>S).right(o,v);if(w===o.length)return e.every(ov(d/um,h/um,m));if(w===0)return a1.every(Math.max(ov(d,h,m),1));const[E,A]=o[v/o[w-1][2]<o[w][2]/v?w-1:w];return E.every(A)}return[c,f]}const[NW,PW]=dI(Es,Dy,Ip,fI,Ny,ky),[DW,RW]=dI(ws,Py,kp,xf,Iy,Oy);function fm(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function dm(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Iu(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function MW(e){var t=e.dateTime,r=e.date,n=e.time,i=e.periods,a=e.days,o=e.shortDays,c=e.months,f=e.shortMonths,d=Nu(i),h=Pu(i),m=Nu(a),v=Pu(a),w=Nu(o),E=Pu(o),A=Nu(c),S=Pu(c),b=Nu(f),T=Pu(f),_={a:ue,A:se,b:q,B:fe,c:null,d:iS,e:iS,f:iV,g:pV,G:mV,H:tV,I:rV,j:nV,L:hI,m:aV,M:sV,p:we,q:G,Q:oS,s:lS,S:oV,u:lV,U:cV,V:uV,w:fV,W:dV,x:null,X:null,y:hV,Y:gV,Z:xV,"%":sS},N={a:le,A:ne,b:ae,B:he,c:null,d:aS,e:aS,f:EV,g:NV,G:DV,H:vV,I:yV,j:wV,L:gI,m:AV,M:CV,p:ke,q:De,Q:oS,s:lS,S:SV,u:_V,U:bV,V:TV,w:OV,W:kV,x:null,X:null,y:IV,Y:PV,Z:RV,"%":sS},M={a:re,A:ee,b:V,B:de,c:pe,d:rS,e:rS,f:qW,g:tS,G:eS,H:nS,I:nS,j:XW,L:ZW,m:$W,M:KW,p:B,q:GW,Q:JW,s:eV,S:YW,u:UW,U:zW,V:WW,w:jW,W:VW,x:K,X:Ce,y:tS,Y:eS,Z:HW,"%":QW};_.x=R(r,_),_.X=R(n,_),_.c=R(t,_),N.x=R(r,N),N.X=R(n,N),N.c=R(t,N);function R(ce,be){return function(ze){var W=[],He=-1,Ge=0,et=ce.length,Ze,Ie,rt;for(ze instanceof Date||(ze=new Date(+ze));++He<et;)ce.charCodeAt(He)===37&&(W.push(ce.slice(Ge,He)),(Ie=JC[Ze=ce.charAt(++He)])!=null?Ze=ce.charAt(++He):Ie=Ze==="e"?" ":"0",(rt=be[Ze])&&(Ze=rt(ze,Ie)),W.push(Ze),Ge=He+1);return W.push(ce.slice(Ge,He)),W.join("")}}function P(ce,be){return function(ze){var W=Iu(1900,void 0,1),He=z(W,ce,ze+="",0),Ge,et;if(He!=ze.length)return null;if("Q"in W)return new Date(W.Q);if("s"in W)return new Date(W.s*1e3+("L"in W?W.L:0));if(be&&!("Z"in W)&&(W.Z=0),"p"in W&&(W.H=W.H%12+W.p*12),W.m===void 0&&(W.m="q"in W?W.q:0),"V"in W){if(W.V<1||W.V>53)return null;"w"in W||(W.w=1),"Z"in W?(Ge=dm(Iu(W.y,0,1)),et=Ge.getUTCDay(),Ge=et>4||et===0?o1.ceil(Ge):o1(Ge),Ge=Op.offset(Ge,(W.V-1)*7),W.y=Ge.getUTCFullYear(),W.m=Ge.getUTCMonth(),W.d=Ge.getUTCDate()+(W.w+6)%7):(Ge=fm(Iu(W.y,0,1)),et=Ge.getDay(),Ge=et>4||et===0?s1.ceil(Ge):s1(Ge),Ge=xf.offset(Ge,(W.V-1)*7),W.y=Ge.getFullYear(),W.m=Ge.getMonth(),W.d=Ge.getDate()+(W.w+6)%7)}else("W"in W||"U"in W)&&("w"in W||(W.w="u"in W?W.u%7:"W"in W?1:0),et="Z"in W?dm(Iu(W.y,0,1)).getUTCDay():fm(Iu(W.y,0,1)).getDay(),W.m=0,W.d="W"in W?(W.w+6)%7+W.W*7-(et+5)%7:W.w+W.U*7-(et+6)%7);return"Z"in W?(W.H+=W.Z/100|0,W.M+=W.Z%100,dm(W)):fm(W)}}function z(ce,be,ze,W){for(var He=0,Ge=be.length,et=ze.length,Ze,Ie;He<Ge;){if(W>=et)return-1;if(Ze=be.charCodeAt(He++),Ze===37){if(Ze=be.charAt(He++),Ie=M[Ze in JC?be.charAt(He++):Ze],!Ie||(W=Ie(ce,ze,W))<0)return-1}else if(Ze!=ze.charCodeAt(W++))return-1}return W}function B(ce,be,ze){var W=d.exec(be.slice(ze));return W?(ce.p=h.get(W[0].toLowerCase()),ze+W[0].length):-1}function re(ce,be,ze){var W=w.exec(be.slice(ze));return W?(ce.w=E.get(W[0].toLowerCase()),ze+W[0].length):-1}function ee(ce,be,ze){var W=m.exec(be.slice(ze));return W?(ce.w=v.get(W[0].toLowerCase()),ze+W[0].length):-1}function V(ce,be,ze){var W=b.exec(be.slice(ze));return W?(ce.m=T.get(W[0].toLowerCase()),ze+W[0].length):-1}function de(ce,be,ze){var W=A.exec(be.slice(ze));return W?(ce.m=S.get(W[0].toLowerCase()),ze+W[0].length):-1}function pe(ce,be,ze){return z(ce,t,be,ze)}function K(ce,be,ze){return z(ce,r,be,ze)}function Ce(ce,be,ze){return z(ce,n,be,ze)}function ue(ce){return o[ce.getDay()]}function se(ce){return a[ce.getDay()]}function q(ce){return f[ce.getMonth()]}function fe(ce){return c[ce.getMonth()]}function we(ce){return i[+(ce.getHours()>=12)]}function G(ce){return 1+~~(ce.getMonth()/3)}function le(ce){return o[ce.getUTCDay()]}function ne(ce){return a[ce.getUTCDay()]}function ae(ce){return f[ce.getUTCMonth()]}function he(ce){return c[ce.getUTCMonth()]}function ke(ce){return i[+(ce.getUTCHours()>=12)]}function De(ce){return 1+~~(ce.getUTCMonth()/3)}return{format:function(ce){var be=R(ce+="",_);return be.toString=function(){return ce},be},parse:function(ce){var be=P(ce+="",!1);return be.toString=function(){return ce},be},utcFormat:function(ce){var be=R(ce+="",N);return be.toString=function(){return ce},be},utcParse:function(ce){var be=P(ce+="",!0);return be.toString=function(){return ce},be}}}var JC={"-":"",_:" ",0:"0"},fn=/^\s*\d+/,FW=/^%/,LW=/[\\^$*+?|[\]().{}]/g;function Pt(e,t,r){var n=e<0?"-":"",i=(n?-e:e)+"",a=i.length;return n+(a<r?new Array(r-a+1).join(t)+i:i)}function BW(e){return e.replace(LW,"\\$&")}function Nu(e){return new RegExp("^(?:"+e.map(BW).join("|")+")","i")}function Pu(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function jW(e,t,r){var n=fn.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function UW(e,t,r){var n=fn.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function zW(e,t,r){var n=fn.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function WW(e,t,r){var n=fn.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function VW(e,t,r){var n=fn.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function eS(e,t,r){var n=fn.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function tS(e,t,r){var n=fn.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function HW(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function GW(e,t,r){var n=fn.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function $W(e,t,r){var n=fn.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function rS(e,t,r){var n=fn.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function XW(e,t,r){var n=fn.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function nS(e,t,r){var n=fn.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function KW(e,t,r){var n=fn.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function YW(e,t,r){var n=fn.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function ZW(e,t,r){var n=fn.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function qW(e,t,r){var n=fn.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function QW(e,t,r){var n=FW.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function JW(e,t,r){var n=fn.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function eV(e,t,r){var n=fn.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function iS(e,t){return Pt(e.getDate(),t,2)}function tV(e,t){return Pt(e.getHours(),t,2)}function rV(e,t){return Pt(e.getHours()%12||12,t,2)}function nV(e,t){return Pt(1+xf.count(ws(e),e),t,3)}function hI(e,t){return Pt(e.getMilliseconds(),t,3)}function iV(e,t){return hI(e,t)+"000"}function aV(e,t){return Pt(e.getMonth()+1,t,2)}function sV(e,t){return Pt(e.getMinutes(),t,2)}function oV(e,t){return Pt(e.getSeconds(),t,2)}function lV(e){var t=e.getDay();return t===0?7:t}function cV(e,t){return Pt(kp.count(ws(e)-1,e),t,2)}function pI(e){var t=e.getDay();return t>=4||t===0?Fc(e):Fc.ceil(e)}function uV(e,t){return e=pI(e),Pt(Fc.count(ws(e),e)+(ws(e).getDay()===4),t,2)}function fV(e){return e.getDay()}function dV(e,t){return Pt(s1.count(ws(e)-1,e),t,2)}function hV(e,t){return Pt(e.getFullYear()%100,t,2)}function pV(e,t){return e=pI(e),Pt(e.getFullYear()%100,t,2)}function gV(e,t){return Pt(e.getFullYear()%1e4,t,4)}function mV(e,t){var r=e.getDay();return e=r>=4||r===0?Fc(e):Fc.ceil(e),Pt(e.getFullYear()%1e4,t,4)}function xV(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Pt(t/60|0,"0",2)+Pt(t%60,"0",2)}function aS(e,t){return Pt(e.getUTCDate(),t,2)}function vV(e,t){return Pt(e.getUTCHours(),t,2)}function yV(e,t){return Pt(e.getUTCHours()%12||12,t,2)}function wV(e,t){return Pt(1+Op.count(Es(e),e),t,3)}function gI(e,t){return Pt(e.getUTCMilliseconds(),t,3)}function EV(e,t){return gI(e,t)+"000"}function AV(e,t){return Pt(e.getUTCMonth()+1,t,2)}function CV(e,t){return Pt(e.getUTCMinutes(),t,2)}function SV(e,t){return Pt(e.getUTCSeconds(),t,2)}function _V(e){var t=e.getUTCDay();return t===0?7:t}function bV(e,t){return Pt(Ip.count(Es(e)-1,e),t,2)}function mI(e){var t=e.getUTCDay();return t>=4||t===0?Lc(e):Lc.ceil(e)}function TV(e,t){return e=mI(e),Pt(Lc.count(Es(e),e)+(Es(e).getUTCDay()===4),t,2)}function OV(e){return e.getUTCDay()}function kV(e,t){return Pt(o1.count(Es(e)-1,e),t,2)}function IV(e,t){return Pt(e.getUTCFullYear()%100,t,2)}function NV(e,t){return e=mI(e),Pt(e.getUTCFullYear()%100,t,2)}function PV(e,t){return Pt(e.getUTCFullYear()%1e4,t,4)}function DV(e,t){var r=e.getUTCDay();return e=r>=4||r===0?Lc(e):Lc.ceil(e),Pt(e.getUTCFullYear()%1e4,t,4)}function RV(){return"+0000"}function sS(){return"%"}function oS(e){return+e}function lS(e){return Math.floor(+e/1e3)}var Vl,xI,vI;MV({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function MV(e){return Vl=MW(e),xI=Vl.format,Vl.parse,vI=Vl.utcFormat,Vl.utcParse,Vl}function FV(e){return new Date(e)}function LV(e){return e instanceof Date?+e:+new Date(+e)}function Ry(e,t,r,n,i,a,o,c,f,d){var h=wy(),m=h.invert,v=h.domain,w=d(".%L"),E=d(":%S"),A=d("%I:%M"),S=d("%I %p"),b=d("%a %d"),T=d("%b %d"),_=d("%B"),N=d("%Y");function M(R){return(f(R)<R?w:c(R)<R?E:o(R)<R?A:a(R)<R?S:n(R)<R?i(R)<R?b:T:r(R)<R?_:N)(R)}return h.invert=function(R){return new Date(m(R))},h.domain=function(R){return arguments.length?v(Array.from(R,LV)):v().map(FV)},h.ticks=function(R){var P=v();return e(P[0],P[P.length-1],R??10)},h.tickFormat=function(R,P){return P==null?M:d(P)},h.nice=function(R){var P=v();return(!R||typeof R.range!="function")&&(R=t(P[0],P[P.length-1],R??10)),R?v(iI(P,R)):h},h.copy=function(){return mf(h,Ry(e,t,r,n,i,a,o,c,f,d))},h}function BV(){return ra.apply(Ry(DW,RW,ws,Py,kp,xf,Iy,Oy,Xo,xI).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function jV(){return ra.apply(Ry(NW,PW,Es,Dy,Ip,Op,Ny,ky,Xo,vI).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Np(){var e=0,t=1,r,n,i,a,o=Gn,c=!1,f;function d(m){return m==null||isNaN(m=+m)?f:o(i===0?.5:(m=(a(m)-r)*i,c?Math.max(0,Math.min(1,m)):m))}d.domain=function(m){return arguments.length?([e,t]=m,r=a(e=+e),n=a(t=+t),i=r===n?0:1/(n-r),d):[e,t]},d.clamp=function(m){return arguments.length?(c=!!m,d):c},d.interpolator=function(m){return arguments.length?(o=m,d):o};function h(m){return function(v){var w,E;return arguments.length?([w,E]=v,o=m(w,E),d):[o(0),o(1)]}}return d.range=h(Xc),d.rangeRound=h(yy),d.unknown=function(m){return arguments.length?(f=m,d):f},function(m){return a=m,r=m(e),n=m(t),i=r===n?0:1/(n-r),d}}function To(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function yI(){var e=bo(Np()(Gn));return e.copy=function(){return To(e,yI())},Is.apply(e,arguments)}function wI(){var e=Cy(Np()).domain([1,10]);return e.copy=function(){return To(e,wI()).base(e.base())},Is.apply(e,arguments)}function EI(){var e=Sy(Np());return e.copy=function(){return To(e,EI()).constant(e.constant())},Is.apply(e,arguments)}function My(){var e=_y(Np());return e.copy=function(){return To(e,My()).exponent(e.exponent())},Is.apply(e,arguments)}function UV(){return My.apply(null,arguments).exponent(.5)}function AI(){var e=[],t=Gn;function r(n){if(n!=null&&!isNaN(n=+n))return t((pf(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let i of n)i!=null&&!isNaN(i=+i)&&e.push(i);return e.sort(po),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,i)=>t(i/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(i,a)=>_z(e,a/n))},r.copy=function(){return AI(t).domain(e)},Is.apply(r,arguments)}function Pp(){var e=0,t=.5,r=1,n=1,i,a,o,c,f,d=Gn,h,m=!1,v;function w(A){return isNaN(A=+A)?v:(A=.5+((A=+h(A))-a)*(n*A<n*a?c:f),d(m?Math.max(0,Math.min(1,A)):A))}w.domain=function(A){return arguments.length?([e,t,r]=A,i=h(e=+e),a=h(t=+t),o=h(r=+r),c=i===a?0:.5/(a-i),f=a===o?0:.5/(o-a),n=a<i?-1:1,w):[e,t,r]},w.clamp=function(A){return arguments.length?(m=!!A,w):m},w.interpolator=function(A){return arguments.length?(d=A,w):d};function E(A){return function(S){var b,T,_;return arguments.length?([b,T,_]=S,d=Qz(A,[b,T,_]),w):[d(0),d(.5),d(1)]}}return w.range=E(Xc),w.rangeRound=E(yy),w.unknown=function(A){return arguments.length?(v=A,w):v},function(A){return h=A,i=A(e),a=A(t),o=A(r),c=i===a?0:.5/(a-i),f=a===o?0:.5/(o-a),n=a<i?-1:1,w}}function CI(){var e=bo(Pp()(Gn));return e.copy=function(){return To(e,CI())},Is.apply(e,arguments)}function SI(){var e=Cy(Pp()).domain([.1,1,10]);return e.copy=function(){return To(e,SI()).base(e.base())},Is.apply(e,arguments)}function _I(){var e=Sy(Pp());return e.copy=function(){return To(e,_I()).constant(e.constant())},Is.apply(e,arguments)}function Fy(){var e=_y(Pp());return e.copy=function(){return To(e,Fy()).exponent(e.exponent())},Is.apply(e,arguments)}function zV(){return Fy.apply(null,arguments).exponent(.5)}const ju=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:my,scaleDiverging:CI,scaleDivergingLog:SI,scaleDivergingPow:Fy,scaleDivergingSqrt:zV,scaleDivergingSymlog:_I,scaleIdentity:nI,scaleImplicit:lv,scaleLinear:rI,scaleLog:aI,scaleOrdinal:gy,scalePoint:Oz,scalePow:by,scaleQuantile:lI,scaleQuantize:cI,scaleRadial:oI,scaleSequential:yI,scaleSequentialLog:wI,scaleSequentialPow:My,scaleSequentialQuantile:AI,scaleSequentialSqrt:UV,scaleSequentialSymlog:EI,scaleSqrt:EW,scaleSymlog:sI,scaleThreshold:uI,scaleTime:BV,scaleUtc:jV,tickFormat:tI},Symbol.toStringTag,{value:"Module"}));var Ns=e=>e.chartData,Dp=ve([Ns],e=>{var t=e.chartData!=null?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:t,dataStartIndex:0}}),bI=(e,t,r,n)=>n?Dp(e):Ns(e),WV=(e,t,r)=>r?Dp(e):Ns(e);function As(e){if(Array.isArray(e)&&e.length===2){var[t,r]=e;if(St(t)&&St(r))return!0}return!1}function cS(e,t,r){return r?e:[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}function TI(e,t){if(t&&typeof e!="function"&&Array.isArray(e)&&e.length===2){var[r,n]=e,i,a;if(St(r))i=r;else if(typeof r=="function")return;if(St(n))a=n;else if(typeof n=="function")return;var o=[i,a];if(As(o))return o}}function VV(e,t,r){if(!(!r&&t==null)){if(typeof e=="function"&&t!=null)try{var n=e(t,r);if(As(n))return cS(n,t,r)}catch{}if(Array.isArray(e)&&e.length===2){var[i,a]=e,o,c;if(i==="auto")t!=null&&(o=Math.min(...t));else if(qe(i))o=i;else if(typeof i=="function")try{t!=null&&(o=i(t==null?void 0:t[0]))}catch{}else if(typeof i=="string"&&b3.test(i)){var f=b3.exec(i);if(f==null||f[1]==null||t==null)o=void 0;else{var d=+f[1];o=t[0]-d}}else o=t==null?void 0:t[0];if(a==="auto")t!=null&&(c=Math.max(...t));else if(qe(a))c=a;else if(typeof a=="function")try{t!=null&&(c=a(t==null?void 0:t[1]))}catch{}else if(typeof a=="string"&&T3.test(a)){var h=T3.exec(a);if(h==null||h[1]==null||t==null)c=void 0;else{var m=+h[1];c=t[1]+m}}else c=t==null?void 0:t[1];var v=[o,c];if(As(v))return t==null?v:cS(v,t,r)}}}var Kc=1e9,HV={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},By,fr=!0,ea="[DecimalError] ",el=ea+"Invalid argument: ",Ly=ea+"Exponent out of range: ",Yc=Math.floor,Uo=Math.pow,GV=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Ei,rn=1e7,nr=7,OI=9007199254740991,l1=Yc(OI/nr),Ye={};Ye.absoluteValue=Ye.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};Ye.comparedTo=Ye.cmp=function(e){var t,r,n,i,a=this;if(e=new a.constructor(e),a.s!==e.s)return a.s||-e.s;if(a.e!==e.e)return a.e>e.e^a.s<0?1:-1;for(n=a.d.length,i=e.d.length,t=0,r=n<i?n:i;t<r;++t)if(a.d[t]!==e.d[t])return a.d[t]>e.d[t]^a.s<0?1:-1;return n===i?0:n>i^a.s<0?1:-1};Ye.decimalPlaces=Ye.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*nr;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};Ye.dividedBy=Ye.div=function(e){return us(this,new this.constructor(e))};Ye.dividedToIntegerBy=Ye.idiv=function(e){var t=this,r=t.constructor;return Ht(us(t,new r(e),0,1),r.precision)};Ye.equals=Ye.eq=function(e){return!this.cmp(e)};Ye.exponent=function(){return Lr(this)};Ye.greaterThan=Ye.gt=function(e){return this.cmp(e)>0};Ye.greaterThanOrEqualTo=Ye.gte=function(e){return this.cmp(e)>=0};Ye.isInteger=Ye.isint=function(){return this.e>this.d.length-2};Ye.isNegative=Ye.isneg=function(){return this.s<0};Ye.isPositive=Ye.ispos=function(){return this.s>0};Ye.isZero=function(){return this.s===0};Ye.lessThan=Ye.lt=function(e){return this.cmp(e)<0};Ye.lessThanOrEqualTo=Ye.lte=function(e){return this.cmp(e)<1};Ye.logarithm=Ye.log=function(e){var t,r=this,n=r.constructor,i=n.precision,a=i+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(Ei))throw Error(ea+"NaN");if(r.s<1)throw Error(ea+(r.s?"NaN":"-Infinity"));return r.eq(Ei)?new n(0):(fr=!1,t=us(z0(r,a),z0(e,a),a),fr=!0,Ht(t,i))};Ye.minus=Ye.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?NI(t,e):kI(t,(e.s=-e.s,e))};Ye.modulo=Ye.mod=function(e){var t,r=this,n=r.constructor,i=n.precision;if(e=new n(e),!e.s)throw Error(ea+"NaN");return r.s?(fr=!1,t=us(r,e,0,1).times(e),fr=!0,r.minus(t)):Ht(new n(r),i)};Ye.naturalExponential=Ye.exp=function(){return II(this)};Ye.naturalLogarithm=Ye.ln=function(){return z0(this)};Ye.negated=Ye.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};Ye.plus=Ye.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?kI(t,e):NI(t,(e.s=-e.s,e))};Ye.precision=Ye.sd=function(e){var t,r,n,i=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(el+e);if(t=Lr(i)+1,n=i.d.length-1,r=n*nr+1,n=i.d[n],n){for(;n%10==0;n/=10)r--;for(n=i.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};Ye.squareRoot=Ye.sqrt=function(){var e,t,r,n,i,a,o,c=this,f=c.constructor;if(c.s<1){if(!c.s)return new f(0);throw Error(ea+"NaN")}for(e=Lr(c),fr=!1,i=Math.sqrt(+c),i==0||i==1/0?(t=Ua(c.d),(t.length+e)%2==0&&(t+="0"),i=Math.sqrt(t),e=Yc((e+1)/2)-(e<0||e%2),i==1/0?t="5e"+e:(t=i.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new f(t)):n=new f(i.toString()),r=f.precision,i=o=r+3;;)if(a=n,n=a.plus(us(c,a,o+2)).times(.5),Ua(a.d).slice(0,o)===(t=Ua(n.d)).slice(0,o)){if(t=t.slice(o-3,o+1),i==o&&t=="4999"){if(Ht(a,r+1,0),a.times(a).eq(c)){n=a;break}}else if(t!="9999")break;o+=4}return fr=!0,Ht(n,r)};Ye.times=Ye.mul=function(e){var t,r,n,i,a,o,c,f,d,h=this,m=h.constructor,v=h.d,w=(e=new m(e)).d;if(!h.s||!e.s)return new m(0);for(e.s*=h.s,r=h.e+e.e,f=v.length,d=w.length,f<d&&(a=v,v=w,w=a,o=f,f=d,d=o),a=[],o=f+d,n=o;n--;)a.push(0);for(n=d;--n>=0;){for(t=0,i=f+n;i>n;)c=a[i]+w[n]*v[i-n-1]+t,a[i--]=c%rn|0,t=c/rn|0;a[i]=(a[i]+t)%rn|0}for(;!a[--o];)a.pop();return t?++r:a.shift(),e.d=a,e.e=r,fr?Ht(e,m.precision):e};Ye.toDecimalPlaces=Ye.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(Xa(e,0,Kc),t===void 0?t=n.rounding:Xa(t,0,8),Ht(r,e+Lr(r)+1,t))};Ye.toExponential=function(e,t){var r,n=this,i=n.constructor;return e===void 0?r=gl(n,!0):(Xa(e,0,Kc),t===void 0?t=i.rounding:Xa(t,0,8),n=Ht(new i(n),e+1,t),r=gl(n,!0,e+1)),r};Ye.toFixed=function(e,t){var r,n,i=this,a=i.constructor;return e===void 0?gl(i):(Xa(e,0,Kc),t===void 0?t=a.rounding:Xa(t,0,8),n=Ht(new a(i),e+Lr(i)+1,t),r=gl(n.abs(),!1,e+Lr(n)+1),i.isneg()&&!i.isZero()?"-"+r:r)};Ye.toInteger=Ye.toint=function(){var e=this,t=e.constructor;return Ht(new t(e),Lr(e)+1,t.rounding)};Ye.toNumber=function(){return+this};Ye.toPower=Ye.pow=function(e){var t,r,n,i,a,o,c=this,f=c.constructor,d=12,h=+(e=new f(e));if(!e.s)return new f(Ei);if(c=new f(c),!c.s){if(e.s<1)throw Error(ea+"Infinity");return c}if(c.eq(Ei))return c;if(n=f.precision,e.eq(Ei))return Ht(c,n);if(t=e.e,r=e.d.length-1,o=t>=r,a=c.s,o){if((r=h<0?-h:h)<=OI){for(i=new f(Ei),t=Math.ceil(n/nr+4),fr=!1;r%2&&(i=i.times(c),fS(i.d,t)),r=Yc(r/2),r!==0;)c=c.times(c),fS(c.d,t);return fr=!0,e.s<0?new f(Ei).div(i):Ht(i,n)}}else if(a<0)throw Error(ea+"NaN");return a=a<0&&e.d[Math.max(t,r)]&1?-1:1,c.s=1,fr=!1,i=e.times(z0(c,n+d)),fr=!0,i=II(i),i.s=a,i};Ye.toPrecision=function(e,t){var r,n,i=this,a=i.constructor;return e===void 0?(r=Lr(i),n=gl(i,r<=a.toExpNeg||r>=a.toExpPos)):(Xa(e,1,Kc),t===void 0?t=a.rounding:Xa(t,0,8),i=Ht(new a(i),e,t),r=Lr(i),n=gl(i,e<=r||r<=a.toExpNeg,e)),n};Ye.toSignificantDigits=Ye.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(Xa(e,1,Kc),t===void 0?t=n.rounding:Xa(t,0,8)),Ht(new n(r),e,t)};Ye.toString=Ye.valueOf=Ye.val=Ye.toJSON=Ye[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=Lr(e),r=e.constructor;return gl(e,t<=r.toExpNeg||t>=r.toExpPos)};function kI(e,t){var r,n,i,a,o,c,f,d,h=e.constructor,m=h.precision;if(!e.s||!t.s)return t.s||(t=new h(e)),fr?Ht(t,m):t;if(f=e.d,d=t.d,o=e.e,i=t.e,f=f.slice(),a=o-i,a){for(a<0?(n=f,a=-a,c=d.length):(n=d,i=o,c=f.length),o=Math.ceil(m/nr),c=o>c?o+1:c+1,a>c&&(a=c,n.length=1),n.reverse();a--;)n.push(0);n.reverse()}for(c=f.length,a=d.length,c-a<0&&(a=c,n=d,d=f,f=n),r=0;a;)r=(f[--a]=f[a]+d[a]+r)/rn|0,f[a]%=rn;for(r&&(f.unshift(r),++i),c=f.length;f[--c]==0;)f.pop();return t.d=f,t.e=i,fr?Ht(t,m):t}function Xa(e,t,r){if(e!==~~e||e<t||e>r)throw Error(el+e)}function Ua(e){var t,r,n,i=e.length-1,a="",o=e[0];if(i>0){for(a+=o,t=1;t<i;t++)n=e[t]+"",r=nr-n.length,r&&(a+=Ks(r)),a+=n;o=e[t],n=o+"",r=nr-n.length,r&&(a+=Ks(r))}else if(o===0)return"0";for(;o%10===0;)o/=10;return a+o}var us=function(){function e(n,i){var a,o=0,c=n.length;for(n=n.slice();c--;)a=n[c]*i+o,n[c]=a%rn|0,o=a/rn|0;return o&&n.unshift(o),n}function t(n,i,a,o){var c,f;if(a!=o)f=a>o?1:-1;else for(c=f=0;c<a;c++)if(n[c]!=i[c]){f=n[c]>i[c]?1:-1;break}return f}function r(n,i,a){for(var o=0;a--;)n[a]-=o,o=n[a]<i[a]?1:0,n[a]=o*rn+n[a]-i[a];for(;!n[0]&&n.length>1;)n.shift()}return function(n,i,a,o){var c,f,d,h,m,v,w,E,A,S,b,T,_,N,M,R,P,z,B=n.constructor,re=n.s==i.s?1:-1,ee=n.d,V=i.d;if(!n.s)return new B(n);if(!i.s)throw Error(ea+"Division by zero");for(f=n.e-i.e,P=V.length,M=ee.length,w=new B(re),E=w.d=[],d=0;V[d]==(ee[d]||0);)++d;if(V[d]>(ee[d]||0)&&--f,a==null?T=a=B.precision:o?T=a+(Lr(n)-Lr(i))+1:T=a,T<0)return new B(0);if(T=T/nr+2|0,d=0,P==1)for(h=0,V=V[0],T++;(d<M||h)&&T--;d++)_=h*rn+(ee[d]||0),E[d]=_/V|0,h=_%V|0;else{for(h=rn/(V[0]+1)|0,h>1&&(V=e(V,h),ee=e(ee,h),P=V.length,M=ee.length),N=P,A=ee.slice(0,P),S=A.length;S<P;)A[S++]=0;z=V.slice(),z.unshift(0),R=V[0],V[1]>=rn/2&&++R;do h=0,c=t(V,A,P,S),c<0?(b=A[0],P!=S&&(b=b*rn+(A[1]||0)),h=b/R|0,h>1?(h>=rn&&(h=rn-1),m=e(V,h),v=m.length,S=A.length,c=t(m,A,v,S),c==1&&(h--,r(m,P<v?z:V,v))):(h==0&&(c=h=1),m=V.slice()),v=m.length,v<S&&m.unshift(0),r(A,m,S),c==-1&&(S=A.length,c=t(V,A,P,S),c<1&&(h++,r(A,P<S?z:V,S))),S=A.length):c===0&&(h++,A=[0]),E[d++]=h,c&&A[0]?A[S++]=ee[N]||0:(A=[ee[N]],S=1);while((N++<M||A[0]!==void 0)&&T--)}return E[0]||E.shift(),w.e=f,Ht(w,o?a+Lr(w)+1:a)}}();function II(e,t){var r,n,i,a,o,c,f=0,d=0,h=e.constructor,m=h.precision;if(Lr(e)>16)throw Error(Ly+Lr(e));if(!e.s)return new h(Ei);for(fr=!1,c=m,o=new h(.03125);e.abs().gte(.1);)e=e.times(o),d+=5;for(n=Math.log(Uo(2,d))/Math.LN10*2+5|0,c+=n,r=i=a=new h(Ei),h.precision=c;;){if(i=Ht(i.times(e),c),r=r.times(++f),o=a.plus(us(i,r,c)),Ua(o.d).slice(0,c)===Ua(a.d).slice(0,c)){for(;d--;)a=Ht(a.times(a),c);return h.precision=m,t==null?(fr=!0,Ht(a,m)):a}a=o}}function Lr(e){for(var t=e.e*nr,r=e.d[0];r>=10;r/=10)t++;return t}function hm(e,t,r){if(t>e.LN10.sd())throw fr=!0,r&&(e.precision=r),Error(ea+"LN10 precision limit exceeded");return Ht(new e(e.LN10),t)}function Ks(e){for(var t="";e--;)t+="0";return t}function z0(e,t){var r,n,i,a,o,c,f,d,h,m=1,v=10,w=e,E=w.d,A=w.constructor,S=A.precision;if(w.s<1)throw Error(ea+(w.s?"NaN":"-Infinity"));if(w.eq(Ei))return new A(0);if(t==null?(fr=!1,d=S):d=t,w.eq(10))return t==null&&(fr=!0),hm(A,d);if(d+=v,A.precision=d,r=Ua(E),n=r.charAt(0),a=Lr(w),Math.abs(a)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)w=w.times(e),r=Ua(w.d),n=r.charAt(0),m++;a=Lr(w),n>1?(w=new A("0."+r),a++):w=new A(n+"."+r.slice(1))}else return f=hm(A,d+2,S).times(a+""),w=z0(new A(n+"."+r.slice(1)),d-v).plus(f),A.precision=S,t==null?(fr=!0,Ht(w,S)):w;for(c=o=w=us(w.minus(Ei),w.plus(Ei),d),h=Ht(w.times(w),d),i=3;;){if(o=Ht(o.times(h),d),f=c.plus(us(o,new A(i),d)),Ua(f.d).slice(0,d)===Ua(c.d).slice(0,d))return c=c.times(2),a!==0&&(c=c.plus(hm(A,d+2,S).times(a+""))),c=us(c,new A(m),d),A.precision=S,t==null?(fr=!0,Ht(c,S)):c;c=f,i+=2}}function uS(e,t){var r,n,i;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(i=t.length;t.charCodeAt(i-1)===48;)--i;if(t=t.slice(n,i),t){if(i-=n,r=r-n-1,e.e=Yc(r/nr),e.d=[],n=(r+1)%nr,r<0&&(n+=nr),n<i){for(n&&e.d.push(+t.slice(0,n)),i-=nr;n<i;)e.d.push(+t.slice(n,n+=nr));t=t.slice(n),n=nr-t.length}else n-=i;for(;n--;)t+="0";if(e.d.push(+t),fr&&(e.e>l1||e.e<-l1))throw Error(Ly+r)}else e.s=0,e.e=0,e.d=[0];return e}function Ht(e,t,r){var n,i,a,o,c,f,d,h,m=e.d;for(o=1,a=m[0];a>=10;a/=10)o++;if(n=t-o,n<0)n+=nr,i=t,d=m[h=0];else{if(h=Math.ceil((n+1)/nr),a=m.length,h>=a)return e;for(d=a=m[h],o=1;a>=10;a/=10)o++;n%=nr,i=n-nr+o}if(r!==void 0&&(a=Uo(10,o-i-1),c=d/a%10|0,f=t<0||m[h+1]!==void 0||d%a,f=r<4?(c||f)&&(r==0||r==(e.s<0?3:2)):c>5||c==5&&(r==4||f||r==6&&(n>0?i>0?d/Uo(10,o-i):0:m[h-1])%10&1||r==(e.s<0?8:7))),t<1||!m[0])return f?(a=Lr(e),m.length=1,t=t-a-1,m[0]=Uo(10,(nr-t%nr)%nr),e.e=Yc(-t/nr)||0):(m.length=1,m[0]=e.e=e.s=0),e;if(n==0?(m.length=h,a=1,h--):(m.length=h+1,a=Uo(10,nr-n),m[h]=i>0?(d/Uo(10,o-i)%Uo(10,i)|0)*a:0),f)for(;;)if(h==0){(m[0]+=a)==rn&&(m[0]=1,++e.e);break}else{if(m[h]+=a,m[h]!=rn)break;m[h--]=0,a=1}for(n=m.length;m[--n]===0;)m.pop();if(fr&&(e.e>l1||e.e<-l1))throw Error(Ly+Lr(e));return e}function NI(e,t){var r,n,i,a,o,c,f,d,h,m,v=e.constructor,w=v.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new v(e),fr?Ht(t,w):t;if(f=e.d,m=t.d,n=t.e,d=e.e,f=f.slice(),o=d-n,o){for(h=o<0,h?(r=f,o=-o,c=m.length):(r=m,n=d,c=f.length),i=Math.max(Math.ceil(w/nr),c)+2,o>i&&(o=i,r.length=1),r.reverse(),i=o;i--;)r.push(0);r.reverse()}else{for(i=f.length,c=m.length,h=i<c,h&&(c=i),i=0;i<c;i++)if(f[i]!=m[i]){h=f[i]<m[i];break}o=0}for(h&&(r=f,f=m,m=r,t.s=-t.s),c=f.length,i=m.length-c;i>0;--i)f[c++]=0;for(i=m.length;i>o;){if(f[--i]<m[i]){for(a=i;a&&f[--a]===0;)f[a]=rn-1;--f[a],f[i]+=rn}f[i]-=m[i]}for(;f[--c]===0;)f.pop();for(;f[0]===0;f.shift())--n;return f[0]?(t.d=f,t.e=n,fr?Ht(t,w):t):new v(0)}function gl(e,t,r){var n,i=Lr(e),a=Ua(e.d),o=a.length;return t?(r&&(n=r-o)>0?a=a.charAt(0)+"."+a.slice(1)+Ks(n):o>1&&(a=a.charAt(0)+"."+a.slice(1)),a=a+(i<0?"e":"e+")+i):i<0?(a="0."+Ks(-i-1)+a,r&&(n=r-o)>0&&(a+=Ks(n))):i>=o?(a+=Ks(i+1-o),r&&(n=r-i-1)>0&&(a=a+"."+Ks(n))):((n=i+1)<o&&(a=a.slice(0,n)+"."+a.slice(n)),r&&(n=r-o)>0&&(i+1===o&&(a+="."),a+=Ks(n))),e.s<0?"-"+a:a}function fS(e,t){if(e.length>t)return e.length=t,!0}function PI(e){var t,r,n;function i(a){var o=this;if(!(o instanceof i))return new i(a);if(o.constructor=i,a instanceof i){o.s=a.s,o.e=a.e,o.d=(a=a.d)?a.slice():a;return}if(typeof a=="number"){if(a*0!==0)throw Error(el+a);if(a>0)o.s=1;else if(a<0)a=-a,o.s=-1;else{o.s=0,o.e=0,o.d=[0];return}if(a===~~a&&a<1e7){o.e=0,o.d=[a];return}return uS(o,a.toString())}else if(typeof a!="string")throw Error(el+a);if(a.charCodeAt(0)===45?(a=a.slice(1),o.s=-1):o.s=1,GV.test(a))uS(o,a);else throw Error(el+a)}if(i.prototype=Ye,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.clone=PI,i.config=i.set=$V,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return i.config(e),i}function $V(e){if(!e||typeof e!="object")throw Error(ea+"Object expected");var t,r,n,i=["precision",1,Kc,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<i.length;t+=3)if((n=e[r=i[t]])!==void 0)if(Yc(n)===n&&n>=i[t+1]&&n<=i[t+2])this[r]=n;else throw Error(el+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(el+r+": "+n);return this}var By=PI(HV);Ei=new By(1);const Ft=By;function DI(e){var t;return e===0?t=1:t=Math.floor(new Ft(e).abs().log(10).toNumber())+1,t}function RI(e,t,r){for(var n=new Ft(e),i=0,a=[];n.lt(t)&&i<1e5;)a.push(n.toNumber()),n=n.add(r),i++;return a}var MI=e=>{var[t,r]=e,[n,i]=[t,r];return t>r&&([n,i]=[r,t]),[n,i]},FI=(e,t,r)=>{if(e.lte(0))return new Ft(0);var n=DI(e.toNumber()),i=new Ft(10).pow(n),a=e.div(i),o=n!==1?.05:.1,c=new Ft(Math.ceil(a.div(o).toNumber())).add(r).mul(o),f=c.mul(i);return t?new Ft(f.toNumber()):new Ft(Math.ceil(f.toNumber()))},XV=(e,t,r)=>{var n=new Ft(1),i=new Ft(e);if(!i.isint()&&r){var a=Math.abs(e);a<1?(n=new Ft(10).pow(DI(e)-1),i=new Ft(Math.floor(i.div(n).toNumber())).mul(n)):a>1&&(i=new Ft(Math.floor(e)))}else e===0?i=new Ft(Math.floor((t-1)/2)):r||(i=new Ft(Math.floor(e)));for(var o=Math.floor((t-1)/2),c=[],f=0;f<t;f++)c.push(i.add(new Ft(f-o).mul(n)).toNumber());return c},LI=function(t,r,n,i){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((r-t)/(n-1)))return{step:new Ft(0),tickMin:new Ft(0),tickMax:new Ft(0)};var o=FI(new Ft(r).sub(t).div(n-1),i,a),c;t<=0&&r>=0?c=new Ft(0):(c=new Ft(t).add(r).div(2),c=c.sub(new Ft(c).mod(o)));var f=Math.ceil(c.sub(t).div(o).toNumber()),d=Math.ceil(new Ft(r).sub(c).div(o).toNumber()),h=f+d+1;return h>n?LI(t,r,n,i,a+1):(h<n&&(d=r>0?d+(n-h):d,f=r>0?f:f+(n-h)),{step:o,tickMin:c.sub(new Ft(f).mul(o)),tickMax:c.add(new Ft(d).mul(o))})},KV=function(t){var[r,n]=t,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=Math.max(i,2),[c,f]=MI([r,n]);if(c===-1/0||f===1/0){var d=f===1/0?[c,...Array(i-1).fill(1/0)]:[...Array(i-1).fill(-1/0),f];return r>n?d.reverse():d}if(c===f)return XV(c,i,a);var{step:h,tickMin:m,tickMax:v}=LI(c,f,o,a,0),w=RI(m,v.add(new Ft(.1).mul(h)),h);return r>n?w.reverse():w},YV=function(t,r){var[n,i]=t,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[o,c]=MI([n,i]);if(o===-1/0||c===1/0)return[n,i];if(o===c)return[o];var f=Math.max(r,2),d=FI(new Ft(c).sub(o).div(f-1),a,0),h=[...RI(new Ft(o),new Ft(c),d),c];return a===!1&&(h=h.map(m=>Math.round(m))),n>i?h.reverse():h},BI=e=>e.rootProps.maxBarSize,ZV=e=>e.rootProps.barGap,jI=e=>e.rootProps.barCategoryGap,qV=e=>e.rootProps.barSize,vf=e=>e.rootProps.stackOffset,UI=e=>e.rootProps.reverseStackOrder,jy=e=>e.options.chartName,Uy=e=>e.rootProps.syncId,zI=e=>e.rootProps.syncMethod,zy=e=>e.options.eventEmitter,wn={grid:-100,barBackground:-50,area:100,cursorRectangle:200,bar:300,line:400,axis:500,scatter:600,activeBar:1e3,cursorLine:1100,activeDot:1200,label:2e3},Mo={allowDecimals:!1,allowDataOverflow:!1,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"auto"},Da={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!0,includeHidden:!1,radiusAxisId:0,reversed:!1,scale:"auto",tick:!0,tickCount:5,type:"auto"},Rp=(e,t)=>{if(!(!e||!t))return e!=null&&e.reversed?[t[1],t[0]]:t};function Mp(e,t,r){if(r!=="auto")return r;if(e!=null)return _o(e,t)?"category":"number"}function dS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function c1(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?dS(Object(r),!0).forEach(function(n){QV(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function QV(e,t,r){return(t=JV(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function JV(e){var t=eH(e,"string");return typeof t=="symbol"?t:t+""}function eH(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var hS={allowDataOverflow:Mo.allowDataOverflow,allowDecimals:Mo.allowDecimals,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:Mo.angleAxisId,includeHidden:!1,name:void 0,reversed:Mo.reversed,scale:Mo.scale,tick:Mo.tick,tickCount:void 0,ticks:void 0,type:Mo.type,unit:void 0},pS={allowDataOverflow:Da.allowDataOverflow,allowDecimals:Da.allowDecimals,allowDuplicatedCategory:Da.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Da.radiusAxisId,includeHidden:Da.includeHidden,name:void 0,reversed:Da.reversed,scale:Da.scale,tick:Da.tick,tickCount:Da.tickCount,ticks:void 0,type:Da.type,unit:void 0},tH=(e,t)=>{if(t!=null)return e.polarAxis.angleAxis[t]},Wy=ve([tH,Ek],(e,t)=>{var r;if(e!=null)return e;var n=(r=Mp(t,"angleAxis",hS.type))!==null&&r!==void 0?r:"category";return c1(c1({},hS),{},{type:n})}),rH=(e,t)=>e.polarAxis.radiusAxis[t],Vy=ve([rH,Ek],(e,t)=>{var r;if(e!=null)return e;var n=(r=Mp(t,"radiusAxis",pS.type))!==null&&r!==void 0?r:"category";return c1(c1({},pS),{},{type:n})}),Fp=e=>e.polarOptions,Hy=ve([Os,ks,Kr],jk),WI=ve([Fp,Hy],(e,t)=>{if(e!=null)return Fn(e.innerRadius,t,0)}),VI=ve([Fp,Hy],(e,t)=>{if(e!=null)return Fn(e.outerRadius,t,t*.8)}),nH=e=>{if(e==null)return[0,0];var{startAngle:t,endAngle:r}=e;return[t,r]},HI=ve([Fp],nH);ve([Wy,HI],Rp);var GI=ve([Hy,WI,VI],(e,t,r)=>{if(!(e==null||t==null||r==null))return[t,r]});ve([Vy,GI],Rp);var $I=ve([Dt,Fp,WI,VI,Os,ks],(e,t,r,n,i,a)=>{if(!(e!=="centric"&&e!=="radial"||t==null||r==null||n==null)){var{cx:o,cy:c,startAngle:f,endAngle:d}=t;return{cx:Fn(o,i,i/2),cy:Fn(c,a,a/2),innerRadius:r,outerRadius:n,startAngle:f,endAngle:d,clockWise:!1}}}),xr=(e,t)=>t,yf=(e,t,r)=>r;function Gy(e){return e==null?void 0:e.id}function XI(e,t,r){var{chartData:n=[]}=t,{allowDuplicatedCategory:i,dataKey:a}=r,o=new Map;return e.forEach(c=>{var f,d=(f=c.data)!==null&&f!==void 0?f:n;if(!(d==null||d.length===0)){var h=Gy(c);d.forEach((m,v)=>{var w=a==null||i?v:String(ar(m,a,null)),E=ar(m,c.dataKey,0),A;o.has(w)?A=o.get(w):A={},Object.assign(A,{[h]:E}),o.set(w,A)})}}),Array.from(o.values())}function Lp(e){return"stackId"in e&&e.stackId!=null&&e.dataKey!=null}var Bp=(e,t)=>e===t?!0:e==null||t==null?!1:e[0]===t[0]&&e[1]===t[1];function jp(e,t){return Array.isArray(e)&&Array.isArray(t)&&e.length===0&&t.length===0?!0:e===t}function iH(e,t){if(e.length===t.length){for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}return!1}var dn=e=>{var t=Dt(e);return t==="horizontal"?"xAxis":t==="vertical"?"yAxis":t==="centric"?"angleAxis":"radiusAxis"},Zc=e=>e.tooltip.settings.axisId;function aH(e){if(e in ju)return ju[e]();var t="scale".concat(of(e));if(t in ju)return ju[t]()}function gS(e){var t=e.ticks,r=e.bandwidth,n=e.range(),i=[Math.min(...n),Math.max(...n)];return{domain:()=>e.domain(),range:function(a){function o(){return a.apply(this,arguments)}return o.toString=function(){return a.toString()},o}(()=>i),rangeMin:()=>i[0],rangeMax:()=>i[1],isInRange(a){var o=i[0],c=i[1];return o<=c?a>=o&&a<=c:a>=c&&a<=o},bandwidth:r?()=>r.call(e):void 0,ticks:t?a=>t.call(e,a):void 0,map:(a,o)=>{var c=e(a);if(c!=null){if(e.bandwidth&&o!==null&&o!==void 0&&o.position){var f=e.bandwidth();switch(o.position){case"middle":c+=f/2;break;case"end":c+=f;break}}return c}}}}function mS(e,t,r){if(typeof e=="function")return gS(e.copy().domain(t).range(r));if(e!=null){var n=aH(e);if(n!=null)return n.domain(t).range(r),gS(n)}}var KI=(e,t)=>{if(t!=null)switch(e){case"linear":{if(!As(t)){for(var r,n,i=0;i<t.length;i++){var a=t[i];St(a)&&((r===void 0||a<r)&&(r=a),(n===void 0||a>n)&&(n=a))}return r!==void 0&&n!==void 0?[r,n]:void 0}return t}default:return t}};function xS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function u1(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?xS(Object(r),!0).forEach(function(n){sH(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function sH(e,t,r){return(t=oH(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oH(e){var t=lH(e,"string");return typeof t=="symbol"?t:t+""}function lH(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var dv=[0,"auto"],en={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},YI=(e,t)=>e.cartesianAxis.xAxis[t],Ps=(e,t)=>{var r=YI(e,t);return r??en},tn={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:dv,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:ff},ZI=(e,t)=>e.cartesianAxis.yAxis[t],Ds=(e,t)=>{var r=ZI(e,t);return r??tn},cH={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},$y=(e,t)=>{var r=e.cartesianAxis.zAxis[t];return r??cH},Or=(e,t,r)=>{switch(t){case"xAxis":return Ps(e,r);case"yAxis":return Ds(e,r);case"zAxis":return $y(e,r);case"angleAxis":return Wy(e,r);case"radiusAxis":return Vy(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},uH=(e,t,r)=>{switch(t){case"xAxis":return Ps(e,r);case"yAxis":return Ds(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},qc=(e,t,r)=>{switch(t){case"xAxis":return Ps(e,r);case"yAxis":return Ds(e,r);case"angleAxis":return Wy(e,r);case"radiusAxis":return Vy(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},qI=e=>e.graphicalItems.cartesianItems.some(t=>t.type==="bar")||e.graphicalItems.polarItems.some(t=>t.type==="radialBar");function Xy(e,t){return r=>{switch(e){case"xAxis":return"xAxisId"in r&&r.xAxisId===t;case"yAxis":return"yAxisId"in r&&r.yAxisId===t;case"zAxis":return"zAxisId"in r&&r.zAxisId===t;case"angleAxis":return"angleAxisId"in r&&r.angleAxisId===t;case"radiusAxis":return"radiusAxisId"in r&&r.radiusAxisId===t;default:return!1}}}var Ky=e=>e.graphicalItems.cartesianItems,fH=ve([xr,yf],Xy),Yy=(e,t,r)=>e.filter(r).filter(n=>(t==null?void 0:t.includeHidden)===!0?!0:!n.hide),wf=ve([Ky,Or,fH],Yy,{memoizeOptions:{resultEqualityCheck:jp}}),QI=ve([wf],e=>e.filter(t=>t.type==="area"||t.type==="bar").filter(Lp)),JI=e=>e.filter(t=>!("stackId"in t)||t.stackId===void 0),dH=ve([wf],JI),Zy=e=>e.map(t=>t.data).filter(Boolean).flat(1),hH=ve([wf],Zy,{memoizeOptions:{resultEqualityCheck:jp}}),qy=(e,t)=>{var{chartData:r=[],dataStartIndex:n,dataEndIndex:i}=t;return e.length>0?e:r.slice(n,i+1)},Qy=ve([hH,bI],qy),Jy=(e,t,r)=>(t==null?void 0:t.dataKey)!=null?e.map(n=>({value:ar(n,t.dataKey)})):r.length>0?r.map(n=>n.dataKey).flatMap(n=>e.map(i=>({value:ar(i,n)}))):e.map(n=>({value:n})),Up=ve([Qy,Or,wf],Jy);function e6(e,t){switch(e){case"xAxis":return t.direction==="x";case"yAxis":return t.direction==="y";default:return!1}}function $d(e){if(Ga(e)||e instanceof Date){var t=Number(e);if(St(t))return t}}function vS(e){if(Array.isArray(e)){var t=[$d(e[0]),$d(e[1])];return As(t)?t:void 0}var r=$d(e);if(r!=null)return[r,r]}function Cs(e){return e.map($d).filter(li)}function pH(e,t,r){return!r||typeof t!="number"||Ha(t)?[]:r.length?Cs(r.flatMap(n=>{var i=ar(e,n.dataKey),a,o;if(Array.isArray(i)?[a,o]=i:a=o=i,!(!St(a)||!St(o)))return[t-a,t+o]})):[]}var Zr=e=>{var t=dn(e),r=Zc(e);return qc(e,t,r)},Ef=ve([Zr],e=>e==null?void 0:e.dataKey),gH=ve([QI,bI,Zr],XI),t6=(e,t,r,n)=>{var i={},a=t.reduce((o,c)=>{if(c.stackId==null)return o;var f=o[c.stackId];return f==null&&(f=[]),f.push(c),o[c.stackId]=f,o},i);return Object.fromEntries(Object.entries(a).map(o=>{var[c,f]=o,d=n?[...f].reverse():f,h=d.map(Gy);return[c,{stackedData:VB(e,h,r),graphicalItems:d}]}))},hv=ve([gH,QI,vf,UI],t6),r6=(e,t,r,n)=>{var{dataStartIndex:i,dataEndIndex:a}=t;if(n==null&&r!=="zAxis"){var o=KB(e,i,a);if(!(o!=null&&o[0]===0&&o[1]===0))return o}},mH=ve([Or],e=>e.allowDataOverflow),ew=e=>{var t;if(e==null||!("domain"in e))return dv;if(e.domain!=null)return e.domain;if("ticks"in e&&e.ticks!=null){if(e.type==="number"){var r=Cs(e.ticks);return[Math.min(...r),Math.max(...r)]}if(e.type==="category")return e.ticks.map(String)}return(t=e==null?void 0:e.domain)!==null&&t!==void 0?t:dv},tw=ve([Or],ew),rw=ve([tw,mH],TI),xH=ve([hv,Ns,xr,rw],r6,{memoizeOptions:{resultEqualityCheck:Bp}}),zp=e=>e.errorBars,vH=(e,t,r)=>e.flatMap(n=>t[n.id]).filter(Boolean).filter(n=>e6(r,n)),f1=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var i=r.filter(Boolean);if(i.length!==0){var a=i.flat(),o=Math.min(...a),c=Math.max(...a);return[o,c]}},nw=(e,t,r,n,i)=>{var a,o;if(r.length>0&&e.forEach(c=>{r.forEach(f=>{var d,h,m=(d=n[f.id])===null||d===void 0?void 0:d.filter(b=>e6(i,b)),v=ar(c,(h=t.dataKey)!==null&&h!==void 0?h:f.dataKey),w=pH(c,v,m);if(w.length>=2){var E=Math.min(...w),A=Math.max(...w);(a==null||E<a)&&(a=E),(o==null||A>o)&&(o=A)}var S=vS(v);S!=null&&(a=a==null?S[0]:Math.min(a,S[0]),o=o==null?S[1]:Math.max(o,S[1]))})}),(t==null?void 0:t.dataKey)!=null&&e.forEach(c=>{var f=vS(ar(c,t.dataKey));f!=null&&(a=a==null?f[0]:Math.min(a,f[0]),o=o==null?f[1]:Math.max(o,f[1]))}),St(a)&&St(o))return[a,o]},yH=ve([Qy,Or,dH,zp,xr],nw,{memoizeOptions:{resultEqualityCheck:Bp}});function wH(e){var{value:t}=e;if(Ga(t)||t instanceof Date)return t}var EH=(e,t,r)=>{var n=e.map(wH).filter(i=>i!=null);return r&&(t.dataKey==null||t.allowDuplicatedCategory&&Q8(n))?$k(0,e.length):t.allowDuplicatedCategory?n:Array.from(new Set(n))},n6=e=>e.referenceElements.dots,Qc=(e,t,r)=>e.filter(n=>n.ifOverflow==="extendDomain").filter(n=>t==="xAxis"?n.xAxisId===r:n.yAxisId===r),AH=ve([n6,xr,yf],Qc),i6=e=>e.referenceElements.areas,CH=ve([i6,xr,yf],Qc),a6=e=>e.referenceElements.lines,SH=ve([a6,xr,yf],Qc),s6=(e,t)=>{if(e!=null){var r=Cs(e.map(n=>t==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},_H=ve(AH,xr,s6),o6=(e,t)=>{if(e!=null){var r=Cs(e.flatMap(n=>[t==="xAxis"?n.x1:n.y1,t==="xAxis"?n.x2:n.y2]));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},bH=ve([CH,xr],o6);function TH(e){var t;if(e.x!=null)return Cs([e.x]);var r=(t=e.segment)===null||t===void 0?void 0:t.map(n=>n.x);return r==null||r.length===0?[]:Cs(r)}function OH(e){var t;if(e.y!=null)return Cs([e.y]);var r=(t=e.segment)===null||t===void 0?void 0:t.map(n=>n.y);return r==null||r.length===0?[]:Cs(r)}var l6=(e,t)=>{if(e!=null){var r=e.flatMap(n=>t==="xAxis"?TH(n):OH(n));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},kH=ve([SH,xr],l6),IH=ve(_H,kH,bH,(e,t,r)=>f1(e,r,t)),iw=(e,t,r,n,i,a,o,c)=>{if(r!=null)return r;var f=o==="vertical"&&c==="xAxis"||o==="horizontal"&&c==="yAxis",d=f?f1(n,a,i):f1(a,i);return VV(t,d,e.allowDataOverflow)},NH=ve([Or,tw,rw,xH,yH,IH,Dt,xr],iw,{memoizeOptions:{resultEqualityCheck:Bp}}),PH=[0,1],aw=(e,t,r,n,i,a,o)=>{if(!((e==null||r==null||r.length===0)&&o===void 0)){var{dataKey:c,type:f}=e,d=_o(t,a);if(d&&c==null){var h;return $k(0,(h=r==null?void 0:r.length)!==null&&h!==void 0?h:0)}return f==="category"?EH(n,e,d):i==="expand"?PH:o}},sw=ve([Or,Dt,Qy,Up,vf,xr,NH],aw);function DH(e){return e in ju}var c6=(e,t,r)=>{if(e!=null){var{scale:n,type:i}=e;if(n==="auto")return i==="category"&&r&&(r.indexOf("LineChart")>=0||r.indexOf("AreaChart")>=0||r.indexOf("ComposedChart")>=0&&!t)?"point":i==="category"?"band":"linear";if(typeof n=="string"){var a="scale".concat(of(n));return DH(a)?a:"point"}}},Oo=ve([Or,qI,jy],c6);function ow(e,t,r,n){if(!(r==null||n==null))return typeof e.scale=="function"?mS(e.scale,r,n):mS(t,r,n)}var lw=(e,t,r)=>{var n=ew(t);if(!(r!=="auto"&&r!=="linear")){if(t!=null&&t.tickCount&&Array.isArray(n)&&(n[0]==="auto"||n[1]==="auto")&&As(e))return KV(e,t.tickCount,t.allowDecimals);if(t!=null&&t.tickCount&&t.type==="number"&&As(e))return YV(e,t.tickCount,t.allowDecimals)}},cw=ve([sw,qc,Oo],lw),uw=(e,t,r,n)=>{if(n!=="angleAxis"&&(e==null?void 0:e.type)==="number"&&As(t)&&Array.isArray(r)&&r.length>0){var i,a,o=t[0],c=(i=r[0])!==null&&i!==void 0?i:0,f=t[1],d=(a=r[r.length-1])!==null&&a!==void 0?a:0;return[Math.min(o,c),Math.max(f,d)]}return t},RH=ve([Or,sw,cw,xr],uw),MH=ve(Up,Or,(e,t)=>{if(!(!t||t.type!=="number")){var r=1/0,n=Array.from(Cs(e.map(m=>m.value))).sort((m,v)=>m-v),i=n[0],a=n[n.length-1];if(i==null||a==null)return 1/0;var o=a-i;if(o===0)return 1/0;for(var c=0;c<n.length-1;c++){var f=n[c],d=n[c+1];if(!(f==null||d==null)){var h=d-f;r=Math.min(r,h)}}return r/o}}),u6=ve(MH,Dt,jI,Kr,(e,t,r,n,i)=>i,(e,t,r,n,i)=>{if(!St(e))return 0;var a=t==="vertical"?n.height:n.width;if(i==="gap")return e*a/2;if(i==="no-gap"){var o=Fn(r,e*a),c=e*a/2;return c-o-(c-o)/a*o}return 0}),FH=(e,t,r)=>{var n=Ps(e,t);return n==null||typeof n.padding!="string"?0:u6(e,"xAxis",t,r,n.padding)},LH=(e,t,r)=>{var n=Ds(e,t);return n==null||typeof n.padding!="string"?0:u6(e,"yAxis",t,r,n.padding)},BH=ve(Ps,FH,(e,t)=>{var r,n;if(e==null)return{left:0,right:0};var{padding:i}=e;return typeof i=="string"?{left:t,right:t}:{left:((r=i.left)!==null&&r!==void 0?r:0)+t,right:((n=i.right)!==null&&n!==void 0?n:0)+t}}),jH=ve(Ds,LH,(e,t)=>{var r,n;if(e==null)return{top:0,bottom:0};var{padding:i}=e;return typeof i=="string"?{top:t,bottom:t}:{top:((r=i.top)!==null&&r!==void 0?r:0)+t,bottom:((n=i.bottom)!==null&&n!==void 0?n:0)+t}}),UH=ve([Kr,BH,yp,vp,(e,t,r)=>r],(e,t,r,n,i)=>{var{padding:a}=n;return i?[a.left,r.width-a.right]:[e.left+t.left,e.left+e.width-t.right]}),zH=ve([Kr,Dt,jH,yp,vp,(e,t,r)=>r],(e,t,r,n,i,a)=>{var{padding:o}=i;return a?[n.height-o.bottom,o.top]:t==="horizontal"?[e.top+e.height-r.bottom,e.top+r.top]:[e.top+r.top,e.top+e.height-r.bottom]}),Af=(e,t,r,n)=>{var i;switch(t){case"xAxis":return UH(e,r,n);case"yAxis":return zH(e,r,n);case"zAxis":return(i=$y(e,r))===null||i===void 0?void 0:i.range;case"angleAxis":return HI(e);case"radiusAxis":return GI(e,r);default:return}},f6=ve([Or,Af],Rp),WH=ve([Oo,RH],KI),Wp=ve([Or,Oo,WH,f6],ow);ve([wf,zp,xr],vH);function d6(e,t){return e.id<t.id?-1:e.id>t.id?1:0}var Vp=(e,t)=>t,Hp=(e,t,r)=>r,VH=ve(mp,Vp,Hp,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(d6)),HH=ve(xp,Vp,Hp,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(d6)),h6=(e,t)=>({width:e.width,height:t.height}),GH=(e,t)=>{var r=typeof t.width=="number"?t.width:ff;return{width:r,height:e.height}},p6=ve(Kr,Ps,h6),$H=(e,t,r)=>{switch(t){case"top":return e.top;case"bottom":return r-e.bottom;default:return 0}},XH=(e,t,r)=>{switch(t){case"left":return e.left;case"right":return r-e.right;default:return 0}},KH=ve(ks,Kr,VH,Vp,Hp,(e,t,r,n,i)=>{var a={},o;return r.forEach(c=>{var f=h6(t,c);o==null&&(o=$H(t,n,e));var d=n==="top"&&!i||n==="bottom"&&i;a[c.id]=o-Number(d)*f.height,o+=(d?-1:1)*f.height}),a}),YH=ve(Os,Kr,HH,Vp,Hp,(e,t,r,n,i)=>{var a={},o;return r.forEach(c=>{var f=GH(t,c);o==null&&(o=XH(t,n,e));var d=n==="left"&&!i||n==="right"&&i;a[c.id]=o-Number(d)*f.width,o+=(d?-1:1)*f.width}),a}),ZH=(e,t)=>{var r=Ps(e,t);if(r!=null)return KH(e,r.orientation,r.mirror)},qH=ve([Kr,Ps,ZH,(e,t)=>t],(e,t,r,n)=>{if(t!=null){var i=r==null?void 0:r[n];return i==null?{x:e.left,y:0}:{x:e.left,y:i}}}),QH=(e,t)=>{var r=Ds(e,t);if(r!=null)return YH(e,r.orientation,r.mirror)},JH=ve([Kr,Ds,QH,(e,t)=>t],(e,t,r,n)=>{if(t!=null){var i=r==null?void 0:r[n];return i==null?{x:0,y:e.top}:{x:i,y:e.top}}}),g6=ve(Kr,Ds,(e,t)=>{var r=typeof t.width=="number"?t.width:ff;return{width:r,height:e.height}}),yS=(e,t,r)=>{switch(t){case"xAxis":return p6(e,r).width;case"yAxis":return g6(e,r).height;default:return}},m6=(e,t,r,n)=>{if(r!=null){var{allowDuplicatedCategory:i,type:a,dataKey:o}=r,c=_o(e,n),f=t.map(d=>d.value);if(o&&c&&a==="category"&&i&&Q8(f))return f}},fw=ve([Dt,Up,Or,xr],m6),x6=(e,t,r,n)=>{if(!(r==null||r.dataKey==null)){var{type:i,scale:a}=r,o=_o(e,n);if(o&&(i==="number"||a!=="auto"))return t.map(c=>c.value)}},dw=ve([Dt,Up,qc,xr],x6),wS=ve([Dt,uH,Oo,Wp,fw,dw,Af,cw,xr],(e,t,r,n,i,a,o,c,f)=>{if(t!=null){var d=_o(e,f);return{angle:t.angle,interval:t.interval,minTickGap:t.minTickGap,orientation:t.orientation,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit,axisType:f,categoricalDomain:a,duplicateDomain:i,isCategorical:d,niceTicks:c,range:o,realScaleType:r,scale:n}}}),eG=(e,t,r,n,i,a,o,c,f)=>{if(!(t==null||n==null)){var d=_o(e,f),{type:h,ticks:m,tickCount:v}=t,w=r==="scaleBand"&&typeof n.bandwidth=="function"?n.bandwidth()/2:2,E=h==="category"&&n.bandwidth?n.bandwidth()/w:0;E=f==="angleAxis"&&a!=null&&a.length>=2?sn(a[0]-a[1])*2*E:E;var A=m||i;return A?A.map((S,b)=>{var T=o?o.indexOf(S):S,_=n.map(T);return St(_)?{index:b,coordinate:_+E,value:S,offset:E}:null}).filter(li):d&&c?c.map((S,b)=>{var T=n.map(S);return St(T)?{coordinate:T+E,value:S,index:b,offset:E}:null}).filter(li):n.ticks?n.ticks(v).map((S,b)=>{var T=n.map(S);return St(T)?{coordinate:T+E,value:S,index:b,offset:E}:null}).filter(li):n.domain().map((S,b)=>{var T=n.map(S);return St(T)?{coordinate:T+E,value:o?o[S]:S,index:b,offset:E}:null}).filter(li)}},v6=ve([Dt,qc,Oo,Wp,cw,Af,fw,dw,xr],eG),tG=(e,t,r,n,i,a,o)=>{if(!(t==null||r==null||n==null||n[0]===n[1])){var c=_o(e,o),{tickCount:f}=t,d=0;return d=o==="angleAxis"&&(n==null?void 0:n.length)>=2?sn(n[0]-n[1])*2*d:d,c&&a?a.map((h,m)=>{var v=r.map(h);return St(v)?{coordinate:v+d,value:h,index:m,offset:d}:null}).filter(li):r.ticks?r.ticks(f).map((h,m)=>{var v=r.map(h);return St(v)?{coordinate:v+d,value:h,index:m,offset:d}:null}).filter(li):r.domain().map((h,m)=>{var v=r.map(h);return St(v)?{coordinate:v+d,value:i?i[h]:h,index:m,offset:d}:null}).filter(li)}},Bc=ve([Dt,qc,Wp,Af,fw,dw,xr],tG),jc=ve(Or,Wp,(e,t)=>{if(!(e==null||t==null))return u1(u1({},e),{},{scale:t})}),rG=ve([Or,Oo,sw,f6],ow);ve((e,t,r)=>$y(e,r),rG,(e,t)=>{if(!(e==null||t==null))return u1(u1({},e),{},{scale:t})});var nG=ve([Dt,mp,xp],(e,t,r)=>{switch(e){case"horizontal":return t.some(n=>n.reversed)?"right-to-left":"left-to-right";case"vertical":return r.some(n=>n.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),y6=e=>e.options.defaultTooltipEventType,w6=e=>e.options.validateTooltipEventTypes;function E6(e,t,r){if(e==null)return t;var n=e?"axis":"item";return r==null?t:r.includes(n)?n:t}function hw(e,t){var r=y6(e),n=w6(e);return E6(t,r,n)}function iG(e){return Je(t=>hw(t,e))}var A6=(e,t)=>{var r,n=Number(t);if(!(Ha(n)||t==null))return n>=0?e==null||(r=e[n])===null||r===void 0?void 0:r.value:void 0},aG=e=>e.tooltip.settings,Qs={active:!1,index:null,dataKey:void 0,graphicalItemId:void 0,coordinate:void 0},sG={itemInteraction:{click:Qs,hover:Qs},axisInteraction:{click:Qs,hover:Qs},keyboardInteraction:Qs,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0,sourceViewBox:void 0,graphicalItemId:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},C6=hi({name:"tooltip",initialState:sG,reducers:{addTooltipEntrySettings:{reducer(e,t){e.tooltipItemPayloads.push(t.payload)},prepare:lr()},replaceTooltipEntrySettings:{reducer(e,t){var{prev:r,next:n}=t.payload,i=Ea(e).tooltipItemPayloads.indexOf(r);i>-1&&(e.tooltipItemPayloads[i]=n)},prepare:lr()},removeTooltipEntrySettings:{reducer(e,t){var r=Ea(e).tooltipItemPayloads.indexOf(t.payload);r>-1&&e.tooltipItemPayloads.splice(r,1)},prepare:lr()},setTooltipSettingsState(e,t){e.settings=t.payload},setActiveMouseOverItemIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=t.payload.activeIndex,e.itemInteraction.hover.dataKey=t.payload.activeDataKey,e.itemInteraction.hover.graphicalItemId=t.payload.activeGraphicalItemId,e.itemInteraction.hover.coordinate=t.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,t){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=t.payload.activeIndex,e.itemInteraction.click.dataKey=t.payload.activeDataKey,e.itemInteraction.click.graphicalItemId=t.payload.activeGraphicalItemId,e.itemInteraction.click.coordinate=t.payload.activeCoordinate},setMouseOverAxisIndex(e,t){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=t.payload.activeIndex,e.axisInteraction.hover.dataKey=t.payload.activeDataKey,e.axisInteraction.hover.coordinate=t.payload.activeCoordinate},setMouseClickAxisIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=t.payload.activeIndex,e.axisInteraction.click.dataKey=t.payload.activeDataKey,e.axisInteraction.click.coordinate=t.payload.activeCoordinate},setSyncInteraction(e,t){e.syncInteraction=t.payload},setKeyboardInteraction(e,t){e.keyboardInteraction.active=t.payload.active,e.keyboardInteraction.index=t.payload.activeIndex,e.keyboardInteraction.coordinate=t.payload.activeCoordinate}}}),{addTooltipEntrySettings:oG,replaceTooltipEntrySettings:lG,removeTooltipEntrySettings:cG,setTooltipSettingsState:uG,setActiveMouseOverItemIndex:S6,mouseLeaveItem:fG,mouseLeaveChart:_6,setActiveClickItemIndex:dG,setMouseOverAxisIndex:b6,setMouseClickAxisIndex:hG,setSyncInteraction:pv,setKeyboardInteraction:gv}=C6.actions,pG=C6.reducer;function ES(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function xd(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ES(Object(r),!0).forEach(function(n){gG(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ES(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function gG(e,t,r){return(t=mG(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mG(e){var t=xG(e,"string");return typeof t=="symbol"?t:t+""}function xG(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vG(e,t,r){return t==="axis"?r==="click"?e.axisInteraction.click:e.axisInteraction.hover:r==="click"?e.itemInteraction.click:e.itemInteraction.hover}function yG(e){return e.index!=null}var T6=(e,t,r,n)=>{if(t==null)return Qs;var i=vG(e,t,r);if(i==null)return Qs;if(i.active)return i;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&e.syncInteraction.index!=null)return e.syncInteraction;var a=e.settings.active===!0;if(yG(i)){if(a)return xd(xd({},i),{},{active:!0})}else if(n!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:n,graphicalItemId:void 0};return xd(xd({},Qs),{},{coordinate:i.coordinate})};function wG(e){if(typeof e=="number")return Number.isFinite(e)?e:void 0;if(e instanceof Date){var t=e.valueOf();return Number.isFinite(t)?t:void 0}var r=Number(e);return Number.isFinite(r)?r:void 0}function EG(e,t){var r=wG(e),n=t[0],i=t[1];if(r===void 0)return!1;var a=Math.min(n,i),o=Math.max(n,i);return r>=a&&r<=o}function AG(e,t,r){if(r==null||t==null)return!0;var n=ar(e,t);return n==null||!As(r)?!0:EG(n,r)}var pw=(e,t,r,n)=>{var i=e==null?void 0:e.index;if(i==null)return null;var a=Number(i);if(!St(a))return i;var o=0,c=1/0;t.length>0&&(c=t.length-1);var f=Math.max(o,Math.min(a,c)),d=t[f];return d==null||AG(d,r,n)?String(f):null},O6=(e,t,r,n,i,a,o)=>{if(a!=null){var c=o[0],f=c==null?void 0:c.getPosition(a);if(f!=null)return f;var d=i==null?void 0:i[Number(a)];if(d)switch(r){case"horizontal":return{x:d.coordinate,y:(n.top+t)/2};default:return{x:(n.left+e)/2,y:d.coordinate}}}},k6=(e,t,r,n)=>{if(t==="axis")return e.tooltipItemPayloads;if(e.tooltipItemPayloads.length===0)return[];var i;if(r==="hover"?i=e.itemInteraction.hover.graphicalItemId:i=e.itemInteraction.click.graphicalItemId,i==null&&n!=null){var a=e.tooltipItemPayloads[0];return a!=null?[a]:[]}return e.tooltipItemPayloads.filter(o=>{var c;return((c=o.settings)===null||c===void 0?void 0:c.graphicalItemId)===i})},I6=e=>e.options.tooltipPayloadSearcher,Jc=e=>e.tooltip;function AS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function CS(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?AS(Object(r),!0).forEach(function(n){CG(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):AS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function CG(e,t,r){return(t=SG(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function SG(e){var t=_G(e,"string");return typeof t=="symbol"?t:t+""}function _G(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function bG(e,t){return e??t}var N6=(e,t,r,n,i,a,o)=>{if(!(t==null||a==null)){var{chartData:c,computedData:f,dataStartIndex:d,dataEndIndex:h}=r,m=[];return e.reduce((v,w)=>{var E,{dataDefinedOnItem:A,settings:S}=w,b=bG(A,c),T=Array.isArray(b)?ok(b,d,h):b,_=(E=S==null?void 0:S.dataKey)!==null&&E!==void 0?E:n,N=S==null?void 0:S.nameKey,M;if(n&&Array.isArray(T)&&!Array.isArray(T[0])&&o==="axis"?M=b9(T,n,i):M=a(T,t,f,N),Array.isArray(M))M.forEach(P=>{var z=CS(CS({},S),{},{name:P.name,unit:P.unit,color:void 0,fill:void 0});v.push(O3({tooltipEntrySettings:z,dataKey:P.dataKey,payload:P.payload,value:ar(P.payload,P.dataKey),name:P.name}))});else{var R;v.push(O3({tooltipEntrySettings:S,dataKey:_,payload:M,value:ar(M,_),name:(R=ar(M,N))!==null&&R!==void 0?R:S==null?void 0:S.name}))}return v},m)}},gw=ve([Zr,qI,jy],c6),TG=ve([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,t)=>[...e,...t]),OG=ve([dn,Zc],Xy),eu=ve([TG,Zr,OG],Yy,{memoizeOptions:{resultEqualityCheck:jp}}),kG=ve([eu],e=>e.filter(Lp)),IG=ve([eu],Zy,{memoizeOptions:{resultEqualityCheck:jp}}),tu=ve([IG,Ns],qy),NG=ve([kG,Ns,Zr],XI),mw=ve([tu,Zr,eu],Jy),P6=ve([Zr],ew),PG=ve([Zr],e=>e.allowDataOverflow),D6=ve([P6,PG],TI),DG=ve([eu],e=>e.filter(Lp)),RG=ve([NG,DG,vf,UI],t6),MG=ve([RG,Ns,dn,D6],r6),FG=ve([eu],JI),LG=ve([tu,Zr,FG,zp,dn],nw,{memoizeOptions:{resultEqualityCheck:Bp}}),BG=ve([n6,dn,Zc],Qc),jG=ve([BG,dn],s6),UG=ve([i6,dn,Zc],Qc),zG=ve([UG,dn],o6),WG=ve([a6,dn,Zc],Qc),VG=ve([WG,dn],l6),HG=ve([jG,VG,zG],f1),GG=ve([Zr,P6,D6,MG,LG,HG,Dt,dn],iw),Cf=ve([Zr,Dt,tu,mw,vf,dn,GG],aw),$G=ve([Cf,Zr,gw],lw),XG=ve([Zr,Cf,$G,dn],uw),R6=e=>{var t=dn(e),r=Zc(e),n=!1;return Af(e,t,r,n)},M6=ve([Zr,R6],Rp),F6=ve([Zr,gw,XG,M6],ow),KG=ve([Dt,mw,Zr,dn],m6),YG=ve([Dt,mw,Zr,dn],x6),ZG=(e,t,r,n,i,a,o,c)=>{if(t){var{type:f}=t,d=_o(e,c);if(n){var h=r==="scaleBand"&&n.bandwidth?n.bandwidth()/2:2,m=f==="category"&&n.bandwidth?n.bandwidth()/h:0;return m=c==="angleAxis"&&i!=null&&(i==null?void 0:i.length)>=2?sn(i[0]-i[1])*2*m:m,d&&o?o.map((v,w)=>{var E=n.map(v);return St(E)?{coordinate:E+m,value:v,index:w,offset:m}:null}).filter(li):n.domain().map((v,w)=>{var E=n.map(v);return St(E)?{coordinate:E+m,value:a?a[v]:v,index:w,offset:m}:null}).filter(li)}}},Rs=ve([Dt,Zr,gw,F6,R6,KG,YG,dn],ZG),xw=ve([y6,w6,aG],(e,t,r)=>E6(r.shared,e,t)),L6=e=>e.tooltip.settings.trigger,vw=e=>e.tooltip.settings.defaultIndex,Sf=ve([Jc,xw,L6,vw],T6),ml=ve([Sf,tu,Ef,Cf],pw),B6=ve([Rs,ml],A6),yw=ve([Sf],e=>{if(e)return e.dataKey}),qG=ve([Sf],e=>{if(e)return e.graphicalItemId}),j6=ve([Jc,xw,L6,vw],k6),QG=ve([Os,ks,Dt,Kr,Rs,vw,j6],O6),JG=ve([Sf,QG],(e,t)=>e!=null&&e.coordinate?e.coordinate:t),e$=ve([Sf],e=>{var t;return(t=e==null?void 0:e.active)!==null&&t!==void 0?t:!1}),t$=ve([j6,ml,Ns,Ef,B6,I6,xw],N6);ve([t$],e=>{if(e!=null){var t=e.map(r=>r.payload).filter(r=>r!=null);return Array.from(new Set(t))}});function SS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function _S(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?SS(Object(r),!0).forEach(function(n){r$(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):SS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function r$(e,t,r){return(t=n$(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function n$(e){var t=i$(e,"string");return typeof t=="symbol"?t:t+""}function i$(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var a$=()=>Je(Zr),s$=()=>{var e=a$(),t=Je(Rs),r=Je(F6);return Wh(!e||!r?void 0:_S(_S({},e),{},{scale:r}),t)};function bS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Hl(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?bS(Object(r),!0).forEach(function(n){o$(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):bS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function o$(e,t,r){return(t=l$(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function l$(e){var t=c$(e,"string");return typeof t=="symbol"?t:t+""}function c$(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var u$=(e,t,r,n)=>{var i=t.find(a=>a&&a.index===r);if(i){if(e==="horizontal")return{x:i.coordinate,y:n.chartY};if(e==="vertical")return{x:n.chartX,y:i.coordinate}}return{x:0,y:0}},f$=(e,t,r,n)=>{var i=t.find(d=>d&&d.index===r);if(i){if(e==="centric"){var a=i.coordinate,{radius:o}=n;return Hl(Hl(Hl({},n),Fr(n.cx,n.cy,o,a)),{},{angle:a,radius:o})}var c=i.coordinate,{angle:f}=n;return Hl(Hl(Hl({},n),Fr(n.cx,n.cy,c,f)),{},{angle:f,radius:c})}return{angle:0,clockWise:!1,cx:0,cy:0,endAngle:0,innerRadius:0,outerRadius:0,radius:0,startAngle:0,x:0,y:0}};function d$(e,t){var{chartX:r,chartY:n}=e;return r>=t.left&&r<=t.left+t.width&&n>=t.top&&n<=t.top+t.height}var U6=(e,t,r,n,i)=>{var a,o=(a=t==null?void 0:t.length)!==null&&a!==void 0?a:0;if(o<=1||e==null)return 0;if(n==="angleAxis"&&i!=null&&Math.abs(Math.abs(i[1]-i[0])-360)<=1e-6)for(var c=0;c<o;c++){var f,d,h,m,v,w=c>0?(f=r[c-1])===null||f===void 0?void 0:f.coordinate:(d=r[o-1])===null||d===void 0?void 0:d.coordinate,E=(h=r[c])===null||h===void 0?void 0:h.coordinate,A=c>=o-1?(m=r[0])===null||m===void 0?void 0:m.coordinate:(v=r[c+1])===null||v===void 0?void 0:v.coordinate,S=void 0;if(!(w==null||E==null||A==null))if(sn(E-w)!==sn(A-E)){var b=[];if(sn(A-E)===sn(i[1]-i[0])){S=A;var T=E+i[1]-i[0];b[0]=Math.min(T,(T+w)/2),b[1]=Math.max(T,(T+w)/2)}else{S=w;var _=A+i[1]-i[0];b[0]=Math.min(E,(_+E)/2),b[1]=Math.max(E,(_+E)/2)}var N=[Math.min(E,(S+E)/2),Math.max(E,(S+E)/2)];if(e>N[0]&&e<=N[1]||e>=b[0]&&e<=b[1]){var M;return(M=r[c])===null||M===void 0?void 0:M.index}}else{var R=Math.min(w,A),P=Math.max(w,A);if(e>(R+E)/2&&e<=(P+E)/2){var z;return(z=r[c])===null||z===void 0?void 0:z.index}}}else if(t)for(var B=0;B<o;B++){var re=t[B];if(re!=null){var ee=t[B+1],V=t[B-1];if(B===0&&ee!=null&&e<=(re.coordinate+ee.coordinate)/2||B===o-1&&V!=null&&e>(re.coordinate+V.coordinate)/2||B>0&&B<o-1&&V!=null&&ee!=null&&e>(re.coordinate+V.coordinate)/2&&e<=(re.coordinate+ee.coordinate)/2)return re.index}}return-1},h$=()=>Je(jy),ww=(e,t)=>t,z6=(e,t,r)=>r,Ew=(e,t,r,n)=>n,p$=ve(Rs,e=>ap(e,t=>t.coordinate)),Aw=ve([Jc,ww,z6,Ew],T6),Cw=ve([Aw,tu,Ef,Cf],pw),g$=(e,t,r)=>{if(t!=null){var n=Jc(e);return t==="axis"?r==="hover"?n.axisInteraction.hover.dataKey:n.axisInteraction.click.dataKey:r==="hover"?n.itemInteraction.hover.dataKey:n.itemInteraction.click.dataKey}},W6=ve([Jc,ww,z6,Ew],k6),d1=ve([Os,ks,Dt,Kr,Rs,Ew,W6],O6),m$=ve([Aw,d1],(e,t)=>{var r;return(r=e.coordinate)!==null&&r!==void 0?r:t}),V6=ve([Rs,Cw],A6),x$=ve([W6,Cw,Ns,Ef,V6,I6,ww],N6),v$=ve([Aw,Cw],(e,t)=>({isActive:e.active&&t!=null,activeIndex:t})),y$=(e,t,r,n,i,a,o)=>{if(!(!e||!r||!n||!i)&&d$(e,o)){var c=YB(e,t),f=U6(c,a,i,r,n),d=u$(t,i,f,e);return{activeIndex:String(f),activeCoordinate:d}}},w$=(e,t,r,n,i,a,o)=>{if(!(!e||!n||!i||!a||!r)){var c=lz(e,r);if(c){var f=ZB(c,t),d=U6(f,o,a,n,i),h=f$(t,a,d,c);return{activeIndex:String(d),activeCoordinate:h}}}},E$=(e,t,r,n,i,a,o,c)=>{if(!(!e||!t||!n||!i||!a))return t==="horizontal"||t==="vertical"?y$(e,t,n,i,a,o,c):w$(e,t,r,n,i,a,o)},A$=ve(e=>e.zIndex.zIndexMap,(e,t)=>t,(e,t,r)=>r,(e,t,r)=>{if(t!=null){var n=e[t];if(n!=null)return r?n.panoramaElement:n.element}}),C$=ve(e=>e.zIndex.zIndexMap,e=>{var t=Object.keys(e).map(n=>parseInt(n,10)).concat(Object.values(wn)),r=Array.from(new Set(t));return r.sort((n,i)=>n-i)},{memoizeOptions:{resultEqualityCheck:iH}});function TS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function OS(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?TS(Object(r),!0).forEach(function(n){S$(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):TS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function S$(e,t,r){return(t=_$(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _$(e){var t=b$(e,"string");return typeof t=="symbol"?t:t+""}function b$(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var T$={},O$={zIndexMap:Object.values(wn).reduce((e,t)=>OS(OS({},e),{},{[t]:{element:void 0,panoramaElement:void 0,consumers:0}}),T$)},k$=new Set(Object.values(wn));function I$(e){return k$.has(e)}var H6=hi({name:"zIndex",initialState:O$,reducers:{registerZIndexPortal:{reducer:(e,t)=>{var{zIndex:r}=t.payload;e.zIndexMap[r]?e.zIndexMap[r].consumers+=1:e.zIndexMap[r]={consumers:1,element:void 0,panoramaElement:void 0}},prepare:lr()},unregisterZIndexPortal:{reducer:(e,t)=>{var{zIndex:r}=t.payload;e.zIndexMap[r]&&(e.zIndexMap[r].consumers-=1,e.zIndexMap[r].consumers<=0&&!I$(r)&&delete e.zIndexMap[r])},prepare:lr()},registerZIndexPortalElement:{reducer:(e,t)=>{var{zIndex:r,element:n,isPanorama:i}=t.payload;e.zIndexMap[r]?i?e.zIndexMap[r].panoramaElement=n:e.zIndexMap[r].element=n:e.zIndexMap[r]={consumers:0,element:i?void 0:n,panoramaElement:i?n:void 0}},prepare:lr()},unregisterZIndexPortalElement:{reducer:(e,t)=>{var{zIndex:r}=t.payload;e.zIndexMap[r]&&(t.payload.isPanorama?e.zIndexMap[r].panoramaElement=void 0:e.zIndexMap[r].element=void 0)},prepare:lr()}}}),{registerZIndexPortal:N$,unregisterZIndexPortal:P$,registerZIndexPortalElement:D$,unregisterZIndexPortalElement:R$}=H6.actions,M$=H6.reducer;function Ta(e){var{zIndex:t,children:r}=e,n=Cj(),i=n&&t!==void 0&&t!==0,a=pi(),o=Qt();I.useLayoutEffect(()=>i?(o(N$({zIndex:t})),()=>{o(P$({zIndex:t}))}):Gc,[o,t,i]);var c=Je(f=>A$(f,t,a));return i?c?af.createPortal(r,c):null:r}function mv(){return mv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},mv.apply(null,arguments)}function kS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function vd(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?kS(Object(r),!0).forEach(function(n){F$(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):kS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function F$(e,t,r){return(t=L$(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function L$(e){var t=B$(e,"string");return typeof t=="symbol"?t:t+""}function B$(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function j$(e){var{cursor:t,cursorComp:r,cursorProps:n}=e;return I.isValidElement(t)?I.cloneElement(t,n):I.createElement(r,n)}function U$(e){var t,{coordinate:r,payload:n,index:i,offset:a,tooltipAxisBandSize:o,layout:c,cursor:f,tooltipEventType:d,chartName:h}=e,m=r,v=n,w=i;if(!f||!m||h!=="ScatterChart"&&d!=="axis")return null;var E,A,S;if(h==="ScatterChart")E=m,A=AU,S=wn.cursorLine;else if(h==="BarChart")E=CU(c,m,a,o),A=Bk,S=wn.cursorRectangle;else if(c==="radial"&&eO(m)){var{cx:b,cy:T,radius:_,startAngle:N,endAngle:M}=Uk(m);E={cx:b,cy:T,startAngle:N,endAngle:M,innerRadius:_,outerRadius:_},A=Wk,S=wn.cursorLine}else E={points:dz(c,m,a)},A=hy,S=wn.cursorLine;var R=typeof f=="object"&&"className"in f?f.className:void 0,P=vd(vd(vd(vd({stroke:"#ccc",pointerEvents:"none"},a),E),O0(f)),{},{payload:v,payloadIndex:w,className:Bt("recharts-tooltip-cursor",R)});return I.createElement(Ta,{zIndex:(t=e.zIndex)!==null&&t!==void 0?t:S},I.createElement(j$,{cursor:f,cursorComp:A,cursorProps:P}))}function z$(e){var t=s$(),r=yk(),n=$c(),i=h$();return t==null||r==null||n==null||i==null?null:I.createElement(U$,mv({},e,{offset:r,layout:n,tooltipAxisBandSize:t,chartName:i}))}var G6=I.createContext(null),W$=()=>I.useContext(G6),$6={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function i(f,d,h){this.fn=f,this.context=d,this.once=h||!1}function a(f,d,h,m,v){if(typeof h!="function")throw new TypeError("The listener must be a function");var w=new i(h,m||f,v),E=r?r+d:d;return f._events[E]?f._events[E].fn?f._events[E]=[f._events[E],w]:f._events[E].push(w):(f._events[E]=w,f._eventsCount++),f}function o(f,d){--f._eventsCount===0?f._events=new n:delete f._events[d]}function c(){this._events=new n,this._eventsCount=0}c.prototype.eventNames=function(){var d=[],h,m;if(this._eventsCount===0)return d;for(m in h=this._events)t.call(h,m)&&d.push(r?m.slice(1):m);return Object.getOwnPropertySymbols?d.concat(Object.getOwnPropertySymbols(h)):d},c.prototype.listeners=function(d){var h=r?r+d:d,m=this._events[h];if(!m)return[];if(m.fn)return[m.fn];for(var v=0,w=m.length,E=new Array(w);v<w;v++)E[v]=m[v].fn;return E},c.prototype.listenerCount=function(d){var h=r?r+d:d,m=this._events[h];return m?m.fn?1:m.length:0},c.prototype.emit=function(d,h,m,v,w,E){var A=r?r+d:d;if(!this._events[A])return!1;var S=this._events[A],b=arguments.length,T,_;if(S.fn){switch(S.once&&this.removeListener(d,S.fn,void 0,!0),b){case 1:return S.fn.call(S.context),!0;case 2:return S.fn.call(S.context,h),!0;case 3:return S.fn.call(S.context,h,m),!0;case 4:return S.fn.call(S.context,h,m,v),!0;case 5:return S.fn.call(S.context,h,m,v,w),!0;case 6:return S.fn.call(S.context,h,m,v,w,E),!0}for(_=1,T=new Array(b-1);_<b;_++)T[_-1]=arguments[_];S.fn.apply(S.context,T)}else{var N=S.length,M;for(_=0;_<N;_++)switch(S[_].once&&this.removeListener(d,S[_].fn,void 0,!0),b){case 1:S[_].fn.call(S[_].context);break;case 2:S[_].fn.call(S[_].context,h);break;case 3:S[_].fn.call(S[_].context,h,m);break;case 4:S[_].fn.call(S[_].context,h,m,v);break;default:if(!T)for(M=1,T=new Array(b-1);M<b;M++)T[M-1]=arguments[M];S[_].fn.apply(S[_].context,T)}}return!0},c.prototype.on=function(d,h,m){return a(this,d,h,m,!1)},c.prototype.once=function(d,h,m){return a(this,d,h,m,!0)},c.prototype.removeListener=function(d,h,m,v){var w=r?r+d:d;if(!this._events[w])return this;if(!h)return o(this,w),this;var E=this._events[w];if(E.fn)E.fn===h&&(!v||E.once)&&(!m||E.context===m)&&o(this,w);else{for(var A=0,S=[],b=E.length;A<b;A++)(E[A].fn!==h||v&&!E[A].once||m&&E[A].context!==m)&&S.push(E[A]);S.length?this._events[w]=S.length===1?S[0]:S:o(this,w)}return this},c.prototype.removeAllListeners=function(d){var h;return d?(h=r?r+d:d,this._events[h]&&o(this,h)):(this._events=new n,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=r,c.EventEmitter=c,e.exports=c})($6);var V$=$6.exports;const H$=bs(V$);var W0=new H$,xv="recharts.syncEvent.tooltip",IS="recharts.syncEvent.brush",X6=(e,t)=>{if(t&&Array.isArray(e)){var r=Number.parseInt(t,10);if(!Ha(r))return e[r]}},G$={chartName:"",tooltipPayloadSearcher:()=>{},eventEmitter:void 0,defaultTooltipEventType:"axis"},K6=hi({name:"options",initialState:G$,reducers:{createEventEmitter:e=>{e.eventEmitter==null&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),$$=K6.reducer,{createEventEmitter:X$}=K6.actions;function K$(e){return e.tooltip.syncInteraction}var Y$={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},Y6=hi({name:"chartData",initialState:Y$,reducers:{setChartData(e,t){if(e.chartData=t.payload,t.payload==null){e.dataStartIndex=0,e.dataEndIndex=0;return}t.payload.length>0&&e.dataEndIndex!==t.payload.length-1&&(e.dataEndIndex=t.payload.length-1)},setComputedData(e,t){e.computedData=t.payload},setDataStartEndIndexes(e,t){var{startIndex:r,endIndex:n}=t.payload;r!=null&&(e.dataStartIndex=r),n!=null&&(e.dataEndIndex=n)}}}),{setChartData:NS,setDataStartEndIndexes:Z$,setComputedData:vce}=Y6.actions,q$=Y6.reducer,Q$=["x","y"];function PS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Gl(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?PS(Object(r),!0).forEach(function(n){J$(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):PS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function J$(e,t,r){return(t=eX(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eX(e){var t=tX(e,"string");return typeof t=="symbol"?t:t+""}function tX(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rX(e,t){if(e==null)return{};var r,n,i=nX(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function nX(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function iX(){var e=Je(Uy),t=Je(zy),r=Qt(),n=Je(zI),i=Je(Rs),a=$c(),o=wp(),c=Je(f=>f.rootProps.className);I.useEffect(()=>{if(e==null)return Gc;var f=(d,h,m)=>{if(t!==m&&e===d){if(n==="index"){var v;if(o&&h!==null&&h!==void 0&&(v=h.payload)!==null&&v!==void 0&&v.coordinate&&h.payload.sourceViewBox){var w=h.payload.coordinate,{x:E,y:A}=w,S=rX(w,Q$),{x:b,y:T,width:_,height:N}=h.payload.sourceViewBox,M=Gl(Gl({},S),{},{x:o.x+(_?(E-b)/_:0)*o.width,y:o.y+(N?(A-T)/N:0)*o.height});r(Gl(Gl({},h),{},{payload:Gl(Gl({},h.payload),{},{coordinate:M})}))}else r(h);return}if(i!=null){var R;if(typeof n=="function"){var P={activeTooltipIndex:h.payload.index==null?void 0:Number(h.payload.index),isTooltipActive:h.payload.active,activeIndex:h.payload.index==null?void 0:Number(h.payload.index),activeLabel:h.payload.label,activeDataKey:h.payload.dataKey,activeCoordinate:h.payload.coordinate},z=n(i,P);R=i[z]}else n==="value"&&(R=i.find(Ce=>String(Ce.value)===h.payload.label));var{coordinate:B}=h.payload;if(R==null||h.payload.active===!1||B==null||o==null){r(pv({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0,sourceViewBox:void 0,graphicalItemId:void 0}));return}var{x:re,y:ee}=B,V=Math.min(re,o.x+o.width),de=Math.min(ee,o.y+o.height),pe={x:a==="horizontal"?R.coordinate:V,y:a==="horizontal"?de:R.coordinate},K=pv({active:h.payload.active,coordinate:pe,dataKey:h.payload.dataKey,index:String(R.index),label:h.payload.label,sourceViewBox:h.payload.sourceViewBox,graphicalItemId:h.payload.graphicalItemId});r(K)}}};return W0.on(xv,f),()=>{W0.off(xv,f)}},[c,r,t,e,n,i,a,o])}function aX(){var e=Je(Uy),t=Je(zy),r=Qt();I.useEffect(()=>{if(e==null)return Gc;var n=(i,a,o)=>{t!==o&&e===i&&r(Z$(a))};return W0.on(IS,n),()=>{W0.off(IS,n)}},[r,t,e])}function sX(){var e=Qt();I.useEffect(()=>{e(X$())},[e]),iX(),aX()}function oX(e,t,r,n,i,a){var o=Je(w=>g$(w,e,t)),c=Je(zy),f=Je(Uy),d=Je(zI),h=Je(K$),m=h==null?void 0:h.active,v=wp();I.useEffect(()=>{if(!m&&f!=null&&c!=null){var w=pv({active:a,coordinate:r,dataKey:o,index:i,label:typeof n=="number"?String(n):n,sourceViewBox:v,graphicalItemId:void 0});W0.emit(xv,f,w,c)}},[m,r,o,i,n,c,f,d,a,v])}function DS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function RS(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?DS(Object(r),!0).forEach(function(n){lX(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):DS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function lX(e,t,r){return(t=cX(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cX(e){var t=uX(e,"string");return typeof t=="symbol"?t:t+""}function uX(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fX(e){return e.dataKey}function dX(e,t){return I.isValidElement(e)?I.cloneElement(e,t):typeof e=="function"?I.createElement(e,t):I.createElement(tU,t)}var MS=[],hX={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,includeHidden:!1,isAnimationActive:"auto",itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function FS(e){var t,r,n=un(e,hX),{active:i,allowEscapeViewBox:a,animationDuration:o,animationEasing:c,content:f,filterNull:d,isAnimationActive:h,offset:m,payloadUniqBy:v,position:w,reverseDirection:E,useTranslate3d:A,wrapperStyle:S,cursor:b,shared:T,trigger:_,defaultIndex:N,portal:M,axisId:R}=n,P=Qt(),z=typeof N=="number"?String(N):N;I.useEffect(()=>{P(uG({shared:T,trigger:_,axisId:R,active:i,defaultIndex:z}))},[P,T,_,R,i,z]);var B=wp(),re=Dk(),ee=iG(T),{activeIndex:V,isActive:de}=(t=Je(ke=>v$(ke,ee,_,z)))!==null&&t!==void 0?t:{},pe=Je(ke=>x$(ke,ee,_,z)),K=Je(ke=>V6(ke,ee,_,z)),Ce=Je(ke=>m$(ke,ee,_,z)),ue=pe,se=W$(),q=(r=i??de)!==null&&r!==void 0?r:!1,[fe,we]=NO([ue,q]),G=ee==="axis"?K:void 0;oX(ee,_,Ce,G,V,q);var le=M??se;if(le==null||B==null||ee==null)return null;var ne=ue??MS;q||(ne=MS),d&&ne.length&&(ne=yO(ne.filter(ke=>ke.value!=null&&(ke.hide!==!0||n.includeHidden)),v,fX));var ae=ne.length>0,he=I.createElement(lU,{allowEscapeViewBox:a,animationDuration:o,animationEasing:c,isAnimationActive:h,active:q,coordinate:Ce,hasPayload:ae,offset:m,position:w,reverseDirection:E,useTranslate3d:A,viewBox:B,wrapperStyle:S,lastBoundingBox:fe,innerRef:we,hasPortalFromProps:!!M},dX(f,RS(RS({},n),{},{payload:ne,label:G,active:q,activeIndex:V,coordinate:Ce,accessibilityLayer:re})));return I.createElement(I.Fragment,null,af.createPortal(he,le),q&&I.createElement(z$,{cursor:b,tooltipEventType:ee,coordinate:Ce,payload:ne,index:V}))}var _f=e=>null;_f.displayName="Cell";function pX(e,t,r){return(t=gX(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gX(e){var t=mX(e,"string");return typeof t=="symbol"?t:t+""}function mX(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class xX{constructor(t){pX(this,"cache",new Map),this.maxSize=t}get(t){var r=this.cache.get(t);return r!==void 0&&(this.cache.delete(t),this.cache.set(t,r)),r}set(t,r){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxSize){var n=this.cache.keys().next().value;n!=null&&this.cache.delete(n)}this.cache.set(t,r)}clear(){this.cache.clear()}size(){return this.cache.size}}function LS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function vX(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?LS(Object(r),!0).forEach(function(n){yX(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):LS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function yX(e,t,r){return(t=wX(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wX(e){var t=EX(e,"string");return typeof t=="symbol"?t:t+""}function EX(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var AX={cacheSize:2e3,enableCache:!0},Z6=vX({},AX),BS=new xX(Z6.cacheSize),CX={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},jS="recharts_measurement_span";function SX(e,t){var r=t.fontSize||"",n=t.fontFamily||"",i=t.fontWeight||"",a=t.fontStyle||"",o=t.letterSpacing||"",c=t.textTransform||"";return"".concat(e,"|").concat(r,"|").concat(n,"|").concat(i,"|").concat(a,"|").concat(o,"|").concat(c)}var US=(e,t)=>{try{var r=document.getElementById(jS);r||(r=document.createElement("span"),r.setAttribute("id",jS),r.setAttribute("aria-hidden","true"),document.body.appendChild(r)),Object.assign(r.style,CX,t),r.textContent="".concat(e);var n=r.getBoundingClientRect();return{width:n.width,height:n.height}}catch{return{width:0,height:0}}},e0=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||Sp.isSsr)return{width:0,height:0};if(!Z6.enableCache)return US(t,r);var n=SX(t,r),i=BS.get(n);if(i)return i;var a=US(t,r);return BS.set(n,a),a},q6;function _X(e,t,r){return(t=bX(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function bX(e){var t=TX(e,"string");return typeof t=="symbol"?t:t+""}function TX(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var zS=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,WS=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,OX=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,kX=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,IX={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},NX=["cm","mm","pt","pc","in","Q","px"];function PX(e){return NX.includes(e)}var uc="NaN";function DX(e,t){return e*IX[t]}class vn{static parse(t){var r,[,n,i]=(r=kX.exec(t))!==null&&r!==void 0?r:[];return n==null?vn.NaN:new vn(parseFloat(n),i??"")}constructor(t,r){this.num=t,this.unit=r,this.num=t,this.unit=r,Ha(t)&&(this.unit=""),r!==""&&!OX.test(r)&&(this.num=NaN,this.unit=""),PX(r)&&(this.num=DX(t,r),this.unit="px")}add(t){return this.unit!==t.unit?new vn(NaN,""):new vn(this.num+t.num,this.unit)}subtract(t){return this.unit!==t.unit?new vn(NaN,""):new vn(this.num-t.num,this.unit)}multiply(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new vn(NaN,""):new vn(this.num*t.num,this.unit||t.unit)}divide(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new vn(NaN,""):new vn(this.num/t.num,this.unit||t.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return Ha(this.num)}}q6=vn;_X(vn,"NaN",new q6(NaN,""));function Q6(e){if(e==null||e.includes(uc))return uc;for(var t=e;t.includes("*")||t.includes("/");){var r,[,n,i,a]=(r=zS.exec(t))!==null&&r!==void 0?r:[],o=vn.parse(n??""),c=vn.parse(a??""),f=i==="*"?o.multiply(c):o.divide(c);if(f.isNaN())return uc;t=t.replace(zS,f.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var d,[,h,m,v]=(d=WS.exec(t))!==null&&d!==void 0?d:[],w=vn.parse(h??""),E=vn.parse(v??""),A=m==="+"?w.add(E):w.subtract(E);if(A.isNaN())return uc;t=t.replace(WS,A.toString())}return t}var VS=/\(([^()]*)\)/;function RX(e){for(var t=e,r;(r=VS.exec(t))!=null;){var[,n]=r;t=t.replace(VS,Q6(n))}return t}function MX(e){var t=e.replace(/\s+/g,"");return t=RX(t),t=Q6(t),t}function FX(e){try{return MX(e)}catch{return uc}}function pm(e){var t=FX(e.slice(5,-1));return t===uc?"":t}var LX=["x","y","lineHeight","capHeight","fill","scaleToFit","textAnchor","verticalAnchor"],BX=["dx","dy","angle","className","breakAll"];function vv(){return vv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},vv.apply(null,arguments)}function HS(e,t){if(e==null)return{};var r,n,i=jX(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function jX(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var J6=/[ \f\n\r\t\v\u2028\u2029]+/,eN=e=>{var{children:t,breakAll:r,style:n}=e;try{var i=[];cn(t)||(r?i=t.toString().split(""):i=t.toString().split(J6));var a=i.map(c=>({word:c,width:e0(c,n).width})),o=r?0:e0("",n).width;return{wordsWithComputedWidth:a,spaceWidth:o}}catch{return null}};function UX(e){return e==="start"||e==="middle"||e==="end"||e==="inherit"}var tN=(e,t,r,n)=>e.reduce((i,a)=>{var{word:o,width:c}=a,f=i[i.length-1];if(f&&c!=null&&(t==null||n||f.width+c+r<Number(t)))f.words.push(o),f.width+=c+r;else{var d={words:[o],width:c};i.push(d)}return i},[]),rN=e=>e.reduce((t,r)=>t.width>r.width?t:r),zX="",GS=(e,t,r,n,i,a,o,c)=>{var f=e.slice(0,t),d=eN({breakAll:r,style:n,children:f+zX});if(!d)return[!1,[]];var h=tN(d.wordsWithComputedWidth,a,o,c),m=h.length>i||rN(h).width>Number(a);return[m,h]},WX=(e,t,r,n,i)=>{var{maxLines:a,children:o,style:c,breakAll:f}=e,d=qe(a),h=String(o),m=tN(t,n,r,i);if(!d||i)return m;var v=m.length>a||rN(m).width>Number(n);if(!v)return m;for(var w=0,E=h.length-1,A=0,S;w<=E&&A<=h.length-1;){var b=Math.floor((w+E)/2),T=b-1,[_,N]=GS(h,T,f,c,a,n,r,i),[M]=GS(h,b,f,c,a,n,r,i);if(!_&&!M&&(w=b+1),_&&M&&(E=b-1),!_&&M){S=N;break}A++}return S||m},$S=e=>{var t=cn(e)?[]:e.toString().split(J6);return[{words:t,width:void 0}]},VX=e=>{var{width:t,scaleToFit:r,children:n,style:i,breakAll:a,maxLines:o}=e;if((t||r)&&!Sp.isSsr){var c,f,d=eN({breakAll:a,children:n,style:i});if(d){var{wordsWithComputedWidth:h,spaceWidth:m}=d;c=h,f=m}else return $S(n);return WX({breakAll:a,children:n,maxLines:o,style:i},c,f,t,!!r)}return $S(n)},nN="#808080",HX={angle:0,breakAll:!1,capHeight:"0.71em",fill:nN,lineHeight:"1em",scaleToFit:!1,textAnchor:"start",verticalAnchor:"end",x:0,y:0},Gp=I.forwardRef((e,t)=>{var r=un(e,HX),{x:n,y:i,lineHeight:a,capHeight:o,fill:c,scaleToFit:f,textAnchor:d,verticalAnchor:h}=r,m=HS(r,LX),v=I.useMemo(()=>VX({breakAll:m.breakAll,children:m.children,maxLines:m.maxLines,scaleToFit:f,style:m.style,width:m.width}),[m.breakAll,m.children,m.maxLines,f,m.style,m.width]),{dx:w,dy:E,angle:A,className:S,breakAll:b}=m,T=HS(m,BX);if(!Ga(n)||!Ga(i)||v.length===0)return null;var _=Number(n)+(qe(w)?w:0),N=Number(i)+(qe(E)?E:0);if(!St(_)||!St(N))return null;var M;switch(h){case"start":M=pm("calc(".concat(o,")"));break;case"middle":M=pm("calc(".concat((v.length-1)/2," * -").concat(a," + (").concat(o," / 2))"));break;default:M=pm("calc(".concat(v.length-1," * -").concat(a,")"));break}var R=[],P=v[0];if(f&&P!=null){var z=P.width,{width:B}=m;R.push("scale(".concat(qe(B)&&qe(z)?B/z:1,")"))}return A&&R.push("rotate(".concat(A,", ").concat(_,", ").concat(N,")")),R.length&&(T.transform=R.join(" ")),I.createElement("text",vv({},Qi(T),{ref:t,x:_,y:N,className:Bt("recharts-text",S),textAnchor:d,fill:c.includes("url")?nN:c}),v.map((re,ee)=>{var V=re.words.join(b?"":" ");return I.createElement("tspan",{x:_,dy:ee===0?M:a,key:"".concat(V,"-").concat(ee)},V)}))});Gp.displayName="Text";function XS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Ra(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?XS(Object(r),!0).forEach(function(n){GX(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):XS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function GX(e,t,r){return(t=$X(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $X(e){var t=XX(e,"string");return typeof t=="symbol"?t:t+""}function XX(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var KX=e=>{var{viewBox:t,position:r,offset:n=0,parentViewBox:i}=e,{x:a,y:o,height:c,upperWidth:f,lowerWidth:d}=ly(t),h=a,m=a+(f-d)/2,v=(h+m)/2,w=(f+d)/2,E=h+f/2,A=c>=0?1:-1,S=A*n,b=A>0?"end":"start",T=A>0?"start":"end",_=f>=0?1:-1,N=_*n,M=_>0?"end":"start",R=_>0?"start":"end",P=i;if(r==="top"){var z={x:h+f/2,y:o-S,horizontalAnchor:"middle",verticalAnchor:b};return P&&(z.height=Math.max(o-P.y,0),z.width=f),z}if(r==="bottom"){var B={x:m+d/2,y:o+c+S,horizontalAnchor:"middle",verticalAnchor:T};return P&&(B.height=Math.max(P.y+P.height-(o+c),0),B.width=d),B}if(r==="left"){var re={x:v-N,y:o+c/2,horizontalAnchor:M,verticalAnchor:"middle"};return P&&(re.width=Math.max(re.x-P.x,0),re.height=c),re}if(r==="right"){var ee={x:v+w+N,y:o+c/2,horizontalAnchor:R,verticalAnchor:"middle"};return P&&(ee.width=Math.max(P.x+P.width-ee.x,0),ee.height=c),ee}var V=P?{width:w,height:c}:{};return r==="insideLeft"?Ra({x:v+N,y:o+c/2,horizontalAnchor:R,verticalAnchor:"middle"},V):r==="insideRight"?Ra({x:v+w-N,y:o+c/2,horizontalAnchor:M,verticalAnchor:"middle"},V):r==="insideTop"?Ra({x:h+f/2,y:o+S,horizontalAnchor:"middle",verticalAnchor:T},V):r==="insideBottom"?Ra({x:m+d/2,y:o+c-S,horizontalAnchor:"middle",verticalAnchor:b},V):r==="insideTopLeft"?Ra({x:h+N,y:o+S,horizontalAnchor:R,verticalAnchor:T},V):r==="insideTopRight"?Ra({x:h+f-N,y:o+S,horizontalAnchor:M,verticalAnchor:T},V):r==="insideBottomLeft"?Ra({x:m+N,y:o+c-S,horizontalAnchor:R,verticalAnchor:b},V):r==="insideBottomRight"?Ra({x:m+d-N,y:o+c-S,horizontalAnchor:M,verticalAnchor:b},V):r&&typeof r=="object"&&(qe(r.x)||fl(r.x))&&(qe(r.y)||fl(r.y))?Ra({x:a+Fn(r.x,w),y:o+Fn(r.y,c),horizontalAnchor:"end",verticalAnchor:"end"},V):Ra({x:E,y:o+c/2,horizontalAnchor:"middle",verticalAnchor:"middle"},V)},YX=["labelRef"],ZX=["content"];function KS(e,t){if(e==null)return{};var r,n,i=qX(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function qX(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function YS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Uu(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?YS(Object(r),!0).forEach(function(n){QX(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):YS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function QX(e,t,r){return(t=JX(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function JX(e){var t=eK(e,"string");return typeof t=="symbol"?t:t+""}function eK(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ns(){return ns=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ns.apply(null,arguments)}var iN=I.createContext(null),tK=e=>{var{x:t,y:r,upperWidth:n,lowerWidth:i,width:a,height:o,children:c}=e,f=I.useMemo(()=>({x:t,y:r,upperWidth:n,lowerWidth:i,width:a,height:o}),[t,r,n,i,a,o]);return I.createElement(iN.Provider,{value:f},c)},aN=()=>{var e=I.useContext(iN),t=wp();return e||(t?ly(t):void 0)},rK=I.createContext(null),nK=()=>{var e=I.useContext(rK),t=Je($I);return e||t},iK=e=>{var{value:t,formatter:r}=e,n=cn(e.children)?t:e.children;return typeof r=="function"?r(n):n},Sw=e=>e!=null&&typeof e=="function",aK=(e,t)=>{var r=sn(t-e),n=Math.min(Math.abs(t-e),360);return r*n},sK=(e,t,r,n,i)=>{var{offset:a,className:o}=e,{cx:c,cy:f,innerRadius:d,outerRadius:h,startAngle:m,endAngle:v,clockWise:w}=i,E=(d+h)/2,A=aK(m,v),S=A>=0?1:-1,b,T;switch(t){case"insideStart":b=m+S*a,T=w;break;case"insideEnd":b=v-S*a,T=!w;break;case"end":b=v+S*a,T=w;break;default:throw new Error("Unsupported position ".concat(t))}T=A<=0?T:!T;var _=Fr(c,f,E,b),N=Fr(c,f,E,b+(T?1:-1)*359),M="M".concat(_.x,",").concat(_.y,`
    A`).concat(E,",").concat(E,",0,1,").concat(T?0:1,`,
    `).concat(N.x,",").concat(N.y),R=cn(e.id)?k0("recharts-radial-line-"):e.id;return I.createElement("text",ns({},n,{dominantBaseline:"central",className:Bt("recharts-radial-bar-label",o)}),I.createElement("defs",null,I.createElement("path",{id:R,d:M})),I.createElement("textPath",{xlinkHref:"#".concat(R)},r))},oK=(e,t,r)=>{var{cx:n,cy:i,innerRadius:a,outerRadius:o,startAngle:c,endAngle:f}=e,d=(c+f)/2;if(r==="outside"){var{x:h,y:m}=Fr(n,i,o+t,d);return{x:h,y:m,textAnchor:h>=n?"start":"end",verticalAnchor:"middle"}}if(r==="center")return{x:n,y:i,textAnchor:"middle",verticalAnchor:"middle"};if(r==="centerTop")return{x:n,y:i,textAnchor:"middle",verticalAnchor:"start"};if(r==="centerBottom")return{x:n,y:i,textAnchor:"middle",verticalAnchor:"end"};var v=(a+o)/2,{x:w,y:E}=Fr(n,i,v,d);return{x:w,y:E,textAnchor:"middle",verticalAnchor:"middle"}},Xd=e=>e!=null&&"cx"in e&&qe(e.cx),lK={angle:0,offset:5,zIndex:wn.label,position:"middle",textBreakAll:!1};function cK(e){if(!Xd(e))return e;var{cx:t,cy:r,outerRadius:n}=e,i=n*2;return{x:t-n,y:r-n,width:i,upperWidth:i,lowerWidth:i,height:i}}function Ys(e){var t=un(e,lK),{viewBox:r,parentViewBox:n,position:i,value:a,children:o,content:c,className:f="",textBreakAll:d,labelRef:h}=t,m=nK(),v=aN(),w=i==="center"?v:m??v,E,A,S;r==null?E=w:Xd(r)?E=r:E=ly(r);var b=cK(E);if(!E||cn(a)&&cn(o)&&!I.isValidElement(c)&&typeof c!="function")return null;var T=Uu(Uu({},t),{},{viewBox:E});if(I.isValidElement(c)){var{labelRef:_}=T,N=KS(T,YX);return I.cloneElement(c,N)}if(typeof c=="function"){var{content:M}=T,R=KS(T,ZX);if(A=I.createElement(c,R),I.isValidElement(A))return A}else A=iK(t);var P=Qi(t);if(Xd(E)){if(i==="insideStart"||i==="insideEnd"||i==="end")return sK(t,i,A,P,E);S=oK(E,t.offset,t.position)}else{if(!b)return null;var z=KX({viewBox:b,position:i,offset:t.offset,parentViewBox:Xd(n)?void 0:n});S=Uu(Uu({x:z.x,y:z.y,textAnchor:z.horizontalAnchor,verticalAnchor:z.verticalAnchor},z.width!==void 0?{width:z.width}:{}),z.height!==void 0?{height:z.height}:{})}return I.createElement(Ta,{zIndex:t.zIndex},I.createElement(Gp,ns({ref:h,className:Bt("recharts-label",f)},P,S,{textAnchor:UX(P.textAnchor)?P.textAnchor:S.textAnchor,breakAll:d}),A))}Ys.displayName="Label";var uK=(e,t,r)=>{if(!e)return null;var n={viewBox:t,labelRef:r};return e===!0?I.createElement(Ys,ns({key:"label-implicit"},n)):Ga(e)?I.createElement(Ys,ns({key:"label-implicit",value:e},n)):I.isValidElement(e)?e.type===Ys?I.cloneElement(e,Uu({key:"label-implicit"},n)):I.createElement(Ys,ns({key:"label-implicit",content:e},n)):Sw(e)?I.createElement(Ys,ns({key:"label-implicit",content:e},n)):e&&typeof e=="object"?I.createElement(Ys,ns({},e,{key:"label-implicit"},n)):null};function fK(e){var{label:t,labelRef:r}=e,n=aN();return uK(t,n,r)||null}var sN={},oN={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r[r.length-1]}e.last=t})(oN);var lN={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Array.isArray(r)?r:Array.from(r)}e.toArray=t})(lN);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=oN,r=lN,n=rp;function i(a){if(n.isArrayLike(a))return t.last(r.toArray(a))}e.last=i})(sN);var dK=sN.last;const hK=bs(dK);var pK=["valueAccessor"],gK=["dataKey","clockWise","id","textBreakAll","zIndex"];function h1(){return h1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},h1.apply(null,arguments)}function ZS(e,t){if(e==null)return{};var r,n,i=mK(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function mK(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var xK=e=>Array.isArray(e.value)?hK(e.value):e.value,cN=I.createContext(void 0),vK=cN.Provider,uN=I.createContext(void 0),yK=uN.Provider;function wK(){return I.useContext(cN)}function EK(){return I.useContext(uN)}function Kd(e){var{valueAccessor:t=xK}=e,r=ZS(e,pK),{dataKey:n,clockWise:i,id:a,textBreakAll:o,zIndex:c}=r,f=ZS(r,gK),d=wK(),h=EK(),m=d||h;return!m||!m.length?null:I.createElement(Ta,{zIndex:c??wn.label},I.createElement(Yn,{className:"recharts-label-list"},m.map((v,w)=>{var E,A=cn(n)?t(v,w):ar(v.payload,n),S=cn(a)?{}:{id:"".concat(a,"-").concat(w)};return I.createElement(Ys,h1({key:"label-".concat(w)},Qi(v),f,S,{fill:(E=r.fill)!==null&&E!==void 0?E:v.fill,parentViewBox:v.parentViewBox,value:A,textBreakAll:o,viewBox:v.viewBox,index:w,zIndex:0}))})))}Kd.displayName="LabelList";function fN(e){var{label:t}=e;return t?t===!0?I.createElement(Kd,{key:"labelList-implicit"}):I.isValidElement(t)||Sw(t)?I.createElement(Kd,{key:"labelList-implicit",content:t}):typeof t=="object"?I.createElement(Kd,h1({key:"labelList-implicit"},t,{type:String(t.type)})):null:null}var dN=e=>e.graphicalItems.polarItems,AK=ve([xr,yf],Xy),$p=ve([dN,Or,AK],Yy),CK=ve([$p],Zy),Xp=ve([CK,Dp],qy),SK=ve([Xp,Or,$p],Jy);ve([Xp,Or,$p],(e,t,r)=>r.length>0?e.flatMap(n=>r.flatMap(i=>{var a,o=ar(n,(a=t.dataKey)!==null&&a!==void 0?a:i.dataKey);return{value:o,errorDomain:[]}})).filter(Boolean):(t==null?void 0:t.dataKey)!=null?e.map(n=>({value:ar(n,t.dataKey),errorDomain:[]})):e.map(n=>({value:n,errorDomain:[]})));var qS=()=>{},_K=ve([Xp,Or,$p,zp,xr],nw),bK=ve([Or,tw,rw,qS,_K,qS,Dt,xr],iw),hN=ve([Or,Dt,Xp,SK,vf,xr,bK],aw),TK=ve([hN,qc,Oo],lw),OK=ve([Or,hN,TK,xr],uw);ve([Oo,OK],KI);var kK={radiusAxis:{},angleAxis:{}},pN=hi({name:"polarAxis",initialState:kK,reducers:{addRadiusAxis(e,t){e.radiusAxis[t.payload.id]=t.payload},removeRadiusAxis(e,t){delete e.radiusAxis[t.payload.id]},addAngleAxis(e,t){e.angleAxis[t.payload.id]=t.payload},removeAngleAxis(e,t){delete e.angleAxis[t.payload.id]}}}),{addRadiusAxis:yce,removeRadiusAxis:wce,addAngleAxis:Ece,removeAngleAxis:Ace}=pN.actions,IK=pN.reducer;function gN(e){return e&&typeof e=="object"&&"className"in e&&typeof e.className=="string"?e.className:""}function QS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function JS(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?QS(Object(r),!0).forEach(function(n){NK(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):QS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function NK(e,t,r){return(t=PK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function PK(e){var t=DK(e,"string");return typeof t=="symbol"?t:t+""}function DK(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var RK=(e,t)=>t,_w=ve([dN,RK],(e,t)=>e.filter(r=>r.type==="pie").find(r=>r.id===t)),MK=[],bw=(e,t,r)=>(r==null?void 0:r.length)===0?MK:r,mN=ve([Dp,_w,bw],(e,t,r)=>{var{chartData:n}=e;if(t!=null){var i;if((t==null?void 0:t.data)!=null&&t.data.length>0?i=t.data:i=n,(!i||!i.length)&&r!=null&&(i=r.map(a=>JS(JS({},t.presentationProps),a.props))),i!=null)return i}}),FK=ve([mN,_w,bw],(e,t,r)=>{if(!(e==null||t==null))return e.map((n,i)=>{var a,o=ar(n,t.nameKey,t.name),c;return r!=null&&(a=r[i])!==null&&a!==void 0&&(a=a.props)!==null&&a!==void 0&&a.fill?c=r[i].props.fill:typeof n=="object"&&n!=null&&"fill"in n?c=n.fill:c=t.fill,{value:gp(o,t.dataKey),color:c,payload:n,type:t.legendType}})}),LK=ve([mN,_w,bw,Kr],(e,t,r,n)=>{if(!(t==null||e==null))return BY({offset:n,pieSettings:t,displayedData:e,cells:r})}),xN={exports:{}},Gt={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Tw=Symbol.for("react.transitional.element"),Ow=Symbol.for("react.portal"),Kp=Symbol.for("react.fragment"),Yp=Symbol.for("react.strict_mode"),Zp=Symbol.for("react.profiler"),qp=Symbol.for("react.consumer"),Qp=Symbol.for("react.context"),Jp=Symbol.for("react.forward_ref"),eg=Symbol.for("react.suspense"),tg=Symbol.for("react.suspense_list"),rg=Symbol.for("react.memo"),ng=Symbol.for("react.lazy"),BK=Symbol.for("react.view_transition"),jK=Symbol.for("react.client.reference");function na(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case Tw:switch(e=e.type,e){case Kp:case Zp:case Yp:case eg:case tg:case BK:return e;default:switch(e=e&&e.$$typeof,e){case Qp:case Jp:case ng:case rg:return e;case qp:return e;default:return t}}case Ow:return t}}}Gt.ContextConsumer=qp;Gt.ContextProvider=Qp;Gt.Element=Tw;Gt.ForwardRef=Jp;Gt.Fragment=Kp;Gt.Lazy=ng;Gt.Memo=rg;Gt.Portal=Ow;Gt.Profiler=Zp;Gt.StrictMode=Yp;Gt.Suspense=eg;Gt.SuspenseList=tg;Gt.isContextConsumer=function(e){return na(e)===qp};Gt.isContextProvider=function(e){return na(e)===Qp};Gt.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===Tw};Gt.isForwardRef=function(e){return na(e)===Jp};Gt.isFragment=function(e){return na(e)===Kp};Gt.isLazy=function(e){return na(e)===ng};Gt.isMemo=function(e){return na(e)===rg};Gt.isPortal=function(e){return na(e)===Ow};Gt.isProfiler=function(e){return na(e)===Zp};Gt.isStrictMode=function(e){return na(e)===Yp};Gt.isSuspense=function(e){return na(e)===eg};Gt.isSuspenseList=function(e){return na(e)===tg};Gt.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===Kp||e===Zp||e===Yp||e===eg||e===tg||typeof e=="object"&&e!==null&&(e.$$typeof===ng||e.$$typeof===rg||e.$$typeof===Qp||e.$$typeof===qp||e.$$typeof===Jp||e.$$typeof===jK||e.getModuleId!==void 0)};Gt.typeOf=na;xN.exports=Gt;var UK=xN.exports,e_=e=>typeof e=="string"?e:e?e.displayName||e.name||"Component":"",t_=null,gm=null,vN=e=>{if(e===t_&&Array.isArray(gm))return gm;var t=[];return I.Children.forEach(e,r=>{cn(r)||(UK.isFragment(r)?t=t.concat(vN(r.props.children)):t.push(r))}),gm=t,t_=e,t};function kw(e,t){var r=[],n=[];return Array.isArray(t)?n=t.map(i=>e_(i)):n=[e_(t)],vN(e).forEach(i=>{var a=ul(i,"type.displayName")||ul(i,"type.name");a&&n.indexOf(a)!==-1&&r.push(i)}),r}var yN={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){var i;if(typeof r!="object"||r==null)return!1;if(Object.getPrototypeOf(r)===null)return!0;if(Object.prototype.toString.call(r)!=="[object Object]"){const a=r[Symbol.toStringTag];return a==null||!((i=Object.getOwnPropertyDescriptor(r,Symbol.toStringTag))!=null&&i.writable)?!1:r.toString()===`[object ${a}]`}let n=r;for(;Object.getPrototypeOf(n)!==null;)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(r)===n}e.isPlainObject=t})(yN);var zK=yN.isPlainObject;const WK=bs(zK);var r_,n_,i_,a_,s_;function o_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function l_(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?o_(Object(r),!0).forEach(function(n){VK(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function VK(e,t,r){return(t=HK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function HK(e){var t=GK(e,"string");return typeof t=="symbol"?t:t+""}function GK(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function p1(){return p1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},p1.apply(null,arguments)}function Du(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var c_=(e,t,r,n,i)=>{var a=r-n,o;return o=Cr(r_||(r_=Du(["M ",",",""])),e,t),o+=Cr(n_||(n_=Du(["L ",",",""])),e+r,t),o+=Cr(i_||(i_=Du(["L ",",",""])),e+r-a/2,t+i),o+=Cr(a_||(a_=Du(["L ",",",""])),e+r-a/2-n,t+i),o+=Cr(s_||(s_=Du(["L ",","," Z"])),e,t),o},$K={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},XK=e=>{var t=un(e,$K),{x:r,y:n,upperWidth:i,lowerWidth:a,height:o,className:c}=t,{animationEasing:f,animationDuration:d,animationBegin:h,isUpdateAnimationActive:m}=t,v=I.useRef(null),[w,E]=I.useState(-1),A=I.useRef(i),S=I.useRef(a),b=I.useRef(o),T=I.useRef(r),_=I.useRef(n),N=bp(e,"trapezoid-");if(I.useEffect(()=>{if(v.current&&v.current.getTotalLength)try{var pe=v.current.getTotalLength();pe&&E(pe)}catch{}},[]),r!==+r||n!==+n||i!==+i||a!==+a||o!==+o||i===0&&a===0||o===0)return null;var M=Bt("recharts-trapezoid",c);if(!m)return I.createElement("g",null,I.createElement("path",p1({},Qi(t),{className:M,d:c_(r,n,i,a,o)})));var R=A.current,P=S.current,z=b.current,B=T.current,re=_.current,ee="0px ".concat(w===-1?1:w,"px"),V="".concat(w,"px 0px"),de=Rk(["strokeDasharray"],d,f);return I.createElement(_p,{animationId:N,key:N,canBegin:w>0,duration:d,easing:f,isActive:m,begin:h},pe=>{var K=Vr(R,i,pe),Ce=Vr(P,a,pe),ue=Vr(z,o,pe),se=Vr(B,r,pe),q=Vr(re,n,pe);v.current&&(A.current=K,S.current=Ce,b.current=ue,T.current=se,_.current=q);var fe=pe>0?{transition:de,strokeDasharray:V}:{strokeDasharray:ee};return I.createElement("path",p1({},Qi(t),{className:M,d:c_(se,q,K,Ce,ue),ref:v,style:l_(l_({},fe),t.style)}))})},KK=["option","shapeType","activeClassName"];function YK(e,t){if(e==null)return{};var r,n,i=ZK(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function ZK(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function u_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function g1(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?u_(Object(r),!0).forEach(function(n){qK(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function qK(e,t,r){return(t=QK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function QK(e){var t=JK(e,"string");return typeof t=="symbol"?t:t+""}function JK(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function eY(e,t){return g1(g1({},t),e)}function tY(e,t){return e==="symbols"}function f_(e){var{shapeType:t,elementProps:r}=e;switch(t){case"rectangle":return I.createElement(Bk,r);case"trapezoid":return I.createElement(XK,r);case"sector":return I.createElement(Wk,r);case"symbols":if(tY(t))return I.createElement(W2,r);break;case"curve":return I.createElement(hy,r);default:return null}}function rY(e){return I.isValidElement(e)?e.props:e}function wN(e){var{option:t,shapeType:r,activeClassName:n="recharts-active-shape"}=e,i=YK(e,KK),a;if(I.isValidElement(t))a=I.cloneElement(t,g1(g1({},i),rY(t)));else if(typeof t=="function")a=t(i,i.index);else if(WK(t)&&typeof t!="boolean"){var o=eY(t,i);a=I.createElement(f_,{shapeType:r,elementProps:o})}else{var c=i;a=I.createElement(f_,{shapeType:r,elementProps:c})}return i.isActive?I.createElement(Yn,{className:n},a):a}var Iw=(e,t,r)=>{var n=Qt();return(i,a)=>o=>{e==null||e(i,a,o),n(S6({activeIndex:String(a),activeDataKey:t,activeCoordinate:i.tooltipPosition,activeGraphicalItemId:r}))}},Nw=e=>{var t=Qt();return(r,n)=>i=>{e==null||e(r,n,i),t(fG())}},Pw=(e,t,r)=>{var n=Qt();return(i,a)=>o=>{e==null||e(i,a,o),n(dG({activeIndex:String(a),activeDataKey:t,activeCoordinate:i.tooltipPosition,activeGraphicalItemId:r}))}};function EN(e){var{tooltipEntrySettings:t}=e,r=Qt(),n=pi(),i=I.useRef(null);return I.useLayoutEffect(()=>{n||(i.current===null?r(oG(t)):i.current!==t&&r(lG({prev:i.current,next:t})),i.current=t)},[t,r,n]),I.useLayoutEffect(()=>()=>{i.current&&(r(cG(i.current)),i.current=null)},[r]),null}function nY(e){var{legendPayload:t}=e,r=Qt(),n=pi(),i=I.useRef(null);return I.useLayoutEffect(()=>{n||(i.current===null?r(kk(t)):i.current!==t&&r(Ik({prev:i.current,next:t})),i.current=t)},[r,n,t]),I.useLayoutEffect(()=>()=>{i.current&&(r(Nk(i.current)),i.current=null)},[r]),null}function iY(e){var{legendPayload:t}=e,r=Qt(),n=Je(Dt),i=I.useRef(null);return I.useLayoutEffect(()=>{n!=="centric"&&n!=="radial"||(i.current===null?r(kk(t)):i.current!==t&&r(Ik({prev:i.current,next:t})),i.current=t)},[r,n,t]),I.useLayoutEffect(()=>()=>{i.current&&(r(Nk(i.current)),i.current=null)},[r]),null}var mm,aY=()=>{var[e]=I.useState(()=>k0("uid-"));return e},sY=(mm=TD.useId)!==null&&mm!==void 0?mm:aY;function oY(e,t){var r=sY();return t||(e?"".concat(e,"-").concat(r):r)}var lY=I.createContext(void 0),AN=e=>{var{id:t,type:r,children:n}=e,i=oY("recharts-".concat(r),t);return I.createElement(lY.Provider,{value:i},n(i))},cY={cartesianItems:[],polarItems:[]},CN=hi({name:"graphicalItems",initialState:cY,reducers:{addCartesianGraphicalItem:{reducer(e,t){e.cartesianItems.push(t.payload)},prepare:lr()},replaceCartesianGraphicalItem:{reducer(e,t){var{prev:r,next:n}=t.payload,i=Ea(e).cartesianItems.indexOf(r);i>-1&&(e.cartesianItems[i]=n)},prepare:lr()},removeCartesianGraphicalItem:{reducer(e,t){var r=Ea(e).cartesianItems.indexOf(t.payload);r>-1&&e.cartesianItems.splice(r,1)},prepare:lr()},addPolarGraphicalItem:{reducer(e,t){e.polarItems.push(t.payload)},prepare:lr()},removePolarGraphicalItem:{reducer(e,t){var r=Ea(e).polarItems.indexOf(t.payload);r>-1&&e.polarItems.splice(r,1)},prepare:lr()}}}),{addCartesianGraphicalItem:uY,replaceCartesianGraphicalItem:fY,removeCartesianGraphicalItem:dY,addPolarGraphicalItem:hY,removePolarGraphicalItem:pY}=CN.actions,gY=CN.reducer,mY=e=>{var t=Qt(),r=I.useRef(null);return I.useLayoutEffect(()=>{r.current===null?t(uY(e)):r.current!==e&&t(fY({prev:r.current,next:e})),r.current=e},[t,e]),I.useLayoutEffect(()=>()=>{r.current&&(t(dY(r.current)),r.current=null)},[t]),null},xY=I.memo(mY);function vY(e){var t=Qt();return I.useLayoutEffect(()=>(t(hY(e)),()=>{t(pY(e))}),[t,e]),null}var yY=["key"],wY=["onMouseEnter","onClick","onMouseLeave"],EY=["id"],AY=["id"];function d_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function _r(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?d_(Object(r),!0).forEach(function(n){CY(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function CY(e,t,r){return(t=SY(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function SY(e){var t=_Y(e,"string");return typeof t=="symbol"?t:t+""}function _Y(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yo(){return yo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},yo.apply(null,arguments)}function ig(e,t){if(e==null)return{};var r,n,i=bY(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function bY(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function TY(e){var t=I.useMemo(()=>kw(e.children,_f),[e.children]),r=Je(n=>FK(n,e.id,t));return r==null?null:I.createElement(iY,{legendPayload:r})}var OY=I.memo(e=>{var{dataKey:t,nameKey:r,sectors:n,stroke:i,strokeWidth:a,fill:o,name:c,hide:f,tooltipType:d,id:h}=e,m={dataDefinedOnItem:n.map(v=>v.tooltipPayload),getPosition:v=>{var w;return(w=n[Number(v)])===null||w===void 0?void 0:w.tooltipPosition},settings:{stroke:i,strokeWidth:a,fill:o,dataKey:t,nameKey:r,name:gp(c,t),hide:f,type:d,color:o,unit:"",graphicalItemId:h}};return I.createElement(EN,{tooltipEntrySettings:m})}),kY=(e,t)=>e>t?"start":e<t?"end":"middle",IY=(e,t,r)=>Fn(typeof t=="function"?t(e):t,r,r*.8),NY=(e,t,r)=>{var{top:n,left:i,width:a,height:o}=t,c=jk(a,o),f=i+Fn(e.cx,a,a/2),d=n+Fn(e.cy,o,o/2),h=Fn(e.innerRadius,c,0),m=IY(r,e.outerRadius,c),v=e.maxRadius||Math.sqrt(a*a+o*o)/2;return{cx:f,cy:d,innerRadius:h,outerRadius:m,maxRadius:v}},PY=(e,t)=>{var r=sn(t-e),n=Math.min(Math.abs(t-e),360);return r*n},DY=(e,t)=>{if(I.isValidElement(e))return I.cloneElement(e,t);if(typeof e=="function")return e(t);var r=Bt("recharts-pie-label-line",typeof e!="boolean"?e.className:""),{key:n}=t,i=ig(t,yY);return I.createElement(hy,yo({},i,{type:"linear",className:r}))},RY=(e,t,r)=>{if(I.isValidElement(e))return I.cloneElement(e,t);var n=r;if(typeof e=="function"&&(n=e(t),I.isValidElement(n)))return n;var i=Bt("recharts-pie-label-text",gN(e));return I.createElement(Gp,yo({},t,{alignmentBaseline:"middle",className:i}),n)};function MY(e){var{sectors:t,props:r,showLabels:n}=e,{label:i,labelLine:a,dataKey:o}=r;if(!n||!i||!t)return null;var c=Sa(r),f=O0(i),d=O0(a),h=typeof i=="object"&&"offsetRadius"in i&&typeof i.offsetRadius=="number"&&i.offsetRadius||20,m=t.map((v,w)=>{var E=(v.startAngle+v.endAngle)/2,A=Fr(v.cx,v.cy,v.outerRadius+h,E),S=_r(_r(_r(_r({},c),v),{},{stroke:"none"},f),{},{index:w,textAnchor:kY(A.x,v.cx)},A),b=_r(_r(_r(_r({},c),v),{},{fill:"none",stroke:v.fill},d),{},{index:w,points:[Fr(v.cx,v.cy,v.outerRadius,E),A],key:"line"});return I.createElement(Ta,{zIndex:wn.label,key:"label-".concat(v.startAngle,"-").concat(v.endAngle,"-").concat(v.midAngle,"-").concat(w)},I.createElement(Yn,null,a&&DY(a,b),RY(i,S,ar(v,o))))});return I.createElement(Yn,{className:"recharts-pie-labels"},m)}function FY(e){var{sectors:t,props:r,showLabels:n}=e,{label:i}=r;return typeof i=="object"&&i!=null&&"position"in i?I.createElement(fN,{label:i}):I.createElement(MY,{sectors:t,props:r,showLabels:n})}function LY(e){var{sectors:t,activeShape:r,inactiveShape:n,allOtherPieProps:i,shape:a,id:o}=e,c=Je(ml),f=Je(yw),d=Je(qG),{onMouseEnter:h,onClick:m,onMouseLeave:v}=i,w=ig(i,wY),E=Iw(h,i.dataKey,o),A=Nw(v),S=Pw(m,i.dataKey,o);return t==null||t.length===0?null:I.createElement(I.Fragment,null,t.map((b,T)=>{if((b==null?void 0:b.startAngle)===0&&(b==null?void 0:b.endAngle)===0&&t.length!==1)return null;var _=d==null||d===o,N=String(T)===c&&(f==null||i.dataKey===f)&&_,M=c?n:null,R=r&&N?r:M,P=_r(_r({},b),{},{stroke:b.stroke,tabIndex:-1,[fk]:T,[dk]:o});return I.createElement(Yn,yo({key:"sector-".concat(b==null?void 0:b.startAngle,"-").concat(b==null?void 0:b.endAngle,"-").concat(b.midAngle,"-").concat(T),tabIndex:-1,className:"recharts-pie-sector"},lf(w,b,T),{onMouseEnter:E(b,T),onMouseLeave:A(b,T),onClick:S(b,T)}),I.createElement(wN,yo({option:a??R,index:T,shapeType:"sector",isActive:N},P)))}))}function BY(e){var t,{pieSettings:r,displayedData:n,cells:i,offset:a}=e,{cornerRadius:o,startAngle:c,endAngle:f,dataKey:d,nameKey:h,tooltipType:m}=r,v=Math.abs(r.minAngle),w=PY(c,f),E=Math.abs(w),A=n.length<=1?0:(t=r.paddingAngle)!==null&&t!==void 0?t:0,S=n.filter(R=>ar(R,d,0)!==0).length,b=(E>=360?S:S-1)*A,T=E-S*v-b,_=n.reduce((R,P)=>{var z=ar(P,d,0);return R+(qe(z)?z:0)},0),N;if(_>0){var M;N=n.map((R,P)=>{var z=ar(R,d,0),B=ar(R,h,P),re=NY(r,a,R),ee=(qe(z)?z:0)/_,V,de=_r(_r({},R),i&&i[P]&&i[P].props);P?V=M.endAngle+sn(w)*A*(z!==0?1:0):V=c;var pe=V+sn(w)*((z!==0?v:0)+ee*T),K=(V+pe)/2,Ce=(re.innerRadius+re.outerRadius)/2,ue=[{name:B,value:z,payload:de,dataKey:d,type:m,graphicalItemId:r.id}],se=Fr(re.cx,re.cy,Ce,K);return M=_r(_r(_r(_r({},r.presentationProps),{},{percent:ee,cornerRadius:typeof o=="string"?parseFloat(o):o,name:B,tooltipPayload:ue,midAngle:K,middleRadius:Ce,tooltipPosition:se},de),re),{},{value:z,dataKey:d,startAngle:V,endAngle:pe,payload:de,paddingAngle:sn(w)*A}),M})}return N}function jY(e){var{showLabels:t,sectors:r,children:n}=e,i=I.useMemo(()=>!t||!r?[]:r.map(a=>({value:a.value,payload:a.payload,clockWise:!1,parentViewBox:void 0,viewBox:{cx:a.cx,cy:a.cy,innerRadius:a.innerRadius,outerRadius:a.outerRadius,startAngle:a.startAngle,endAngle:a.endAngle,clockWise:!1},fill:a.fill})),[r,t]);return I.createElement(yK,{value:t?i:void 0},n)}function UY(e){var{props:t,previousSectorsRef:r,id:n}=e,{sectors:i,isAnimationActive:a,animationBegin:o,animationDuration:c,animationEasing:f,activeShape:d,inactiveShape:h,onAnimationStart:m,onAnimationEnd:v}=t,w=bp(t,"recharts-pie-"),E=r.current,[A,S]=I.useState(!1),b=I.useCallback(()=>{typeof v=="function"&&v(),S(!1)},[v]),T=I.useCallback(()=>{typeof m=="function"&&m(),S(!0)},[m]);return I.createElement(jY,{showLabels:!A,sectors:i},I.createElement(_p,{animationId:w,begin:o,duration:c,isActive:a,easing:f,onAnimationStart:T,onAnimationEnd:b,key:w},_=>{var N,M=[],R=i&&i[0],P=(N=R==null?void 0:R.startAngle)!==null&&N!==void 0?N:0;return i==null||i.forEach((z,B)=>{var re=E&&E[B],ee=B>0?ul(z,"paddingAngle",0):0;if(re){var V=Vr(re.endAngle-re.startAngle,z.endAngle-z.startAngle,_),de=_r(_r({},z),{},{startAngle:P+ee,endAngle:P+V+ee});M.push(de),P=de.endAngle}else{var{endAngle:pe,startAngle:K}=z,Ce=Vr(0,pe-K,_),ue=_r(_r({},z),{},{startAngle:P+ee,endAngle:P+Ce+ee});M.push(ue),P=ue.endAngle}}),r.current=M,I.createElement(Yn,null,I.createElement(LY,{sectors:M,activeShape:d,inactiveShape:h,allOtherPieProps:t,shape:t.shape,id:n}))}),I.createElement(FY,{showLabels:!A,sectors:i,props:t}),t.children)}var zY={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:"auto",label:!1,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff",zIndex:wn.area};function WY(e){var{id:t}=e,r=ig(e,EY),{hide:n,className:i,rootTabIndex:a}=e,o=I.useMemo(()=>kw(e.children,_f),[e.children]),c=Je(h=>LK(h,t,o)),f=I.useRef(null),d=Bt("recharts-pie",i);return n||c==null?(f.current=null,I.createElement(Yn,{tabIndex:a,className:d})):I.createElement(Ta,{zIndex:e.zIndex},I.createElement(OY,{dataKey:e.dataKey,nameKey:e.nameKey,sectors:c,stroke:e.stroke,strokeWidth:e.strokeWidth,fill:e.fill,name:e.name,hide:e.hide,tooltipType:e.tooltipType,id:t}),I.createElement(Yn,{tabIndex:a,className:d},I.createElement(UY,{props:_r(_r({},r),{},{sectors:c}),previousSectorsRef:f,id:t})))}function SN(e){var t=un(e,zY),{id:r}=t,n=ig(t,AY),i=Sa(n);return I.createElement(AN,{id:r,type:"pie"},a=>I.createElement(I.Fragment,null,I.createElement(vY,{type:"pie",id:a,data:n.data,dataKey:n.dataKey,hide:n.hide,angleAxisId:0,radiusAxisId:0,name:n.name,nameKey:n.nameKey,tooltipType:n.tooltipType,legendType:n.legendType,fill:n.fill,cx:n.cx,cy:n.cy,startAngle:n.startAngle,endAngle:n.endAngle,paddingAngle:n.paddingAngle,minAngle:n.minAngle,innerRadius:n.innerRadius,outerRadius:n.outerRadius,cornerRadius:n.cornerRadius,presentationProps:i,maxRadius:t.maxRadius}),I.createElement(TY,yo({},n,{id:a})),I.createElement(WY,yo({},n,{id:a}))))}SN.displayName="Pie";function h_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function p_(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?h_(Object(r),!0).forEach(function(n){VY(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function VY(e,t,r){return(t=HY(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function HY(e){var t=GY(e,"string");return typeof t=="symbol"?t:t+""}function GY(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var _N=0,$Y={xAxis:{},yAxis:{},zAxis:{}},bN=hi({name:"cartesianAxis",initialState:$Y,reducers:{addXAxis:{reducer(e,t){e.xAxis[t.payload.id]=t.payload},prepare:lr()},replaceXAxis:{reducer(e,t){var{prev:r,next:n}=t.payload;e.xAxis[r.id]!==void 0&&(r.id!==n.id&&delete e.xAxis[r.id],e.xAxis[n.id]=n)},prepare:lr()},removeXAxis:{reducer(e,t){delete e.xAxis[t.payload.id]},prepare:lr()},addYAxis:{reducer(e,t){e.yAxis[t.payload.id]=t.payload},prepare:lr()},replaceYAxis:{reducer(e,t){var{prev:r,next:n}=t.payload;e.yAxis[r.id]!==void 0&&(r.id!==n.id&&delete e.yAxis[r.id],e.yAxis[n.id]=n)},prepare:lr()},removeYAxis:{reducer(e,t){delete e.yAxis[t.payload.id]},prepare:lr()},addZAxis:{reducer(e,t){e.zAxis[t.payload.id]=t.payload},prepare:lr()},replaceZAxis:{reducer(e,t){var{prev:r,next:n}=t.payload;e.zAxis[r.id]!==void 0&&(r.id!==n.id&&delete e.zAxis[r.id],e.zAxis[n.id]=n)},prepare:lr()},removeZAxis:{reducer(e,t){delete e.zAxis[t.payload.id]},prepare:lr()},updateYAxisWidth(e,t){var{id:r,width:n}=t.payload,i=e.yAxis[r];if(i){var a,o=i.widthHistory||[];if(o.length===3&&o[0]===o[2]&&n===o[1]&&n!==i.width&&Math.abs(n-((a=o[0])!==null&&a!==void 0?a:0))<=1)return;var c=[...o,n].slice(-3);e.yAxis[r]=p_(p_({},i),{},{width:n,widthHistory:c})}}}}),{addXAxis:XY,replaceXAxis:KY,removeXAxis:YY,addYAxis:ZY,replaceYAxis:qY,removeYAxis:QY,addZAxis:Cce,replaceZAxis:Sce,removeZAxis:_ce,updateYAxisWidth:JY}=bN.actions,eZ=bN.reducer,tZ=ve([Kr],e=>({top:e.top,bottom:e.bottom,left:e.left,right:e.right})),rZ=ve([tZ,Os,ks],(e,t,r)=>{if(!(!e||t==null||r==null))return{x:e.left,y:e.top,width:Math.max(0,t-e.left-e.right),height:Math.max(0,r-e.top-e.bottom)}}),TN=()=>Je(rZ),g_=(e,t,r)=>{var n=r??e;if(!cn(n))return Fn(n,t,0)},nZ=(e,t,r)=>{var n={},i=e.filter(Lp),a=e.filter(d=>d.stackId==null),o=i.reduce((d,h)=>{var m=d[h.stackId];return m==null&&(m=[]),m.push(h),d[h.stackId]=m,d},n),c=Object.entries(o).map(d=>{var h,[m,v]=d,w=v.map(A=>A.dataKey),E=g_(t,r,(h=v[0])===null||h===void 0?void 0:h.barSize);return{stackId:m,dataKeys:w,barSize:E}}),f=a.map(d=>{var h=[d.dataKey].filter(v=>v!=null),m=g_(t,r,d.barSize);return{stackId:void 0,dataKeys:h,barSize:m}});return[...c,...f]};function m_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function yd(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?m_(Object(r),!0).forEach(function(n){iZ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function iZ(e,t,r){return(t=aZ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function aZ(e){var t=sZ(e,"string");return typeof t=="symbol"?t:t+""}function sZ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function oZ(e,t,r,n,i){var a,o=n.length;if(!(o<1)){var c=Fn(e,r,0,!0),f,d=[];if(St((a=n[0])===null||a===void 0?void 0:a.barSize)){var h=!1,m=r/o,v=n.reduce((T,_)=>T+(_.barSize||0),0);v+=(o-1)*c,v>=r&&(v-=(o-1)*c,c=0),v>=r&&m>0&&(h=!0,m*=.9,v=o*m);var w=(r-v)/2>>0,E={offset:w-c,size:0};f=n.reduce((T,_)=>{var N,M={stackId:_.stackId,dataKeys:_.dataKeys,position:{offset:E.offset+E.size+c,size:h?m:(N=_.barSize)!==null&&N!==void 0?N:0}},R=[...T,M];return E=M.position,R},d)}else{var A=Fn(t,r,0,!0);r-2*A-(o-1)*c<=0&&(c=0);var S=(r-2*A-(o-1)*c)/o;S>1&&(S>>=0);var b=St(i)?Math.min(S,i):S;f=n.reduce((T,_,N)=>[...T,{stackId:_.stackId,dataKeys:_.dataKeys,position:{offset:A+(S+c)*N+(S-b)/2,size:b}}],d)}return f}}var lZ=(e,t,r,n,i,a,o)=>{var c=cn(o)?t:o,f=oZ(r,n,i!==a?i:a,e,c);return i!==a&&f!=null&&(f=f.map(d=>yd(yd({},d),{},{position:yd(yd({},d.position),{},{offset:d.position.offset-i/2})}))),f},cZ=(e,t)=>{var r=Gy(t);if(!(!e||r==null||t==null)){var{stackId:n}=t;if(n!=null){var i=e[n];if(i){var{stackedData:a}=i;if(a)return a.find(o=>o.key===r)}}}},uZ=(e,t)=>{if(!(e==null||t==null)){var r=e.find(n=>n.stackId===t.stackId&&t.dataKey!=null&&n.dataKeys.includes(t.dataKey));if(r!=null)return r.position}};function fZ(e,t){return e&&typeof e=="object"&&"zIndex"in e&&typeof e.zIndex=="number"&&St(e.zIndex)?e.zIndex:t}var ON=e=>{var{chartData:t}=e,r=Qt(),n=pi();return I.useEffect(()=>n?()=>{}:(r(NS(t)),()=>{r(NS(void 0))}),[t,r,n]),null},x_={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},kN=hi({name:"brush",initialState:x_,reducers:{setBrushSettings(e,t){return t.payload==null?x_:t.payload}}}),{setBrushSettings:bce}=kN.actions,dZ=kN.reducer;function hZ(e){return(e%180+180)%180}var pZ=function(t){var{width:r,height:n}=t,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=hZ(i),o=a*Math.PI/180,c=Math.atan(n/r),f=o>c&&o<Math.PI-c?n/Math.sin(o):r/Math.cos(o);return Math.abs(f)},gZ={dots:[],areas:[],lines:[]},IN=hi({name:"referenceElements",initialState:gZ,reducers:{addDot:(e,t)=>{e.dots.push(t.payload)},removeDot:(e,t)=>{var r=Ea(e).dots.findIndex(n=>n===t.payload);r!==-1&&e.dots.splice(r,1)},addArea:(e,t)=>{e.areas.push(t.payload)},removeArea:(e,t)=>{var r=Ea(e).areas.findIndex(n=>n===t.payload);r!==-1&&e.areas.splice(r,1)},addLine:(e,t)=>{e.lines.push(t.payload)},removeLine:(e,t)=>{var r=Ea(e).lines.findIndex(n=>n===t.payload);r!==-1&&e.lines.splice(r,1)}}}),{addDot:Tce,removeDot:Oce,addArea:kce,removeArea:Ice,addLine:Nce,removeLine:Pce}=IN.actions,mZ=IN.reducer,xZ=I.createContext(void 0),vZ=e=>{var{children:t}=e,[r]=I.useState("".concat(k0("recharts"),"-clip")),n=TN();if(n==null)return null;var{x:i,y:a,width:o,height:c}=n;return I.createElement(xZ.Provider,{value:r},I.createElement("defs",null,I.createElement("clipPath",{id:r},I.createElement("rect",{x:i,y:a,height:c,width:o}))),t)};function NN(e,t){if(t<1)return[];if(t===1)return e;for(var r=[],n=0;n<e.length;n+=t){var i=e[n];i!==void 0&&r.push(i)}return r}function yZ(e,t,r){var n={width:e.width+t.width,height:e.height+t.height};return pZ(n,r)}function wZ(e,t,r){var n=r==="width",{x:i,y:a,width:o,height:c}=e;return t===1?{start:n?i:a,end:n?i+o:a+c}:{start:n?i+o:a+c,end:n?i:a}}function V0(e,t,r,n,i){if(e*t<e*n||e*t>e*i)return!1;var a=r();return e*(t-e*a/2-n)>=0&&e*(t+e*a/2-i)<=0}function EZ(e,t){return NN(e,t+1)}function AZ(e,t,r,n,i){for(var a=(n||[]).slice(),{start:o,end:c}=t,f=0,d=1,h=o,m=function(){var E=n==null?void 0:n[f];if(E===void 0)return{v:NN(n,d)};var A=f,S,b=()=>(S===void 0&&(S=r(E,A)),S),T=E.coordinate,_=f===0||V0(e,T,b,h,c);_||(f=0,h=o,d+=1),_&&(h=T+e*(b()/2+i),f+=d)},v;d<=a.length;)if(v=m(),v)return v.v;return[]}function CZ(e,t,r,n,i){var a=(n||[]).slice(),o=a.length;if(o===0)return[];for(var{start:c,end:f}=t,d=1;d<=o;d++){for(var h=(o-1)%d,m=c,v=!0,w=function(){var N=n[A];if(N==null)return 0;var M=A,R,P=()=>(R===void 0&&(R=r(N,M)),R),z=N.coordinate,B=A===h||V0(e,z,P,m,f);if(!B)return v=!1,1;B&&(m=z+e*(P()/2+i))},E,A=h;A<o&&(E=w(),!(E!==0&&E===1));A+=d);if(v){for(var S=[],b=h;b<o;b+=d){var T=n[b];T!=null&&S.push(T)}return S}}return[]}function v_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function In(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?v_(Object(r),!0).forEach(function(n){SZ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function SZ(e,t,r){return(t=_Z(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _Z(e){var t=bZ(e,"string");return typeof t=="symbol"?t:t+""}function bZ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function TZ(e,t,r,n,i){for(var a=(n||[]).slice(),o=a.length,{start:c}=t,{end:f}=t,d=function(v){var w=a[v];if(w==null)return 1;var E=w,A,S=()=>(A===void 0&&(A=r(w,v)),A);if(v===o-1){var b=e*(E.coordinate+e*S()/2-f);a[v]=E=In(In({},E),{},{tickCoord:b>0?E.coordinate-b*e:E.coordinate})}else a[v]=E=In(In({},E),{},{tickCoord:E.coordinate});if(E.tickCoord!=null){var T=V0(e,E.tickCoord,S,c,f);T&&(f=E.tickCoord-e*(S()/2+i),a[v]=In(In({},E),{},{isShow:!0}))}},h=o-1;h>=0;h--)d(h);return a}function OZ(e,t,r,n,i,a){var o=(n||[]).slice(),c=o.length,{start:f,end:d}=t;if(a){var h=n[c-1];if(h!=null){var m=r(h,c-1),v=e*(h.coordinate+e*m/2-d);if(o[c-1]=h=In(In({},h),{},{tickCoord:v>0?h.coordinate-v*e:h.coordinate}),h.tickCoord!=null){var w=V0(e,h.tickCoord,()=>m,f,d);w&&(d=h.tickCoord-e*(m/2+i),o[c-1]=In(In({},h),{},{isShow:!0}))}}}for(var E=a?c-1:c,A=function(T){var _=o[T];if(_==null)return 1;var N=_,M,R=()=>(M===void 0&&(M=r(_,T)),M);if(T===0){var P=e*(N.coordinate-e*R()/2-f);o[T]=N=In(In({},N),{},{tickCoord:P<0?N.coordinate-P*e:N.coordinate})}else o[T]=N=In(In({},N),{},{tickCoord:N.coordinate});if(N.tickCoord!=null){var z=V0(e,N.tickCoord,R,f,d);z&&(f=N.tickCoord+e*(R()/2+i),o[T]=In(In({},N),{},{isShow:!0}))}},S=0;S<E;S++)A(S);return o}function Dw(e,t,r){var{tick:n,ticks:i,viewBox:a,minTickGap:o,orientation:c,interval:f,tickFormatter:d,unit:h,angle:m}=e;if(!i||!i.length||!n)return[];if(qe(f)||Sp.isSsr){var v;return(v=EZ(i,qe(f)?f:0))!==null&&v!==void 0?v:[]}var w=[],E=c==="top"||c==="bottom"?"width":"height",A=h&&E==="width"?e0(h,{fontSize:t,letterSpacing:r}):{width:0,height:0},S=(M,R)=>{var P=typeof d=="function"?d(M.value,R):M.value;return E==="width"?yZ(e0(P,{fontSize:t,letterSpacing:r}),A,m):e0(P,{fontSize:t,letterSpacing:r})[E]},b=i[0],T=i[1],_=i.length>=2&&b!=null&&T!=null?sn(T.coordinate-b.coordinate):1,N=wZ(a,_,E);return f==="equidistantPreserveStart"?AZ(_,N,S,i,o):f==="equidistantPreserveEnd"?CZ(_,N,S,i,o):(f==="preserveStart"||f==="preserveStartEnd"?w=OZ(_,N,S,i,o,f==="preserveStartEnd"):w=TZ(_,N,S,i,o),w.filter(M=>M.isShow))}var kZ=e=>{var{ticks:t,label:r,labelGapWithTick:n=5,tickSize:i=0,tickMargin:a=0}=e,o=0;if(t){Array.from(t).forEach(h=>{if(h){var m=h.getBoundingClientRect();m.width>o&&(o=m.width)}});var c=r?r.getBoundingClientRect().width:0,f=i+a,d=o+f+c+(r?n:0);return Math.round(d)}return 0},IZ=["axisLine","width","height","className","hide","ticks","axisType"];function NZ(e,t){if(e==null)return{};var r,n,i=PZ(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function PZ(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function xl(){return xl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},xl.apply(null,arguments)}function y_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Ar(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?y_(Object(r),!0).forEach(function(n){DZ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function DZ(e,t,r){return(t=RZ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function RZ(e){var t=MZ(e,"string");return typeof t=="symbol"?t:t+""}function MZ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var fs={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd",zIndex:wn.axis};function FZ(e){var{x:t,y:r,width:n,height:i,orientation:a,mirror:o,axisLine:c,otherSvgProps:f}=e;if(!c)return null;var d=Ar(Ar(Ar({},f),Sa(c)),{},{fill:"none"});if(a==="top"||a==="bottom"){var h=+(a==="top"&&!o||a==="bottom"&&o);d=Ar(Ar({},d),{},{x1:t,y1:r+h*i,x2:t+n,y2:r+h*i})}else{var m=+(a==="left"&&!o||a==="right"&&o);d=Ar(Ar({},d),{},{x1:t+m*n,y1:r,x2:t+m*n,y2:r+i})}return I.createElement("line",xl({},d,{className:Bt("recharts-cartesian-axis-line",ul(c,"className"))}))}function LZ(e,t,r,n,i,a,o,c,f){var d,h,m,v,w,E,A=c?-1:1,S=e.tickSize||o,b=qe(e.tickCoord)?e.tickCoord:e.coordinate;switch(a){case"top":d=h=e.coordinate,v=r+ +!c*i,m=v-A*S,E=m-A*f,w=b;break;case"left":m=v=e.coordinate,h=t+ +!c*n,d=h-A*S,w=d-A*f,E=b;break;case"right":m=v=e.coordinate,h=t+ +c*n,d=h+A*S,w=d+A*f,E=b;break;default:d=h=e.coordinate,v=r+ +c*i,m=v+A*S,E=m+A*f,w=b;break}return{line:{x1:d,y1:m,x2:h,y2:v},tick:{x:w,y:E}}}function BZ(e,t){switch(e){case"left":return t?"start":"end";case"right":return t?"end":"start";default:return"middle"}}function jZ(e,t){switch(e){case"left":case"right":return"middle";case"top":return t?"start":"end";default:return t?"end":"start"}}function UZ(e){var{option:t,tickProps:r,value:n}=e,i,a=Bt(r.className,"recharts-cartesian-axis-tick-value");if(I.isValidElement(t))i=I.cloneElement(t,Ar(Ar({},r),{},{className:a}));else if(typeof t=="function")i=t(Ar(Ar({},r),{},{className:a}));else{var o="recharts-cartesian-axis-tick-value";typeof t!="boolean"&&(o=Bt(o,gN(t))),i=I.createElement(Gp,xl({},r,{className:o}),n)}return i}var zZ=I.forwardRef((e,t)=>{var{ticks:r=[],tick:n,tickLine:i,stroke:a,tickFormatter:o,unit:c,padding:f,tickTextProps:d,orientation:h,mirror:m,x:v,y:w,width:E,height:A,tickSize:S,tickMargin:b,fontSize:T,letterSpacing:_,getTicksConfig:N,events:M,axisType:R}=e,P=Dw(Ar(Ar({},N),{},{ticks:r}),T,_),z=BZ(h,m),B=jZ(h,m),re=Sa(N),ee=O0(n),V={};typeof i=="object"&&(V=i);var de=Ar(Ar({},re),{},{fill:"none"},V),pe=P.map(ue=>Ar({entry:ue},LZ(ue,v,w,E,A,h,S,m,b))),K=pe.map(ue=>{var{entry:se,line:q}=ue;return I.createElement(Yn,{className:"recharts-cartesian-axis-tick",key:"tick-".concat(se.value,"-").concat(se.coordinate,"-").concat(se.tickCoord)},i&&I.createElement("line",xl({},de,q,{className:Bt("recharts-cartesian-axis-tick-line",ul(i,"className"))})))}),Ce=pe.map((ue,se)=>{var q,fe,{entry:we,tick:G}=ue,le=Ar(Ar(Ar(Ar({verticalAnchor:B},re),{},{textAnchor:z,stroke:"none",fill:a},G),{},{index:se,payload:we,visibleTicksCount:P.length,tickFormatter:o,padding:f},d),{},{angle:(q=(fe=d==null?void 0:d.angle)!==null&&fe!==void 0?fe:re.angle)!==null&&q!==void 0?q:0}),ne=Ar(Ar({},le),ee);return I.createElement(Yn,xl({className:"recharts-cartesian-axis-tick-label",key:"tick-label-".concat(we.value,"-").concat(we.coordinate,"-").concat(we.tickCoord)},lf(M,we,se)),n&&I.createElement(UZ,{option:n,tickProps:ne,value:"".concat(typeof o=="function"?o(we.value,se):we.value).concat(c||"")}))});return I.createElement("g",{className:"recharts-cartesian-axis-ticks recharts-".concat(R,"-ticks")},Ce.length>0&&I.createElement(Ta,{zIndex:wn.label},I.createElement("g",{className:"recharts-cartesian-axis-tick-labels recharts-".concat(R,"-tick-labels"),ref:t},Ce)),K.length>0&&I.createElement("g",{className:"recharts-cartesian-axis-tick-lines recharts-".concat(R,"-tick-lines")},K))}),WZ=I.forwardRef((e,t)=>{var{axisLine:r,width:n,height:i,className:a,hide:o,ticks:c,axisType:f}=e,d=NZ(e,IZ),[h,m]=I.useState(""),[v,w]=I.useState(""),E=I.useRef(null);I.useImperativeHandle(t,()=>({getCalculatedWidth:()=>{var S;return kZ({ticks:E.current,label:(S=e.labelRef)===null||S===void 0?void 0:S.current,labelGapWithTick:5,tickSize:e.tickSize,tickMargin:e.tickMargin})}}));var A=I.useCallback(S=>{if(S){var b=S.getElementsByClassName("recharts-cartesian-axis-tick-value");E.current=b;var T=b[0];if(T){var _=window.getComputedStyle(T),N=_.fontSize,M=_.letterSpacing;(N!==h||M!==v)&&(m(N),w(M))}}},[h,v]);return o||n!=null&&n<=0||i!=null&&i<=0?null:I.createElement(Ta,{zIndex:e.zIndex},I.createElement(Yn,{className:Bt("recharts-cartesian-axis",a)},I.createElement(FZ,{x:e.x,y:e.y,width:n,height:i,orientation:e.orientation,mirror:e.mirror,axisLine:r,otherSvgProps:Sa(e)}),I.createElement(zZ,{ref:A,axisType:f,events:d,fontSize:h,getTicksConfig:e,height:e.height,letterSpacing:v,mirror:e.mirror,orientation:e.orientation,padding:e.padding,stroke:e.stroke,tick:e.tick,tickFormatter:e.tickFormatter,tickLine:e.tickLine,tickMargin:e.tickMargin,tickSize:e.tickSize,tickTextProps:e.tickTextProps,ticks:c,unit:e.unit,width:e.width,x:e.x,y:e.y}),I.createElement(tK,{x:e.x,y:e.y,width:e.width,height:e.height,lowerWidth:e.width,upperWidth:e.width},I.createElement(fK,{label:e.label,labelRef:e.labelRef}),e.children)))}),Rw=I.forwardRef((e,t)=>{var r=un(e,fs);return I.createElement(WZ,xl({},r,{ref:t}))});Rw.displayName="CartesianAxis";var VZ=["x1","y1","x2","y2","key"],HZ=["offset"],GZ=["xAxisId","yAxisId"],$Z=["xAxisId","yAxisId"];function w_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Dn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?w_(Object(r),!0).forEach(function(n){XZ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):w_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function XZ(e,t,r){return(t=KZ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function KZ(e){var t=YZ(e,"string");return typeof t=="symbol"?t:t+""}function YZ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ko(){return Ko=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ko.apply(null,arguments)}function m1(e,t){if(e==null)return{};var r,n,i=ZZ(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function ZZ(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var qZ=e=>{var{fill:t}=e;if(!t||t==="none")return null;var{fillOpacity:r,x:n,y:i,width:a,height:o,ry:c}=e;return I.createElement("rect",{x:n,y:i,ry:c,width:a,height:o,stroke:"none",fill:t,fillOpacity:r,className:"recharts-cartesian-grid-bg"})};function PN(e){var{option:t,lineItemProps:r}=e,n;if(I.isValidElement(t))n=I.cloneElement(t,r);else if(typeof t=="function")n=t(r);else{var i,{x1:a,y1:o,x2:c,y2:f,key:d}=r,h=m1(r,VZ),m=(i=Sa(h))!==null&&i!==void 0?i:{},{offset:v}=m,w=m1(m,HZ);n=I.createElement("line",Ko({},w,{x1:a,y1:o,x2:c,y2:f,fill:"none",key:d}))}return n}function QZ(e){var{x:t,width:r,horizontal:n=!0,horizontalPoints:i}=e;if(!n||!i||!i.length)return null;var{xAxisId:a,yAxisId:o}=e,c=m1(e,GZ),f=i.map((d,h)=>{var m=Dn(Dn({},c),{},{x1:t,y1:d,x2:t+r,y2:d,key:"line-".concat(h),index:h});return I.createElement(PN,{key:"line-".concat(h),option:n,lineItemProps:m})});return I.createElement("g",{className:"recharts-cartesian-grid-horizontal"},f)}function JZ(e){var{y:t,height:r,vertical:n=!0,verticalPoints:i}=e;if(!n||!i||!i.length)return null;var{xAxisId:a,yAxisId:o}=e,c=m1(e,$Z),f=i.map((d,h)=>{var m=Dn(Dn({},c),{},{x1:d,y1:t,x2:d,y2:t+r,key:"line-".concat(h),index:h});return I.createElement(PN,{option:n,lineItemProps:m,key:"line-".concat(h)})});return I.createElement("g",{className:"recharts-cartesian-grid-vertical"},f)}function eq(e){var{horizontalFill:t,fillOpacity:r,x:n,y:i,width:a,height:o,horizontalPoints:c,horizontal:f=!0}=e;if(!f||!t||!t.length||c==null)return null;var d=c.map(m=>Math.round(m+i-i)).sort((m,v)=>m-v);i!==d[0]&&d.unshift(0);var h=d.map((m,v)=>{var w=d[v+1],E=w==null,A=E?i+o-m:w-m;if(A<=0)return null;var S=v%t.length;return I.createElement("rect",{key:"react-".concat(v),y:m,x:n,height:A,width:a,stroke:"none",fill:t[S],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return I.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},h)}function tq(e){var{vertical:t=!0,verticalFill:r,fillOpacity:n,x:i,y:a,width:o,height:c,verticalPoints:f}=e;if(!t||!r||!r.length)return null;var d=f.map(m=>Math.round(m+i-i)).sort((m,v)=>m-v);i!==d[0]&&d.unshift(0);var h=d.map((m,v)=>{var w=d[v+1],E=w==null,A=E?i+o-m:w-m;if(A<=0)return null;var S=v%r.length;return I.createElement("rect",{key:"react-".concat(v),x:m,y:a,width:A,height:c,stroke:"none",fill:r[S],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return I.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},h)}var rq=(e,t)=>{var{xAxis:r,width:n,height:i,offset:a}=e;return lk(Dw(Dn(Dn(Dn({},fs),r),{},{ticks:ck(r),viewBox:{x:0,y:0,width:n,height:i}})),a.left,a.left+a.width,t)},nq=(e,t)=>{var{yAxis:r,width:n,height:i,offset:a}=e;return lk(Dw(Dn(Dn(Dn({},fs),r),{},{ticks:ck(r),viewBox:{x:0,y:0,width:n,height:i}})),a.top,a.top+a.height,t)},iq={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0,syncWithTicks:!1,zIndex:wn.grid};function DN(e){var t=cy(),r=uy(),n=yk(),i=Dn(Dn({},un(e,iq)),{},{x:qe(e.x)?e.x:n.left,y:qe(e.y)?e.y:n.top,width:qe(e.width)?e.width:n.width,height:qe(e.height)?e.height:n.height}),{xAxisId:a,yAxisId:o,x:c,y:f,width:d,height:h,syncWithTicks:m,horizontalValues:v,verticalValues:w}=i,E=pi(),A=Je(B=>wS(B,"xAxis",a,E)),S=Je(B=>wS(B,"yAxis",o,E));if(!$a(d)||!$a(h)||!qe(c)||!qe(f))return null;var b=i.verticalCoordinatesGenerator||rq,T=i.horizontalCoordinatesGenerator||nq,{horizontalPoints:_,verticalPoints:N}=i;if((!_||!_.length)&&typeof T=="function"){var M=v&&v.length,R=T({yAxis:S?Dn(Dn({},S),{},{ticks:M?v:S.ticks}):void 0,width:t??d,height:r??h,offset:n},M?!0:m);Vh(Array.isArray(R),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof R,"]")),Array.isArray(R)&&(_=R)}if((!N||!N.length)&&typeof b=="function"){var P=w&&w.length,z=b({xAxis:A?Dn(Dn({},A),{},{ticks:P?w:A.ticks}):void 0,width:t??d,height:r??h,offset:n},P?!0:m);Vh(Array.isArray(z),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof z,"]")),Array.isArray(z)&&(N=z)}return I.createElement(Ta,{zIndex:i.zIndex},I.createElement("g",{className:"recharts-cartesian-grid"},I.createElement(qZ,{fill:i.fill,fillOpacity:i.fillOpacity,x:i.x,y:i.y,width:i.width,height:i.height,ry:i.ry}),I.createElement(eq,Ko({},i,{horizontalPoints:_})),I.createElement(tq,Ko({},i,{verticalPoints:N})),I.createElement(QZ,Ko({},i,{offset:n,horizontalPoints:_,xAxis:A,yAxis:S})),I.createElement(JZ,Ko({},i,{offset:n,verticalPoints:N,xAxis:A,yAxis:S}))))}DN.displayName="CartesianGrid";var aq={},RN=hi({name:"errorBars",initialState:aq,reducers:{addErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]||(e[r]=[]),e[r].push(n)},replaceErrorBar:(e,t)=>{var{itemId:r,prev:n,next:i}=t.payload;e[r]&&(e[r]=e[r].map(a=>a.dataKey===n.dataKey&&a.direction===n.direction?i:a))},removeErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]&&(e[r]=e[r].filter(i=>i.dataKey!==n.dataKey||i.direction!==n.direction))}}}),{addErrorBar:Dce,replaceErrorBar:Rce,removeErrorBar:Mce}=RN.actions,sq=RN.reducer,oq=["children"];function lq(e,t){if(e==null)return{};var r,n,i=cq(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function cq(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var uq={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},fq=I.createContext(uq);function dq(e){var{children:t}=e,r=lq(e,oq);return I.createElement(fq.Provider,{value:r},t)}function MN(e,t){var r,n,i=Je(d=>Ps(d,e)),a=Je(d=>Ds(d,t)),o=(r=i==null?void 0:i.allowDataOverflow)!==null&&r!==void 0?r:en.allowDataOverflow,c=(n=a==null?void 0:a.allowDataOverflow)!==null&&n!==void 0?n:tn.allowDataOverflow,f=o||c;return{needClip:f,needClipX:o,needClipY:c}}function hq(e){var{xAxisId:t,yAxisId:r,clipPathId:n}=e,i=TN(),{needClipX:a,needClipY:o,needClip:c}=MN(t,r);if(!c||!i)return null;var{x:f,y:d,width:h,height:m}=i;return I.createElement("clipPath",{id:"clipPath-".concat(n)},I.createElement("rect",{x:a?f:f-h/2,y:o?d:d-m/2,width:a?h:h*2,height:o?m:m*2}))}var pq={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bf=I;function gq(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var mq=typeof Object.is=="function"?Object.is:gq,xq=bf.useSyncExternalStore,vq=bf.useRef,yq=bf.useEffect,wq=bf.useMemo,Eq=bf.useDebugValue;pq.useSyncExternalStoreWithSelector=function(e,t,r,n,i){var a=vq(null);if(a.current===null){var o={hasValue:!1,value:null};a.current=o}else o=a.current;a=wq(function(){function f(w){if(!d){if(d=!0,h=w,w=n(w),i!==void 0&&o.hasValue){var E=o.value;if(i(E,w))return m=E}return m=w}if(E=m,mq(h,w))return E;var A=n(w);return i!==void 0&&i(E,A)?(h=w,E):(h=w,m=A)}var d=!1,h,m,v=r===void 0?null:r;return[function(){return f(t())},v===null?void 0:function(){return f(v())}]},[t,r,n,i]);var c=xq(e,a[0],a[1]);return yq(function(){o.hasValue=!0,o.value=c},[c]),Eq(c),c};function Aq(e){e()}function Cq(){let e=null,t=null;return{clear(){e=null,t=null},notify(){Aq(()=>{let r=e;for(;r;)r.callback(),r=r.next})},get(){const r=[];let n=e;for(;n;)r.push(n),n=n.next;return r},subscribe(r){let n=!0;const i=t={callback:r,next:null,prev:t};return i.prev?i.prev.next=i:e=i,function(){!n||e===null||(n=!1,i.next?i.next.prev=i.prev:t=i.prev,i.prev?i.prev.next=i.next:e=i.next)}}}}var E_={notify(){},get:()=>[]};function Sq(e,t){let r,n=E_,i=0,a=!1;function o(A){h();const S=n.subscribe(A);let b=!1;return()=>{b||(b=!0,S(),m())}}function c(){n.notify()}function f(){E.onStateChange&&E.onStateChange()}function d(){return a}function h(){i++,r||(r=e.subscribe(f),n=Cq())}function m(){i--,r&&i===0&&(r(),r=void 0,n.clear(),n=E_)}function v(){a||(a=!0,h())}function w(){a&&(a=!1,m())}const E={addNestedSub:o,notifyNestedSubs:c,handleChangeWrapper:f,isSubscribed:d,trySubscribe:v,tryUnsubscribe:w,getListeners:()=>n};return E}var _q=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",bq=_q(),Tq=()=>typeof navigator<"u"&&navigator.product==="ReactNative",Oq=Tq(),kq=()=>bq||Oq?I.useLayoutEffect:I.useEffect,Iq=kq();function A_(e,t){return e===t?e!==0||t!==0||1/e===1/t:e!==e&&t!==t}function Nq(e,t){if(A_(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;const r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(let i=0;i<r.length;i++)if(!Object.prototype.hasOwnProperty.call(t,r[i])||!A_(e[r[i]],t[r[i]]))return!1;return!0}var xm=Symbol.for("react-redux-context"),vm=typeof globalThis<"u"?globalThis:{};function Pq(){if(!I.createContext)return{};const e=vm[xm]??(vm[xm]=new Map);let t=e.get(I.createContext);return t||(t=I.createContext(null),e.set(I.createContext,t)),t}var Dq=Pq();function Rq(e){const{children:t,context:r,serverState:n,store:i}=e,a=I.useMemo(()=>{const f=Sq(i);return{store:i,subscription:f,getServerState:n?()=>n:void 0}},[i,n]),o=I.useMemo(()=>i.getState(),[i]);Iq(()=>{const{subscription:f}=a;return f.onStateChange=f.notifyNestedSubs,f.trySubscribe(),o!==i.getState()&&f.notifyNestedSubs(),()=>{f.tryUnsubscribe(),f.onStateChange=void 0}},[a,o]);const c=r||Dq;return I.createElement(c.Provider,{value:a},t)}var Mq=Rq,Fq=new Set(["axisLine","tickLine","activeBar","activeDot","activeLabel","activeShape","allowEscapeViewBox","background","cursor","dot","label","line","margin","padding","position","shape","style","tick","wrapperStyle","radius"]);function Lq(e,t){return e==null&&t==null?!0:typeof e=="number"&&typeof t=="number"?e===t||e!==e&&t!==t:e===t}function Mw(e,t){var r=new Set([...Object.keys(e),...Object.keys(t)]);for(var n of r)if(Fq.has(n)){if(e[n]==null&&t[n]==null)continue;if(!Nq(e[n],t[n]))return!1}else if(!Lq(e[n],t[n]))return!1;return!0}function bl(e,t){var r,n;return(r=(n=e.graphicalItems.cartesianItems.find(i=>i.id===t))===null||n===void 0?void 0:n.xAxisId)!==null&&r!==void 0?r:_N}function Tl(e,t){var r,n;return(r=(n=e.graphicalItems.cartesianItems.find(i=>i.id===t))===null||n===void 0?void 0:n.yAxisId)!==null&&r!==void 0?r:_N}var Bq="Invariant failed";function jq(e,t){throw new Error(Bq)}function yv(){return yv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},yv.apply(null,arguments)}function x1(e){return I.createElement(wN,yv({shapeType:"rectangle",activeClassName:"recharts-active-bar"},e))}var Uq=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(n,i)=>{if(qe(t))return t;var a=qe(n)||cn(n);return a?t(n,i):(a||jq(),r)}},zq=(e,t,r)=>r,Wq=(e,t)=>t,Tf=ve([Ky,Wq],(e,t)=>e.filter(r=>r.type==="bar").find(r=>r.id===t)),Vq=ve([Tf],e=>e==null?void 0:e.maxBarSize),Hq=(e,t,r,n)=>n,Gq=ve([Dt,Ky,bl,Tl,zq],(e,t,r,n,i)=>t.filter(a=>e==="horizontal"?a.xAxisId===r:a.yAxisId===n).filter(a=>a.isPanorama===i).filter(a=>a.hide===!1).filter(a=>a.type==="bar")),$q=(e,t,r)=>{var n=Dt(e),i=bl(e,t),a=Tl(e,t);if(!(i==null||a==null))return n==="horizontal"?hv(e,"yAxis",a,r):hv(e,"xAxis",i,r)},Xq=(e,t)=>{var r=Dt(e),n=bl(e,t),i=Tl(e,t);if(!(n==null||i==null))return r==="horizontal"?yS(e,"xAxis",n):yS(e,"yAxis",i)},Kq=ve([Gq,qV,Xq],nZ),Yq=(e,t,r)=>{var n,i,a=Tf(e,t);if(a==null)return 0;var o=bl(e,t),c=Tl(e,t);if(o==null||c==null)return 0;var f=Dt(e),d=BI(e),{maxBarSize:h}=a,m=cn(h)?d:h,v,w;return f==="horizontal"?(v=jc(e,"xAxis",o,r),w=Bc(e,"xAxis",o,r)):(v=jc(e,"yAxis",c,r),w=Bc(e,"yAxis",c,r)),(n=(i=Wh(v,w,!0))!==null&&i!==void 0?i:m)!==null&&n!==void 0?n:0},FN=(e,t,r)=>{var n=Dt(e),i=bl(e,t),a=Tl(e,t);if(!(i==null||a==null)){var o,c;return n==="horizontal"?(o=jc(e,"xAxis",i,r),c=Bc(e,"xAxis",i,r)):(o=jc(e,"yAxis",a,r),c=Bc(e,"yAxis",a,r)),Wh(o,c)}},Zq=ve([Kq,BI,ZV,jI,Yq,FN,Vq],lZ),qq=(e,t,r)=>{var n=bl(e,t);if(n!=null)return jc(e,"xAxis",n,r)},Qq=(e,t,r)=>{var n=Tl(e,t);if(n!=null)return jc(e,"yAxis",n,r)},Jq=(e,t,r)=>{var n=bl(e,t);if(n!=null)return Bc(e,"xAxis",n,r)},eQ=(e,t,r)=>{var n=Tl(e,t);if(n!=null)return Bc(e,"yAxis",n,r)},tQ=ve([Zq,Tf],uZ),rQ=ve([$q,Tf],cZ),nQ=ve([Kr,sy,qq,Qq,Jq,eQ,tQ,Dt,WV,FN,rQ,Tf,Hq],(e,t,r,n,i,a,o,c,f,d,h,m,v)=>{var{chartData:w,dataStartIndex:E,dataEndIndex:A}=f;if(!(m==null||o==null||t==null||c!=="horizontal"&&c!=="vertical"||r==null||n==null||i==null||a==null||d==null)){var{data:S}=m,b;if(S!=null&&S.length>0?b=S:b=w==null?void 0:w.slice(E,A+1),b!=null)return NQ({layout:c,barSettings:m,pos:o,parentViewBox:t,bandSize:d,xAxis:r,yAxis:n,xAxisTicks:i,yAxisTicks:a,stackedData:h,displayedData:b,offset:e,cells:v,dataStartIndex:E})}}),iQ=["index"];function wv(){return wv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},wv.apply(null,arguments)}function aQ(e,t){if(e==null)return{};var r,n,i=sQ(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function sQ(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var LN=I.createContext(void 0),oQ=e=>{var t=I.useContext(LN);if(t!=null)return t.stackId;if(e!=null)return HB(e)},lQ=(e,t)=>"recharts-bar-stack-clip-path-".concat(e,"-").concat(t),cQ=e=>{var t=I.useContext(LN);if(t!=null){var{stackId:r}=t;return"url(#".concat(lQ(r,e),")")}},BN=e=>{var{index:t}=e,r=aQ(e,iQ),n=cQ(t);return I.createElement(Yn,wv({className:"recharts-bar-stack-layer",clipPath:n},r))},uQ=["onMouseEnter","onMouseLeave","onClick"],fQ=["value","background","tooltipPosition"],dQ=["id"],hQ=["onMouseEnter","onClick","onMouseLeave"];function Ss(){return Ss=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ss.apply(null,arguments)}function C_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Vn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?C_(Object(r),!0).forEach(function(n){pQ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):C_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function pQ(e,t,r){return(t=gQ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gQ(e){var t=mQ(e,"string");return typeof t=="symbol"?t:t+""}function mQ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function v1(e,t){if(e==null)return{};var r,n,i=xQ(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function xQ(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var vQ=e=>{var{dataKey:t,name:r,fill:n,legendType:i,hide:a}=e;return[{inactive:a,dataKey:t,type:i,color:n,value:gp(r,t),payload:e}]},yQ=I.memo(e=>{var{dataKey:t,stroke:r,strokeWidth:n,fill:i,name:a,hide:o,unit:c,tooltipType:f,id:d}=e,h={dataDefinedOnItem:void 0,getPosition:Gc,settings:{stroke:r,strokeWidth:n,fill:i,dataKey:t,nameKey:void 0,name:gp(a,t),hide:o,type:f,color:i,unit:c,graphicalItemId:d}};return I.createElement(EN,{tooltipEntrySettings:h})});function wQ(e){var t=Je(ml),{data:r,dataKey:n,background:i,allOtherBarProps:a}=e,{onMouseEnter:o,onMouseLeave:c,onClick:f}=a,d=v1(a,uQ),h=Iw(o,n,a.id),m=Nw(c),v=Pw(f,n,a.id);if(!i||r==null)return null;var w=O0(i);return I.createElement(Ta,{zIndex:fZ(i,wn.barBackground)},r.map((E,A)=>{var{value:S,background:b,tooltipPosition:T}=E,_=v1(E,fQ);if(!b)return null;var N=h(E,A),M=m(E,A),R=v(E,A),P=Vn(Vn(Vn(Vn(Vn({option:i,isActive:String(A)===t},_),{},{fill:"#eee"},b),w),lf(d,E,A)),{},{onMouseEnter:N,onMouseLeave:M,onClick:R,dataKey:n,index:A,className:"recharts-bar-background-rectangle"});return I.createElement(x1,Ss({key:"background-bar-".concat(A)},P))}))}function EQ(e){var{showLabels:t,children:r,rects:n}=e,i=n==null?void 0:n.map(a=>{var o={x:a.x,y:a.y,width:a.width,lowerWidth:a.width,upperWidth:a.width,height:a.height};return Vn(Vn({},o),{},{value:a.value,payload:a.payload,parentViewBox:a.parentViewBox,viewBox:o,fill:a.fill})});return I.createElement(vK,{value:t?i:void 0},r)}function AQ(e){var{shape:t,activeBar:r,baseProps:n,entry:i,index:a,dataKey:o}=e,c=Je(ml),f=Je(yw),d=r&&String(a)===c&&(f==null||o===f),h=d?r:t;return d?I.createElement(Ta,{zIndex:wn.activeBar},I.createElement(BN,{index:a},I.createElement(x1,Ss({},n,{name:String(n.name)},i,{isActive:d,option:h,index:a,dataKey:o})))):I.createElement(x1,Ss({},n,{name:String(n.name)},i,{isActive:d,option:h,index:a,dataKey:o}))}function CQ(e){var{shape:t,baseProps:r,entry:n,index:i,dataKey:a}=e;return I.createElement(x1,Ss({},r,{name:String(r.name)},n,{isActive:!1,option:t,index:i,dataKey:a}))}function SQ(e){var t,{data:r,props:n}=e,i=(t=Sa(n))!==null&&t!==void 0?t:{},{id:a}=i,o=v1(i,dQ),{shape:c,dataKey:f,activeBar:d}=n,{onMouseEnter:h,onClick:m,onMouseLeave:v}=n,w=v1(n,hQ),E=Iw(h,f,a),A=Nw(v),S=Pw(m,f,a);return r?I.createElement(I.Fragment,null,r.map((b,T)=>I.createElement(BN,Ss({index:T,key:"rectangle-".concat(b==null?void 0:b.x,"-").concat(b==null?void 0:b.y,"-").concat(b==null?void 0:b.value,"-").concat(T),className:"recharts-bar-rectangle"},lf(w,b,T),{onMouseEnter:E(b,T),onMouseLeave:A(b,T),onClick:S(b,T)}),d?I.createElement(AQ,{shape:c,activeBar:d,baseProps:o,entry:b,index:T,dataKey:f}):I.createElement(CQ,{shape:c,baseProps:o,entry:b,index:T,dataKey:f})))):null}function _Q(e){var{props:t,previousRectanglesRef:r}=e,{data:n,layout:i,isAnimationActive:a,animationBegin:o,animationDuration:c,animationEasing:f,onAnimationEnd:d,onAnimationStart:h}=t,m=r.current,v=bp(t,"recharts-bar-"),[w,E]=I.useState(!1),A=!w,S=I.useCallback(()=>{typeof d=="function"&&d(),E(!1)},[d]),b=I.useCallback(()=>{typeof h=="function"&&h(),E(!0)},[h]);return I.createElement(EQ,{showLabels:A,rects:n},I.createElement(_p,{animationId:v,begin:o,duration:c,isActive:a,easing:f,onAnimationEnd:S,onAnimationStart:b,key:v},T=>{var _=T===1?n:n==null?void 0:n.map((N,M)=>{var R=m&&m[M];if(R)return Vn(Vn({},N),{},{x:Vr(R.x,N.x,T),y:Vr(R.y,N.y,T),width:Vr(R.width,N.width,T),height:Vr(R.height,N.height,T)});if(i==="horizontal"){var P=Vr(0,N.height,T),z=Vr(N.stackedBarStart,N.y,T);return Vn(Vn({},N),{},{y:z,height:P})}var B=Vr(0,N.width,T),re=Vr(N.stackedBarStart,N.x,T);return Vn(Vn({},N),{},{width:B,x:re})});return T>0&&(r.current=_??null),_==null?null:I.createElement(Yn,null,I.createElement(SQ,{props:t,data:_}))}),I.createElement(fN,{label:t.label}),t.children)}function bQ(e){var t=I.useRef(null);return I.createElement(_Q,{previousRectanglesRef:t,props:e})}var jN=0,TQ=(e,t)=>{var r=Array.isArray(e.value)?e.value[1]:e.value;return{x:e.x,y:e.y,value:r,errorVal:ar(e,t)}};class OQ extends I.PureComponent{render(){var{hide:t,data:r,dataKey:n,className:i,xAxisId:a,yAxisId:o,needClip:c,background:f,id:d}=this.props;if(t||r==null)return null;var h=Bt("recharts-bar",i),m=d;return I.createElement(Yn,{className:h,id:d},c&&I.createElement("defs",null,I.createElement(hq,{clipPathId:m,xAxisId:a,yAxisId:o})),I.createElement(Yn,{className:"recharts-bar-rectangles",clipPath:c?"url(#clipPath-".concat(m,")"):void 0},I.createElement(wQ,{data:r,dataKey:n,background:f,allOtherBarProps:this.props}),I.createElement(bQ,this.props)))}}var kQ={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",background:!1,hide:!1,isAnimationActive:"auto",label:!1,legendType:"rect",minPointSize:jN,xAxisId:0,yAxisId:0,zIndex:wn.bar};function IQ(e){var{xAxisId:t,yAxisId:r,hide:n,legendType:i,minPointSize:a,activeBar:o,animationBegin:c,animationDuration:f,animationEasing:d,isAnimationActive:h}=e,{needClip:m}=MN(t,r),v=$c(),w=pi(),E=kw(e.children,_f),A=Je(T=>nQ(T,e.id,w,E));if(v!=="vertical"&&v!=="horizontal")return null;var S,b=A==null?void 0:A[0];return b==null||b.height==null||b.width==null?S=0:S=v==="vertical"?b.height/2:b.width/2,I.createElement(dq,{xAxisId:t,yAxisId:r,data:A,dataPointFormatter:TQ,errorBarOffset:S},I.createElement(OQ,Ss({},e,{layout:v,needClip:m,data:A,xAxisId:t,yAxisId:r,hide:n,legendType:i,minPointSize:a,activeBar:o,animationBegin:c,animationDuration:f,animationEasing:d,isAnimationActive:h})))}function NQ(e){var{layout:t,barSettings:{dataKey:r,minPointSize:n},pos:i,bandSize:a,xAxis:o,yAxis:c,xAxisTicks:f,yAxisTicks:d,stackedData:h,displayedData:m,offset:v,cells:w,parentViewBox:E,dataStartIndex:A}=e,S=t==="horizontal"?c:o,b=h?S.scale.domain():null,T=GB({numericAxis:S}),_=S.scale.map(T);return m.map((N,M)=>{var R,P,z,B,re,ee;if(h){var V=h[M+A];if(V==null)return null;R=jB(V,b)}else R=ar(N,r),Array.isArray(R)||(R=[T,R]);var de=Uq(n,jN)(R[1],M);if(t==="horizontal"){var pe,K=c.scale.map(R[0]),Ce=c.scale.map(R[1]);if(K==null||Ce==null)return null;P=_3({axis:o,ticks:f,bandSize:a,offset:i.offset,entry:N,index:M}),z=(pe=Ce??K)!==null&&pe!==void 0?pe:void 0,B=i.size;var ue=K-Ce;if(re=Ha(ue)?0:ue,ee={x:P,y:v.top,width:B,height:v.height},Math.abs(de)>0&&Math.abs(re)<Math.abs(de)){var se=sn(re||de)*(Math.abs(de)-Math.abs(re));z-=se,re+=se}}else{var q=o.scale.map(R[0]),fe=o.scale.map(R[1]);if(q==null||fe==null)return null;if(P=q,z=_3({axis:c,ticks:d,bandSize:a,offset:i.offset,entry:N,index:M}),B=fe-q,re=i.size,ee={x:v.left,y:z,width:v.width,height:re},Math.abs(de)>0&&Math.abs(B)<Math.abs(de)){var we=sn(B||de)*(Math.abs(de)-Math.abs(B));B+=we}}if(P==null||z==null||B==null||re==null)return null;var G=Vn(Vn({},N),{},{stackedBarStart:_,x:P,y:z,width:B,height:re,value:h?R:R[1],payload:N,background:ee,tooltipPosition:{x:P+B/2,y:z+re/2},parentViewBox:E},w&&w[M]&&w[M].props);return G}).filter(Boolean)}function PQ(e){var t=un(e,kQ),r=oQ(t.stackId),n=pi();return I.createElement(AN,{id:t.id,type:"bar"},i=>I.createElement(I.Fragment,null,I.createElement(nY,{legendPayload:vQ(t)}),I.createElement(yQ,{dataKey:t.dataKey,stroke:t.stroke,strokeWidth:t.strokeWidth,fill:t.fill,name:t.name,hide:t.hide,unit:t.unit,tooltipType:t.tooltipType,id:i}),I.createElement(xY,{type:"bar",id:i,data:void 0,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,stackId:r,hide:t.hide,barSize:t.barSize,minPointSize:t.minPointSize,maxBarSize:t.maxBarSize,isPanorama:n}),I.createElement(Ta,{zIndex:t.zIndex},I.createElement(IQ,Ss({},t,{id:i})))))}var Ev=I.memo(PQ,Mw);Ev.displayName="Bar";var DQ=["domain","range"],RQ=["domain","range"];function S_(e,t){if(e==null)return{};var r,n,i=MQ(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function MQ(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function __(e,t){return e===t?!0:Array.isArray(e)&&e.length===2&&Array.isArray(t)&&t.length===2?e[0]===t[0]&&e[1]===t[1]:!1}function UN(e,t){if(e===t)return!0;var{domain:r,range:n}=e,i=S_(e,DQ),{domain:a,range:o}=t,c=S_(t,RQ);return!__(r,a)||!__(n,o)?!1:Mw(i,c)}var FQ=["type"],LQ=["dangerouslySetInnerHTML","ticks","scale"],BQ=["id","scale"];function Av(){return Av=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Av.apply(null,arguments)}function b_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function T_(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?b_(Object(r),!0).forEach(function(n){jQ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function jQ(e,t,r){return(t=UQ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function UQ(e){var t=zQ(e,"string");return typeof t=="symbol"?t:t+""}function zQ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Cv(e,t){if(e==null)return{};var r,n,i=WQ(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function WQ(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function VQ(e){var t=Qt(),r=I.useRef(null),n=wk(),{type:i}=e,a=Cv(e,FQ),o=Mp(n,"xAxis",i),c=I.useMemo(()=>{if(o!=null)return T_(T_({},a),{},{type:o})},[a,o]);return I.useLayoutEffect(()=>{c!=null&&(r.current===null?t(XY(c)):r.current!==c&&t(KY({prev:r.current,next:c})),r.current=c)},[c,t]),I.useLayoutEffect(()=>()=>{r.current&&(t(YY(r.current)),r.current=null)},[t]),null}var HQ=e=>{var{xAxisId:t,className:r}=e,n=Je(sy),i=pi(),a="xAxis",o=Je(b=>v6(b,a,t,i)),c=Je(b=>p6(b,t)),f=Je(b=>qH(b,t)),d=Je(b=>YI(b,t));if(c==null||f==null||d==null)return null;var{dangerouslySetInnerHTML:h,ticks:m,scale:v}=e,w=Cv(e,LQ),{id:E,scale:A}=d,S=Cv(d,BQ);return I.createElement(Rw,Av({},w,S,{x:f.x,y:f.y,width:c.width,height:c.height,className:Bt("recharts-".concat(a," ").concat(a),r),viewBox:n,ticks:o,axisType:a}))},GQ={allowDataOverflow:en.allowDataOverflow,allowDecimals:en.allowDecimals,allowDuplicatedCategory:en.allowDuplicatedCategory,angle:en.angle,axisLine:fs.axisLine,height:en.height,hide:!1,includeHidden:en.includeHidden,interval:en.interval,label:!1,minTickGap:en.minTickGap,mirror:en.mirror,orientation:en.orientation,padding:en.padding,reversed:en.reversed,scale:en.scale,tick:en.tick,tickCount:en.tickCount,tickLine:fs.tickLine,tickSize:fs.tickSize,type:en.type,xAxisId:0},$Q=e=>{var t=un(e,GQ);return I.createElement(I.Fragment,null,I.createElement(VQ,{allowDataOverflow:t.allowDataOverflow,allowDecimals:t.allowDecimals,allowDuplicatedCategory:t.allowDuplicatedCategory,angle:t.angle,dataKey:t.dataKey,domain:t.domain,height:t.height,hide:t.hide,id:t.xAxisId,includeHidden:t.includeHidden,interval:t.interval,minTickGap:t.minTickGap,mirror:t.mirror,name:t.name,orientation:t.orientation,padding:t.padding,reversed:t.reversed,scale:t.scale,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit}),I.createElement(HQ,t))},zN=I.memo($Q,UN);zN.displayName="XAxis";var XQ=["type"],KQ=["dangerouslySetInnerHTML","ticks","scale"],YQ=["id","scale"];function Sv(){return Sv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Sv.apply(null,arguments)}function O_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function k_(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?O_(Object(r),!0).forEach(function(n){ZQ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ZQ(e,t,r){return(t=qQ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qQ(e){var t=QQ(e,"string");return typeof t=="symbol"?t:t+""}function QQ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _v(e,t){if(e==null)return{};var r,n,i=JQ(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function JQ(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function eJ(e){var t=Qt(),r=I.useRef(null),n=wk(),{type:i}=e,a=_v(e,XQ),o=Mp(n,"yAxis",i),c=I.useMemo(()=>{if(o!=null)return k_(k_({},a),{},{type:o})},[o,a]);return I.useLayoutEffect(()=>{c!=null&&(r.current===null?t(ZY(c)):r.current!==c&&t(qY({prev:r.current,next:c})),r.current=c)},[c,t]),I.useLayoutEffect(()=>()=>{r.current&&(t(QY(r.current)),r.current=null)},[t]),null}function tJ(e){var{yAxisId:t,className:r,width:n,label:i}=e,a=I.useRef(null),o=I.useRef(null),c=Je(sy),f=pi(),d=Qt(),h="yAxis",m=Je(R=>g6(R,t)),v=Je(R=>JH(R,t)),w=Je(R=>v6(R,h,t,f)),E=Je(R=>ZI(R,t));if(I.useLayoutEffect(()=>{if(!(n!=="auto"||!m||Sw(i)||I.isValidElement(i)||E==null)){var R=a.current;if(R){var P=R.getCalculatedWidth();Math.round(m.width)!==Math.round(P)&&d(JY({id:t,width:P}))}}},[w,m,d,i,t,n,E]),m==null||v==null||E==null)return null;var{dangerouslySetInnerHTML:A,ticks:S,scale:b}=e,T=_v(e,KQ),{id:_,scale:N}=E,M=_v(E,YQ);return I.createElement(Rw,Sv({},T,M,{ref:a,labelRef:o,x:v.x,y:v.y,tickTextProps:n==="auto"?{width:void 0}:{width:n},width:m.width,height:m.height,className:Bt("recharts-".concat(h," ").concat(h),r),viewBox:c,ticks:w,axisType:h}))}var rJ={allowDataOverflow:tn.allowDataOverflow,allowDecimals:tn.allowDecimals,allowDuplicatedCategory:tn.allowDuplicatedCategory,angle:tn.angle,axisLine:fs.axisLine,hide:!1,includeHidden:tn.includeHidden,interval:tn.interval,label:!1,minTickGap:tn.minTickGap,mirror:tn.mirror,orientation:tn.orientation,padding:tn.padding,reversed:tn.reversed,scale:tn.scale,tick:tn.tick,tickCount:tn.tickCount,tickLine:fs.tickLine,tickSize:fs.tickSize,type:tn.type,width:tn.width,yAxisId:0},nJ=e=>{var t=un(e,rJ);return I.createElement(I.Fragment,null,I.createElement(eJ,{interval:t.interval,id:t.yAxisId,scale:t.scale,type:t.type,domain:t.domain,allowDataOverflow:t.allowDataOverflow,dataKey:t.dataKey,allowDuplicatedCategory:t.allowDuplicatedCategory,allowDecimals:t.allowDecimals,tickCount:t.tickCount,padding:t.padding,includeHidden:t.includeHidden,reversed:t.reversed,ticks:t.ticks,width:t.width,orientation:t.orientation,mirror:t.mirror,hide:t.hide,unit:t.unit,name:t.name,angle:t.angle,minTickGap:t.minTickGap,tick:t.tick,tickFormatter:t.tickFormatter}),I.createElement(tJ,t))},WN=I.memo(nJ,UN);WN.displayName="YAxis";var iJ=(e,t)=>t,Fw=ve([iJ,Dt,$I,dn,M6,Rs,p$,Kr],E$),Lw=e=>{var t=e.currentTarget.getBoundingClientRect(),r=t.width/e.currentTarget.offsetWidth,n=t.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-t.left)/r),chartY:Math.round((e.clientY-t.top)/n)}},VN=Ji("mouseClick"),HN=uf();HN.startListening({actionCreator:VN,effect:(e,t)=>{var r=e.payload,n=Fw(t.getState(),Lw(r));(n==null?void 0:n.activeIndex)!=null&&t.dispatch(hG({activeIndex:n.activeIndex,activeDataKey:void 0,activeCoordinate:n.activeCoordinate}))}});var bv=Ji("mouseMove"),GN=uf(),wd=null;GN.startListening({actionCreator:bv,effect:(e,t)=>{var r=e.payload;wd!==null&&cancelAnimationFrame(wd);var n=Lw(r);wd=requestAnimationFrame(()=>{var i=t.getState(),a=hw(i,i.tooltip.settings.shared);if(a==="axis"){var o=Fw(i,n);(o==null?void 0:o.activeIndex)!=null?t.dispatch(b6({activeIndex:o.activeIndex,activeDataKey:void 0,activeCoordinate:o.activeCoordinate})):t.dispatch(_6())}wd=null})}});function aJ(e,t){return t instanceof HTMLElement?"HTMLElement <".concat(t.tagName,' class="').concat(t.className,'">'):t===window?"global.window":e==="children"&&typeof t=="object"&&t!==null?"<<CHILDREN>>":t}var I_={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index",baseValue:void 0,reverseStackOrder:!1},$N=hi({name:"rootProps",initialState:I_,reducers:{updateOptions:(e,t)=>{var r;e.accessibilityLayer=t.payload.accessibilityLayer,e.barCategoryGap=t.payload.barCategoryGap,e.barGap=(r=t.payload.barGap)!==null&&r!==void 0?r:I_.barGap,e.barSize=t.payload.barSize,e.maxBarSize=t.payload.maxBarSize,e.stackOffset=t.payload.stackOffset,e.syncId=t.payload.syncId,e.syncMethod=t.payload.syncMethod,e.className=t.payload.className,e.baseValue=t.payload.baseValue,e.reverseStackOrder=t.payload.reverseStackOrder}}}),sJ=$N.reducer,{updateOptions:oJ}=$N.actions,lJ=null,cJ={updatePolarOptions:(e,t)=>t.payload},XN=hi({name:"polarOptions",initialState:lJ,reducers:cJ}),{updatePolarOptions:uJ}=XN.actions,fJ=XN.reducer,KN=Ji("keyDown"),YN=Ji("focus"),Bw=uf();Bw.startListening({actionCreator:KN,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:i}=r.tooltip,a=e.payload;if(!(a!=="ArrowRight"&&a!=="ArrowLeft"&&a!=="Enter")){var o=pw(i,tu(r),Ef(r),Cf(r)),c=o==null?-1:Number(o);if(!(!Number.isFinite(c)||c<0)){var f=Rs(r);if(a==="Enter"){var d=d1(r,"axis","hover",String(i.index));t.dispatch(gv({active:!i.active,activeIndex:i.index,activeCoordinate:d}));return}var h=nG(r),m=h==="left-to-right"?1:-1,v=a==="ArrowRight"?1:-1,w=c+v*m;if(!(f==null||w>=f.length||w<0)){var E=d1(r,"axis","hover",String(w));t.dispatch(gv({active:!0,activeIndex:w.toString(),activeCoordinate:E}))}}}}}});Bw.startListening({actionCreator:YN,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:i}=r.tooltip;if(!i.active&&i.index==null){var a="0",o=d1(r,"axis","hover",String(a));t.dispatch(gv({active:!0,activeIndex:a,activeCoordinate:o}))}}}});var zi=Ji("externalEvent"),ZN=uf(),ym=new Map;ZN.startListening({actionCreator:zi,effect:(e,t)=>{var{handler:r,reactEvent:n}=e.payload;if(r!=null){n.persist();var i=n.type,a=ym.get(i);a!==void 0&&cancelAnimationFrame(a);var o=requestAnimationFrame(()=>{try{var c=t.getState(),f={activeCoordinate:JG(c),activeDataKey:yw(c),activeIndex:ml(c),activeLabel:B6(c),activeTooltipIndex:ml(c),isTooltipActive:e$(c)};r(f,n)}finally{ym.delete(i)}});ym.set(i,o)}}});var dJ=ve([Jc],e=>e.tooltipItemPayloads),hJ=ve([dJ,(e,t)=>t,(e,t,r)=>r],(e,t,r)=>{if(t!=null){var n=e.find(a=>a.settings.graphicalItemId===r);if(n!=null){var{getPosition:i}=n;if(i!=null)return i(t)}}}),qN=Ji("touchMove"),QN=uf();QN.startListening({actionCreator:qN,effect:(e,t)=>{var r=e.payload;if(!(r.touches==null||r.touches.length===0)){var n=t.getState(),i=hw(n,n.tooltip.settings.shared);if(i==="axis"){var a=r.touches[0];if(a==null)return;var o=Fw(n,Lw({clientX:a.clientX,clientY:a.clientY,currentTarget:r.currentTarget}));(o==null?void 0:o.activeIndex)!=null&&t.dispatch(b6({activeIndex:o.activeIndex,activeDataKey:void 0,activeCoordinate:o.activeCoordinate}))}else if(i==="item"){var c,f=r.touches[0];if(document.elementFromPoint==null||f==null)return;var d=document.elementFromPoint(f.clientX,f.clientY);if(!d||!d.getAttribute)return;var h=d.getAttribute(fk),m=(c=d.getAttribute(dk))!==null&&c!==void 0?c:void 0,v=eu(n).find(A=>A.id===m);if(h==null||v==null||m==null)return;var{dataKey:w}=v,E=hJ(n,h,m);t.dispatch(S6({activeDataKey:w,activeIndex:h,activeCoordinate:E,activeGraphicalItemId:m}))}}}});var pJ=DO({brush:dZ,cartesianAxis:eZ,chartData:q$,errorBars:sq,graphicalItems:gY,layout:RB,legend:Lj,options:$$,polarAxis:IK,polarOptions:fJ,referenceElements:mZ,rootProps:sJ,tooltip:pG,zIndex:M$}),gJ=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Chart";return aB({reducer:pJ,preloadedState:t,middleware:n=>{var i;return n({serializableCheck:!1,immutableCheck:!["commonjs","es6","production"].includes((i="es6")!==null&&i!==void 0?i:"")}).concat([HN.middleware,GN.middleware,Bw.middleware,ZN.middleware,QN.middleware])},enhancers:n=>{var i=n;return typeof n=="function"&&(i=n()),i.concat(KO({type:"raf"}))},devTools:{serialize:{replacer:aJ},name:"recharts-".concat(r)}})};function JN(e){var{preloadedState:t,children:r,reduxStoreName:n}=e,i=pi(),a=I.useRef(null);if(i)return r;a.current==null&&(a.current=gJ(t,n));var o=q2;return I.createElement(Mq,{context:o,store:a.current},r)}function mJ(e){var{layout:t,margin:r}=e,n=Qt(),i=pi();return I.useEffect(()=>{i||(n(NB(t)),n(IB(r)))},[n,i,t,r]),null}var eP=I.memo(mJ,Mw);function tP(e){var t=Qt();return I.useEffect(()=>{t(oJ(e))},[t,e]),null}function N_(e){var{zIndex:t,isPanorama:r}=e,n=I.useRef(null),i=Qt();return I.useLayoutEffect(()=>(n.current&&i(D$({zIndex:t,element:n.current,isPanorama:r})),()=>{i(R$({zIndex:t,isPanorama:r}))}),[i,t,r]),I.createElement("g",{tabIndex:-1,ref:n})}function P_(e){var{children:t,isPanorama:r}=e,n=Je(C$);if(!n||n.length===0)return t;var i=n.filter(o=>o<0),a=n.filter(o=>o>0);return I.createElement(I.Fragment,null,i.map(o=>I.createElement(N_,{key:o,zIndex:o,isPanorama:r})),t,a.map(o=>I.createElement(N_,{key:o,zIndex:o,isPanorama:r})))}var xJ=["children"];function vJ(e,t){if(e==null)return{};var r,n,i=yJ(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function yJ(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function y1(){return y1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},y1.apply(null,arguments)}var wJ={width:"100%",height:"100%",display:"block"},EJ=I.forwardRef((e,t)=>{var r=cy(),n=uy(),i=Dk();if(!$a(r)||!$a(n))return null;var{children:a,otherAttributes:o,title:c,desc:f}=e,d,h;return o!=null&&(typeof o.tabIndex=="number"?d=o.tabIndex:d=i?0:void 0,typeof o.role=="string"?h=o.role:h=i?"application":void 0),I.createElement(L2,y1({},o,{title:c,desc:f,role:h,tabIndex:d,width:r,height:n,style:wJ,ref:t}),a)}),AJ=e=>{var{children:t}=e,r=Je(yp);if(!r)return null;var{width:n,height:i,y:a,x:o}=r;return I.createElement(L2,{width:n,height:i,x:o,y:a},t)},D_=I.forwardRef((e,t)=>{var{children:r}=e,n=vJ(e,xJ),i=pi();return i?I.createElement(AJ,null,I.createElement(P_,{isPanorama:!0},r)):I.createElement(EJ,y1({ref:t},n),I.createElement(P_,{isPanorama:!1},r))});function CJ(){var e=Qt(),[t,r]=I.useState(null),n=Je(qB);return I.useEffect(()=>{if(t!=null){var i=t.getBoundingClientRect(),a=i.width/t.offsetWidth;St(a)&&a!==n&&e(DB(a))}},[t,e,n]),r}function R_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function SJ(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?R_(Object(r),!0).forEach(function(n){_J(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):R_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _J(e,t,r){return(t=bJ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function bJ(e){var t=TJ(e,"string");return typeof t=="symbol"?t:t+""}function TJ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function go(){return go=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},go.apply(null,arguments)}var OJ=()=>(sX(),null);function w1(e){if(typeof e=="number")return e;if(typeof e=="string"){var t=parseFloat(e);if(!Number.isNaN(t))return t}return 0}var kJ=I.forwardRef((e,t)=>{var r,n,i=I.useRef(null),[a,o]=I.useState({containerWidth:w1((r=e.style)===null||r===void 0?void 0:r.width),containerHeight:w1((n=e.style)===null||n===void 0?void 0:n.height)}),c=I.useCallback((d,h)=>{o(m=>{var v=Math.round(d),w=Math.round(h);return m.containerWidth===v&&m.containerHeight===w?m:{containerWidth:v,containerHeight:w}})},[]),f=I.useCallback(d=>{if(typeof t=="function"&&t(d),d!=null&&typeof ResizeObserver<"u"){var{width:h,height:m}=d.getBoundingClientRect();c(h,m);var v=E=>{var A=E[0];if(A!=null){var{width:S,height:b}=A.contentRect;c(S,b)}},w=new ResizeObserver(v);w.observe(d),i.current=w}},[t,c]);return I.useEffect(()=>()=>{var d=i.current;d!=null&&d.disconnect()},[c]),I.createElement(I.Fragment,null,I.createElement(df,{width:a.containerWidth,height:a.containerHeight}),I.createElement("div",go({ref:f},e)))}),IJ=I.forwardRef((e,t)=>{var{width:r,height:n}=e,[i,a]=I.useState({containerWidth:w1(r),containerHeight:w1(n)}),o=I.useCallback((f,d)=>{a(h=>{var m=Math.round(f),v=Math.round(d);return h.containerWidth===m&&h.containerHeight===v?h:{containerWidth:m,containerHeight:v}})},[]),c=I.useCallback(f=>{if(typeof t=="function"&&t(f),f!=null){var{width:d,height:h}=f.getBoundingClientRect();o(d,h)}},[t,o]);return I.createElement(I.Fragment,null,I.createElement(df,{width:i.containerWidth,height:i.containerHeight}),I.createElement("div",go({ref:c},e)))}),NJ=I.forwardRef((e,t)=>{var{width:r,height:n}=e;return I.createElement(I.Fragment,null,I.createElement(df,{width:r,height:n}),I.createElement("div",go({ref:t},e)))}),PJ=I.forwardRef((e,t)=>{var{width:r,height:n}=e;return typeof r=="string"||typeof n=="string"?I.createElement(IJ,go({},e,{ref:t})):typeof r=="number"&&typeof n=="number"?I.createElement(NJ,go({},e,{width:r,height:n,ref:t})):I.createElement(I.Fragment,null,I.createElement(df,{width:r,height:n}),I.createElement("div",go({ref:t},e)))});function DJ(e){return e?kJ:PJ}var RJ=I.forwardRef((e,t)=>{var{children:r,className:n,height:i,onClick:a,onContextMenu:o,onDoubleClick:c,onMouseDown:f,onMouseEnter:d,onMouseLeave:h,onMouseMove:m,onMouseUp:v,onTouchEnd:w,onTouchMove:E,onTouchStart:A,style:S,width:b,responsive:T,dispatchTouchEvents:_=!0}=e,N=I.useRef(null),M=Qt(),[R,P]=I.useState(null),[z,B]=I.useState(null),re=CJ(),ee=oy(),V=(ee==null?void 0:ee.width)>0?ee.width:b,de=(ee==null?void 0:ee.height)>0?ee.height:i,pe=I.useCallback(ce=>{re(ce),typeof t=="function"&&t(ce),P(ce),B(ce),ce!=null&&(N.current=ce)},[re,t,P,B]),K=I.useCallback(ce=>{M(VN(ce)),M(zi({handler:a,reactEvent:ce}))},[M,a]),Ce=I.useCallback(ce=>{M(bv(ce)),M(zi({handler:d,reactEvent:ce}))},[M,d]),ue=I.useCallback(ce=>{M(_6()),M(zi({handler:h,reactEvent:ce}))},[M,h]),se=I.useCallback(ce=>{M(bv(ce)),M(zi({handler:m,reactEvent:ce}))},[M,m]),q=I.useCallback(()=>{M(YN())},[M]),fe=I.useCallback(ce=>{M(KN(ce.key))},[M]),we=I.useCallback(ce=>{M(zi({handler:o,reactEvent:ce}))},[M,o]),G=I.useCallback(ce=>{M(zi({handler:c,reactEvent:ce}))},[M,c]),le=I.useCallback(ce=>{M(zi({handler:f,reactEvent:ce}))},[M,f]),ne=I.useCallback(ce=>{M(zi({handler:v,reactEvent:ce}))},[M,v]),ae=I.useCallback(ce=>{M(zi({handler:A,reactEvent:ce}))},[M,A]),he=I.useCallback(ce=>{_&&M(qN(ce)),M(zi({handler:E,reactEvent:ce}))},[M,_,E]),ke=I.useCallback(ce=>{M(zi({handler:w,reactEvent:ce}))},[M,w]),De=DJ(T);return I.createElement(G6.Provider,{value:R},I.createElement(D8.Provider,{value:z},I.createElement(De,{width:V??(S==null?void 0:S.width),height:de??(S==null?void 0:S.height),className:Bt("recharts-wrapper",n),style:SJ({position:"relative",cursor:"default",width:V,height:de},S),onClick:K,onContextMenu:we,onDoubleClick:G,onFocus:q,onKeyDown:fe,onMouseDown:le,onMouseEnter:Ce,onMouseLeave:ue,onMouseMove:se,onMouseUp:ne,onTouchEnd:ke,onTouchMove:he,onTouchStart:ae,ref:pe},I.createElement(OJ,null),r)))}),MJ=["width","height","responsive","children","className","style","compact","title","desc"];function FJ(e,t){if(e==null)return{};var r,n,i=LJ(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function LJ(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var rP=I.forwardRef((e,t)=>{var{width:r,height:n,responsive:i,children:a,className:o,style:c,compact:f,title:d,desc:h}=e,m=FJ(e,MJ),v=Sa(m);return f?I.createElement(I.Fragment,null,I.createElement(df,{width:r,height:n}),I.createElement(D_,{otherAttributes:v,title:d,desc:h},a)):I.createElement(RJ,{className:o,style:c,width:r,height:n,responsive:i??!1,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},I.createElement(D_,{otherAttributes:v,title:d,desc:h,ref:t},I.createElement(vZ,null,a)))});function Tv(){return Tv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Tv.apply(null,arguments)}var BJ={top:5,right:5,bottom:5,left:5},jJ={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,layout:"horizontal",margin:BJ,responsive:!1,reverseStackOrder:!1,stackOffset:"none",syncMethod:"index"},UJ=I.forwardRef(function(t,r){var n,i=un(t.categoricalChartProps,jJ),{chartName:a,defaultTooltipEventType:o,validateTooltipEventTypes:c,tooltipPayloadSearcher:f,categoricalChartProps:d}=t,h={chartName:a,defaultTooltipEventType:o,validateTooltipEventTypes:c,tooltipPayloadSearcher:f,eventEmitter:void 0};return I.createElement(JN,{preloadedState:{options:h},reduxStoreName:(n=d.id)!==null&&n!==void 0?n:a},I.createElement(ON,{chartData:d.data}),I.createElement(eP,{layout:i.layout,margin:i.margin}),I.createElement(tP,{baseValue:i.baseValue,accessibilityLayer:i.accessibilityLayer,barCategoryGap:i.barCategoryGap,maxBarSize:i.maxBarSize,stackOffset:i.stackOffset,barGap:i.barGap,barSize:i.barSize,syncId:i.syncId,syncMethod:i.syncMethod,className:i.className,reverseStackOrder:i.reverseStackOrder}),I.createElement(rP,Tv({},i,{ref:r})))}),zJ=["axis","item"],WJ=I.forwardRef((e,t)=>I.createElement(UJ,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:zJ,tooltipPayloadSearcher:X6,categoricalChartProps:e,ref:t}));function VJ(e){var t=Qt();return I.useEffect(()=>{t(uJ(e))},[t,e]),null}var HJ=["layout"];function Ov(){return Ov=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ov.apply(null,arguments)}function GJ(e,t){if(e==null)return{};var r,n,i=$J(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function $J(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var XJ={top:5,right:5,bottom:5,left:5},nP={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:XJ,reverseStackOrder:!1,syncMethod:"index",layout:"radial",responsive:!1,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},KJ=I.forwardRef(function(t,r){var n,i=un(t.categoricalChartProps,nP),{layout:a}=i,o=GJ(i,HJ),{chartName:c,defaultTooltipEventType:f,validateTooltipEventTypes:d,tooltipPayloadSearcher:h}=t,m={chartName:c,defaultTooltipEventType:f,validateTooltipEventTypes:d,tooltipPayloadSearcher:h,eventEmitter:void 0};return I.createElement(JN,{preloadedState:{options:m},reduxStoreName:(n=i.id)!==null&&n!==void 0?n:c},I.createElement(ON,{chartData:i.data}),I.createElement(eP,{layout:a,margin:i.margin}),I.createElement(tP,{baseValue:void 0,accessibilityLayer:i.accessibilityLayer,barCategoryGap:i.barCategoryGap,maxBarSize:i.maxBarSize,stackOffset:i.stackOffset,barGap:i.barGap,barSize:i.barSize,syncId:i.syncId,syncMethod:i.syncMethod,className:i.className,reverseStackOrder:i.reverseStackOrder}),I.createElement(VJ,{cx:i.cx,cy:i.cy,startAngle:i.startAngle,endAngle:i.endAngle,innerRadius:i.innerRadius,outerRadius:i.outerRadius}),I.createElement(rP,Ov({},o,{ref:r})))});function M_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function F_(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?M_(Object(r),!0).forEach(function(n){YJ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):M_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function YJ(e,t,r){return(t=ZJ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ZJ(e){var t=qJ(e,"string");return typeof t=="symbol"?t:t+""}function qJ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var QJ=["item"],JJ=F_(F_({},nP),{},{layout:"centric",startAngle:0,endAngle:360}),eee=I.forwardRef((e,t)=>{var r=un(e,JJ);return I.createElement(KJ,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:QJ,tooltipPayloadSearcher:X6,categoricalChartProps:r,ref:t})});const Ed=["#7c3aed","#ec4899","#06b6d4"],L_=()=>{const e=[];for(let t=6;t>=0;t--){const r=new Date;r.setDate(r.getDate()-t),e.push({date:r.toISOString().slice(0,10),label:r.toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"}),visitors:0,students:0})}return e},tee=()=>{const[e,t]=I.useState(null),[r,n]=I.useState(!0);if(I.useEffect(()=>{const a=async()=>{try{const c=await fetch(`${Ut}/reports/chart`),f=await c.json();c.ok&&Array.isArray(f)&&f.length>0?t(f):t(L_())}catch{t(L_())}finally{n(!1)}};a();const o=setInterval(a,3e4);return()=>clearInterval(o)},[]),r||!e)return k.jsxs("div",{className:"charts-row",children:[k.jsx("div",{className:"chart-card chart-skeleton"}),k.jsx("div",{className:"chart-card chart-skeleton"})]});let i=[{name:"Visitors",value:e.reduce((a,o)=>a+o.visitors,0),color:Ed[0]},{name:"Students",value:e.reduce((a,o)=>a+o.students,0),color:Ed[1]}].filter(a=>a.value>0);return i.length===0&&(i=[{name:"No data yet",value:1,color:"#94a3b8"}]),k.jsxs("div",{className:"charts-row",children:[k.jsxs("div",{className:"chart-card chart-bar",children:[k.jsx("h4",{children:"Visit & Entry Statistics"}),k.jsx("div",{className:"chart-inner",children:k.jsx(P3,{width:"100%",height:280,children:k.jsxs(WJ,{data:e,margin:{top:10,right:10,left:0,bottom:0},children:[k.jsx(DN,{strokeDasharray:"3 3",stroke:"rgba(0,0,0,0.06)"}),k.jsx(zN,{dataKey:"label",tick:{fontSize:11}}),k.jsx(WN,{tick:{fontSize:11},domain:[0,"auto"],allowDecimals:!1}),k.jsx(FS,{contentStyle:{borderRadius:8,border:"none",boxShadow:"0 4px 12px rgba(0,0,0,0.1)"}}),k.jsx(Ev,{dataKey:"visitors",fill:Ed[0],radius:[4,4,0,0],name:"Visitors"}),k.jsx(Ev,{dataKey:"students",fill:Ed[1],radius:[4,4,0,0],name:"Students"})]})})})]}),k.jsxs("div",{className:"chart-card chart-pie",children:[k.jsx("h4",{children:"Entry Type Distribution"}),k.jsx("div",{className:"chart-inner",children:k.jsx(P3,{width:"100%",height:280,children:k.jsxs(eee,{children:[k.jsx(SN,{data:i,cx:"50%",cy:"50%",innerRadius:60,outerRadius:100,paddingAngle:2,dataKey:"value",label:({name:a,percent:o})=>`${a} ${(o*100).toFixed(0)}%`,children:i.map((a,o)=>k.jsx(_f,{fill:a.color},o))}),k.jsx(FS,{formatter:(a,o,c)=>[`${a} entries`,c.payload.name],contentStyle:{borderRadius:8,border:"none",boxShadow:"0 4px 12px rgba(0,0,0,0.1)"}}),k.jsx(Pk,{})]})})})]})]})},ree=()=>k.jsxs("div",{className:"reception-screen",children:[k.jsxs("div",{className:"page-header",children:[k.jsx("h2",{children:"Dashboard"}),k.jsx("span",{className:"page-subtitle",children:"Overview"})]}),k.jsx(DF,{}),k.jsx(tee,{}),k.jsxs("div",{className:"reception-layout",children:[k.jsxs("section",{className:"panel panel-scanner",children:[k.jsxs("div",{className:"panel-header",children:[k.jsx("div",{className:"panel-icon",children:k.jsx(T0,{size:20,strokeWidth:2})}),k.jsx("h3",{children:"Student Entry (Scanner)"})]}),k.jsx(PF,{})]}),k.jsxs("section",{className:"panel panel-form",children:[k.jsxs("div",{className:"panel-header",children:[k.jsx("div",{className:"panel-icon",children:k.jsx(P7,{size:20,strokeWidth:2})}),k.jsx("h3",{children:"Visitor Check-In"})]}),k.jsx(aF,{})]}),k.jsxs("section",{className:"panel panel-active",children:[k.jsxs("div",{className:"panel-header",children:[k.jsx("div",{className:"panel-icon",children:k.jsx(Y1,{size:20,strokeWidth:2})}),k.jsx("h3",{children:"Active Visitors (Check-Out)"})]}),k.jsx(oF,{})]})]})]}),nee=["No Uniform","Late Entry","No ID Card","Misconduct"];function iee(){const{addToast:e}=Cl(),[t,r]=I.useState([]),[n,i]=I.useState(""),[a,o]=I.useState([]),[c,f]=I.useState(null),[d,h]=I.useState({fineType:"",amount:"",reason:"",date:new Date().toISOString().slice(0,10)}),[m,v]=I.useState(!1),[w,E]=I.useState(!1);I.useEffect(()=>{fetch(`${Ut}/students/departments`,{credentials:"include"}).then(T=>T.json()).then(T=>r(T.departments||[])).catch(()=>r([]))},[]);const A=async()=>{const T=(n||"").trim();if(!T){e({message:"Enter Student ID or name to search",type:"error",size:"small"});return}E(!0);try{const _=await fetch(`${Ut}/students?q=${encodeURIComponent(T)}`,{credentials:"include"}),N=await _.json();if(!_.ok)throw new Error(N.message||"Search failed");const M=Array.isArray(N)?N:[];o(M),M.length===0?(e({message:"No students found",type:"info",size:"small"}),f(null)):M.length===1?(f(M[0]),e({message:"Student selected",type:"success",size:"small"})):f(null)}catch(_){e({message:_.message||"Search failed",type:"error",size:"small"}),o([])}finally{E(!1)}},S=T=>{f(T),h(_=>({..._}))},b=async T=>{if(T.preventDefault(),!c){e({message:"Select a student first",type:"error",size:"small"});return}if(!d.fineType||!d.amount){e({message:"Fine type and amount are required",type:"error",size:"small"});return}const _=Number(d.amount);if(isNaN(_)||_<=0){e({message:"Amount must be a positive number",type:"error",size:"small"});return}v(!0);try{const N=await fetch(`${Ut}/fines`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({studentId:c.studentId,name:c.name,department:c.department,fineType:d.fineType,amount:_,reason:d.reason||"",date:d.date||new Date().toISOString()})}),M=await N.text();let R;try{R=M?JSON.parse(M):{}}catch{throw new Error(N.ok?"Invalid response from server":"Backend may not be running or returned an error. Ensure the backend is running on port 5000.")}if(!N.ok)throw new Error(R.message||"Failed to add fine");e({message:`Fine of Rs.${_} added for ${c.name}`,type:"success",size:"small"}),h({fineType:"",amount:"",reason:"",date:new Date().toISOString().slice(0,10)}),f(null),i(""),o([])}catch(N){e({message:N.message||"Failed to add fine",type:"error",size:"small"})}finally{v(!1)}};return k.jsxs("div",{className:"admin-section",children:[k.jsxs("div",{className:"panel-header",children:[k.jsx("div",{className:"panel-icon",children:k.jsx(r8,{size:20,strokeWidth:2})}),k.jsx("h3",{children:"Add Fine (Manual Entry)"})]}),k.jsx("p",{className:"section-hint",children:"Search student by ID or name, then add a fine."}),k.jsxs("div",{className:"form-large",style:{marginBottom:"1.5rem"},children:[k.jsxs("div",{className:"form-row-inline",style:{gap:"0.5rem",alignItems:"flex-end"},children:[k.jsxs("div",{className:"form-group",style:{flex:1},children:[k.jsx("label",{children:"Search Student (ID or Name)"}),k.jsx("input",{type:"text",value:n,onChange:T=>i(T.target.value),onKeyDown:T=>T.key==="Enter"&&(T.preventDefault(),A()),placeholder:"e.g. IHS-RAD-001 or Ahmed",className:"input-large"})]}),k.jsx("button",{type:"button",className:"btn-secondary",onClick:A,disabled:w,children:w?k.jsxs(k.Fragment,{children:[k.jsx(Ic,{})," Searching..."]}):"Search"})]}),a.length>0&&k.jsxs("div",{style:{marginTop:"0.75rem"},children:[k.jsx("p",{className:"section-hint",style:{marginBottom:"0.5rem",fontSize:"0.85rem"},children:c?k.jsxs(k.Fragment,{children:[k.jsx(K1,{size:14,strokeWidth:2,style:{marginRight:4,verticalAlign:"middle"}})," Student selected"]}):"Click a student below to select"}),k.jsx("div",{className:"search-results",style:{maxHeight:"180px",overflowY:"auto",border:"1px solid #e2e8f0",borderRadius:"8px"},children:a.map(T=>k.jsxs("div",{onClick:()=>S(T),className:(c==null?void 0:c._id)===T._id?"search-result-item selected":"search-result-item",style:{padding:"0.6rem 1rem",cursor:"pointer",borderBottom:"1px solid #f1f5f9"},children:[k.jsx("strong",{children:T.studentId}),"  ",T.name," (",T.department,")"]},T._id))})]}),c&&k.jsxs("div",{className:"status success",style:{marginTop:"0.75rem"},children:["Selected: ",k.jsx("strong",{children:c.studentId}),"  ",c.name," (",c.department,")"]})]}),k.jsxs("form",{className:"form-large",onSubmit:b,children:[k.jsxs("div",{className:"form-row-inline form-row-2",children:[k.jsxs("div",{className:"form-group",children:[k.jsx("label",{children:"Fine Type"}),k.jsxs("select",{value:d.fineType,onChange:T=>h(_=>({..._,fineType:T.target.value})),className:"input-large select-professional",required:!0,children:[k.jsx("option",{value:"",children:"Select type..."}),nee.map(T=>k.jsx("option",{value:T,children:T},T))]})]}),k.jsxs("div",{className:"form-group",children:[k.jsx("label",{children:"Amount (Rs.)"}),k.jsx("input",{type:"number",min:"1",value:d.amount,onChange:T=>h(_=>({..._,amount:T.target.value})),placeholder:"e.g. 500",className:"input-large",required:!0})]})]}),k.jsxs("div",{className:"form-row-inline form-row-2",children:[k.jsxs("div",{className:"form-group",children:[k.jsx("label",{children:"Reason (optional)"}),k.jsx("input",{type:"text",value:d.reason,onChange:T=>h(_=>({..._,reason:T.target.value})),placeholder:"Additional details",className:"input-large"})]}),k.jsxs("div",{className:"form-group",children:[k.jsx("label",{children:"Date"}),k.jsx("input",{type:"date",value:d.date,onChange:T=>h(_=>({..._,date:T.target.value})),className:"input-large"})]})]}),k.jsx("button",{type:"submit",className:"btn-primary-wide",disabled:m||!c||!d.fineType||!d.amount,title:c?!d.fineType||!d.amount?"Fill fine type and amount":"":"Search and select a student first",children:m?k.jsxs(k.Fragment,{children:[k.jsx(Ic,{})," Adding..."]}):"Add Fine"})]})]})}function aee(){const{addToast:e}=Cl(),[t,r]=I.useState([]),[n,i]=I.useState(!1),[a,o]=I.useState({from:"",to:"",department:"",studentId:""}),[c,f]=I.useState([]);I.useEffect(()=>{fetch(`${Ut}/students/departments`,{credentials:"include"}).then(m=>m.json()).then(m=>f(m.departments||[])).catch(()=>f([]))},[]);const d=async()=>{i(!0);try{const m=new URLSearchParams;a.from&&m.append("from",a.from),a.to&&m.append("to",a.to),a.department&&m.append("department",a.department),a.studentId&&m.append("studentId",a.studentId);const v=await fetch(`${Ut}/fines?${m.toString()}`,{credentials:"include"}),w=await v.json();if(!v.ok)throw new Error(w.message||"Failed to load fines");r(w)}catch(m){e({message:m.message||"Failed to load fines",type:"error",size:"small"}),r([])}finally{i(!1)}},h=()=>{const m=new URLSearchParams;a.from&&m.append("from",a.from),a.to&&m.append("to",a.to),a.department&&m.append("department",a.department),a.studentId&&m.append("studentId",a.studentId),window.open(`${Ut}/export/fines?${m.toString()}`,"_blank"),e({message:"CSV export opened in new tab",type:"success",size:"small"})};return I.useEffect(()=>{d()},[]),k.jsxs("div",{className:"admin-section",children:[k.jsxs("div",{className:"panel-header",children:[k.jsx("div",{className:"panel-icon",children:k.jsx(Y1,{size:20,strokeWidth:2})}),k.jsx("h3",{children:"Fines History"})]}),k.jsxs("div",{className:"filters-row",style:{marginBottom:"1rem"},children:[k.jsxs("div",{children:[k.jsx("label",{children:"From"}),k.jsx("input",{type:"date",value:a.from,onChange:m=>o(v=>({...v,from:m.target.value}))})]}),k.jsxs("div",{children:[k.jsx("label",{children:"To"}),k.jsx("input",{type:"date",value:a.to,onChange:m=>o(v=>({...v,to:m.target.value}))})]}),k.jsxs("div",{children:[k.jsx("label",{children:"Department"}),k.jsxs("select",{value:a.department,onChange:m=>o(v=>({...v,department:m.target.value})),children:[k.jsx("option",{value:"",children:"All"}),c.map(m=>k.jsx("option",{value:m,children:m},m))]})]}),k.jsxs("div",{children:[k.jsx("label",{children:"Student ID"}),k.jsx("input",{type:"text",value:a.studentId,onChange:m=>o(v=>({...v,studentId:m.target.value})),placeholder:"Filter by ID"})]}),k.jsx("button",{className:"btn-secondary",onClick:d,children:"Apply"}),k.jsx("button",{className:"btn-secondary",onClick:h,children:"Export CSV"})]}),n?k.jsx(Ah,{rows:6,cols:7}):k.jsx("div",{className:"table-wrapper",children:k.jsxs("table",{className:"table-large",children:[k.jsx("thead",{children:k.jsxs("tr",{children:[k.jsx("th",{children:"Student ID"}),k.jsx("th",{children:"Name"}),k.jsx("th",{children:"Department"}),k.jsx("th",{children:"Fine Type"}),k.jsx("th",{children:"Amount"}),k.jsx("th",{children:"Reason"}),k.jsx("th",{children:"Date"}),k.jsx("th",{children:"Added By"})]})}),k.jsx("tbody",{children:t.map(m=>k.jsxs("tr",{children:[k.jsx("td",{children:m.studentId}),k.jsx("td",{children:m.name}),k.jsx("td",{children:k.jsx("span",{className:"dept-badge",children:m.department})}),k.jsx("td",{children:k.jsx("span",{className:"fine-badge",children:m.fineType})}),k.jsxs("td",{children:["Rs. ",m.amount]}),k.jsx("td",{children:m.reason||""}),k.jsx("td",{children:m.date?new Date(m.date).toLocaleString():""}),k.jsx("td",{children:m.addedBy||""})]},m._id))})]})}),!n&&t.length===0&&k.jsx("div",{className:"empty-state",children:"No fines recorded."})]})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var iP=1252,see=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],jw={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Uw=function(e){see.indexOf(e)!=-1&&(iP=jw[0]=e)};function oee(){Uw(1252)}var xa=function(e){Uw(e)};function aP(){xa(1200),oee()}function B_(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function lee(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function sP(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var zu=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?lee(e.slice(2)):t==254&&r==255?sP(e.slice(2)):t==65279?e.slice(1):e},Ad=function(t){return String.fromCharCode(t)},j_=function(t){return String.fromCharCode(t)},H0,no="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function U_(e){for(var t="",r=0,n=0,i=0,a=0,o=0,c=0,f=0,d=0;d<e.length;)r=e.charCodeAt(d++),a=r>>2,n=e.charCodeAt(d++),o=(r&3)<<4|n>>4,i=e.charCodeAt(d++),c=(n&15)<<2|i>>6,f=i&63,isNaN(n)?c=f=64:isNaN(i)&&(f=64),t+=no.charAt(a)+no.charAt(o)+no.charAt(c)+no.charAt(f);return t}function ki(e){var t="",r=0,n=0,i=0,a=0,o=0,c=0,f=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<e.length;)a=no.indexOf(e.charAt(d++)),o=no.indexOf(e.charAt(d++)),r=a<<2|o>>4,t+=String.fromCharCode(r),c=no.indexOf(e.charAt(d++)),n=(o&15)<<4|c>>2,c!==64&&(t+=String.fromCharCode(n)),f=no.indexOf(e.charAt(d++)),i=(c&3)<<6|f,f!==64&&(t+=String.fromCharCode(i));return t}var Ct=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Ol=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function wo(e){return Ct?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function z_(e){return Ct?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var ma=function(t){return Ct?Ol(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function kl(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function zw(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return zw(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Js=Ct?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Ol(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),i=0;for(t=0,r=0;t<e.length;r+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function cee(e){for(var t=[],r=0,n=e.length+250,i=wo(e.length+255),a=0;a<e.length;++a){var o=e.charCodeAt(a);if(o<128)i[r++]=o;else if(o<2048)i[r++]=192|o>>6&31,i[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var c=e.charCodeAt(++a)&1023;i[r++]=240|o>>8&7,i[r++]=128|o>>2&63,i[r++]=128|c>>6&15|(o&3)<<4,i[r++]=128|c&63}else i[r++]=224|o>>12&15,i[r++]=128|o>>6&63,i[r++]=128|o&63;r>n&&(t.push(i.slice(0,r)),r=0,i=wo(65535),n=65530)}return t.push(i.slice(0,r)),Js(t)}var Kn=/\u0000/g,Wu=/[\u0001-\u0006]/g;function wc(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function va(e,t){var r=""+e;return r.length>=t?r:br("0",t-r.length)+r}function Ww(e,t){var r=""+e;return r.length>=t?r:br(" ",t-r.length)+r}function E1(e,t){var r=""+e;return r.length>=t?r:r+br(" ",t-r.length)}function uee(e,t){var r=""+Math.round(e);return r.length>=t?r:br("0",t-r.length)+r}function fee(e,t){var r=""+e;return r.length>=t?r:br("0",t-r.length)+r}var W_=Math.pow(2,32);function $l(e,t){if(e>W_||e<-W_)return uee(e,t);var r=Math.round(e);return fee(r,t)}function A1(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var V_=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],wm=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function dee(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var ft={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},H_={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},hee={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function C1(e,t,r){for(var n=e<0?-1:1,i=e*n,a=0,o=1,c=0,f=1,d=0,h=0,m=Math.floor(i);d<t&&(m=Math.floor(i),c=m*o+a,h=m*d+f,!(i-m<5e-8));)i=1/(i-m),a=o,o=c,f=d,d=h;if(h>t&&(d>t?(h=f,c=a):(h=d,c=o)),!r)return[0,n*c,h];var v=Math.floor(n*c/h);return[v,n*c-v*h,h]}function Yo(e,t,r){if(e>2958465||e<0)return null;var n=e|0,i=Math.floor(86400*(e-n)),a=0,o=[],c={D:n,T:i,u:86400*(e-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),t&&t.date1904&&(n+=1462),c.u>.9999&&(c.u=0,++i==86400&&(c.T=i=0,++n,++c.D)),n===60)o=r?[1317,10,29]:[1900,2,29],a=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var f=new Date(1900,0,1);f.setDate(f.getDate()+n-1),o=[f.getFullYear(),f.getMonth()+1,f.getDate()],a=f.getDay(),n<60&&(a=(a+6)%7),r&&(a=yee(f,o))}return c.y=o[0],c.m=o[1],c.d=o[2],c.S=i%60,i=Math.floor(i/60),c.M=i%60,i=Math.floor(i/60),c.H=i,c.q=a,c}var oP=new Date(1899,11,31,0,0,0),pee=oP.getTime(),gee=new Date(1900,2,1,0,0,0);function lP(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=gee&&(r+=24*60*60*1e3),(r-(pee+(e.getTimezoneOffset()-oP.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Vw(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function mee(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function xee(e){var t=e<0?12:11,r=Vw(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function vee(e){var t=Vw(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function G0(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=xee(e):t===10?r=e.toFixed(10).substr(0,12):r=vee(e),Vw(mee(r.toUpperCase()))}function vl(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):G0(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return ta(14,lP(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function yee(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function wee(e,t,r,n){var i="",a=0,o=0,c=r.y,f,d=0;switch(e){case 98:c=r.y+543;case 121:switch(t.length){case 1:case 2:f=c%100,d=2;break;default:f=c%1e4,d=4;break}break;case 109:switch(t.length){case 1:case 2:f=r.m,d=t.length;break;case 3:return wm[r.m-1][1];case 5:return wm[r.m-1][0];default:return wm[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:f=r.d,d=t.length;break;case 3:return V_[r.q][0];default:return V_[r.q][1]}break;case 104:switch(t.length){case 1:case 2:f=1+(r.H+11)%12,d=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:f=r.H,d=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:f=r.M,d=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?va(r.S,t.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,a=Math.round(o*(r.S+r.u)),a>=60*o&&(a=0),t==="s"?a===0?"0":""+a/o:(i=va(a,2+n),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":f=r.D*24+r.H;break;case"[m]":case"[mm]":f=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":f=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}d=t.length===3?1:2;break;case 101:f=c,d=1;break}var h=d>0?va(f,d):"";return h}function io(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var cP=/%/g;function Eee(e,t,r){var n=t.replace(cP,""),i=t.length-n.length;return ds(e,n,r*Math.pow(10,2*i))+br("%",i)}function Aee(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return ds(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function uP(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+uP(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%i;if(a<0&&(a+=i),r=(t/Math.pow(10,a)).toPrecision(n+1+(i+a)%i),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+a):r+="E+"+(o-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,f,d,h){return f+d+h.substr(0,(i+a)%i)+"."+h.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var fP=/# (\?+)( ?)\/( ?)(\d+)/;function Cee(e,t,r){var n=parseInt(e[4],10),i=Math.round(t*n),a=Math.floor(i/n),o=i-a*n,c=n;return r+(a===0?"":""+a)+" "+(o===0?br(" ",e[1].length+1+e[4].length):Ww(o,e[1].length)+e[2]+"/"+e[3]+va(c,e[4].length))}function See(e,t,r){return r+(t===0?"":""+t)+br(" ",e[1].length+2+e[4].length)}var dP=/^#*0*\.([0#]+)/,hP=/\).*[0#]/,pP=/\(###\) ###\\?-####/;function Wn(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function G_(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function $_(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function _ee(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function bee(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Wi(e,t,r){if(e.charCodeAt(0)===40&&!t.match(hP)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Wi("n",n,r):"("+Wi("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Aee(e,t,r);if(t.indexOf("%")!==-1)return Eee(e,t,r);if(t.indexOf("E")!==-1)return uP(t,r);if(t.charCodeAt(0)===36)return"$"+Wi(e,t.substr(t.charAt(1)==" "?2:1),r);var i,a,o,c,f=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+$l(f,t.length);if(t.match(/^[#?]+$/))return i=$l(r,0),i==="0"&&(i=""),i.length>t.length?i:Wn(t.substr(0,t.length-i.length))+i;if(a=t.match(fP))return Cee(a,f,d);if(t.match(/^#+0+$/))return d+$l(f,t.length-t.indexOf("0"));if(a=t.match(dP))return i=G_(r,a[1].length).replace(/^([^\.]+)$/,"$1."+Wn(a[1])).replace(/\.$/,"."+Wn(a[1])).replace(/\.(\d*)$/,function(E,A){return"."+A+br("0",Wn(a[1]).length-A.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return d+G_(f,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return d+io($l(f,0));if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Wi(e,t,-r):io(""+(Math.floor(r)+_ee(r,a[1].length)))+"."+va($_(r,a[1].length),a[1].length);if(a=t.match(/^#,#*,#0/))return Wi(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=wc(Wi(e,t.replace(/[\\-]/g,""),r)),o=0,wc(wc(t.replace(/\\/g,"")).replace(/[0#]/g,function(E){return o<i.length?i.charAt(o++):E==="0"?"0":""}));if(t.match(pP))return i=Wi(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var h="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(a[4].length,7),c=C1(f,Math.pow(10,o)-1,!1),i=""+d,h=ds("n",a[1],c[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),i+=h+a[2]+"/"+a[3],h=E1(c[2],o),h.length<a[4].length&&(h=Wn(a[4].substr(a[4].length-h.length))+h),i+=h,i;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(a[1].length,a[4].length),7),c=C1(f,Math.pow(10,o)-1,!0),d+(c[0]||(c[1]?"":"0"))+" "+(c[1]?Ww(c[1],o)+a[2]+"/"+a[3]+E1(c[2],o):br(" ",2*o+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return i=$l(r,0),t.length<=i.length?i:Wn(t.substr(0,t.length-i.length))+i;if(a=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var m=t.indexOf(".")-o,v=t.length-i.length-m;return Wn(t.substr(0,m)+i+t.substr(t.length-v))}if(a=t.match(/^00,000\.([#0]*0)$/))return o=$_(r,a[1].length),r<0?"-"+Wi(e,t,-r):io(bee(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(E){return"00,"+(E.length<3?va(0,3-E.length):"")+E})+"."+va(o,a[1].length);switch(t){case"###,##0.00":return Wi(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var w=io($l(f,0));return w!=="0"?d+w:"";case"###,###.00":return Wi(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Wi(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function Tee(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return ds(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function Oee(e,t,r){var n=t.replace(cP,""),i=t.length-n.length;return ds(e,n,r*Math.pow(10,2*i))+br("%",i)}function gP(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+gP(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%i;if(a<0&&(a+=i),r=(t/Math.pow(10,a)).toPrecision(n+1+(i+a)%i),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+a):r+="E+"+(o-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,f,d,h){return f+d+h.substr(0,(i+a)%i)+"."+h.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Fa(e,t,r){if(e.charCodeAt(0)===40&&!t.match(hP)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Fa("n",n,r):"("+Fa("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Tee(e,t,r);if(t.indexOf("%")!==-1)return Oee(e,t,r);if(t.indexOf("E")!==-1)return gP(t,r);if(t.charCodeAt(0)===36)return"$"+Fa(e,t.substr(t.charAt(1)==" "?2:1),r);var i,a,o,c,f=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+va(f,t.length);if(t.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>t.length?i:Wn(t.substr(0,t.length-i.length))+i;if(a=t.match(fP))return See(a,f,d);if(t.match(/^#+0+$/))return d+va(f,t.length-t.indexOf("0"));if(a=t.match(dP))return i=(""+r).replace(/^([^\.]+)$/,"$1."+Wn(a[1])).replace(/\.$/,"."+Wn(a[1])),i=i.replace(/\.(\d*)$/,function(E,A){return"."+A+br("0",Wn(a[1]).length-A.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return d+(""+f).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return d+io(""+f);if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Fa(e,t,-r):io(""+r)+"."+br("0",a[1].length);if(a=t.match(/^#,#*,#0/))return Fa(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=wc(Fa(e,t.replace(/[\\-]/g,""),r)),o=0,wc(wc(t.replace(/\\/g,"")).replace(/[0#]/g,function(E){return o<i.length?i.charAt(o++):E==="0"?"0":""}));if(t.match(pP))return i=Fa(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var h="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(a[4].length,7),c=C1(f,Math.pow(10,o)-1,!1),i=""+d,h=ds("n",a[1],c[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),i+=h+a[2]+"/"+a[3],h=E1(c[2],o),h.length<a[4].length&&(h=Wn(a[4].substr(a[4].length-h.length))+h),i+=h,i;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(a[1].length,a[4].length),7),c=C1(f,Math.pow(10,o)-1,!0),d+(c[0]||(c[1]?"":"0"))+" "+(c[1]?Ww(c[1],o)+a[2]+"/"+a[3]+E1(c[2],o):br(" ",2*o+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return i=""+r,t.length<=i.length?i:Wn(t.substr(0,t.length-i.length))+i;if(a=t.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var m=t.indexOf(".")-o,v=t.length-i.length-m;return Wn(t.substr(0,m)+i+t.substr(t.length-v))}if(a=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Fa(e,t,-r):io(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(E){return"00,"+(E.length<3?va(0,3-E.length):"")+E})+"."+va(0,a[1].length);switch(t){case"###,###":case"##,###":case"#,###":var w=io(""+f);return w!=="0"?d+w:"";default:if(t.match(/\.[0#?]*$/))return Fa(e,t.slice(0,t.lastIndexOf(".")),r)+Wn(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function ds(e,t,r){return(r|0)===r?Fa(e,t,r):Wi(e,t,r)}function kee(e){for(var t=[],r=!1,n=0,i=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(i,n-i),i=n+1}if(t[t.length]=e.substr(i),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var mP=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function ru(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":A1(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(mP))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function Iee(e,t,r,n){for(var i=[],a="",o=0,c="",f="t",d,h,m,v="H";o<e.length;)switch(c=e.charAt(o)){case"G":if(!A1(e,o))throw new Error("unrecognized character "+c+" in "+e);i[i.length]={t:"G",v:"General"},o+=7;break;case'"':for(a="";(m=e.charCodeAt(++o))!==34&&o<e.length;)a+=String.fromCharCode(m);i[i.length]={t:"t",v:a},++o;break;case"\\":var w=e.charAt(++o),E=w==="("||w===")"?w:"t";i[i.length]={t:E,v:w},++o;break;case"_":i[i.length]={t:"t",v:" "},o+=2;break;case"@":i[i.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(d==null&&(d=Yo(t,r,e.charAt(o+1)==="2"),d==null))return"";i[i.length]={t:"X",v:e.substr(o,2)},f=c,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||d==null&&(d=Yo(t,r),d==null))return"";for(a=c;++o<e.length&&e.charAt(o).toLowerCase()===c;)a+=c;c==="m"&&f.toLowerCase()==="h"&&(c="M"),c==="h"&&(c=v),i[i.length]={t:c,v:a},f=c;break;case"A":case"a":case"":var A={t:c,v:c};if(d==null&&(d=Yo(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(d!=null&&(A.v=d.H>=12?"P":"A"),A.t="T",v="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(d!=null&&(A.v=d.H>=12?"PM":"AM"),A.t="T",o+=5,v="h"):e.substr(o,5).toUpperCase()==="/"?(d!=null&&(A.v=d.H>=12?"":""),A.t="T",o+=5,v="h"):(A.t="t",++o),d==null&&A.t==="T")return"";i[i.length]=A,f=c;break;case"[":for(a=c;e.charAt(o++)!=="]"&&o<e.length;)a+=e.charAt(o);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(mP)){if(d==null&&(d=Yo(t,r),d==null))return"";i[i.length]={t:"Z",v:a.toLowerCase()},f=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",ru(e)||(i[i.length]={t:"t",v:a}));break;case".":if(d!=null){for(a=c;++o<e.length&&(c=e.charAt(o))==="0";)a+=c;i[i.length]={t:"s",v:a};break}case"0":case"#":for(a=c;++o<e.length&&"0#?.,E+-%".indexOf(c=e.charAt(o))>-1;)a+=c;i[i.length]={t:"n",v:a};break;case"?":for(a=c;e.charAt(++o)===c;)a+=c;i[i.length]={t:c,v:a},f=c;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":i[i.length]={t:n===1?"t":c,v:c},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=c;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)a+=e.charAt(o);i[i.length]={t:"D",v:a};break;case" ":i[i.length]={t:c,v:c},++o;break;case"$":i[i.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+e);i[i.length]={t:"t",v:c},++o;break}var S=0,b=0,T;for(o=i.length-1,f="t";o>=0;--o)switch(i[o].t){case"h":case"H":i[o].t=v,f="h",S<1&&(S=1);break;case"s":(T=i[o].v.match(/\.0+$/))&&(b=Math.max(b,T[0].length-1)),S<3&&(S=3);case"d":case"y":case"M":case"e":f=i[o].t;break;case"m":f==="s"&&(i[o].t="M",S<2&&(S=2));break;case"X":break;case"Z":S<1&&i[o].v.match(/[Hh]/)&&(S=1),S<2&&i[o].v.match(/[Mm]/)&&(S=2),S<3&&i[o].v.match(/[Ss]/)&&(S=3)}switch(S){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var _="",N;for(o=0;o<i.length;++o)switch(i[o].t){case"t":case"T":case" ":case"D":break;case"X":i[o].v="",i[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[o].v=wee(i[o].t.charCodeAt(0),i[o].v,d,b),i[o].t="t";break;case"n":case"?":for(N=o+1;i[N]!=null&&((c=i[N].t)==="?"||c==="D"||(c===" "||c==="t")&&i[N+1]!=null&&(i[N+1].t==="?"||i[N+1].t==="t"&&i[N+1].v==="/")||i[o].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(i[N].v==="/"||i[N].v===" "&&i[N+1]!=null&&i[N+1].t=="?"));)i[o].v+=i[N].v,i[N]={v:"",t:";"},++N;_+=i[o].v,o=N-1;break;case"G":i[o].t="t",i[o].v=vl(t,r);break}var M="",R,P;if(_.length>0){_.charCodeAt(0)==40?(R=t<0&&_.charCodeAt(0)===45?-t:t,P=ds("n",_,R)):(R=t<0&&n>1?-t:t,P=ds("n",_,R),R<0&&i[0]&&i[0].t=="t"&&(P=P.substr(1),i[0].v="-"+i[0].v)),N=P.length-1;var z=i.length;for(o=0;o<i.length;++o)if(i[o]!=null&&i[o].t!="t"&&i[o].v.indexOf(".")>-1){z=o;break}var B=i.length;if(z===i.length&&P.indexOf("E")===-1){for(o=i.length-1;o>=0;--o)i[o]==null||"n?".indexOf(i[o].t)===-1||(N>=i[o].v.length-1?(N-=i[o].v.length,i[o].v=P.substr(N+1,i[o].v.length)):N<0?i[o].v="":(i[o].v=P.substr(0,N+1),N=-1),i[o].t="t",B=o);N>=0&&B<i.length&&(i[B].v=P.substr(0,N+1)+i[B].v)}else if(z!==i.length&&P.indexOf("E")===-1){for(N=P.indexOf(".")-1,o=z;o>=0;--o)if(!(i[o]==null||"n?".indexOf(i[o].t)===-1)){for(h=i[o].v.indexOf(".")>-1&&o===z?i[o].v.indexOf(".")-1:i[o].v.length-1,M=i[o].v.substr(h+1);h>=0;--h)N>=0&&(i[o].v.charAt(h)==="0"||i[o].v.charAt(h)==="#")&&(M=P.charAt(N--)+M);i[o].v=M,i[o].t="t",B=o}for(N>=0&&B<i.length&&(i[B].v=P.substr(0,N+1)+i[B].v),N=P.indexOf(".")+1,o=z;o<i.length;++o)if(!(i[o]==null||"n?(".indexOf(i[o].t)===-1&&o!==z)){for(h=i[o].v.indexOf(".")>-1&&o===z?i[o].v.indexOf(".")+1:0,M=i[o].v.substr(0,h);h<i[o].v.length;++h)N<P.length&&(M+=P.charAt(N++));i[o].v=M,i[o].t="t",B=o}}}for(o=0;o<i.length;++o)i[o]!=null&&"n?".indexOf(i[o].t)>-1&&(R=n>1&&t<0&&o>0&&i[o-1].v==="-"?-t:t,i[o].v=ds(i[o].t,i[o].v,R),i[o].t="t");var re="";for(o=0;o!==i.length;++o)i[o]!=null&&(re+=i[o].v);return re}var X_=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function K_(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function Nee(e,t){var r=kee(e),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(X_),c=r[1].match(X_);return K_(t,o)?[n,r[0]]:K_(t,c)?[n,r[1]]:[n,r[o!=null&&c!=null?2:1]]}return[n,a]}function ta(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:ft)[e],n==null&&(n=r.table&&r.table[H_[e]]||ft[H_[e]]),n==null&&(n=hee[e]||"General");break}if(A1(n,0))return vl(t,r);t instanceof Date&&(t=lP(t,r.date1904));var i=Nee(n,t);if(A1(i[1]))return vl(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return Iee(i[1],t,r,i[0])}function tl(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(ft[r]==null){t<0&&(t=r);continue}if(ft[r]==e){t=r;break}}t<0&&(t=391)}return ft[t]=e,t}function xP(){ft=dee()}var Pee={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},vP=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Dee(e){var t=typeof e=="number"?ft[e]:e;return t=t.replace(vP,"(\\d+)"),new RegExp("^"+t+"$")}function Ree(e,t,r){var n=-1,i=-1,a=-1,o=-1,c=-1,f=-1;(t.match(vP)||[]).forEach(function(m,v){var w=parseInt(r[v+1],10);switch(m.toLowerCase().charAt(0)){case"y":n=w;break;case"d":a=w;break;case"h":o=w;break;case"s":f=w;break;case"m":o>=0?c=w:i=w;break}}),f>=0&&c==-1&&i>=0&&(c=i,i=-1);var d=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var h=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(f>=0?f:0)).slice(-2);return o==-1&&c==-1&&f==-1?d:n==-1&&i==-1&&a==-1?h:d+"T"+h}var Mee=function(){var e={};e.version="1.2.0";function t(){for(var P=0,z=new Array(256),B=0;B!=256;++B)P=B,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,z[B]=P;return typeof Int32Array<"u"?new Int32Array(z):z}var r=t();function n(P){var z=0,B=0,re=0,ee=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(re=0;re!=256;++re)ee[re]=P[re];for(re=0;re!=256;++re)for(B=P[re],z=256+re;z<4096;z+=256)B=ee[z]=B>>>8^P[B&255];var V=[];for(re=1;re!=16;++re)V[re-1]=typeof Int32Array<"u"?ee.subarray(re*256,re*256+256):ee.slice(re*256,re*256+256);return V}var i=n(r),a=i[0],o=i[1],c=i[2],f=i[3],d=i[4],h=i[5],m=i[6],v=i[7],w=i[8],E=i[9],A=i[10],S=i[11],b=i[12],T=i[13],_=i[14];function N(P,z){for(var B=z^-1,re=0,ee=P.length;re<ee;)B=B>>>8^r[(B^P.charCodeAt(re++))&255];return~B}function M(P,z){for(var B=z^-1,re=P.length-15,ee=0;ee<re;)B=_[P[ee++]^B&255]^T[P[ee++]^B>>8&255]^b[P[ee++]^B>>16&255]^S[P[ee++]^B>>>24]^A[P[ee++]]^E[P[ee++]]^w[P[ee++]]^v[P[ee++]]^m[P[ee++]]^h[P[ee++]]^d[P[ee++]]^f[P[ee++]]^c[P[ee++]]^o[P[ee++]]^a[P[ee++]]^r[P[ee++]];for(re+=15;ee<re;)B=B>>>8^r[(B^P[ee++])&255];return~B}function R(P,z){for(var B=z^-1,re=0,ee=P.length,V=0,de=0;re<ee;)V=P.charCodeAt(re++),V<128?B=B>>>8^r[(B^V)&255]:V<2048?(B=B>>>8^r[(B^(192|V>>6&31))&255],B=B>>>8^r[(B^(128|V&63))&255]):V>=55296&&V<57344?(V=(V&1023)+64,de=P.charCodeAt(re++)&1023,B=B>>>8^r[(B^(240|V>>8&7))&255],B=B>>>8^r[(B^(128|V>>2&63))&255],B=B>>>8^r[(B^(128|de>>6&15|(V&3)<<4))&255],B=B>>>8^r[(B^(128|de&63))&255]):(B=B>>>8^r[(B^(224|V>>12&15))&255],B=B>>>8^r[(B^(128|V>>6&63))&255],B=B>>>8^r[(B^(128|V&63))&255]);return~B}return e.table=r,e.bstr=N,e.buf=M,e.str=R,e}(),bt=function(){var t={};t.version="1.2.1";function r(j,H){for(var X=j.split("/"),Y=H.split("/"),Q=0,te=0,ye=Math.min(X.length,Y.length);Q<ye;++Q){if(te=X[Q].length-Y[Q].length)return te;if(X[Q]!=Y[Q])return X[Q]<Y[Q]?-1:1}return X.length-Y.length}function n(j){if(j.charAt(j.length-1)=="/")return j.slice(0,-1).indexOf("/")===-1?j:n(j.slice(0,-1));var H=j.lastIndexOf("/");return H===-1?j:j.slice(0,H+1)}function i(j){if(j.charAt(j.length-1)=="/")return i(j.slice(0,-1));var H=j.lastIndexOf("/");return H===-1?j:j.slice(H+1)}function a(j,H){typeof H=="string"&&(H=new Date(H));var X=H.getHours();X=X<<6|H.getMinutes(),X=X<<5|H.getSeconds()>>>1,j.write_shift(2,X);var Y=H.getFullYear()-1980;Y=Y<<4|H.getMonth()+1,Y=Y<<5|H.getDate(),j.write_shift(2,Y)}function o(j){var H=j.read_shift(2)&65535,X=j.read_shift(2)&65535,Y=new Date,Q=X&31;X>>>=5;var te=X&15;X>>>=4,Y.setMilliseconds(0),Y.setFullYear(X+1980),Y.setMonth(te-1),Y.setDate(Q);var ye=H&31;H>>>=5;var Oe=H&63;return H>>>=6,Y.setHours(H),Y.setMinutes(Oe),Y.setSeconds(ye<<1),Y}function c(j){yn(j,0);for(var H={},X=0;j.l<=j.length-4;){var Y=j.read_shift(2),Q=j.read_shift(2),te=j.l+Q,ye={};switch(Y){case 21589:X=j.read_shift(1),X&1&&(ye.mtime=j.read_shift(4)),Q>5&&(X&2&&(ye.atime=j.read_shift(4)),X&4&&(ye.ctime=j.read_shift(4))),ye.mtime&&(ye.mt=new Date(ye.mtime*1e3));break}j.l=te,H[Y]=ye}return H}var f;function d(){return f||(f={})}function h(j,H){if(j[0]==80&&j[1]==75)return au(j,H);if((j[0]|32)==109&&(j[1]|32)==105)return Ml(j,H);if(j.length<512)throw new Error("CFB file size "+j.length+" < 512");var X=3,Y=512,Q=0,te=0,ye=0,Oe=0,ge=0,Ee=[],Ae=j.slice(0,512);yn(Ae,0);var Ne=m(Ae);switch(X=Ne[0],X){case 3:Y=512;break;case 4:Y=4096;break;case 0:if(Ne[1]==0)return au(j,H);default:throw new Error("Major Version: Expected 3 or 4 saw "+X)}Y!==512&&(Ae=j.slice(0,Y),yn(Ae,28));var Re=j.slice(0,Y);v(Ae,X);var Fe=Ae.read_shift(4,"i");if(X===3&&Fe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Fe);Ae.l+=4,ye=Ae.read_shift(4,"i"),Ae.l+=4,Ae.chk("00100000","Mini Stream Cutoff Size: "),Oe=Ae.read_shift(4,"i"),Q=Ae.read_shift(4,"i"),ge=Ae.read_shift(4,"i"),te=Ae.read_shift(4,"i");for(var je=-1,Ve=0;Ve<109&&(je=Ae.read_shift(4,"i"),!(je<0));++Ve)Ee[Ve]=je;var lt=w(j,Y);S(ge,te,lt,Y,Ee);var Te=T(lt,ye,Ee,Y);Te[ye].name="!Directory",Q>0&&Oe!==de&&(Te[Oe].name="!MiniFAT"),Te[Ee[0]].name="!FAT",Te.fat_addrs=Ee,Te.ssz=Y;var Jt={},gt=[],Ri=[],No=[];_(ye,Te,lt,gt,Q,Jt,Ri,Oe),E(Ri,No,gt),gt.shift();var Et={FileIndex:Ri,FullPaths:No};return H&&H.raw&&(Et.raw={header:Re,sectors:lt}),Et}function m(j){if(j[j.l]==80&&j[j.l+1]==75)return[0,0];j.chk(pe,"Header Signature: "),j.l+=16;var H=j.read_shift(2,"u");return[j.read_shift(2,"u"),H]}function v(j,H){var X=9;switch(j.l+=2,X=j.read_shift(2)){case 9:if(H!=3)throw new Error("Sector Shift: Expected 9 saw "+X);break;case 12:if(H!=4)throw new Error("Sector Shift: Expected 12 saw "+X);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+X)}j.chk("0600","Mini Sector Shift: "),j.chk("000000000000","Reserved: ")}function w(j,H){for(var X=Math.ceil(j.length/H)-1,Y=[],Q=1;Q<X;++Q)Y[Q-1]=j.slice(Q*H,(Q+1)*H);return Y[X-1]=j.slice(X*H),Y}function E(j,H,X){for(var Y=0,Q=0,te=0,ye=0,Oe=0,ge=X.length,Ee=[],Ae=[];Y<ge;++Y)Ee[Y]=Ae[Y]=Y,H[Y]=X[Y];for(;Oe<Ae.length;++Oe)Y=Ae[Oe],Q=j[Y].L,te=j[Y].R,ye=j[Y].C,Ee[Y]===Y&&(Q!==-1&&Ee[Q]!==Q&&(Ee[Y]=Ee[Q]),te!==-1&&Ee[te]!==te&&(Ee[Y]=Ee[te])),ye!==-1&&(Ee[ye]=Y),Q!==-1&&Y!=Ee[Y]&&(Ee[Q]=Ee[Y],Ae.lastIndexOf(Q)<Oe&&Ae.push(Q)),te!==-1&&Y!=Ee[Y]&&(Ee[te]=Ee[Y],Ae.lastIndexOf(te)<Oe&&Ae.push(te));for(Y=1;Y<ge;++Y)Ee[Y]===Y&&(te!==-1&&Ee[te]!==te?Ee[Y]=Ee[te]:Q!==-1&&Ee[Q]!==Q&&(Ee[Y]=Ee[Q]));for(Y=1;Y<ge;++Y)if(j[Y].type!==0){if(Oe=Y,Oe!=Ee[Oe])do Oe=Ee[Oe],H[Y]=H[Oe]+"/"+H[Y];while(Oe!==0&&Ee[Oe]!==-1&&Oe!=Ee[Oe]);Ee[Y]=-1}for(H[0]+="/",Y=1;Y<ge;++Y)j[Y].type!==2&&(H[Y]+="/")}function A(j,H,X){for(var Y=j.start,Q=j.size,te=[],ye=Y;X&&Q>0&&ye>=0;)te.push(H.slice(ye*V,ye*V+V)),Q-=V,ye=zo(X,ye*4);return te.length===0?zr(0):Js(te).slice(0,j.size)}function S(j,H,X,Y,Q){var te=de;if(j===de){if(H!==0)throw new Error("DIFAT chain shorter than expected")}else if(j!==-1){var ye=X[j],Oe=(Y>>>2)-1;if(!ye)return;for(var ge=0;ge<Oe&&(te=zo(ye,ge*4))!==de;++ge)Q.push(te);S(zo(ye,Y-4),H-1,X,Y,Q)}}function b(j,H,X,Y,Q){var te=[],ye=[];Q||(Q=[]);var Oe=Y-1,ge=0,Ee=0;for(ge=H;ge>=0;){Q[ge]=!0,te[te.length]=ge,ye.push(j[ge]);var Ae=X[Math.floor(ge*4/Y)];if(Ee=ge*4&Oe,Y<4+Ee)throw new Error("FAT boundary crossed: "+ge+" 4 "+Y);if(!j[Ae])break;ge=zo(j[Ae],Ee)}return{nodes:te,data:i4([ye])}}function T(j,H,X,Y){var Q=j.length,te=[],ye=[],Oe=[],ge=[],Ee=Y-1,Ae=0,Ne=0,Re=0,Fe=0;for(Ae=0;Ae<Q;++Ae)if(Oe=[],Re=Ae+H,Re>=Q&&(Re-=Q),!ye[Re]){ge=[];var je=[];for(Ne=Re;Ne>=0;){je[Ne]=!0,ye[Ne]=!0,Oe[Oe.length]=Ne,ge.push(j[Ne]);var Ve=X[Math.floor(Ne*4/Y)];if(Fe=Ne*4&Ee,Y<4+Fe)throw new Error("FAT boundary crossed: "+Ne+" 4 "+Y);if(!j[Ve]||(Ne=zo(j[Ve],Fe),je[Ne]))break}te[Re]={nodes:Oe,data:i4([ge])}}return te}function _(j,H,X,Y,Q,te,ye,Oe){for(var ge=0,Ee=Y.length?2:0,Ae=H[j].data,Ne=0,Re=0,Fe;Ne<Ae.length;Ne+=128){var je=Ae.slice(Ne,Ne+128);yn(je,64),Re=je.read_shift(2),Fe=Kw(je,0,Re-Ee),Y.push(Fe);var Ve={name:Fe,type:je.read_shift(1),color:je.read_shift(1),L:je.read_shift(4,"i"),R:je.read_shift(4,"i"),C:je.read_shift(4,"i"),clsid:je.read_shift(16),state:je.read_shift(4,"i"),start:0,size:0},lt=je.read_shift(2)+je.read_shift(2)+je.read_shift(2)+je.read_shift(2);lt!==0&&(Ve.ct=N(je,je.l-8));var Te=je.read_shift(2)+je.read_shift(2)+je.read_shift(2)+je.read_shift(2);Te!==0&&(Ve.mt=N(je,je.l-8)),Ve.start=je.read_shift(4,"i"),Ve.size=je.read_shift(4,"i"),Ve.size<0&&Ve.start<0&&(Ve.size=Ve.type=0,Ve.start=de,Ve.name=""),Ve.type===5?(ge=Ve.start,Q>0&&ge!==de&&(H[ge].name="!StreamData")):Ve.size>=4096?(Ve.storage="fat",H[Ve.start]===void 0&&(H[Ve.start]=b(X,Ve.start,H.fat_addrs,H.ssz)),H[Ve.start].name=Ve.name,Ve.content=H[Ve.start].data.slice(0,Ve.size)):(Ve.storage="minifat",Ve.size<0?Ve.size=0:ge!==de&&Ve.start!==de&&H[ge]&&(Ve.content=A(Ve,H[ge].data,(H[Oe]||{}).data))),Ve.content&&yn(Ve.content,0),te[Fe]=Ve,ye.push(Ve)}}function N(j,H){return new Date((wi(j,H+4)/1e7*Math.pow(2,32)+wi(j,H)/1e7-11644473600)*1e3)}function M(j,H){return d(),h(f.readFileSync(j),H)}function R(j,H){var X=H&&H.type;switch(X||Ct&&Buffer.isBuffer(j)&&(X="buffer"),X||"base64"){case"file":return M(j,H);case"base64":return h(ma(ki(j)),H);case"binary":return h(ma(j),H)}return h(j,H)}function P(j,H){var X=H||{},Y=X.root||"Root Entry";if(j.FullPaths||(j.FullPaths=[]),j.FileIndex||(j.FileIndex=[]),j.FullPaths.length!==j.FileIndex.length)throw new Error("inconsistent CFB structure");j.FullPaths.length===0&&(j.FullPaths[0]=Y+"/",j.FileIndex[0]={name:Y,type:5}),X.CLSID&&(j.FileIndex[0].clsid=X.CLSID),z(j)}function z(j){var H="Sh33tJ5";if(!bt.find(j,"/"+H)){var X=zr(4);X[0]=55,X[1]=X[3]=50,X[2]=54,j.FileIndex.push({name:H,type:2,content:X,size:4,L:69,R:69,C:69}),j.FullPaths.push(j.FullPaths[0]+H),B(j)}}function B(j,H){P(j);for(var X=!1,Y=!1,Q=j.FullPaths.length-1;Q>=0;--Q){var te=j.FileIndex[Q];switch(te.type){case 0:Y?X=!0:(j.FileIndex.pop(),j.FullPaths.pop());break;case 1:case 2:case 5:Y=!0,isNaN(te.R*te.L*te.C)&&(X=!0),te.R>-1&&te.L>-1&&te.R==te.L&&(X=!0);break;default:X=!0;break}}if(!(!X&&!H)){var ye=new Date(1987,1,19),Oe=0,ge=Object.create?Object.create(null):{},Ee=[];for(Q=0;Q<j.FullPaths.length;++Q)ge[j.FullPaths[Q]]=!0,j.FileIndex[Q].type!==0&&Ee.push([j.FullPaths[Q],j.FileIndex[Q]]);for(Q=0;Q<Ee.length;++Q){var Ae=n(Ee[Q][0]);Y=ge[Ae],Y||(Ee.push([Ae,{name:i(Ae).replace("/",""),type:1,clsid:Ce,ct:ye,mt:ye,content:null}]),ge[Ae]=!0)}for(Ee.sort(function(Fe,je){return r(Fe[0],je[0])}),j.FullPaths=[],j.FileIndex=[],Q=0;Q<Ee.length;++Q)j.FullPaths[Q]=Ee[Q][0],j.FileIndex[Q]=Ee[Q][1];for(Q=0;Q<Ee.length;++Q){var Ne=j.FileIndex[Q],Re=j.FullPaths[Q];if(Ne.name=i(Re).replace("/",""),Ne.L=Ne.R=Ne.C=-(Ne.color=1),Ne.size=Ne.content?Ne.content.length:0,Ne.start=0,Ne.clsid=Ne.clsid||Ce,Q===0)Ne.C=Ee.length>1?1:-1,Ne.size=0,Ne.type=5;else if(Re.slice(-1)=="/"){for(Oe=Q+1;Oe<Ee.length&&n(j.FullPaths[Oe])!=Re;++Oe);for(Ne.C=Oe>=Ee.length?-1:Oe,Oe=Q+1;Oe<Ee.length&&n(j.FullPaths[Oe])!=n(Re);++Oe);Ne.R=Oe>=Ee.length?-1:Oe,Ne.type=1}else n(j.FullPaths[Q+1]||"")==n(Re)&&(Ne.R=Q+1),Ne.type=2}}}function re(j,H){var X=H||{};if(X.fileType=="mad")return Di(j,X);switch(B(j),X.fileType){case"zip":return qa(j,X)}var Y=function(Fe){for(var je=0,Ve=0,lt=0;lt<Fe.FileIndex.length;++lt){var Te=Fe.FileIndex[lt];if(Te.content){var Jt=Te.content.length;Jt>0&&(Jt<4096?je+=Jt+63>>6:Ve+=Jt+511>>9)}}for(var gt=Fe.FullPaths.length+3>>2,Ri=je+7>>3,No=je+127>>7,Et=Ri+Ve+gt+No,mt=Et+127>>7,xt=mt<=109?0:Math.ceil((mt-109)/127);Et+mt+xt+127>>7>mt;)xt=++mt<=109?0:Math.ceil((mt-109)/127);var mi=[1,xt,mt,No,gt,Ve,je,0];return Fe.FileIndex[0].size=je<<6,mi[7]=(Fe.FileIndex[0].start=mi[0]+mi[1]+mi[2]+mi[3]+mi[4]+mi[5])+(mi[6]+7>>3),mi}(j),Q=zr(Y[7]<<9),te=0,ye=0;{for(te=0;te<8;++te)Q.write_shift(1,K[te]);for(te=0;te<8;++te)Q.write_shift(2,0);for(Q.write_shift(2,62),Q.write_shift(2,3),Q.write_shift(2,65534),Q.write_shift(2,9),Q.write_shift(2,6),te=0;te<3;++te)Q.write_shift(2,0);for(Q.write_shift(4,0),Q.write_shift(4,Y[2]),Q.write_shift(4,Y[0]+Y[1]+Y[2]+Y[3]-1),Q.write_shift(4,0),Q.write_shift(4,4096),Q.write_shift(4,Y[3]?Y[0]+Y[1]+Y[2]-1:de),Q.write_shift(4,Y[3]),Q.write_shift(-4,Y[1]?Y[0]-1:de),Q.write_shift(4,Y[1]),te=0;te<109;++te)Q.write_shift(-4,te<Y[2]?Y[1]+te:-1)}if(Y[1])for(ye=0;ye<Y[1];++ye){for(;te<236+ye*127;++te)Q.write_shift(-4,te<Y[2]?Y[1]+te:-1);Q.write_shift(-4,ye===Y[1]-1?de:ye+1)}var Oe=function(Fe){for(ye+=Fe;te<ye-1;++te)Q.write_shift(-4,te+1);Fe&&(++te,Q.write_shift(-4,de))};for(ye=te=0,ye+=Y[1];te<ye;++te)Q.write_shift(-4,ue.DIFSECT);for(ye+=Y[2];te<ye;++te)Q.write_shift(-4,ue.FATSECT);Oe(Y[3]),Oe(Y[4]);for(var ge=0,Ee=0,Ae=j.FileIndex[0];ge<j.FileIndex.length;++ge)Ae=j.FileIndex[ge],Ae.content&&(Ee=Ae.content.length,!(Ee<4096)&&(Ae.start=ye,Oe(Ee+511>>9)));for(Oe(Y[6]+7>>3);Q.l&511;)Q.write_shift(-4,ue.ENDOFCHAIN);for(ye=te=0,ge=0;ge<j.FileIndex.length;++ge)Ae=j.FileIndex[ge],Ae.content&&(Ee=Ae.content.length,!(!Ee||Ee>=4096)&&(Ae.start=ye,Oe(Ee+63>>6)));for(;Q.l&511;)Q.write_shift(-4,ue.ENDOFCHAIN);for(te=0;te<Y[4]<<2;++te){var Ne=j.FullPaths[te];if(!Ne||Ne.length===0){for(ge=0;ge<17;++ge)Q.write_shift(4,0);for(ge=0;ge<3;++ge)Q.write_shift(4,-1);for(ge=0;ge<12;++ge)Q.write_shift(4,0);continue}Ae=j.FileIndex[te],te===0&&(Ae.start=Ae.size?Ae.start-1:de);var Re=te===0&&X.root||Ae.name;if(Ee=2*(Re.length+1),Q.write_shift(64,Re,"utf16le"),Q.write_shift(2,Ee),Q.write_shift(1,Ae.type),Q.write_shift(1,Ae.color),Q.write_shift(-4,Ae.L),Q.write_shift(-4,Ae.R),Q.write_shift(-4,Ae.C),Ae.clsid)Q.write_shift(16,Ae.clsid,"hex");else for(ge=0;ge<4;++ge)Q.write_shift(4,0);Q.write_shift(4,Ae.state||0),Q.write_shift(4,0),Q.write_shift(4,0),Q.write_shift(4,0),Q.write_shift(4,0),Q.write_shift(4,Ae.start),Q.write_shift(4,Ae.size),Q.write_shift(4,0)}for(te=1;te<j.FileIndex.length;++te)if(Ae=j.FileIndex[te],Ae.size>=4096)if(Q.l=Ae.start+1<<9,Ct&&Buffer.isBuffer(Ae.content))Ae.content.copy(Q,Q.l,0,Ae.size),Q.l+=Ae.size+511&-512;else{for(ge=0;ge<Ae.size;++ge)Q.write_shift(1,Ae.content[ge]);for(;ge&511;++ge)Q.write_shift(1,0)}for(te=1;te<j.FileIndex.length;++te)if(Ae=j.FileIndex[te],Ae.size>0&&Ae.size<4096)if(Ct&&Buffer.isBuffer(Ae.content))Ae.content.copy(Q,Q.l,0,Ae.size),Q.l+=Ae.size+63&-64;else{for(ge=0;ge<Ae.size;++ge)Q.write_shift(1,Ae.content[ge]);for(;ge&63;++ge)Q.write_shift(1,0)}if(Ct)Q.l=Q.length;else for(;Q.l<Q.length;)Q.write_shift(1,0);return Q}function ee(j,H){var X=j.FullPaths.map(function(ge){return ge.toUpperCase()}),Y=X.map(function(ge){var Ee=ge.split("/");return Ee[Ee.length-(ge.slice(-1)=="/"?2:1)]}),Q=!1;H.charCodeAt(0)===47?(Q=!0,H=X[0].slice(0,-1)+H):Q=H.indexOf("/")!==-1;var te=H.toUpperCase(),ye=Q===!0?X.indexOf(te):Y.indexOf(te);if(ye!==-1)return j.FileIndex[ye];var Oe=!te.match(Wu);for(te=te.replace(Kn,""),Oe&&(te=te.replace(Wu,"!")),ye=0;ye<X.length;++ye)if((Oe?X[ye].replace(Wu,"!"):X[ye]).replace(Kn,"")==te||(Oe?Y[ye].replace(Wu,"!"):Y[ye]).replace(Kn,"")==te)return j.FileIndex[ye];return null}var V=64,de=-2,pe="d0cf11e0a1b11ae1",K=[208,207,17,224,161,177,26,225],Ce="00000000000000000000000000000000",ue={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:de,FREESECT:-1,HEADER_SIGNATURE:pe,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Ce,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function se(j,H,X){d();var Y=re(j,X);f.writeFileSync(H,Y)}function q(j){for(var H=new Array(j.length),X=0;X<j.length;++X)H[X]=String.fromCharCode(j[X]);return H.join("")}function fe(j,H){var X=re(j,H);switch(H&&H.type||"buffer"){case"file":return d(),f.writeFileSync(H.filename,X),X;case"binary":return typeof X=="string"?X:q(X);case"base64":return U_(typeof X=="string"?X:q(X));case"buffer":if(Ct)return Buffer.isBuffer(X)?X:Ol(X);case"array":return typeof X=="string"?ma(X):X}return X}var we;function G(j){try{var H=j.InflateRaw,X=new H;if(X._processChunk(new Uint8Array([3,0]),X._finishFlushFlag),X.bytesRead)we=j;else throw new Error("zlib does not expose bytesRead")}catch(Y){console.error("cannot use native zlib: "+(Y.message||Y))}}function le(j,H){if(!we)return Ls(j,H);var X=we.InflateRaw,Y=new X,Q=Y._processChunk(j.slice(j.l),Y._finishFlushFlag);return j.l+=Y.bytesRead,Q}function ne(j){return we?we.deflateRawSync(j):dt(j)}var ae=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],he=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ke=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function De(j){var H=(j<<1|j<<11)&139536|(j<<5|j<<15)&558144;return(H>>16|H>>8|H)&255}for(var ce=typeof Uint8Array<"u",be=ce?new Uint8Array(256):[],ze=0;ze<256;++ze)be[ze]=De(ze);function W(j,H){var X=be[j&255];return H<=8?X>>>8-H:(X=X<<8|be[j>>8&255],H<=16?X>>>16-H:(X=X<<8|be[j>>16&255],X>>>24-H))}function He(j,H){var X=H&7,Y=H>>>3;return(j[Y]|(X<=6?0:j[Y+1]<<8))>>>X&3}function Ge(j,H){var X=H&7,Y=H>>>3;return(j[Y]|(X<=5?0:j[Y+1]<<8))>>>X&7}function et(j,H){var X=H&7,Y=H>>>3;return(j[Y]|(X<=4?0:j[Y+1]<<8))>>>X&15}function Ze(j,H){var X=H&7,Y=H>>>3;return(j[Y]|(X<=3?0:j[Y+1]<<8))>>>X&31}function Ie(j,H){var X=H&7,Y=H>>>3;return(j[Y]|(X<=1?0:j[Y+1]<<8))>>>X&127}function rt(j,H,X){var Y=H&7,Q=H>>>3,te=(1<<X)-1,ye=j[Q]>>>Y;return X<8-Y||(ye|=j[Q+1]<<8-Y,X<16-Y)||(ye|=j[Q+2]<<16-Y,X<24-Y)||(ye|=j[Q+3]<<24-Y),ye&te}function at(j,H,X){var Y=H&7,Q=H>>>3;return Y<=5?j[Q]|=(X&7)<<Y:(j[Q]|=X<<Y&255,j[Q+1]=(X&7)>>8-Y),H+3}function Br(j,H,X){var Y=H&7,Q=H>>>3;return X=(X&1)<<Y,j[Q]|=X,H+1}function $e(j,H,X){var Y=H&7,Q=H>>>3;return X<<=Y,j[Q]|=X&255,X>>>=8,j[Q+1]=X,H+8}function Pi(j,H,X){var Y=H&7,Q=H>>>3;return X<<=Y,j[Q]|=X&255,X>>>=8,j[Q+1]=X&255,j[Q+2]=X>>>8,H+16}function Be(j,H){var X=j.length,Y=2*X>H?2*X:H+5,Q=0;if(X>=H)return j;if(Ct){var te=z_(Y);if(j.copy)j.copy(te);else for(;Q<j.length;++Q)te[Q]=j[Q];return te}else if(ce){var ye=new Uint8Array(Y);if(ye.set)ye.set(j);else for(;Q<X;++Q)ye[Q]=j[Q];return ye}return j.length=Y,j}function Qe(j){for(var H=new Array(j),X=0;X<j;++X)H[X]=0;return H}function _t(j,H,X){var Y=1,Q=0,te=0,ye=0,Oe=0,ge=j.length,Ee=ce?new Uint16Array(32):Qe(32);for(te=0;te<32;++te)Ee[te]=0;for(te=ge;te<X;++te)j[te]=0;ge=j.length;var Ae=ce?new Uint16Array(ge):Qe(ge);for(te=0;te<ge;++te)Ee[Q=j[te]]++,Y<Q&&(Y=Q),Ae[te]=0;for(Ee[0]=0,te=1;te<=Y;++te)Ee[te+16]=Oe=Oe+Ee[te-1]<<1;for(te=0;te<ge;++te)Oe=j[te],Oe!=0&&(Ae[te]=Ee[Oe+16]++);var Ne=0;for(te=0;te<ge;++te)if(Ne=j[te],Ne!=0)for(Oe=W(Ae[te],Y)>>Y-Ne,ye=(1<<Y+4-Ne)-1;ye>=0;--ye)H[Oe|ye<<Ne]=Ne&15|te<<4;return Y}var Rt=ce?new Uint16Array(512):Qe(512),Fs=ce?new Uint16Array(32):Qe(32);if(!ce){for(var sr=0;sr<512;++sr)Rt[sr]=0;for(sr=0;sr<32;++sr)Fs[sr]=0}(function(){for(var j=[],H=0;H<32;H++)j.push(5);_t(j,Fs,32);var X=[];for(H=0;H<=143;H++)X.push(8);for(;H<=255;H++)X.push(9);for(;H<=279;H++)X.push(7);for(;H<=287;H++)X.push(8);_t(X,Rt,288)})();var $t=function(){for(var H=ce?new Uint8Array(32768):[],X=0,Y=0;X<ke.length-1;++X)for(;Y<ke[X+1];++Y)H[Y]=X;for(;Y<32768;++Y)H[Y]=29;var Q=ce?new Uint8Array(259):[];for(X=0,Y=0;X<he.length-1;++X)for(;Y<he[X+1];++Y)Q[Y]=X;function te(Oe,ge){for(var Ee=0;Ee<Oe.length;){var Ae=Math.min(65535,Oe.length-Ee),Ne=Ee+Ae==Oe.length;for(ge.write_shift(1,+Ne),ge.write_shift(2,Ae),ge.write_shift(2,~Ae&65535);Ae-- >0;)ge[ge.l++]=Oe[Ee++]}return ge.l}function ye(Oe,ge){for(var Ee=0,Ae=0,Ne=ce?new Uint16Array(32768):[];Ae<Oe.length;){var Re=Math.min(65535,Oe.length-Ae);if(Re<10){for(Ee=at(ge,Ee,+(Ae+Re==Oe.length)),Ee&7&&(Ee+=8-(Ee&7)),ge.l=Ee/8|0,ge.write_shift(2,Re),ge.write_shift(2,~Re&65535);Re-- >0;)ge[ge.l++]=Oe[Ae++];Ee=ge.l*8;continue}Ee=at(ge,Ee,+(Ae+Re==Oe.length)+2);for(var Fe=0;Re-- >0;){var je=Oe[Ae];Fe=(Fe<<5^je)&32767;var Ve=-1,lt=0;if((Ve=Ne[Fe])&&(Ve|=Ae&-32768,Ve>Ae&&(Ve-=32768),Ve<Ae))for(;Oe[Ve+lt]==Oe[Ae+lt]&&lt<250;)++lt;if(lt>2){je=Q[lt],je<=22?Ee=$e(ge,Ee,be[je+1]>>1)-1:($e(ge,Ee,3),Ee+=5,$e(ge,Ee,be[je-23]>>5),Ee+=3);var Te=je<8?0:je-4>>2;Te>0&&(Pi(ge,Ee,lt-he[je]),Ee+=Te),je=H[Ae-Ve],Ee=$e(ge,Ee,be[je]>>3),Ee-=3;var Jt=je<4?0:je-2>>1;Jt>0&&(Pi(ge,Ee,Ae-Ve-ke[je]),Ee+=Jt);for(var gt=0;gt<lt;++gt)Ne[Fe]=Ae&32767,Fe=(Fe<<5^Oe[Ae])&32767,++Ae;Re-=lt-1}else je<=143?je=je+48:Ee=Br(ge,Ee,1),Ee=$e(ge,Ee,be[je]),Ne[Fe]=Ae&32767,++Ae}Ee=$e(ge,Ee,0)-1}return ge.l=(Ee+7)/8|0,ge.l}return function(ge,Ee){return ge.length<8?te(ge,Ee):ye(ge,Ee)}}();function dt(j){var H=zr(50+Math.floor(j.length*1.1)),X=$t(j,H);return H.slice(0,X)}var Xt=ce?new Uint16Array(32768):Qe(32768),ei=ce?new Uint16Array(32768):Qe(32768),ht=ce?new Uint16Array(128):Qe(128),We=1,vr=1;function Mt(j,H){var X=Ze(j,H)+257;H+=5;var Y=Ze(j,H)+1;H+=5;var Q=et(j,H)+4;H+=4;for(var te=0,ye=ce?new Uint8Array(19):Qe(19),Oe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ge=1,Ee=ce?new Uint8Array(8):Qe(8),Ae=ce?new Uint8Array(8):Qe(8),Ne=ye.length,Re=0;Re<Q;++Re)ye[ae[Re]]=te=Ge(j,H),ge<te&&(ge=te),Ee[te]++,H+=3;var Fe=0;for(Ee[0]=0,Re=1;Re<=ge;++Re)Ae[Re]=Fe=Fe+Ee[Re-1]<<1;for(Re=0;Re<Ne;++Re)(Fe=ye[Re])!=0&&(Oe[Re]=Ae[Fe]++);var je=0;for(Re=0;Re<Ne;++Re)if(je=ye[Re],je!=0){Fe=be[Oe[Re]]>>8-je;for(var Ve=(1<<7-je)-1;Ve>=0;--Ve)ht[Fe|Ve<<je]=je&7|Re<<3}var lt=[];for(ge=1;lt.length<X+Y;)switch(Fe=ht[Ie(j,H)],H+=Fe&7,Fe>>>=3){case 16:for(te=3+He(j,H),H+=2,Fe=lt[lt.length-1];te-- >0;)lt.push(Fe);break;case 17:for(te=3+Ge(j,H),H+=3;te-- >0;)lt.push(0);break;case 18:for(te=11+Ie(j,H),H+=7;te-- >0;)lt.push(0);break;default:lt.push(Fe),ge<Fe&&(ge=Fe);break}var Te=lt.slice(0,X),Jt=lt.slice(X);for(Re=X;Re<286;++Re)Te[Re]=0;for(Re=Y;Re<30;++Re)Jt[Re]=0;return We=_t(Te,Xt,286),vr=_t(Jt,ei,30),H}function or(j,H){if(j[0]==3&&!(j[1]&3))return[wo(H),2];for(var X=0,Y=0,Q=z_(H||1<<18),te=0,ye=Q.length>>>0,Oe=0,ge=0;!(Y&1);){if(Y=Ge(j,X),X+=3,Y>>>1)Y>>1==1?(Oe=9,ge=5):(X=Mt(j,X),Oe=We,ge=vr);else{X&7&&(X+=8-(X&7));var Ee=j[X>>>3]|j[(X>>>3)+1]<<8;if(X+=32,Ee>0)for(!H&&ye<te+Ee&&(Q=Be(Q,te+Ee),ye=Q.length);Ee-- >0;)Q[te++]=j[X>>>3],X+=8;continue}for(;;){!H&&ye<te+32767&&(Q=Be(Q,te+32767),ye=Q.length);var Ae=rt(j,X,Oe),Ne=Y>>>1==1?Rt[Ae]:Xt[Ae];if(X+=Ne&15,Ne>>>=4,!(Ne>>>8&255))Q[te++]=Ne;else{if(Ne==256)break;Ne-=257;var Re=Ne<8?0:Ne-4>>2;Re>5&&(Re=0);var Fe=te+he[Ne];Re>0&&(Fe+=rt(j,X,Re),X+=Re),Ae=rt(j,X,ge),Ne=Y>>>1==1?Fs[Ae]:ei[Ae],X+=Ne&15,Ne>>>=4;var je=Ne<4?0:Ne-2>>1,Ve=ke[Ne];for(je>0&&(Ve+=rt(j,X,je),X+=je),!H&&ye<Fe&&(Q=Be(Q,Fe+100),ye=Q.length);te<Fe;)Q[te]=Q[te-Ve],++te}}}return H?[Q,X+7>>>3]:[Q.slice(0,te),X+7>>>3]}function Ls(j,H){var X=j.slice(j.l||0),Y=or(X,H);return j.l+=Y[1],Y[0]}function Rl(j,H){if(j)typeof console<"u"&&console.error(H);else throw new Error(H)}function au(j,H){var X=j;yn(X,0);var Y=[],Q=[],te={FileIndex:Y,FullPaths:Q};P(te,{root:H.root});for(var ye=X.length-4;(X[ye]!=80||X[ye+1]!=75||X[ye+2]!=5||X[ye+3]!=6)&&ye>=0;)--ye;X.l=ye+4,X.l+=4;var Oe=X.read_shift(2);X.l+=6;var ge=X.read_shift(4);for(X.l=ge,ye=0;ye<Oe;++ye){X.l+=20;var Ee=X.read_shift(4),Ae=X.read_shift(4),Ne=X.read_shift(2),Re=X.read_shift(2),Fe=X.read_shift(2);X.l+=8;var je=X.read_shift(4),Ve=c(X.slice(X.l+Ne,X.l+Ne+Re));X.l+=Ne+Re+Fe;var lt=X.l;X.l=je+4,Ot(X,Ee,Ae,te,Ve),X.l=lt}return te}function Ot(j,H,X,Y,Q){j.l+=2;var te=j.read_shift(2),ye=j.read_shift(2),Oe=o(j);if(te&8257)throw new Error("Unsupported ZIP encryption");for(var ge=j.read_shift(4),Ee=j.read_shift(4),Ae=j.read_shift(4),Ne=j.read_shift(2),Re=j.read_shift(2),Fe="",je=0;je<Ne;++je)Fe+=String.fromCharCode(j[j.l++]);if(Re){var Ve=c(j.slice(j.l,j.l+Re));(Ve[21589]||{}).mt&&(Oe=Ve[21589].mt),((Q||{})[21589]||{}).mt&&(Oe=Q[21589].mt)}j.l+=Re;var lt=j.slice(j.l,j.l+Ee);switch(ye){case 8:lt=le(j,Ae);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ye)}var Te=!1;te&8&&(ge=j.read_shift(4),ge==134695760&&(ge=j.read_shift(4),Te=!0),Ee=j.read_shift(4),Ae=j.read_shift(4)),Ee!=H&&Rl(Te,"Bad compressed size: "+H+" != "+Ee),Ae!=X&&Rl(Te,"Bad uncompressed size: "+X+" != "+Ae),aa(Y,Fe,lt,{unsafe:!0,mt:Oe})}function qa(j,H){var X=H||{},Y=[],Q=[],te=zr(1),ye=X.compression?8:0,Oe=0,ge=0,Ee=0,Ae=0,Ne=0,Re=j.FullPaths[0],Fe=Re,je=j.FileIndex[0],Ve=[],lt=0;for(ge=1;ge<j.FullPaths.length;++ge)if(Fe=j.FullPaths[ge].slice(Re.length),je=j.FileIndex[ge],!(!je.size||!je.content||Fe=="Sh33tJ5")){var Te=Ae,Jt=zr(Fe.length);for(Ee=0;Ee<Fe.length;++Ee)Jt.write_shift(1,Fe.charCodeAt(Ee)&127);Jt=Jt.slice(0,Jt.l),Ve[Ne]=Mee.buf(je.content,0);var gt=je.content;ye==8&&(gt=ne(gt)),te=zr(30),te.write_shift(4,67324752),te.write_shift(2,20),te.write_shift(2,Oe),te.write_shift(2,ye),je.mt?a(te,je.mt):te.write_shift(4,0),te.write_shift(-4,Ve[Ne]),te.write_shift(4,gt.length),te.write_shift(4,je.content.length),te.write_shift(2,Jt.length),te.write_shift(2,0),Ae+=te.length,Y.push(te),Ae+=Jt.length,Y.push(Jt),Ae+=gt.length,Y.push(gt),te=zr(46),te.write_shift(4,33639248),te.write_shift(2,0),te.write_shift(2,20),te.write_shift(2,Oe),te.write_shift(2,ye),te.write_shift(4,0),te.write_shift(-4,Ve[Ne]),te.write_shift(4,gt.length),te.write_shift(4,je.content.length),te.write_shift(2,Jt.length),te.write_shift(2,0),te.write_shift(2,0),te.write_shift(2,0),te.write_shift(2,0),te.write_shift(4,0),te.write_shift(4,Te),lt+=te.l,Q.push(te),lt+=Jt.length,Q.push(Jt),++Ne}return te=zr(22),te.write_shift(4,101010256),te.write_shift(2,0),te.write_shift(2,0),te.write_shift(2,Ne),te.write_shift(2,Ne),te.write_shift(4,lt),te.write_shift(4,Ae),te.write_shift(2,0),Js([Js(Y),Js(Q),te])}var Io={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Rf(j,H){if(j.ctype)return j.ctype;var X=j.name||"",Y=X.match(/\.([^\.]+)$/);return Y&&Io[Y[1]]||H&&(Y=(X=H).match(/[\.\\]([^\.\\])+$/),Y&&Io[Y[1]])?Io[Y[1]]:"application/octet-stream"}function gi(j){for(var H=U_(j),X=[],Y=0;Y<H.length;Y+=76)X.push(H.slice(Y,Y+76));return X.join(`\r
`)+`\r
`}function su(j){var H=j.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Ee){var Ae=Ee.charCodeAt(0).toString(16).toUpperCase();return"="+(Ae.length==1?"0"+Ae:Ae)});H=H.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),H.charAt(0)==`
`&&(H="=0D"+H.slice(1)),H=H.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var X=[],Y=H.split(`\r
`),Q=0;Q<Y.length;++Q){var te=Y[Q];if(te.length==0){X.push("");continue}for(var ye=0;ye<te.length;){var Oe=76,ge=te.slice(ye,ye+Oe);ge.charAt(Oe-1)=="="?Oe--:ge.charAt(Oe-2)=="="?Oe-=2:ge.charAt(Oe-3)=="="&&(Oe-=3),ge=te.slice(ye,ye+Oe),ye+=Oe,ye<te.length&&(ge+="="),X.push(ge)}}return X.join(`\r
`)}function qr(j){for(var H=[],X=0;X<j.length;++X){for(var Y=j[X];X<=j.length&&Y.charAt(Y.length-1)=="=";)Y=Y.slice(0,Y.length-1)+j[++X];H.push(Y)}for(var Q=0;Q<H.length;++Q)H[Q]=H[Q].replace(/[=][0-9A-Fa-f]{2}/g,function(te){return String.fromCharCode(parseInt(te.slice(1),16))});return ma(H.join(`\r
`))}function Bs(j,H,X){for(var Y="",Q="",te="",ye,Oe=0;Oe<10;++Oe){var ge=H[Oe];if(!ge||ge.match(/^\s*$/))break;var Ee=ge.match(/^(.*?):\s*([^\s].*)$/);if(Ee)switch(Ee[1].toLowerCase()){case"content-location":Y=Ee[2].trim();break;case"content-type":te=Ee[2].trim();break;case"content-transfer-encoding":Q=Ee[2].trim();break}}switch(++Oe,Q.toLowerCase()){case"base64":ye=ma(ki(H.slice(Oe).join("")));break;case"quoted-printable":ye=qr(H.slice(Oe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+Q)}var Ae=aa(j,Y.slice(X.length),ye,{unsafe:!0});te&&(Ae.ctype=te)}function Ml(j,H){if(q(j.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var X=H&&H.root||"",Y=(Ct&&Buffer.isBuffer(j)?j.toString("binary"):q(j)).split(`\r
`),Q=0,te="";for(Q=0;Q<Y.length;++Q)if(te=Y[Q],!!/^Content-Location:/i.test(te)&&(te=te.slice(te.indexOf("file")),X||(X=te.slice(0,te.lastIndexOf("/")+1)),te.slice(0,X.length)!=X))for(;X.length>0&&(X=X.slice(0,X.length-1),X=X.slice(0,X.lastIndexOf("/")+1),te.slice(0,X.length)!=X););var ye=(Y[1]||"").match(/boundary="(.*?)"/);if(!ye)throw new Error("MAD cannot find boundary");var Oe="--"+(ye[1]||""),ge=[],Ee=[],Ae={FileIndex:ge,FullPaths:Ee};P(Ae);var Ne,Re=0;for(Q=0;Q<Y.length;++Q){var Fe=Y[Q];Fe!==Oe&&Fe!==Oe+"--"||(Re++&&Bs(Ae,Y.slice(Ne,Q),X),Ne=Q)}return Ae}function Di(j,H){var X=H||{},Y=X.boundary||"SheetJS";Y="------="+Y;for(var Q=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+Y.slice(2)+'"',"","",""],te=j.FullPaths[0],ye=te,Oe=j.FileIndex[0],ge=1;ge<j.FullPaths.length;++ge)if(ye=j.FullPaths[ge].slice(te.length),Oe=j.FileIndex[ge],!(!Oe.size||!Oe.content||ye=="Sh33tJ5")){ye=ye.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(lt){return"_x"+lt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(lt){return"_u"+lt.charCodeAt(0).toString(16)+"_"});for(var Ee=Oe.content,Ae=Ct&&Buffer.isBuffer(Ee)?Ee.toString("binary"):q(Ee),Ne=0,Re=Math.min(1024,Ae.length),Fe=0,je=0;je<=Re;++je)(Fe=Ae.charCodeAt(je))>=32&&Fe<128&&++Ne;var Ve=Ne>=Re*4/5;Q.push(Y),Q.push("Content-Location: "+(X.root||"file:///C:/SheetJS/")+ye),Q.push("Content-Transfer-Encoding: "+(Ve?"quoted-printable":"base64")),Q.push("Content-Type: "+Rf(Oe,ye)),Q.push(""),Q.push(Ve?su(Ae):gi(Ae))}return Q.push(Y+`--\r
`),Q.join(`\r
`)}function cg(j){var H={};return P(H,j),H}function aa(j,H,X,Y){var Q=Y&&Y.unsafe;Q||P(j);var te=!Q&&bt.find(j,H);if(!te){var ye=j.FullPaths[0];H.slice(0,ye.length)==ye?ye=H:(ye.slice(-1)!="/"&&(ye+="/"),ye=(ye+H).replace("//","/")),te={name:i(H),type:2},j.FileIndex.push(te),j.FullPaths.push(ye),Q||bt.utils.cfb_gc(j)}return te.content=X,te.size=X?X.length:0,Y&&(Y.CLSID&&(te.clsid=Y.CLSID),Y.mt&&(te.mt=Y.mt),Y.ct&&(te.ct=Y.ct)),te}function ou(j,H){P(j);var X=bt.find(j,H);if(X){for(var Y=0;Y<j.FileIndex.length;++Y)if(j.FileIndex[Y]==X)return j.FileIndex.splice(Y,1),j.FullPaths.splice(Y,1),!0}return!1}function _n(j,H,X){P(j);var Y=bt.find(j,H);if(Y){for(var Q=0;Q<j.FileIndex.length;++Q)if(j.FileIndex[Q]==Y)return j.FileIndex[Q].name=i(X),j.FullPaths[Q]=X,!0}return!1}function Qa(j){B(j,!0)}return t.find=ee,t.read=R,t.parse=h,t.write=fe,t.writeFile=se,t.utils={cfb_new:cg,cfb_add:aa,cfb_del:ou,cfb_mov:_n,cfb_gc:Qa,ReadShift:t0,CheckField:UP,prep_blob:yn,bconcat:Js,use_zlib:G,_deflateRaw:dt,_inflateRaw:Ls,consts:ue},t}();function Fee(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function Ka(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function Hw(e){for(var t=[],r=Ka(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}var S1=new Date(1899,11,30,0,0,0);function qn(e,t){var r=e.getTime(),n=S1.getTime()+(e.getTimezoneOffset()-S1.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var yP=new Date,Lee=S1.getTime()+(yP.getTimezoneOffset()-S1.getTimezoneOffset())*6e4,Y_=yP.getTimezoneOffset();function ag(e){var t=new Date;return t.setTime(e*24*60*60*1e3+Lee),t.getTimezoneOffset()!==Y_&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Y_)*6e4),t}function Bee(e){var t=0,r=0,n=!1,i=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var a=1;a!=i.length;++a)if(i[a]){switch(r=1,a>3&&(n=!0),i[a].slice(i[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[a].slice(i[a].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(i[a],10)}return t}var Z_=new Date("2017-02-19T19:06:09.000Z"),wP=isNaN(Z_.getFullYear())?new Date("2/19/17"):Z_,jee=wP.getFullYear()==2017;function ln(e,t){var r=new Date(e);if(jee)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(wP.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function yl(e,t){if(Ct&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Hu(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Hu(sP(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Hu(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Hu(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(a){return r[a]||a})}catch{}for(var n=[],i=0;i!=e.length;++i)n.push(String.fromCharCode(e[i]));return n.join("")}function An(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=An(e[r]));return t}function br(e,t){for(var r="";r.length<t;)r+=e;return r}function Aa(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,a){return r=-r,a}),!isNaN(t=Number(n)))?t/r:t}var Uee=["january","february","march","april","may","june","july","august","september","october","november","december"];function Uc(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),i=t.getMonth(),a=t.getDate();if(isNaN(a))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&Uee.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||a>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var zee=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(e||typeof n=="string")return r.split(n);for(var a=r.split(n),o=[a[0]],c=1;c<a.length;++c)o.push(i),o.push(a[c]);return o}}();function EP(e){return e?e.content&&e.type?yl(e.content,!0):e.data?zu(e.data):e.asNodeBuffer&&Ct?zu(e.asNodeBuffer().toString("binary")):e.asBinary?zu(e.asBinary()):e._data&&e._data.getContent?zu(yl(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function AP(e){if(!e)return null;if(e.data)return B_(e.data);if(e.asNodeBuffer&&Ct)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?B_(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function Wee(e){return e&&e.name.slice(-4)===".bin"?AP(e):EP(e)}function Hi(e,t){for(var r=e.FullPaths||Ka(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),a=0;a<r.length;++a){var o=r[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||i==o)return e.files?e.files[r[a]]:e.FileIndex[a]}return null}function Gw(e,t){var r=Hi(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Dr(e,t,r){if(!r)return Wee(Gw(e,t));if(!t)return null;try{return Dr(e,t)}catch{return null}}function Ai(e,t,r){if(!r)return EP(Gw(e,t));if(!t)return null;try{return Ai(e,t)}catch{return null}}function Vee(e,t,r){return AP(Gw(e,t))}function q_(e){for(var t=e.FullPaths||Ka(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function Hee(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Ct?n=Ol(r):n=cee(r),bt.utils.cfb_add(e,t,n)}bt.utils.cfb_add(e,t,r)}else e.file(t,r)}function CP(e,t){switch(t.type){case"base64":return bt.read(e,{type:"base64"});case"binary":return bt.read(e,{type:"binary"});case"buffer":case"array":return bt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Vu(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var SP=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Gee=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Q_=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,$ee=/<[^>]*>/g,Un=SP.match(Q_)?Q_:$ee,Xee=/<\w*:/,Kee=/<(\/?)\w+:/;function ot(e,t,r){for(var n={},i=0,a=0;i!==e.length&&!((a=e.charCodeAt(i))===32||a===10||a===13);++i);if(t||(n[0]=e.slice(0,i)),i===e.length)return n;var o=e.match(Gee),c=0,f="",d=0,h="",m="",v=1;if(o)for(d=0;d!=o.length;++d){for(m=o[d],a=0;a!=m.length&&m.charCodeAt(a)!==61;++a);for(h=m.slice(0,a).trim();m.charCodeAt(a+1)==32;)++a;for(v=(i=m.charCodeAt(a+1))==34||i==39?1:0,f=m.slice(a+1+v,m.length-v),c=0;c!=h.length&&h.charCodeAt(c)!==58;++c);if(c===h.length)h.indexOf("_")>0&&(h=h.slice(0,h.indexOf("_"))),n[h]=f,n[h.toLowerCase()]=f;else{var w=(c===5&&h.slice(0,5)==="xmlns"?"xmlns":"")+h.slice(c+1);if(n[w]&&h.slice(c-3,c)=="ext")continue;n[w]=f,n[w.toLowerCase()]=f}}return n}function Ya(e){return e.replace(Kee,"<$1")}var _P={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Yee=Hw(_P),Nt=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",a=i.indexOf("<![CDATA[");if(a==-1)return i.replace(e,function(c,f){return _P[c]||String.fromCharCode(parseInt(f,c.indexOf("x")>-1?16:10))||c}).replace(t,function(c,f){return String.fromCharCode(parseInt(f,16))});var o=i.indexOf("]]>");return r(i.slice(0,a))+i.slice(a+9,o)+r(i.slice(o+3))}}(),Zee=/[&<>'"]/g,qee=/[\u0000-\u001f]/g;function $w(e){var t=e+"";return t.replace(Zee,function(r){return Yee[r]}).replace(/\n/g,"<br/>").replace(qee,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var J_=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function cr(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Em(e){for(var t="",r=0,n=0,i=0,a=0,o=0,c=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(i=e.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=i&63,t+=String.fromCharCode(o);continue}if(a=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(i&63)<<6|a&63);continue}o=e.charCodeAt(r++),c=((n&7)<<18|(i&63)<<12|(a&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(c>>>10&1023)),t+=String.fromCharCode(56320+(c&1023))}return t}function e4(e){var t=wo(2*e.length),r,n,i=1,a=0,o=0,c;for(n=0;n<e.length;n+=i)i=1,(c=e.charCodeAt(n))<128?r=c:c<224?(r=(c&31)*64+(e.charCodeAt(n+1)&63),i=2):c<240?(r=(c&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),i=3):(i=4,r=(c&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[a++]=o&255,t[a++]=o>>>8,o=0),t[a++]=r%256,t[a++]=r>>>8;return t.slice(0,a).toString("ucs2")}function t4(e){return Ol(e,"binary").toString("utf8")}var Cd="foo bar baz",qt=Ct&&(t4(Cd)==Em(Cd)&&t4||e4(Cd)==Em(Cd)&&e4)||Em,Hu=Ct?function(e){return Ol(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,i=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},$0=function(){var e={};return function(r,n){var i=r+"|"+(n||"");return e[i]?e[i]:e[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),bP=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)n=n.replace(e[i][0],e[i][1]);return n}}(),Qee=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),Jee=/<\/?(?:vt:)?variant>/g,ete=/<(?:vt:)([^>]*)>([\s\S]*)</;function r4(e,t){var r=ot(e),n=e.match(Qee(r.baseType))||[],i=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(a){var o=a.replace(Jee,"").match(ete);o&&i.push({v:qt(o[2]),t:o[1]})}),i}var tte=/(^\s|\s$|\n)/;function rte(e){return Ka(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function nte(e,t,r){return"<"+e+(r!=null?rte(r):"")+(t!=null?(t.match(tte)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Xw(e){if(Ct&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return qt(kl(zw(e)));throw new Error("Bad input format: expected Buffer or string")}var X0=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,ite={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},ate=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function ste(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),i=e[t+6]&15,a=5;a>=0;--a)i=i*256+e[t+a];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function ote(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,i=0,a=0,o=n?-t:t;isFinite(o)?o==0?i=a=0:(i=Math.floor(Math.log(o)/Math.LN2),a=o*Math.pow(2,52-i),i<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?i=-1022:(a-=Math.pow(2,52),i+=1023)):(i=2047,a=isNaN(t)?26985:0);for(var c=0;c<=5;++c,a/=256)e[r+c]=a&255;e[r+6]=(i&15)<<4|a&15,e[r+7]=i>>4|n}var n4=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var i=0,a=e[0][n].length;i<a;i+=r)t.push.apply(t,e[0][n].slice(i,i+r));return t},i4=Ct?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Ol(t)})):n4(e)}:n4,a4=function(e,t,r){for(var n=[],i=t;i<r;i+=2)n.push(String.fromCharCode(ls(e,i)));return n.join("").replace(Kn,"")},Kw=Ct?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Kn,""):a4(e,t,r)}:a4,s4=function(e,t,r){for(var n=[],i=t;i<t+r;++i)n.push(("0"+e[i].toString(16)).slice(-2));return n.join("")},TP=Ct?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):s4(e,t,r)}:s4,o4=function(e,t,r){for(var n=[],i=t;i<r;i++)n.push(String.fromCharCode(Kl(e,i)));return n.join("")},Of=Ct?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):o4(t,r,n)}:o4,OP=function(e,t){var r=wi(e,t);return r>0?Of(e,t+4,t+4+r-1):""},kP=OP,IP=function(e,t){var r=wi(e,t);return r>0?Of(e,t+4,t+4+r-1):""},NP=IP,PP=function(e,t){var r=2*wi(e,t);return r>0?Of(e,t+4,t+4+r-1):""},DP=PP,RP=function(t,r){var n=wi(t,r);return n>0?Kw(t,r+4,r+4+n):""},MP=RP,FP=function(e,t){var r=wi(e,t);return r>0?Of(e,t+4,t+4+r):""},LP=FP,BP=function(e,t){return ste(e,t)},_1=BP,jP=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Ct&&(kP=function(t,r){if(!Buffer.isBuffer(t))return OP(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},NP=function(t,r){if(!Buffer.isBuffer(t))return IP(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},DP=function(t,r){if(!Buffer.isBuffer(t))return PP(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},MP=function(t,r){if(!Buffer.isBuffer(t))return RP(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},LP=function(t,r){if(!Buffer.isBuffer(t))return FP(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},_1=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):BP(t,r)},jP=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Kl=function(e,t){return e[t]},ls=function(e,t){return e[t+1]*256+e[t]},lte=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},wi=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},zo=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},cte=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function t0(e,t){var r="",n,i,a=[],o,c,f,d;switch(t){case"dbcs":if(d=this.l,Ct&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(f=0;f<e;++f)r+=String.fromCharCode(ls(this,d)),d+=2;e*=2;break;case"utf8":r=Of(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Kw(this,this.l,this.l+e);break;case"wstr":return t0.call(this,e,"dbcs");case"lpstr-ansi":r=kP(this,this.l),e=4+wi(this,this.l);break;case"lpstr-cp":r=NP(this,this.l),e=4+wi(this,this.l);break;case"lpwstr":r=DP(this,this.l),e=4+2*wi(this,this.l);break;case"lpp4":e=4+wi(this,this.l),r=MP(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+wi(this,this.l),r=LP(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=Kl(this,this.l+e++))!==0;)a.push(Ad(o));r=a.join("");break;case"_wstr":for(e=0,r="";(o=ls(this,this.l+e))!==0;)a.push(Ad(o)),e+=2;e+=2,r=a.join("");break;case"dbcs-cont":for(r="",d=this.l,f=0;f<e;++f){if(this.lens&&this.lens.indexOf(d)!==-1)return o=Kl(this,d),this.l=d+1,c=t0.call(this,e-f,o?"dbcs-cont":"sbcs-cont"),a.join("")+c;a.push(Ad(ls(this,d))),d+=2}r=a.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",d=this.l,f=0;f!=e;++f){if(this.lens&&this.lens.indexOf(d)!==-1)return o=Kl(this,d),this.l=d+1,c=t0.call(this,e-f,o?"dbcs-cont":"sbcs-cont"),a.join("")+c;a.push(Ad(Kl(this,d))),d+=1}r=a.join("");break;default:switch(e){case 1:return n=Kl(this,this.l),this.l++,n;case 2:return n=(t==="i"?lte:ls)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?zo:cte)(this,this.l),this.l+=4,n):(i=wi(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return e==8?i=_1(this,this.l):i=_1([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:r=TP(this,this.l,e);break}}return this.l+=e,r}var ute=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},fte=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},dte=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function hte(e,t,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=t.length;++i)dte(this,t.charCodeAt(i),this.l+2*i);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;n=t.length}else if(r==="hex"){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var o=t.charCodeAt(i);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,ute(this,t,this.l);break;case 8:if(n=8,r==="f"){ote(this,t,this.l);break}case 16:break;case-4:n=4,fte(this,t,this.l);break}return this.l+=n,this}function UP(e,t){var r=TP(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function yn(e,t){e.l=t,e.read_shift=t0,e.chk=UP,e.write_shift=hte}function jn(e,t){e.l+=t}function zr(e){var t=wo(e);return yn(t,0),t}function Ms(e,t,r){if(e){var n,i,a;yn(e,e.l||0);for(var o=e.length,c=0,f=0;e.l<o;){c=e.read_shift(1),c&128&&(c=(c&127)+((e.read_shift(1)&127)<<7));var d=N1[c]||N1[65535];for(n=e.read_shift(1),a=n&127,i=1;i<4&&n&128;++i)a+=((n=e.read_shift(1))&127)<<7*i;f=e.l+a;var h=d.f&&d.f(e,a,r);if(e.l=f,t(h,d,c))return}}}function kv(){var e=[],t=Ct?256:2048,r=function(d){var h=zr(d);return yn(h,0),h},n=r(t),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},a=function(d){return n&&d<n.length-n.l?n:(i(),n=r(Math.max(d+1,t)))},o=function(){return i(),Js(e)},c=function(d){i(),n=d,n.l==null&&(n.l=n.length),a(t)};return{next:a,push:c,end:o,_bufs:e}}function r0(e,t,r){var n=An(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function l4(e,t,r){var n=An(e);return n.s=r0(n.s,t.s,r),n.e=r0(n.e,t.s,r),n}function n0(e,t){if(e.cRel&&e.c<0)for(e=An(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=An(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=ct(e);return!e.cRel&&e.cRel!=null&&(r=mte(r)),!e.rRel&&e.rRel!=null&&(r=pte(r)),r}function Am(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+$r(e.s.c)+":"+(e.e.cRel?"":"$")+$r(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Cn(e.s.r)+":"+(e.e.rRel?"":"$")+Cn(e.e.r):n0(e.s,t.biff)+":"+n0(e.e,t.biff)}function Yw(e){return parseInt(gte(e),10)-1}function Cn(e){return""+(e+1)}function pte(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function gte(e){return e.replace(/\$(\d+)$/,"$1")}function Zw(e){for(var t=xte(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function $r(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function mte(e){return e.replace(/^([A-Z])/,"$$$1")}function xte(e){return e.replace(/^\$([A-Z])/,"$1")}function vte(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function $n(e){for(var t=0,r=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:t-1}}function ct(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function nu(e){var t=e.indexOf(":");return t==-1?{s:$n(e),e:$n(e)}:{s:$n(e.slice(0,t)),e:$n(e.slice(t+1))}}function Tt(e,t){return typeof t>"u"||typeof t=="number"?Tt(e.s,e.e):(typeof e!="string"&&(e=ct(e)),typeof t!="string"&&(t=ct(t)),e==t?e:e+":"+t)}function Tr(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,a=e.length;for(r=0;n<a&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.s.c=--r,r=0;n<a&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(t.s.r=--r,n===a||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=a&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.e.c=--r,r=0;n!=a&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return t.e.r=--r,t}function c4(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=ta(e.z,r?qn(t):t)}catch{}try{return e.w=ta((e.XF||{}).numFmtId||(r?14:0),r?qn(t):t)}catch{return""+t}}function _s(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Pl[e.v]||e.v:t==null?c4(e,e.v):c4(e,t))}function ko(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function zP(e,t,r){var n=r||{},i=e?Array.isArray(e):n.dense,a=e||(i?[]:{}),o=0,c=0;if(a&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var f=typeof n.origin=="string"?$n(n.origin):n.origin;o=f.r,c=f.c}a["!ref"]||(a["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var h=Tr(a["!ref"]);d.s.c=h.s.c,d.s.r=h.s.r,d.e.c=Math.max(d.e.c,h.e.c),d.e.r=Math.max(d.e.r,h.e.r),o==-1&&(d.e.r=o=h.e.r+1)}for(var m=0;m!=t.length;++m)if(t[m]){if(!Array.isArray(t[m]))throw new Error("aoa_to_sheet expects an array of arrays");for(var v=0;v!=t[m].length;++v)if(!(typeof t[m][v]>"u")){var w={v:t[m][v]},E=o+m,A=c+v;if(d.s.r>E&&(d.s.r=E),d.s.c>A&&(d.s.c=A),d.e.r<E&&(d.e.r=E),d.e.c<A&&(d.e.c=A),t[m][v]&&typeof t[m][v]=="object"&&!Array.isArray(t[m][v])&&!(t[m][v]instanceof Date))w=t[m][v];else if(Array.isArray(w.v)&&(w.f=t[m][v][1],w.v=w.v[0]),w.v===null)if(w.f)w.t="n";else if(n.nullError)w.t="e",w.v=0;else if(n.sheetStubs)w.t="z";else continue;else typeof w.v=="number"?w.t="n":typeof w.v=="boolean"?w.t="b":w.v instanceof Date?(w.z=n.dateNF||ft[14],n.cellDates?(w.t="d",w.w=ta(w.z,qn(w.v))):(w.t="n",w.v=qn(w.v),w.w=ta(w.z,w.v))):w.t="s";if(i)a[E]||(a[E]=[]),a[E][A]&&a[E][A].z&&(w.z=a[E][A].z),a[E][A]=w;else{var S=ct({c:A,r:E});a[S]&&a[S].z&&(w.z=a[S].z),a[S]=w}}}return d.s.c<1e7&&(a["!ref"]=Tt(d)),a}function iu(e,t){return zP(null,e,t)}function yte(e){return e.read_shift(4,"i")}function Ln(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function wte(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function qw(e,t){var r=e.l,n=e.read_shift(1),i=Ln(e),a=[],o={t:i,h:i};if(n&1){for(var c=e.read_shift(4),f=0;f!=c;++f)a.push(wte(e));o.r=a}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}var Ete=qw;function ia(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Il(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var Ate=Ln;function Qw(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}var Cte=Ln,Iv=Qw;function Jw(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var i=n===0?_1([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):zo(t,0)>>2;return r?i/100:i}function WP(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var Nl=WP;function Rn(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Ste(e){var t={},r=e.read_shift(1),n=r>>>1,i=e.read_shift(1),a=e.read_shift(2,"i"),o=e.read_shift(1),c=e.read_shift(1),f=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=i;var d=rl[i];d&&(t.rgb=Y0(d));break;case 2:t.rgb=Y0([o,c,f]);break;case 3:t.theme=i;break}return a!=0&&(t.tint=a>0?a/32767:a/32768),t}function _te(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function VP(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function bte(e){return VP(e,1)}function Tte(e){return VP(e,2)}var eE=2,ii=3,Sd=11,u4=12,b1=19,_d=64,Ote=65,kte=71,Ite=4108,Nte=4126,nn=80,HP=81,Pte=[nn,HP],Dte={1:{n:"CodePage",t:eE},2:{n:"Category",t:nn},3:{n:"PresentationFormat",t:nn},4:{n:"ByteCount",t:ii},5:{n:"LineCount",t:ii},6:{n:"ParagraphCount",t:ii},7:{n:"SlideCount",t:ii},8:{n:"NoteCount",t:ii},9:{n:"HiddenCount",t:ii},10:{n:"MultimediaClipCount",t:ii},11:{n:"ScaleCrop",t:Sd},12:{n:"HeadingPairs",t:Ite},13:{n:"TitlesOfParts",t:Nte},14:{n:"Manager",t:nn},15:{n:"Company",t:nn},16:{n:"LinksUpToDate",t:Sd},17:{n:"CharacterCount",t:ii},19:{n:"SharedDoc",t:Sd},22:{n:"HyperlinksChanged",t:Sd},23:{n:"AppVersion",t:ii,p:"version"},24:{n:"DigSig",t:Ote},26:{n:"ContentType",t:nn},27:{n:"ContentStatus",t:nn},28:{n:"Language",t:nn},29:{n:"Version",t:nn},255:{},2147483648:{n:"Locale",t:b1},2147483651:{n:"Behavior",t:b1},1919054434:{}},Rte={1:{n:"CodePage",t:eE},2:{n:"Title",t:nn},3:{n:"Subject",t:nn},4:{n:"Author",t:nn},5:{n:"Keywords",t:nn},6:{n:"Comments",t:nn},7:{n:"Template",t:nn},8:{n:"LastAuthor",t:nn},9:{n:"RevNumber",t:nn},10:{n:"EditTime",t:_d},11:{n:"LastPrinted",t:_d},12:{n:"CreatedDate",t:_d},13:{n:"ModifiedDate",t:_d},14:{n:"PageCount",t:ii},15:{n:"WordCount",t:ii},16:{n:"CharCount",t:ii},17:{n:"Thumbnail",t:kte},18:{n:"Application",t:nn},19:{n:"DocSecurity",t:ii},255:{},2147483648:{n:"Locale",t:b1},2147483651:{n:"Behavior",t:b1},1919054434:{}},f4={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},Mte=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function Fte(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var Lte=Fte([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),rl=An(Lte),Pl={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},GP={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},d4={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function Bte(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function jte(e){var t=Bte();if(!e||!e.match)return t;var r={};if((e.match(Un)||[]).forEach(function(n){var i=ot(n);switch(i[0].replace(Xee,"<")){case"<?xml":break;case"<Types":t.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":t[d4[i.ContentType]]!==void 0&&t[d4[i.ContentType]].push(i.PartName);break}}),t.xmlns!==ite.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}var fc={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Nv(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function i0(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Un)||[]).forEach(function(i){var a=ot(i);if(a[0]==="<Relationship"){var o={};o.Type=a.Type,o.Target=a.Target,o.Id=a.Id,a.TargetMode&&(o.TargetMode=a.TargetMode);var c=a.TargetMode==="External"?a.Target:Vu(a.Target,t);r[c]=o,n[a.Id]=o}}),r["!id"]=n,r}var Ute="application/vnd.oasis.opendocument.spreadsheet";function zte(e,t){for(var r=Xw(e),n,i;n=X0.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=ot(n[0],!1),i.path=="/"&&i.type!==Ute)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}var a0=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],Wte=function(){for(var e=new Array(a0.length),t=0;t<a0.length;++t){var r=a0[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function $P(e){var t={};e=qt(e);for(var r=0;r<a0.length;++r){var n=a0[r],i=e.match(Wte[r]);i!=null&&i.length>0&&(t[n[1]]=Nt(i[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=ln(t[n[1]]))}return t}var Vte=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function XP(e,t,r,n){var i=[];if(typeof e=="string")i=r4(e,n);else for(var a=0;a<e.length;++a)i=i.concat(e[a].map(function(h){return{v:h}}));var o=typeof t=="string"?r4(t,n).map(function(h){return h.v}):t,c=0,f=0;if(o.length>0)for(var d=0;d!==i.length;d+=2){switch(f=+i[d+1].v,i[d].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=f,r.SheetNames=o.slice(c,c+f);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=f,r.DefinedNames=o.slice(c,c+f);break;case"Charts":case"Diagramme":r.Chartsheets=f,r.ChartNames=o.slice(c,c+f);break}c+=f}}function Hte(e,t,r){var n={};return t||(t={}),e=qt(e),Vte.forEach(function(i){var a=(e.match($0(i[0]))||[])[1];switch(i[2]){case"string":a&&(t[i[1]]=Nt(a));break;case"bool":t[i[1]]=a==="true";break;case"raw":var o=e.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));o&&o.length>0&&(n[i[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&XP(n.HeadingPairs,n.TitlesOfParts,t,r),t}var Gte=/<[^>]+>[^<]*/g;function $te(e,t){var r={},n="",i=e.match(Gte);if(i)for(var a=0;a!=i.length;++a){var o=i[a],c=ot(o);switch(c[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Nt(c.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var f=o.split(">"),d=f[0].slice(4),h=f[1];switch(d){case"lpstr":case"bstr":case"lpwstr":r[n]=Nt(h);break;case"bool":r[n]=cr(h);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(h,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(h);break;case"filetime":case"date":r[n]=ln(h);break;case"cy":case"error":r[n]=Nt(h);break;default:if(d.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",o,d,f)}}else if(o.slice(0,2)!=="</"){if(t.WTF)throw new Error(o)}}}return r}var Xte={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Cm;function Kte(e,t,r){Cm||(Cm=Hw(Xte)),t=Cm[t]||t,e[t]=r}function tE(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function KP(e,t,r){var n=e.l,i=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return i}function YP(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function ZP(e,t,r){return t===31?YP(e):KP(e,t,r)}function Pv(e,t,r){return ZP(e,t,r===!1?0:4)}function Yte(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return ZP(e,t,0)}function Zte(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var i=e.l;r[n]=e.read_shift(0,"lpwstr").replace(Kn,""),e.l-i&2&&(e.l+=2)}return r}function qte(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(Kn,"");return r}function Qte(e){var t=e.l,r=T1(e,HP);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=T1(e,ii);return[r,n]}function Jte(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(Qte(e));return r}function h4(e,t){for(var r=e.read_shift(4),n={},i=0;i!=r;++i){var a=e.read_shift(4),o=e.read_shift(4);n[a]=e.read_shift(o,t===1200?"utf16le":"utf8").replace(Kn,"").replace(Wu,"!"),t===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function qP(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function ere(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function T1(e,t,r){var n=e.read_shift(2),i,a=r||{};if(e.l+=2,t!==u4&&n!==t&&Pte.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===u4?n:t){case 2:return i=e.read_shift(2,"i"),a.raw||(e.l+=2),i;case 3:return i=e.read_shift(4,"i"),i;case 11:return e.read_shift(4)!==0;case 19:return i=e.read_shift(4),i;case 30:return KP(e,n,4).replace(Kn,"");case 31:return YP(e);case 64:return tE(e);case 65:return qP(e);case 71:return ere(e);case 80:return Pv(e,n,!a.raw).replace(Kn,"");case 81:return Yte(e,n).replace(Kn,"");case 4108:return Jte(e);case 4126:case 4127:return n==4127?Zte(e):qte(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function p4(e,t){var r=e.l,n=e.read_shift(4),i=e.read_shift(4),a=[],o=0,c=0,f=-1,d={};for(o=0;o!=i;++o){var h=e.read_shift(4),m=e.read_shift(4);a[o]=[h,m+r]}a.sort(function(T,_){return T[1]-_[1]});var v={};for(o=0;o!=i;++o){if(e.l!==a[o][1]){var w=!0;if(o>0&&t)switch(t[a[o-1][0]].t){case 2:e.l+2===a[o][1]&&(e.l+=2,w=!1);break;case 80:e.l<=a[o][1]&&(e.l=a[o][1],w=!1);break;case 4108:e.l<=a[o][1]&&(e.l=a[o][1],w=!1);break}if((!t||o==0)&&e.l<=a[o][1]&&(w=!1,e.l=a[o][1]),w)throw new Error("Read Error: Expected address "+a[o][1]+" at "+e.l+" :"+o)}if(t){var E=t[a[o][0]];if(v[E.n]=T1(e,E.t,{raw:!0}),E.p==="version"&&(v[E.n]=String(v[E.n]>>16)+"."+("0000"+String(v[E.n]&65535)).slice(-4)),E.n=="CodePage")switch(v[E.n]){case 0:v[E.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:xa(c=v[E.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+v[E.n])}}else if(a[o][0]===1){if(c=v.CodePage=T1(e,eE),xa(c),f!==-1){var A=e.l;e.l=a[f][1],d=h4(e,c),e.l=A}}else if(a[o][0]===0){if(c===0){f=o,e.l=a[o+1][1];continue}d=h4(e,c)}else{var S=d[a[o][0]],b;switch(e[e.l]){case 65:e.l+=4,b=qP(e);break;case 30:e.l+=4,b=Pv(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,b=Pv(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,b=e.read_shift(4,"i");break;case 19:e.l+=4,b=e.read_shift(4);break;case 5:e.l+=4,b=e.read_shift(8,"f");break;case 11:e.l+=4,b=Ir(e,4);break;case 64:e.l+=4,b=ln(tE(e));break;default:throw new Error("unparsed value: "+e[e.l])}v[S]=b}}return e.l=r+n,v}function g4(e,t,r){var n=e.content;if(!n)return{};yn(n,0);var i,a,o,c,f=0;n.chk("feff","Byte Order: "),n.read_shift(2);var d=n.read_shift(4),h=n.read_shift(16);if(h!==bt.utils.consts.HEADER_CLSID&&h!==r)throw new Error("Bad PropertySet CLSID "+h);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(a=n.read_shift(16),c=n.read_shift(4),i===1&&c!==n.l)throw new Error("Length mismatch: "+c+" !== "+n.l);i===2&&(o=n.read_shift(16),f=n.read_shift(4));var m=p4(n,t),v={SystemIdentifier:d};for(var w in m)v[w]=m[w];if(v.FMTID=a,i===1)return v;if(f-n.l==2&&(n.l+=2),n.l!==f)throw new Error("Length mismatch 2: "+n.l+" !== "+f);var E;try{E=p4(n,null)}catch{}for(w in E)v[w]=E[w];return v.FMTID=[a,o],v}function Gs(e,t){return e.read_shift(t),null}function tre(e,t,r){for(var n=[],i=e.l+t;e.l<i;)n.push(r(e,i-e.l));if(i!==e.l)throw new Error("Slurp error");return n}function Ir(e,t){return e.read_shift(t)===1}function Rr(e){return e.read_shift(2,"u")}function QP(e,t){return tre(e,t,Rr)}function rre(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function kf(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var a=e.read_shift(1);a&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var o=n?e.read_shift(n,i):"";return o}function nre(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,i=r&8,a=1+(r&1),o=0,c,f={};i&&(o=e.read_shift(2)),n&&(c=e.read_shift(4));var d=a==2?"dbcs-cont":"sbcs-cont",h=t===0?"":e.read_shift(t,d);return i&&(e.l+=4*o),n&&(e.l+=c),f.t=h,i||(f.raw="<t>"+f.t+"</t>",f.r=f.t),f}function wl(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var i=e.read_shift(1);return i===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function If(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):wl(e,n,r)}function Dl(e,t,r){if(r.biff>5)return If(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function ire(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function are(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var i=e.read_shift((n?t-24:t)>>1,"utf16le").replace(Kn,"");return n&&(e.l+=24),i}function sre(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=e.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var a=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(a>>1,"utf16le").replace(Kn,"");return r+o}function ore(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return are(e);case"0303000000000000c000000000000046":return sre(e);default:throw new Error("Unsupported Moniker "+r)}}function bd(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Kn,""):"";return r}function lre(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=e.read_shift(2);e.l+=2;var a,o,c,f,d="",h,m;i&16&&(a=bd(e,r-e.l)),i&128&&(o=bd(e,r-e.l)),(i&257)===257&&(c=bd(e,r-e.l)),(i&257)===1&&(f=ore(e,r-e.l)),i&8&&(d=bd(e,r-e.l)),i&32&&(h=e.read_shift(16)),i&64&&(m=tE(e)),e.l=r;var v=o||c||f||"";v&&d&&(v+="#"+d),v||(v="#"+d),i&2&&v.charAt(0)=="/"&&v.charAt(1)!="/"&&(v="file://"+v);var w={Target:v};return h&&(w.guid=h),m&&(w.time=m),a&&(w.Tooltip=a),w}function JP(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),i=e.read_shift(1);return[t,r,n,i]}function e5(e,t){var r=JP(e);return r[3]=0,r}function Za(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function cre(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function ure(e,t,r){return t===0?"":Dl(e,t,r)}function fre(e,t,r){var n=r.biff>8?4:2,i=e.read_shift(n),a=e.read_shift(n,"i"),o=e.read_shift(n,"i");return[i,a,o]}function t5(e){var t=e.read_shift(2),r=Jw(e);return[t,r]}function dre(e,t,r){e.l+=4,t-=4;var n=e.l+t,i=kf(e,t,r),a=e.read_shift(2);if(n-=e.l,a!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+a);return e.l+=a,i}function sg(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);return{s:{c:n,r:t},e:{c:i,r}}}function r5(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),i=e.read_shift(1);return{s:{c:n,r:t},e:{c:i,r}}}var hre=r5;function n5(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function pre(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function gre(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function kn(e){e.l+=2,e.l+=e.read_shift(2)}var mre={0:kn,4:kn,5:kn,6:kn,7:gre,8:kn,9:kn,10:kn,11:kn,12:kn,13:pre,14:kn,15:kn,16:kn,17:kn,18:kn,19:kn,20:kn,21:n5};function xre(e,t){for(var r=e.l+t,n=[];e.l<r;){var i=e.read_shift(2);e.l-=2;try{n.push(mre[i](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function Td(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function vre(e,t){return t===0||e.read_shift(2),1200}function yre(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,i=Dl(e,0,r);return e.read_shift(t+n-e.l),i}function wre(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function Ere(e,t,r){var n=e.read_shift(4),i=e.read_shift(1)&3,a=e.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule";break}var o=kf(e,0,r);return o.length===0&&(o="Sheet1"),{pos:n,hs:i,dt:a,name:o}}function Are(e,t){for(var r=e.l+t,n=e.read_shift(4),i=e.read_shift(4),a=[],o=0;o!=i&&e.l<r;++o)a.push(nre(e));return a.Count=n,a.Unique=i,a}function Cre(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function Sre(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function _re(e){var t=cre(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function bre(e){return e.read_shift(2),e.read_shift(4)}function m4(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var i=e.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var a={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[a,i]}function Tre(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2),c=e.read_shift(2),f=e.read_shift(2),d=e.read_shift(2);return{Pos:[t,r],Dim:[n,i],Flags:a,CurTab:o,FirstTab:c,Selected:f,TabRatio:d}}function Ore(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function kre(){}function Ire(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=kf(e,0,r),n}function Nre(e){var t=Za(e);return t.isst=e.read_shift(4),t}function Pre(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,i=Za(e);r.biff==2&&e.l++;var a=If(e,n-e.l,r);return i.val=a,i}function Dre(e,t,r){var n=e.read_shift(2),i=Dl(e,0,r);return[n,i]}var Rre=Dl;function x4(e,t,r){var n=e.l+t,i=r.biff==8||!r.biff?4:2,a=e.read_shift(i),o=e.read_shift(i),c=e.read_shift(2),f=e.read_shift(2);return e.l=n,{s:{r:a,c},e:{r:o,c:f}}}function Mre(e){var t=e.read_shift(2),r=e.read_shift(2),n=t5(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function Fre(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),a=[];e.l<r;)a.push(t5(e));if(e.l!==r)throw new Error("MulRK read error");var o=e.read_shift(2);if(a.length!=o-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:o,rkrec:a}}function Lre(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),a=[];e.l<r;)a.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var o=e.read_shift(2);if(a.length!=o-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:o,ixfe:a}}function Bre(e,t,r,n){var i={},a=e.read_shift(4),o=e.read_shift(4),c=e.read_shift(4),f=e.read_shift(2);return i.patternType=Mte[c>>26],n.cellStyles&&(i.alc=a&7,i.fWrap=a>>3&1,i.alcV=a>>4&7,i.fJustLast=a>>7&1,i.trot=a>>8&255,i.cIndent=a>>16&15,i.fShrinkToFit=a>>20&1,i.iReadOrder=a>>22&2,i.fAtrNum=a>>26&1,i.fAtrFnt=a>>27&1,i.fAtrAlc=a>>28&1,i.fAtrBdr=a>>29&1,i.fAtrPat=a>>30&1,i.fAtrProt=a>>31&1,i.dgLeft=o&15,i.dgRight=o>>4&15,i.dgTop=o>>8&15,i.dgBottom=o>>12&15,i.icvLeft=o>>16&127,i.icvRight=o>>23&127,i.grbitDiag=o>>30&3,i.icvTop=c&127,i.icvBottom=c>>7&127,i.icvDiag=c>>14&127,i.dgDiag=c>>21&15,i.icvFore=f&127,i.icvBack=f>>7&127,i.fsxButton=f>>14&1),i}function jre(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=Bre(e,t,n.fStyle,r),n}function Ure(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function v4(e,t,r){var n=Za(e);(r.biff==2||t==9)&&++e.l;var i=rre(e);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function zre(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Za(e),i=Rn(e);return n.val=i,n}var y4=ure;function Wre(e,t,r){var n=e.l+t,i=e.read_shift(2),a=e.read_shift(2);if(r.sbcch=a,a==1025||a==14849)return[a,i];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var o=wl(e,a),c=[];n>e.l;)c.push(If(e));return[a,i,o,c]}function w4(e,t,r){var n=e.read_shift(2),i,a={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=dre(e,t-2,r)),a.body=i||e.read_shift(t-2),typeof i=="string"&&(a.Name=i),a}var Vre=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function E4(e,t,r){var n=e.l+t,i=e.read_shift(2),a=e.read_shift(1),o=e.read_shift(1),c=e.read_shift(r&&r.biff==2?1:2),f=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),f=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var d=wl(e,o,r);i&32&&(d=Vre[d.charCodeAt(0)]);var h=n-e.l;r&&r.biff==2&&--h;var m=n==e.l||c===0||!(h>0)?[]:Sse(e,h,r,c);return{chKey:a,Name:d,itab:f,rgce:m}}function i5(e,t,r){if(r.biff<8)return Hre(e,t,r);for(var n=[],i=e.l+t,a=e.read_shift(r.biff>8?4:2);a--!==0;)n.push(fre(e,r.biff>8?12:6,r));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return n}function Hre(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=kf(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function Gre(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),i=e.read_shift(2),a=wl(e,n,r),o=wl(e,i,r);return[a,o]}function $re(e,t,r){var n=r5(e);e.l++;var i=e.read_shift(1);return t-=8,[_se(e,t,r),i,n]}function A4(e,t,r){var n=hre(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,Ase(e,t,r)]}function Xre(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function Kre(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),i=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2),c=Dl(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:i},c,o,a]}}function Yre(e,t,r){return Kre(e,t,r)}function Zre(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(sg(e));return r}function qre(e,t,r){if(r&&r.biff<8)return Jre(e,t,r);var n=n5(e),i=xre(e,t-22,n[1]);return{cmo:n,ft:i}}var Qre={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var i=e.read_shift(1);return e.l+=i,e.l=r,{fmt:n}}};function Jre(e,t,r){e.l+=4;var n=e.read_shift(2),i=e.read_shift(2),a=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var o=[];return o.push((Qre[n]||jn)(e,t,r)),{cmo:[i,n,a],ft:o}}function ene(e,t,r){var n=e.l,i="";try{e.l+=4;var a=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(a)==-1?e.l+=6:o=ire(e,6,r);var c=e.read_shift(2);e.read_shift(2),Rr(e,2);var f=e.read_shift(2);e.l+=f;for(var d=1;d<e.lens.length-1;++d){if(e.l-n!=e.lens[d])throw new Error("TxO: bad continue record");var h=e[e.l],m=wl(e,e.lens[d+1]-e.lens[d]-1);if(i+=m,i.length>=(h?c:2*c))break}if(i.length!==c&&i.length!==c*2)throw new Error("cchText: "+c+" != "+i.length);return e.l=n+t,{t:i}}catch{return e.l=n+t,{t:i}}}function tne(e,t){var r=sg(e);e.l+=16;var n=lre(e,t-24);return[r,n]}function rne(e,t){e.read_shift(2);var r=sg(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(Kn,""),[r,n]}function nne(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=f4[r]||r,r=e.read_shift(2),t[1]=f4[r]||r,t}function ine(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(e5(e));return r}function ane(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(e5(e));return r}function sne(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function a5(e,t,r){if(!r.cellStyles)return jn(e,t);var n=r&&r.biff>=12?4:2,i=e.read_shift(n),a=e.read_shift(n),o=e.read_shift(n),c=e.read_shift(n),f=e.read_shift(2);n==2&&(e.l+=2);var d={s:i,e:a,w:o,ixfe:c,flags:f};return(r.biff>=5||!r.biff)&&(d.level=f>>8&7),d}function one(e,t){var r={};return t<32||(e.l+=16,r.header=Rn(e),r.footer=Rn(e),e.l+=2),r}function lne(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var i=e.read_shift(1);return e.l+=3,i&16&&(n.area=!0),n}var cne=Za,une=QP,fne=If;function dne(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,i}function hne(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Za(e);++e.l;var i=Dl(e,t-7,r);return n.t="str",n.val=i,n}function pne(e){var t=Za(e);++e.l;var r=Rn(e);return t.t="n",t.val=r,t}function gne(e){var t=Za(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function mne(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function xne(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function vne(e,t,r){var n=e.l+t,i=Za(e),a=e.read_shift(2),o=wl(e,a,r);return e.l=n,i.t="str",i.val=o,i}var yne=[2,3,48,49,131,139,140,245],C4=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Hw({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(c,f){var d=[],h=wo(1);switch(f.type){case"base64":h=ma(ki(c));break;case"binary":h=ma(c);break;case"buffer":case"array":h=c;break}yn(h,0);var m=h.read_shift(1),v=!!(m&136),w=!1,E=!1;switch(m){case 2:break;case 3:break;case 48:w=!0,v=!0;break;case 49:w=!0,v=!0;break;case 131:break;case 139:break;case 140:E=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+m.toString(16))}var A=0,S=521;m==2&&(A=h.read_shift(2)),h.l+=3,m!=2&&(A=h.read_shift(4)),A>1048576&&(A=1e6),m!=2&&(S=h.read_shift(2));var b=h.read_shift(2),T=f.codepage||1252;m!=2&&(h.l+=16,h.read_shift(1),h[h.l]!==0&&(T=e[h[h.l]]),h.l+=1,h.l+=2),E&&(h.l+=36);for(var _=[],N={},M=Math.min(h.length,m==2?521:S-10-(w?264:0)),R=E?32:11;h.l<M&&h[h.l]!=13;)switch(N={},N.name=H0.utils.decode(T,h.slice(h.l,h.l+R)).replace(/[\u0000\r\n].*$/g,""),h.l+=R,N.type=String.fromCharCode(h.read_shift(1)),m!=2&&!E&&(N.offset=h.read_shift(4)),N.len=h.read_shift(1),m==2&&(N.offset=h.read_shift(2)),N.dec=h.read_shift(1),N.name.length&&_.push(N),m!=2&&(h.l+=E?13:14),N.type){case"B":(!w||N.len!=8)&&f.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"G":case"P":f.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+N.type)}if(h[h.l]!==13&&(h.l=S-1),h.read_shift(1)!==13)throw new Error("DBF Terminator not found "+h.l+" "+h[h.l]);h.l=S;var P=0,z=0;for(d[0]=[],z=0;z!=_.length;++z)d[0][z]=_[z].name;for(;A-- >0;){if(h[h.l]===42){h.l+=b;continue}for(++h.l,d[++P]=[],z=0,z=0;z!=_.length;++z){var B=h.slice(h.l,h.l+_[z].len);h.l+=_[z].len,yn(B,0);var re=H0.utils.decode(T,B);switch(_[z].type){case"C":re.trim().length&&(d[P][z]=re.replace(/\s+$/,""));break;case"D":re.length===8?d[P][z]=new Date(+re.slice(0,4),+re.slice(4,6)-1,+re.slice(6,8)):d[P][z]=re;break;case"F":d[P][z]=parseFloat(re.trim());break;case"+":case"I":d[P][z]=E?B.read_shift(-4,"i")^2147483648:B.read_shift(4,"i");break;case"L":switch(re.trim().toUpperCase()){case"Y":case"T":d[P][z]=!0;break;case"N":case"F":d[P][z]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+re+"|")}break;case"M":if(!v)throw new Error("DBF Unexpected MEMO for type "+m.toString(16));d[P][z]="##MEMO##"+(E?parseInt(re.trim(),10):B.read_shift(4));break;case"N":re=re.replace(/\u0000/g,"").trim(),re&&re!="."&&(d[P][z]=+re||0);break;case"@":d[P][z]=new Date(B.read_shift(-8,"f")-621356832e5);break;case"T":d[P][z]=new Date((B.read_shift(4)-2440588)*864e5+B.read_shift(4));break;case"Y":d[P][z]=B.read_shift(4,"i")/1e4+B.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[P][z]=-B.read_shift(-8,"f");break;case"B":if(w&&_[z].len==8){d[P][z]=B.read_shift(8,"f");break}case"G":case"P":B.l+=_[z].len;break;case"0":if(_[z].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+_[z].type)}}}if(m!=2&&h.l<h.length&&h[h.l++]!=26)throw new Error("DBF EOF Marker missing "+(h.l-1)+" of "+h.length+" "+h[h.l-1].toString(16));return f&&f.sheetRows&&(d=d.slice(0,f.sheetRows)),f.DBF=_,d}function n(c,f){var d=f||{};d.dateNF||(d.dateNF="yyyymmdd");var h=iu(r(c,d),d);return h["!cols"]=d.DBF.map(function(m){return{wch:m.len,DBF:m}}),delete d.DBF,h}function i(c,f){try{return ko(n(c,f),f)}catch(d){if(f&&f.WTF)throw d}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function o(c,f){var d=f||{};if(+d.codepage>=0&&xa(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var h=kv(),m=jv(c,{header:1,raw:!0,cellDates:!0}),v=m[0],w=m.slice(1),E=c["!cols"]||[],A=0,S=0,b=0,T=1;for(A=0;A<v.length;++A){if(((E[A]||{}).DBF||{}).name){v[A]=E[A].DBF.name,++b;continue}if(v[A]!=null){if(++b,typeof v[A]=="number"&&(v[A]=v[A].toString(10)),typeof v[A]!="string")throw new Error("DBF Invalid column name "+v[A]+" |"+typeof v[A]+"|");if(v.indexOf(v[A])!==A){for(S=0;S<1024;++S)if(v.indexOf(v[A]+"_"+S)==-1){v[A]+="_"+S;break}}}}var _=Tr(c["!ref"]),N=[],M=[],R=[];for(A=0;A<=_.e.c-_.s.c;++A){var P="",z="",B=0,re=[];for(S=0;S<w.length;++S)w[S][A]!=null&&re.push(w[S][A]);if(re.length==0||v[A]==null){N[A]="?";continue}for(S=0;S<re.length;++S){switch(typeof re[S]){case"number":z="B";break;case"string":z="C";break;case"boolean":z="L";break;case"object":z=re[S]instanceof Date?"D":"C";break;default:z="C"}B=Math.max(B,String(re[S]).length),P=P&&P!=z?"C":z}B>250&&(B=250),z=((E[A]||{}).DBF||{}).type,z=="C"&&E[A].DBF.len>B&&(B=E[A].DBF.len),P=="B"&&z=="N"&&(P="N",R[A]=E[A].DBF.dec,B=E[A].DBF.len),M[A]=P=="C"||z=="N"?B:a[P]||0,T+=M[A],N[A]=P}var ee=h.next(32);for(ee.write_shift(4,318902576),ee.write_shift(4,w.length),ee.write_shift(2,296+32*b),ee.write_shift(2,T),A=0;A<4;++A)ee.write_shift(4,0);for(ee.write_shift(4,0|(+t[iP]||3)<<8),A=0,S=0;A<v.length;++A)if(v[A]!=null){var V=h.next(32),de=(v[A].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);V.write_shift(1,de,"sbcs"),V.write_shift(1,N[A]=="?"?"C":N[A],"sbcs"),V.write_shift(4,S),V.write_shift(1,M[A]||a[N[A]]||0),V.write_shift(1,R[A]||0),V.write_shift(1,2),V.write_shift(4,0),V.write_shift(1,0),V.write_shift(4,0),V.write_shift(4,0),S+=M[A]||a[N[A]]||0}var pe=h.next(264);for(pe.write_shift(4,13),A=0;A<65;++A)pe.write_shift(4,0);for(A=0;A<w.length;++A){var K=h.next(T);for(K.write_shift(1,0),S=0;S<v.length;++S)if(v[S]!=null)switch(N[S]){case"L":K.write_shift(1,w[A][S]==null?63:w[A][S]?84:70);break;case"B":K.write_shift(8,w[A][S]||0,"f");break;case"N":var Ce="0";for(typeof w[A][S]=="number"&&(Ce=w[A][S].toFixed(R[S]||0)),b=0;b<M[S]-Ce.length;++b)K.write_shift(1,32);K.write_shift(1,Ce,"sbcs");break;case"D":w[A][S]?(K.write_shift(4,("0000"+w[A][S].getFullYear()).slice(-4),"sbcs"),K.write_shift(2,("00"+(w[A][S].getMonth()+1)).slice(-2),"sbcs"),K.write_shift(2,("00"+w[A][S].getDate()).slice(-2),"sbcs")):K.write_shift(8,"00000000","sbcs");break;case"C":var ue=String(w[A][S]!=null?w[A][S]:"").slice(0,M[S]);for(K.write_shift(1,ue,"sbcs"),b=0;b<M[S]-ue.length;++b)K.write_shift(1,32);break}}return h.next(1).write_shift(1,26),h.end()}return{to_workbook:i,to_sheet:n,from_sheet:o}}(),wne=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Ka(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(v,w){var E=e[w];return typeof E=="number"?j_(E):E},n=function(v,w,E){var A=w.charCodeAt(0)-32<<4|E.charCodeAt(0)-48;return A==59?v:j_(A)};e["|"]=254;function i(v,w){switch(w.type){case"base64":return a(ki(v),w);case"binary":return a(v,w);case"buffer":return a(Ct&&Buffer.isBuffer(v)?v.toString("binary"):kl(v),w);case"array":return a(yl(v),w)}throw new Error("Unrecognized type "+w.type)}function a(v,w){var E=v.split(/[\n\r]+/),A=-1,S=-1,b=0,T=0,_=[],N=[],M=null,R={},P=[],z=[],B=[],re=0,ee;for(+w.codepage>=0&&xa(+w.codepage);b!==E.length;++b){re=0;var V=E[b].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),de=V.replace(/;;/g,"\0").split(";").map(function(ae){return ae.replace(/\u0000/g,";")}),pe=de[0],K;if(V.length>0)switch(pe){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":de[1].charAt(0)=="P"&&N.push(V.slice(3).replace(/;;/g,";"));break;case"C":var Ce=!1,ue=!1,se=!1,q=!1,fe=-1,we=-1;for(T=1;T<de.length;++T)switch(de[T].charAt(0)){case"A":break;case"X":S=parseInt(de[T].slice(1))-1,ue=!0;break;case"Y":for(A=parseInt(de[T].slice(1))-1,ue||(S=0),ee=_.length;ee<=A;++ee)_[ee]=[];break;case"K":K=de[T].slice(1),K.charAt(0)==='"'?K=K.slice(1,K.length-1):K==="TRUE"?K=!0:K==="FALSE"?K=!1:isNaN(Aa(K))?isNaN(Uc(K).getDate())||(K=ln(K)):(K=Aa(K),M!==null&&ru(M)&&(K=ag(K))),Ce=!0;break;case"E":q=!0;var G=Ec(de[T].slice(1),{r:A,c:S});_[A][S]=[_[A][S],G];break;case"S":se=!0,_[A][S]=[_[A][S],"S5S"];break;case"G":break;case"R":fe=parseInt(de[T].slice(1))-1;break;case"C":we=parseInt(de[T].slice(1))-1;break;default:if(w&&w.WTF)throw new Error("SYLK bad record "+V)}if(Ce&&(_[A][S]&&_[A][S].length==2?_[A][S][0]=K:_[A][S]=K,M=null),se){if(q)throw new Error("SYLK shared formula cannot have own formula");var le=fe>-1&&_[fe][we];if(!le||!le[1])throw new Error("SYLK shared formula cannot find base");_[A][S][1]=g5(le[1],{r:A-fe,c:S-we})}break;case"F":var ne=0;for(T=1;T<de.length;++T)switch(de[T].charAt(0)){case"X":S=parseInt(de[T].slice(1))-1,++ne;break;case"Y":for(A=parseInt(de[T].slice(1))-1,ee=_.length;ee<=A;++ee)_[ee]=[];break;case"M":re=parseInt(de[T].slice(1))/20;break;case"F":break;case"G":break;case"P":M=N[parseInt(de[T].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(B=de[T].slice(1).split(" "),ee=parseInt(B[0],10);ee<=parseInt(B[1],10);++ee)re=parseInt(B[2],10),z[ee-1]=re===0?{hidden:!0}:{wch:re},zc(z[ee-1]);break;case"C":S=parseInt(de[T].slice(1))-1,z[S]||(z[S]={});break;case"R":A=parseInt(de[T].slice(1))-1,P[A]||(P[A]={}),re>0?(P[A].hpt=re,P[A].hpx=Z0(re)):re===0&&(P[A].hidden=!0);break;default:if(w&&w.WTF)throw new Error("SYLK bad record "+V)}ne<1&&(M=null);break;default:if(w&&w.WTF)throw new Error("SYLK bad record "+V)}}return P.length>0&&(R["!rows"]=P),z.length>0&&(R["!cols"]=z),w&&w.sheetRows&&(_=_.slice(0,w.sheetRows)),[_,R]}function o(v,w){var E=i(v,w),A=E[0],S=E[1],b=iu(A,w);return Ka(S).forEach(function(T){b[T]=S[T]}),b}function c(v,w){return ko(o(v,w),w)}function f(v,w,E,A){var S="C;Y"+(E+1)+";X"+(A+1)+";K";switch(v.t){case"n":S+=v.v||0,v.f&&!v.F&&(S+=";E"+sae(v.f,{r:E,c:A}));break;case"b":S+=v.v?"TRUE":"FALSE";break;case"e":S+=v.w||v.v;break;case"d":S+='"'+(v.w||v.v)+'"';break;case"s":S+='"'+v.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return S}function d(v,w){w.forEach(function(E,A){var S="F;W"+(A+1)+" "+(A+1)+" ";E.hidden?S+="0":(typeof E.width=="number"&&!E.wpx&&(E.wpx=k1(E.width)),typeof E.wpx=="number"&&!E.wch&&(E.wch=I1(E.wpx)),typeof E.wch=="number"&&(S+=Math.round(E.wch))),S.charAt(S.length-1)!=" "&&v.push(S)})}function h(v,w){w.forEach(function(E,A){var S="F;";E.hidden?S+="M0;":E.hpt?S+="M"+20*E.hpt+";":E.hpx&&(S+="M"+20*d5(E.hpx)+";"),S.length>2&&v.push(S+"R"+(A+1))})}function m(v,w){var E=["ID;PWXL;N;E"],A=[],S=Tr(v["!ref"]),b,T=Array.isArray(v),_=`\r
`;E.push("P;PGeneral"),E.push("F;P0;DG0G8;M255"),v["!cols"]&&d(E,v["!cols"]),v["!rows"]&&h(E,v["!rows"]),E.push("B;Y"+(S.e.r-S.s.r+1)+";X"+(S.e.c-S.s.c+1)+";D"+[S.s.c,S.s.r,S.e.c,S.e.r].join(" "));for(var N=S.s.r;N<=S.e.r;++N)for(var M=S.s.c;M<=S.e.c;++M){var R=ct({r:N,c:M});b=T?(v[N]||[])[M]:v[R],!(!b||b.v==null&&(!b.f||b.F))&&A.push(f(b,v,N,M))}return E.join(_)+_+A.join(_)+_+"E"+_}return{to_workbook:c,to_sheet:o,from_sheet:m}}(),Ene=function(){function e(a,o){switch(o.type){case"base64":return t(ki(a),o);case"binary":return t(a,o);case"buffer":return t(Ct&&Buffer.isBuffer(a)?a.toString("binary"):kl(a),o);case"array":return t(yl(a),o)}throw new Error("Unrecognized type "+o.type)}function t(a,o){for(var c=a.split(`
`),f=-1,d=-1,h=0,m=[];h!==c.length;++h){if(c[h].trim()==="BOT"){m[++f]=[],d=0;continue}if(!(f<0)){var v=c[h].trim().split(","),w=v[0],E=v[1];++h;for(var A=c[h]||"";(A.match(/["]/g)||[]).length&1&&h<c.length-1;)A+=`
`+c[++h];switch(A=A.trim(),+w){case-1:if(A==="BOT"){m[++f]=[],d=0;continue}else if(A!=="EOD")throw new Error("Unrecognized DIF special command "+A);break;case 0:A==="TRUE"?m[f][d]=!0:A==="FALSE"?m[f][d]=!1:isNaN(Aa(E))?isNaN(Uc(E).getDate())?m[f][d]=E:m[f][d]=ln(E):m[f][d]=Aa(E),++d;break;case 1:A=A.slice(1,A.length-1),A=A.replace(/""/g,'"'),A&&A.match(/^=".*"$/)&&(A=A.slice(2,-1)),m[f][d++]=A!==""?A:null;break}if(A==="EOD")break}}return o&&o.sheetRows&&(m=m.slice(0,o.sheetRows)),m}function r(a,o){return iu(e(a,o),o)}function n(a,o){return ko(r(a,o),o)}var i=function(){var a=function(f,d,h,m,v){f.push(d),f.push(h+","+m),f.push('"'+v.replace(/"/g,'""')+'"')},o=function(f,d,h,m){f.push(d+","+h),f.push(d==1?'"'+m.replace(/"/g,'""')+'"':m)};return function(f){var d=[],h=Tr(f["!ref"]),m,v=Array.isArray(f);a(d,"TABLE",0,1,"sheetjs"),a(d,"VECTORS",0,h.e.r-h.s.r+1,""),a(d,"TUPLES",0,h.e.c-h.s.c+1,""),a(d,"DATA",0,0,"");for(var w=h.s.r;w<=h.e.r;++w){o(d,-1,0,"BOT");for(var E=h.s.c;E<=h.e.c;++E){var A=ct({r:w,c:E});if(m=v?(f[w]||[])[E]:f[A],!m){o(d,1,0,"");continue}switch(m.t){case"n":var S=m.w;!S&&m.v!=null&&(S=m.v),S==null?m.f&&!m.F?o(d,1,0,"="+m.f):o(d,1,0,""):o(d,0,S,"V");break;case"b":o(d,0,m.v?1:0,m.v?"TRUE":"FALSE");break;case"s":o(d,1,0,isNaN(m.v)?m.v:'="'+m.v+'"');break;case"d":m.w||(m.w=ta(m.z||ft[14],qn(ln(m.v)))),o(d,0,m.w,"V");break;default:o(d,1,0,"")}}}o(d,-1,0,"EOD");var b=`\r
`,T=d.join(b);return T}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),Ane=function(){function e(m){return m.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(m){return m.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(m,v){for(var w=m.split(`
`),E=-1,A=-1,S=0,b=[];S!==w.length;++S){var T=w[S].trim().split(":");if(T[0]==="cell"){var _=$n(T[1]);if(b.length<=_.r)for(E=b.length;E<=_.r;++E)b[E]||(b[E]=[]);switch(E=_.r,A=_.c,T[2]){case"t":b[E][A]=e(T[3]);break;case"v":b[E][A]=+T[3];break;case"vtf":var N=T[T.length-1];case"vtc":switch(T[3]){case"nl":b[E][A]=!!+T[4];break;default:b[E][A]=+T[4];break}T[2]=="vtf"&&(b[E][A]=[b[E][A],N])}}}return v&&v.sheetRows&&(b=b.slice(0,v.sheetRows)),b}function n(m,v){return iu(r(m,v),v)}function i(m,v){return ko(n(m,v),v)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,c=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),f="--SocialCalcSpreadsheetControlSave--";function d(m){if(!m||!m["!ref"])return"";for(var v=[],w=[],E,A="",S=nu(m["!ref"]),b=Array.isArray(m),T=S.s.r;T<=S.e.r;++T)for(var _=S.s.c;_<=S.e.c;++_)if(A=ct({r:T,c:_}),E=b?(m[T]||[])[_]:m[A],!(!E||E.v==null||E.t==="z")){switch(w=["cell",A,"t"],E.t){case"s":case"str":w.push(t(E.v));break;case"n":E.f?(w[2]="vtf",w[3]="n",w[4]=E.v,w[5]=t(E.f)):(w[2]="v",w[3]=E.v);break;case"b":w[2]="vt"+(E.f?"f":"c"),w[3]="nl",w[4]=E.v?"1":"0",w[5]=t(E.f||(E.v?"TRUE":"FALSE"));break;case"d":var N=qn(ln(E.v));w[2]="vtc",w[3]="nd",w[4]=""+N,w[5]=E.w||ta(E.z||ft[14],N);break;case"e":continue}v.push(w.join(":"))}return v.push("sheet:c:"+(S.e.c-S.s.c+1)+":r:"+(S.e.r-S.s.r+1)+":tvf:1"),v.push("valueformat:1:text-wiki"),v.join(`
`)}function h(m){return[a,o,c,o,d(m),f].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:h}}(),K0=function(){function e(h,m,v,w,E){E.raw?m[v][w]=h:h===""||(h==="TRUE"?m[v][w]=!0:h==="FALSE"?m[v][w]=!1:isNaN(Aa(h))?isNaN(Uc(h).getDate())?m[v][w]=h:m[v][w]=ln(h):m[v][w]=Aa(h))}function t(h,m){var v=m||{},w=[];if(!h||h.length===0)return w;for(var E=h.split(/[\r\n]/),A=E.length-1;A>=0&&E[A].length===0;)--A;for(var S=10,b=0,T=0;T<=A;++T)b=E[T].indexOf(" "),b==-1?b=E[T].length:b++,S=Math.max(S,b);for(T=0;T<=A;++T){w[T]=[];var _=0;for(e(E[T].slice(0,S).trim(),w,T,_,v),_=1;_<=(E[T].length-S)/10+1;++_)e(E[T].slice(S+(_-1)*10,S+_*10).trim(),w,T,_,v)}return v.sheetRows&&(w=w.slice(0,v.sheetRows)),w}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(h){for(var m={},v=!1,w=0,E=0;w<h.length;++w)(E=h.charCodeAt(w))==34?v=!v:!v&&E in r&&(m[E]=(m[E]||0)+1);E=[];for(w in m)Object.prototype.hasOwnProperty.call(m,w)&&E.push([m[w],w]);if(!E.length){m=n;for(w in m)Object.prototype.hasOwnProperty.call(m,w)&&E.push([m[w],w])}return E.sort(function(A,S){return A[0]-S[0]||n[A[1]]-n[S[1]]}),r[E.pop()[1]]||44}function a(h,m){var v=m||{},w="",E=v.dense?[]:{},A={s:{c:0,r:0},e:{c:0,r:0}};h.slice(0,4)=="sep="?h.charCodeAt(5)==13&&h.charCodeAt(6)==10?(w=h.charAt(4),h=h.slice(7)):h.charCodeAt(5)==13||h.charCodeAt(5)==10?(w=h.charAt(4),h=h.slice(6)):w=i(h.slice(0,1024)):v&&v.FS?w=v.FS:w=i(h.slice(0,1024));var S=0,b=0,T=0,_=0,N=0,M=w.charCodeAt(0),R=!1,P=0,z=h.charCodeAt(0);h=h.replace(/\r\n/mg,`
`);var B=v.dateNF!=null?Dee(v.dateNF):null;function re(){var ee=h.slice(_,N),V={};if(ee.charAt(0)=='"'&&ee.charAt(ee.length-1)=='"'&&(ee=ee.slice(1,-1).replace(/""/g,'"')),ee.length===0)V.t="z";else if(v.raw)V.t="s",V.v=ee;else if(ee.trim().length===0)V.t="s",V.v=ee;else if(ee.charCodeAt(0)==61)ee.charCodeAt(1)==34&&ee.charCodeAt(ee.length-1)==34?(V.t="s",V.v=ee.slice(2,-1).replace(/""/g,'"')):lae(ee)?(V.t="n",V.f=ee.slice(1)):(V.t="s",V.v=ee);else if(ee=="TRUE")V.t="b",V.v=!0;else if(ee=="FALSE")V.t="b",V.v=!1;else if(!isNaN(T=Aa(ee)))V.t="n",v.cellText!==!1&&(V.w=ee),V.v=T;else if(!isNaN(Uc(ee).getDate())||B&&ee.match(B)){V.z=v.dateNF||ft[14];var de=0;B&&ee.match(B)&&(ee=Ree(ee,v.dateNF,ee.match(B)||[]),de=1),v.cellDates?(V.t="d",V.v=ln(ee,de)):(V.t="n",V.v=qn(ln(ee,de))),v.cellText!==!1&&(V.w=ta(V.z,V.v instanceof Date?qn(V.v):V.v)),v.cellNF||delete V.z}else V.t="s",V.v=ee;if(V.t=="z"||(v.dense?(E[S]||(E[S]=[]),E[S][b]=V):E[ct({c:b,r:S})]=V),_=N+1,z=h.charCodeAt(_),A.e.c<b&&(A.e.c=b),A.e.r<S&&(A.e.r=S),P==M)++b;else if(b=0,++S,v.sheetRows&&v.sheetRows<=S)return!0}e:for(;N<h.length;++N)switch(P=h.charCodeAt(N)){case 34:z===34&&(R=!R);break;case M:case 10:case 13:if(!R&&re())break e;break}return N-_>0&&re(),E["!ref"]=Tt(A),E}function o(h,m){return!(m&&m.PRN)||m.FS||h.slice(0,4)=="sep="||h.indexOf("	")>=0||h.indexOf(",")>=0||h.indexOf(";")>=0?a(h,m):iu(t(h,m),m)}function c(h,m){var v="",w=m.type=="string"?[0,0,0,0]:cE(h,m);switch(m.type){case"base64":v=ki(h);break;case"binary":v=h;break;case"buffer":m.codepage==65001?v=h.toString("utf8"):m.codepage&&typeof H0<"u"||(v=Ct&&Buffer.isBuffer(h)?h.toString("binary"):kl(h));break;case"array":v=yl(h);break;case"string":v=h;break;default:throw new Error("Unrecognized type "+m.type)}return w[0]==239&&w[1]==187&&w[2]==191?v=qt(v.slice(3)):m.type!="string"&&m.type!="buffer"&&m.codepage==65001?v=qt(v):m.type=="binary"&&typeof H0<"u",v.slice(0,19)=="socialcalc:version:"?Ane.to_sheet(m.type=="string"?v:qt(v),m):o(v,m)}function f(h,m){return ko(c(h,m),m)}function d(h){for(var m=[],v=Tr(h["!ref"]),w,E=Array.isArray(h),A=v.s.r;A<=v.e.r;++A){for(var S=[],b=v.s.c;b<=v.e.c;++b){var T=ct({r:A,c:b});if(w=E?(h[A]||[])[b]:h[T],!w||w.v==null){S.push("          ");continue}for(var _=(w.w||(_s(w),w.w)||"").slice(0,10);_.length<10;)_+=" ";S.push(_+(b===0?" ":""))}m.push(S.join(""))}return m.join(`
`)}return{to_workbook:f,to_sheet:c,from_sheet:d}}();function Cne(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var i=wne.to_workbook(e,r);return r.WTF=n,i}catch(a){if(r.WTF=n,!a.message.match(/SYLK bad record ID/)&&n)throw a;return K0.to_workbook(e,t)}}var s0=function(){function e(G,le,ne){if(G){yn(G,G.l||0);for(var ae=ne.Enum||fe;G.l<G.length;){var he=G.read_shift(2),ke=ae[he]||ae[65535],De=G.read_shift(2),ce=G.l+De,be=ke.f&&ke.f(G,De,ne);if(G.l=ce,le(be,ke,he))return}}}function t(G,le){switch(le.type){case"base64":return r(ma(ki(G)),le);case"binary":return r(ma(G),le);case"buffer":case"array":return r(G,le)}throw"Unsupported type "+le.type}function r(G,le){if(!G)return G;var ne=le||{},ae=ne.dense?[]:{},he="Sheet1",ke="",De=0,ce={},be=[],ze=[],W={s:{r:0,c:0},e:{r:0,c:0}},He=ne.sheetRows||0;if(G[2]==0&&(G[3]==8||G[3]==9)&&G.length>=16&&G[14]==5&&G[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(G[2]==2)ne.Enum=fe,e(G,function(Ie,rt,at){switch(at){case 0:ne.vers=Ie,Ie>=4096&&(ne.qpro=!0);break;case 6:W=Ie;break;case 204:Ie&&(ke=Ie);break;case 222:ke=Ie;break;case 15:case 51:ne.qpro||(Ie[1].v=Ie[1].v.slice(1));case 13:case 14:case 16:at==14&&(Ie[2]&112)==112&&(Ie[2]&15)>1&&(Ie[2]&15)<15&&(Ie[1].z=ne.dateNF||ft[14],ne.cellDates&&(Ie[1].t="d",Ie[1].v=ag(Ie[1].v))),ne.qpro&&Ie[3]>De&&(ae["!ref"]=Tt(W),ce[he]=ae,be.push(he),ae=ne.dense?[]:{},W={s:{r:0,c:0},e:{r:0,c:0}},De=Ie[3],he=ke||"Sheet"+(De+1),ke="");var Br=ne.dense?(ae[Ie[0].r]||[])[Ie[0].c]:ae[ct(Ie[0])];if(Br){Br.t=Ie[1].t,Br.v=Ie[1].v,Ie[1].z!=null&&(Br.z=Ie[1].z),Ie[1].f!=null&&(Br.f=Ie[1].f);break}ne.dense?(ae[Ie[0].r]||(ae[Ie[0].r]=[]),ae[Ie[0].r][Ie[0].c]=Ie[1]):ae[ct(Ie[0])]=Ie[1];break}},ne);else if(G[2]==26||G[2]==14)ne.Enum=we,G[2]==14&&(ne.qpro=!0,G.l=0),e(G,function(Ie,rt,at){switch(at){case 204:he=Ie;break;case 22:Ie[1].v=Ie[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Ie[3]>De&&(ae["!ref"]=Tt(W),ce[he]=ae,be.push(he),ae=ne.dense?[]:{},W={s:{r:0,c:0},e:{r:0,c:0}},De=Ie[3],he="Sheet"+(De+1)),He>0&&Ie[0].r>=He)break;ne.dense?(ae[Ie[0].r]||(ae[Ie[0].r]=[]),ae[Ie[0].r][Ie[0].c]=Ie[1]):ae[ct(Ie[0])]=Ie[1],W.e.c<Ie[0].c&&(W.e.c=Ie[0].c),W.e.r<Ie[0].r&&(W.e.r=Ie[0].r);break;case 27:Ie[14e3]&&(ze[Ie[14e3][0]]=Ie[14e3][1]);break;case 1537:ze[Ie[0]]=Ie[1],Ie[0]==De&&(he=Ie[1]);break}},ne);else throw new Error("Unrecognized LOTUS BOF "+G[2]);if(ae["!ref"]=Tt(W),ce[ke||he]=ae,be.push(ke||he),!ze.length)return{SheetNames:be,Sheets:ce};for(var Ge={},et=[],Ze=0;Ze<ze.length;++Ze)ce[be[Ze]]?(et.push(ze[Ze]||be[Ze]),Ge[ze[Ze]]=ce[ze[Ze]]||ce[be[Ze]]):(et.push(ze[Ze]),Ge[ze[Ze]]={"!ref":"A1"});return{SheetNames:et,Sheets:Ge}}function n(G,le){var ne=le||{};if(+ne.codepage>=0&&xa(+ne.codepage),ne.type=="string")throw new Error("Cannot write WK1 to JS string");var ae=kv(),he=Tr(G["!ref"]),ke=Array.isArray(G),De=[];ca(ae,0,a(1030)),ca(ae,6,f(he));for(var ce=Math.min(he.e.r,8191),be=he.s.r;be<=ce;++be)for(var ze=Cn(be),W=he.s.c;W<=he.e.c;++W){be===he.s.r&&(De[W]=$r(W));var He=De[W]+ze,Ge=ke?(G[be]||[])[W]:G[He];if(!(!Ge||Ge.t=="z"))if(Ge.t=="n")(Ge.v|0)==Ge.v&&Ge.v>=-32768&&Ge.v<=32767?ca(ae,13,w(be,W,Ge.v)):ca(ae,14,A(be,W,Ge.v));else{var et=_s(Ge);ca(ae,15,m(be,W,et.slice(0,239)))}}return ca(ae,1),ae.end()}function i(G,le){var ne=le||{};if(+ne.codepage>=0&&xa(+ne.codepage),ne.type=="string")throw new Error("Cannot write WK3 to JS string");var ae=kv();ca(ae,0,o(G));for(var he=0,ke=0;he<G.SheetNames.length;++he)(G.Sheets[G.SheetNames[he]]||{})["!ref"]&&ca(ae,27,q(G.SheetNames[he],ke++));var De=0;for(he=0;he<G.SheetNames.length;++he){var ce=G.Sheets[G.SheetNames[he]];if(!(!ce||!ce["!ref"])){for(var be=Tr(ce["!ref"]),ze=Array.isArray(ce),W=[],He=Math.min(be.e.r,8191),Ge=be.s.r;Ge<=He;++Ge)for(var et=Cn(Ge),Ze=be.s.c;Ze<=be.e.c;++Ze){Ge===be.s.r&&(W[Ze]=$r(Ze));var Ie=W[Ze]+et,rt=ze?(ce[Ge]||[])[Ze]:ce[Ie];if(!(!rt||rt.t=="z"))if(rt.t=="n")ca(ae,23,re(Ge,Ze,De,rt.v));else{var at=_s(rt);ca(ae,22,P(Ge,Ze,De,at.slice(0,239)))}}++De}}return ca(ae,1),ae.end()}function a(G){var le=zr(2);return le.write_shift(2,G),le}function o(G){var le=zr(26);le.write_shift(2,4096),le.write_shift(2,4),le.write_shift(4,0);for(var ne=0,ae=0,he=0,ke=0;ke<G.SheetNames.length;++ke){var De=G.SheetNames[ke],ce=G.Sheets[De];if(!(!ce||!ce["!ref"])){++he;var be=nu(ce["!ref"]);ne<be.e.r&&(ne=be.e.r),ae<be.e.c&&(ae=be.e.c)}}return ne>8191&&(ne=8191),le.write_shift(2,ne),le.write_shift(1,he),le.write_shift(1,ae),le.write_shift(2,0),le.write_shift(2,0),le.write_shift(1,1),le.write_shift(1,2),le.write_shift(4,0),le.write_shift(4,0),le}function c(G,le,ne){var ae={s:{c:0,r:0},e:{c:0,r:0}};return le==8&&ne.qpro?(ae.s.c=G.read_shift(1),G.l++,ae.s.r=G.read_shift(2),ae.e.c=G.read_shift(1),G.l++,ae.e.r=G.read_shift(2),ae):(ae.s.c=G.read_shift(2),ae.s.r=G.read_shift(2),le==12&&ne.qpro&&(G.l+=2),ae.e.c=G.read_shift(2),ae.e.r=G.read_shift(2),le==12&&ne.qpro&&(G.l+=2),ae.s.c==65535&&(ae.s.c=ae.e.c=ae.s.r=ae.e.r=0),ae)}function f(G){var le=zr(8);return le.write_shift(2,G.s.c),le.write_shift(2,G.s.r),le.write_shift(2,G.e.c),le.write_shift(2,G.e.r),le}function d(G,le,ne){var ae=[{c:0,r:0},{t:"n",v:0},0,0];return ne.qpro&&ne.vers!=20768?(ae[0].c=G.read_shift(1),ae[3]=G.read_shift(1),ae[0].r=G.read_shift(2),G.l+=2):(ae[2]=G.read_shift(1),ae[0].c=G.read_shift(2),ae[0].r=G.read_shift(2)),ae}function h(G,le,ne){var ae=G.l+le,he=d(G,le,ne);if(he[1].t="s",ne.vers==20768){G.l++;var ke=G.read_shift(1);return he[1].v=G.read_shift(ke,"utf8"),he}return ne.qpro&&G.l++,he[1].v=G.read_shift(ae-G.l,"cstr"),he}function m(G,le,ne){var ae=zr(7+ne.length);ae.write_shift(1,255),ae.write_shift(2,le),ae.write_shift(2,G),ae.write_shift(1,39);for(var he=0;he<ae.length;++he){var ke=ne.charCodeAt(he);ae.write_shift(1,ke>=128?95:ke)}return ae.write_shift(1,0),ae}function v(G,le,ne){var ae=d(G,le,ne);return ae[1].v=G.read_shift(2,"i"),ae}function w(G,le,ne){var ae=zr(7);return ae.write_shift(1,255),ae.write_shift(2,le),ae.write_shift(2,G),ae.write_shift(2,ne,"i"),ae}function E(G,le,ne){var ae=d(G,le,ne);return ae[1].v=G.read_shift(8,"f"),ae}function A(G,le,ne){var ae=zr(13);return ae.write_shift(1,255),ae.write_shift(2,le),ae.write_shift(2,G),ae.write_shift(8,ne,"f"),ae}function S(G,le,ne){var ae=G.l+le,he=d(G,le,ne);if(he[1].v=G.read_shift(8,"f"),ne.qpro)G.l=ae;else{var ke=G.read_shift(2);N(G.slice(G.l,G.l+ke),he),G.l+=ke}return he}function b(G,le,ne){var ae=le&32768;return le&=-32769,le=(ae?G:0)+(le>=8192?le-16384:le),(ae?"":"$")+(ne?$r(le):Cn(le))}var T={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},_=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function N(G,le){yn(G,0);for(var ne=[],ae=0,he="",ke="",De="",ce="";G.l<G.length;){var be=G[G.l++];switch(be){case 0:ne.push(G.read_shift(8,"f"));break;case 1:ke=b(le[0].c,G.read_shift(2),!0),he=b(le[0].r,G.read_shift(2),!1),ne.push(ke+he);break;case 2:{var ze=b(le[0].c,G.read_shift(2),!0),W=b(le[0].r,G.read_shift(2),!1);ke=b(le[0].c,G.read_shift(2),!0),he=b(le[0].r,G.read_shift(2),!1),ne.push(ze+W+":"+ke+he)}break;case 3:if(G.l<G.length){console.error("WK1 premature formula end");return}break;case 4:ne.push("("+ne.pop()+")");break;case 5:ne.push(G.read_shift(2));break;case 6:{for(var He="";be=G[G.l++];)He+=String.fromCharCode(be);ne.push('"'+He.replace(/"/g,'""')+'"')}break;case 8:ne.push("-"+ne.pop());break;case 23:ne.push("+"+ne.pop());break;case 22:ne.push("NOT("+ne.pop()+")");break;case 20:case 21:ce=ne.pop(),De=ne.pop(),ne.push(["AND","OR"][be-20]+"("+De+","+ce+")");break;default:if(be<32&&_[be])ce=ne.pop(),De=ne.pop(),ne.push(De+_[be]+ce);else if(T[be]){if(ae=T[be][1],ae==69&&(ae=G[G.l++]),ae>ne.length){console.error("WK1 bad formula parse 0x"+be.toString(16)+":|"+ne.join("|")+"|");return}var Ge=ne.slice(-ae);ne.length-=ae,ne.push(T[be][0]+"("+Ge.join(",")+")")}else return be<=7?console.error("WK1 invalid opcode "+be.toString(16)):be<=24?console.error("WK1 unsupported op "+be.toString(16)):be<=30?console.error("WK1 invalid opcode "+be.toString(16)):be<=115?console.error("WK1 unsupported function opcode "+be.toString(16)):console.error("WK1 unrecognized opcode "+be.toString(16))}}ne.length==1?le[1].f=""+ne[0]:console.error("WK1 bad formula parse |"+ne.join("|")+"|")}function M(G){var le=[{c:0,r:0},{t:"n",v:0},0];return le[0].r=G.read_shift(2),le[3]=G[G.l++],le[0].c=G[G.l++],le}function R(G,le){var ne=M(G);return ne[1].t="s",ne[1].v=G.read_shift(le-4,"cstr"),ne}function P(G,le,ne,ae){var he=zr(6+ae.length);he.write_shift(2,G),he.write_shift(1,ne),he.write_shift(1,le),he.write_shift(1,39);for(var ke=0;ke<ae.length;++ke){var De=ae.charCodeAt(ke);he.write_shift(1,De>=128?95:De)}return he.write_shift(1,0),he}function z(G,le){var ne=M(G);ne[1].v=G.read_shift(2);var ae=ne[1].v>>1;if(ne[1].v&1)switch(ae&7){case 0:ae=(ae>>3)*5e3;break;case 1:ae=(ae>>3)*500;break;case 2:ae=(ae>>3)/20;break;case 3:ae=(ae>>3)/200;break;case 4:ae=(ae>>3)/2e3;break;case 5:ae=(ae>>3)/2e4;break;case 6:ae=(ae>>3)/16;break;case 7:ae=(ae>>3)/64;break}return ne[1].v=ae,ne}function B(G,le){var ne=M(G),ae=G.read_shift(4),he=G.read_shift(4),ke=G.read_shift(2);if(ke==65535)return ae===0&&he===3221225472?(ne[1].t="e",ne[1].v=15):ae===0&&he===3489660928?(ne[1].t="e",ne[1].v=42):ne[1].v=0,ne;var De=ke&32768;return ke=(ke&32767)-16446,ne[1].v=(1-De*2)*(he*Math.pow(2,ke+32)+ae*Math.pow(2,ke)),ne}function re(G,le,ne,ae){var he=zr(14);if(he.write_shift(2,G),he.write_shift(1,ne),he.write_shift(1,le),ae==0)return he.write_shift(4,0),he.write_shift(4,0),he.write_shift(2,65535),he;var ke=0,De=0,ce=0,be=0;return ae<0&&(ke=1,ae=-ae),De=Math.log2(ae)|0,ae/=Math.pow(2,De-31),be=ae>>>0,be&2147483648||(ae/=2,++De,be=ae>>>0),ae-=be,be|=2147483648,be>>>=0,ae*=Math.pow(2,32),ce=ae>>>0,he.write_shift(4,ce),he.write_shift(4,be),De+=16383+(ke?32768:0),he.write_shift(2,De),he}function ee(G,le){var ne=B(G);return G.l+=le-14,ne}function V(G,le){var ne=M(G),ae=G.read_shift(4);return ne[1].v=ae>>6,ne}function de(G,le){var ne=M(G),ae=G.read_shift(8,"f");return ne[1].v=ae,ne}function pe(G,le){var ne=de(G);return G.l+=le-10,ne}function K(G,le){return G[G.l+le-1]==0?G.read_shift(le,"cstr"):""}function Ce(G,le){var ne=G[G.l++];ne>le-1&&(ne=le-1);for(var ae="";ae.length<ne;)ae+=String.fromCharCode(G[G.l++]);return ae}function ue(G,le,ne){if(!(!ne.qpro||le<21)){var ae=G.read_shift(1);G.l+=17,G.l+=1,G.l+=2;var he=G.read_shift(le-21,"cstr");return[ae,he]}}function se(G,le){for(var ne={},ae=G.l+le;G.l<ae;){var he=G.read_shift(2);if(he==14e3){for(ne[he]=[0,""],ne[he][0]=G.read_shift(2);G[G.l];)ne[he][1]+=String.fromCharCode(G[G.l]),G.l++;G.l++}}return ne}function q(G,le){var ne=zr(5+G.length);ne.write_shift(2,14e3),ne.write_shift(2,le);for(var ae=0;ae<G.length;++ae){var he=G.charCodeAt(ae);ne[ne.l++]=he>127?95:he}return ne[ne.l++]=0,ne}var fe={0:{n:"BOF",f:Rr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:v},14:{n:"NUMBER",f:E},15:{n:"LABEL",f:h},16:{n:"FORMULA",f:S},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:h},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:K},222:{n:"SHEETNAMELP",f:Ce},65535:{n:""}},we={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:R},23:{n:"NUMBER17",f:B},24:{n:"NUMBER18",f:z},25:{n:"FORMULA19",f:ee},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:se},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:V},38:{n:"??"},39:{n:"NUMBER27",f:de},40:{n:"FORMULA28",f:pe},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:K},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ue},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:t}}();function Sne(e){var t={},r=e.match(Un),n=0,i=!1;if(r)for(;n!=r.length;++n){var a=ot(r[n]);switch(a[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(a.val=="1")break;t.cp=jw[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=a.val;break;case"<sz":t.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(a.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(a.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":a.rgb&&(t.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+a[0])}}return t}var _ne=function(){var e=$0("t"),t=$0("rPr");function r(a){var o=a.match(e);if(!o)return{t:"s",v:""};var c={t:"s",v:Nt(o[1])},f=a.match(t);return f&&(c.s=Sne(f[1])),c}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(i).map(r).filter(function(c){return c.v})}}(),bne=function(){var t=/(\r\n|\n)/g;function r(i,a,o){var c=[];i.u&&c.push("text-decoration: underline;"),i.uval&&c.push("text-underline-style:"+i.uval+";"),i.sz&&c.push("font-size:"+i.sz+"pt;"),i.outline&&c.push("text-effect: outline;"),i.shadow&&c.push("text-shadow: auto;"),a.push('<span style="'+c.join("")+'">'),i.b&&(a.push("<b>"),o.push("</b>")),i.i&&(a.push("<i>"),o.push("</i>")),i.strike&&(a.push("<s>"),o.push("</s>"));var f=i.valign||"";return f=="superscript"||f=="super"?f="sup":f=="subscript"&&(f="sub"),f!=""&&(a.push("<"+f+">"),o.push("</"+f+">")),o.push("</span>"),i}function n(i){var a=[[],i.v,[]];return i.v?(i.s&&r(i.s,a[0],a[2]),a[0].join("")+a[1].replace(t,"<br/>")+a[2].join("")):""}return function(a){return a.map(n).join("")}}(),Tne=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,One=/<(?:\w+:)?r>/,kne=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function rE(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Nt(qt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=qt(e),r&&(n.h=$w(n.t))):e.match(One)&&(n.r=qt(e),n.t=Nt(qt((e.replace(kne,"").match(Tne)||[]).join("").replace(Un,""))),r&&(n.h=bne(_ne(n.r)))),n):{t:""}}var Ine=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,Nne=/<(?:\w+:)?(?:si|sstItem)>/g,Pne=/<\/(?:\w+:)?(?:si|sstItem)>/;function Dne(e,t){var r=[],n="";if(!e)return r;var i=e.match(Ine);if(i){n=i[2].replace(Nne,"").split(Pne);for(var a=0;a!=n.length;++a){var o=rE(n[a].trim(),t);o!=null&&(r[r.length]=o)}i=ot(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}function Rne(e){return[e.read_shift(4),e.read_shift(4)]}function Mne(e,t){var r=[],n=!1;return Ms(e,function(a,o,c){switch(c){case 159:r.Count=a[0],r.Unique=a[1];break;case 19:r.push(a);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}),r}function s5(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function hs(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function Fne(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=hs(e,4),t.U=hs(e,4),t.W=hs(e,4),t}function Lne(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},i=e.read_shift(4),a=[];i-- >0;)a.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=a,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function Bne(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(Lne(e));return t}function jne(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function Une(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=hs(e,4),t.U=hs(e,4),t.W=hs(e,4),t}function zne(e){var t=Une(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function o5(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function l5(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function Wne(e){var t=hs(e);switch(t.Minor){case 2:return[t.Minor,Vne(e)];case 3:return[t.Minor,Hne()];case 4:return[t.Minor,Gne(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function Vne(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=o5(e,r),i=l5(e,e.length-e.l);return{t:"Std",h:n,v:i}}function Hne(){throw new Error("File is password-protected: ECMA-376 Extensible")}function Gne(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Un,function(a){var o=ot(a);switch(Ya(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(c){n[c]=o[c]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function $ne(e,t){var r={},n=r.EncryptionVersionInfo=hs(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var i=e.read_shift(4);return t-=4,r.EncryptionHeader=o5(e,i),t-=i,r.EncryptionVerifier=l5(e,t),r}function Xne(e){var t={},r=t.EncryptionVersionInfo=hs(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function Kne(e){var t=0,r,n=s5(e),i=n.length+1,a,o,c,f,d;for(r=wo(i),r[0]=n.length,a=1;a!=i;++a)r[a]=n[a-1];for(a=i-1;a>=0;--a)o=r[a],c=t&16384?1:0,f=t<<1&32767,d=c|f,t=d^o;return t^52811}var c5=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},i=function(o,c){return n(o^c)},a=function(o){for(var c=t[o.length-1],f=104,d=o.length-1;d>=0;--d)for(var h=o[d],m=0;m!=7;++m)h&64&&(c^=r[f]),h*=2,--f;return c};return function(o){for(var c=s5(o),f=a(c),d=c.length,h=wo(16),m=0;m!=16;++m)h[m]=0;var v,w,E;for((d&1)===1&&(v=f>>8,h[d]=i(e[0],v),--d,v=f&255,w=c[c.length-1],h[d]=i(w,v));d>0;)--d,v=f>>8,h[d]=i(c[d],v),--d,v=f&255,h[d]=i(c[d],v);for(d=15,E=15-c.length;E>0;)v=f>>8,h[d]=i(e[E],v),--d,--E,v=f&255,h[d]=i(c[d],v),--d,--E;return h}}(),Yne=function(e,t,r,n,i){i||(i=t),n||(n=c5(e));var a,o;for(a=0;a!=t.length;++a)o=t[a],o^=n[r],o=(o>>5|o<<3)&255,i[a]=o,++r;return[i,r,n]},Zne=function(e){var t=0,r=c5(e);return function(n){var i=Yne("",n,t,r);return t=i[1],i[0]}};function qne(e,t,r,n){var i={key:Rr(e),verificationBytes:Rr(e)};return r.password&&(i.verifier=Kne(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=Zne(r.password)),i}function Qne(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=Xne(e):n.Data=$ne(e,t),n}function Jne(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?Qne(e,t-2,n):qne(e,r.biff>=8?t:t-2,r,n),n}var eie=function(){function e(i,a){switch(a.type){case"base64":return t(ki(i),a);case"binary":return t(i,a);case"buffer":return t(Ct&&Buffer.isBuffer(i)?i.toString("binary"):kl(i),a);case"array":return t(yl(i),a)}throw new Error("Unrecognized type "+a.type)}function t(i,a){var o=a||{},c=o.dense?[]:{},f=i.match(/\\trowd.*?\\row\b/g);if(!f.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:f.length-1}};return f.forEach(function(h,m){Array.isArray(c)&&(c[m]=[]);for(var v=/\\\w+\b/g,w=0,E,A=-1;E=v.exec(h);){switch(E[0]){case"\\cell":var S=h.slice(w,v.lastIndex-E[0].length);if(S[0]==" "&&(S=S.slice(1)),++A,S.length){var b={v:S,t:"s"};Array.isArray(c)?c[m][A]=b:c[ct({r:m,c:A})]=b}break}w=v.lastIndex}A>d.e.c&&(d.e.c=A)}),c["!ref"]=Tt(d),c}function r(i,a){return ko(e(i,a),a)}function n(i){for(var a=["{\\rtf1\\ansi"],o=Tr(i["!ref"]),c,f=Array.isArray(i),d=o.s.r;d<=o.e.r;++d){a.push("\\trowd\\trautofit1");for(var h=o.s.c;h<=o.e.c;++h)a.push("\\cellx"+(h+1));for(a.push("\\pard\\intbl"),h=o.s.c;h<=o.e.c;++h){var m=ct({r:d,c:h});c=f?(i[d]||[])[h]:i[m],!(!c||c.v==null&&(!c.f||c.F))&&(a.push(" "+(c.w||(_s(c),c.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function tie(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Y0(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function rie(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,i=Math.max(t,r,n),a=Math.min(t,r,n),o=i-a;if(o===0)return[0,0,t];var c=0,f=0,d=i+a;switch(f=o/(d>1?2-d:d),i){case t:c=((r-n)/o+6)%6;break;case r:c=(n-t)/o+2;break;case n:c=(t-r)/o+4;break}return[c/6,f,d/2]}function nie(e){var t=e[0],r=e[1],n=e[2],i=r*2*(n<.5?n:1-n),a=n-i/2,o=[a,a,a],c=6*t,f;if(r!==0)switch(c|0){case 0:case 6:f=i*c,o[0]+=i,o[1]+=f;break;case 1:f=i*(2-c),o[0]+=f,o[1]+=i;break;case 2:f=i*(c-2),o[1]+=i,o[2]+=f;break;case 3:f=i*(4-c),o[1]+=f,o[2]+=i;break;case 4:f=i*(c-4),o[2]+=i,o[0]+=f;break;case 5:f=i*(6-c),o[2]+=f,o[0]+=i;break}for(var d=0;d!=3;++d)o[d]=Math.round(o[d]*255);return o}function O1(e,t){if(t===0)return e;var r=rie(tie(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Y0(nie(r))}var u5=6,iie=15,aie=1,Hn=u5;function k1(e){return Math.floor((e+Math.round(128/Hn)/256)*Hn)}function I1(e){return Math.floor((e-5)/Hn*100+.5)/100}function Dv(e){return Math.round((e*Hn+5)/Hn*256)/256}function Sm(e){return Dv(I1(k1(e)))}function nE(e){var t=Math.abs(e-Sm(e)),r=Hn;if(t>.005)for(Hn=aie;Hn<iie;++Hn)Math.abs(e-Sm(e))<=t&&(t=Math.abs(e-Sm(e)),r=Hn);Hn=r}function zc(e){e.width?(e.wpx=k1(e.width),e.wch=I1(e.wpx),e.MDW=Hn):e.wpx?(e.wch=I1(e.wpx),e.width=Dv(e.wch),e.MDW=Hn):typeof e.wch=="number"&&(e.width=Dv(e.wch),e.wpx=k1(e.width),e.MDW=Hn),e.customWidth&&delete e.customWidth}var sie=96,f5=sie;function d5(e){return e*96/f5}function Z0(e){return e*f5/96}var oie={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function lie(e,t,r,n){t.Borders=[];var i={},a=!1;(e[0].match(Un)||[]).forEach(function(o){var c=ot(o);switch(Ya(c[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},c.diagonalUp&&(i.diagonalUp=cr(c.diagonalUp)),c.diagonalDown&&(i.diagonalDown=cr(c.diagonalDown)),t.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+c[0]+" in borders")}})}function cie(e,t,r,n){t.Fills=[];var i={},a=!1;(e[0].match(Un)||[]).forEach(function(o){var c=ot(o);switch(Ya(c[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},t.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":c.patternType&&(i.patternType=c.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),c.indexed&&(i.bgColor.indexed=parseInt(c.indexed,10)),c.theme&&(i.bgColor.theme=parseInt(c.theme,10)),c.tint&&(i.bgColor.tint=parseFloat(c.tint)),c.rgb&&(i.bgColor.rgb=c.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),c.theme&&(i.fgColor.theme=parseInt(c.theme,10)),c.tint&&(i.fgColor.tint=parseFloat(c.tint)),c.rgb!=null&&(i.fgColor.rgb=c.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+c[0]+" in fills")}})}function uie(e,t,r,n){t.Fonts=[];var i={},a=!1;(e[0].match(Un)||[]).forEach(function(o){var c=ot(o);switch(Ya(c[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(i),i={};break;case"<name":c.val&&(i.name=qt(c.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=c.val?cr(c.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=c.val?cr(c.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(c.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=c.val?cr(c.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=c.val?cr(c.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=c.val?cr(c.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=c.val?cr(c.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=c.val?cr(c.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":c.val&&(i.sz=+c.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":c.val&&(i.vertAlign=c.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":c.val&&(i.family=parseInt(c.val,10));break;case"<family/>":case"</family>":break;case"<scheme":c.val&&(i.scheme=c.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(c.val=="1")break;c.codepage=jw[parseInt(c.val,10)];break;case"<color":if(i.color||(i.color={}),c.auto&&(i.color.auto=cr(c.auto)),c.rgb)i.color.rgb=c.rgb.slice(-6);else if(c.indexed){i.color.index=parseInt(c.indexed,10);var f=rl[i.color.index];i.color.index==81&&(f=rl[1]),f||(f=rl[1]),i.color.rgb=f[0].toString(16)+f[1].toString(16)+f[2].toString(16)}else c.theme&&(i.color.theme=parseInt(c.theme,10),c.tint&&(i.color.tint=parseFloat(c.tint)),c.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=O1(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+c[0]+" in fonts")}})}function fie(e,t,r){t.NumberFmt=[];for(var n=Ka(ft),i=0;i<n.length;++i)t.NumberFmt[n[i]]=ft[n[i]];var a=e[0].match(Un);if(a)for(i=0;i<a.length;++i){var o=ot(a[i]);switch(Ya(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var c=Nt(qt(o.formatCode)),f=parseInt(o.numFmtId,10);if(t.NumberFmt[f]=c,f>0){if(f>392){for(f=392;f>60&&t.NumberFmt[f]!=null;--f);t.NumberFmt[f]=c}tl(c,f)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}var Od=["numFmtId","fillId","fontId","borderId","xfId"],kd=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function die(e,t,r){t.CellXf=[];var n,i=!1;(e[0].match(Un)||[]).forEach(function(a){var o=ot(a),c=0;switch(Ya(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],c=0;c<Od.length;++c)n[Od[c]]&&(n[Od[c]]=parseInt(n[Od[c]],10));for(c=0;c<kd.length;++c)n[kd[c]]&&(n[kd[c]]=cr(n[kd[c]]));if(t.NumberFmt&&n.numFmtId>392){for(c=392;c>60;--c)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[c]){n.numFmtId=c;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var f={};o.vertical&&(f.vertical=o.vertical),o.horizontal&&(f.horizontal=o.horizontal),o.textRotation!=null&&(f.textRotation=o.textRotation),o.indent&&(f.indent=o.indent),o.wrapText&&(f.wrapText=cr(o.wrapText)),n.alignment=f;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}var hie=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(c,f,d){var h={};if(!c)return h;c=c.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var m;return(m=c.match(t))&&fie(m,h,d),(m=c.match(i))&&uie(m,h,f,d),(m=c.match(n))&&cie(m,h,f,d),(m=c.match(a))&&lie(m,h,f,d),(m=c.match(r))&&die(m,h,d),h}}();function pie(e,t){var r=e.read_shift(2),n=Ln(e);return[r,n]}function gie(e,t,r){var n={};n.sz=e.read_shift(2)/20;var i=_te(e);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var a=e.read_shift(2);switch(a===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(n.underline=o);var c=e.read_shift(1);c>0&&(n.family=c);var f=e.read_shift(1);switch(f>0&&(n.charset=f),e.l++,n.color=Ste(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Ln(e),n}var mie=jn;function xie(e,t){var r=e.l+t,n=e.read_shift(2),i=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:i}}var vie=jn;function yie(e,t,r){var n={};n.NumberFmt=[];for(var i in ft)n.NumberFmt[i]=ft[i];n.CellXf=[],n.Fonts=[];var a=[],o=!1;return Ms(e,function(f,d,h){switch(h){case 44:n.NumberFmt[f[0]]=f[1],tl(f[1],f[0]);break;case 43:n.Fonts.push(f),f.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(f.color.rgb=O1(t.themeElements.clrScheme[f.color.theme].rgb,f.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:a[a.length-1]==617&&n.CellXf.push(f);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:a.push(h),o=!0;break;case 38:a.pop(),o=!1;break;default:if(d.T>0)a.push(h);else if(d.T<0)a.pop();else if(!o||r.WTF&&a[a.length-1]!=37)throw new Error("Unexpected record 0x"+h.toString(16))}}),n}var wie=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function Eie(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Un)||[]).forEach(function(i){var a=ot(i);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=a.val;break;case"<a:sysClr":n.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":a[0].charAt(1)==="/"?(t.themeElements.clrScheme[wie.indexOf(a[0])]=n,n={}):n.name=a[0].slice(3,a[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function Aie(){}function Cie(){}var Sie=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,_ie=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,bie=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function Tie(e,t,r){t.themeElements={};var n;[["clrScheme",Sie,Eie],["fontScheme",_ie,Aie],["fmtScheme",bie,Cie]].forEach(function(i){if(!(n=e.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,t,r)})}var Oie=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function h5(e,t){(!e||e.length===0)&&(e=kie());var r,n={};if(!(r=e.match(Oie)))throw new Error("themeElements not found in theme");return Tie(r[0],n,t),n.raw=e,n}function kie(e,t){var r=[SP];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function Iie(e,t,r){var n=e.l+t,i=e.read_shift(4);if(i!==124226){if(!r.cellStyles){e.l=n;return}var a=e.slice(e.l);e.l=n;var o;try{o=CP(a,{type:"array"})}catch{return}var c=Ai(o,"theme/theme/theme1.xml",!0);if(c)return h5(c,r)}}function Nie(e){return e.read_shift(4)}function Pie(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=Die(e,4);break;case 2:t.xclrValue=JP(e);break;case 3:t.xclrValue=Nie(e);break;case 4:e.l+=4;break}return e.l+=8,t}function Die(e,t){return jn(e,t)}function Rie(e,t){return jn(e,t)}function Mie(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=Pie(e);break;case 6:n[1]=Rie(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function Fie(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var i=e.read_shift(2),a=[];i-- >0;)a.push(Mie(e,r-e.l));return{ixfe:n,ext:a}}function Lie(e,t){t.forEach(function(r){switch(r[0]){}})}function Bie(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Ln(e)}}function jie(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function Uie(e){return e.l+=4,e.read_shift(4)!=0}function zie(e,t,r){var n={Types:[],Cell:[],Value:[]},i=r||{},a=[],o=!1,c=2;return Ms(e,function(f,d,h){switch(h){case 335:n.Types.push({name:f.name});break;case 51:f.forEach(function(m){c==1?n.Cell.push({type:n.Types[m[0]-1].name,index:m[1]}):c==0&&n.Value.push({type:n.Types[m[0]-1].name,index:m[1]})});break;case 337:c=f?1:0;break;case 338:c=2;break;case 35:a.push(h),o=!0;break;case 36:a.pop(),o=!1;break;default:if(!d.T){if(!o||i.WTF&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+h.toString(16))}}}),n}function Wie(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var i=!1,a=2,o;return e.replace(Un,function(c){var f=ot(c);switch(Ya(f[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:f.name});break;case"</metadataType>":break;case"<futureMetadata":for(var d=0;d<n.Types.length;++d)n.Types[d].name==f.name&&(o=n.Types[d]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":a==1?n.Cell.push({type:n.Types[f.t-1].name,index:+f.v}):a==0&&n.Value.push({type:n.Types[f.t-1].name,index:+f.v});break;case"</rc>":break;case"<cellMetadata":a=1;break;case"</cellMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"</valueMetadata>":a=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+f.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+f[0]+" in metadata")}return c}),n}function Vie(e){var t=[];if(!e)return t;var r=1;return(e.match(Un)||[]).forEach(function(n){var i=ot(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,t.push(i);break}}),t}function Hie(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=ct(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function Gie(e,t,r){var n=[];return Ms(e,function(a,o,c){switch(c){case 63:n.push(a);break;default:if(!o.T)throw new Error("Unexpected record 0x"+c.toString(16))}}),n}function $ie(e,t,r,n){if(!e)return e;var i=n||{},a=!1;Ms(e,function(c,f,d){switch(d){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!f.T){if(!a||i.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}},i)}function Xie(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}function S4(e,t,r,n){var i=Array.isArray(e),a;t.forEach(function(o){var c=$n(o.ref);if(i?(e[c.r]||(e[c.r]=[]),a=e[c.r][c.c]):a=e[o.ref],!a){a={t:"z"},i?e[c.r][c.c]=a:e[o.ref]=a;var f=Tr(e["!ref"]||"BDWGO1000001:A1");f.s.r>c.r&&(f.s.r=c.r),f.e.r<c.r&&(f.e.r=c.r),f.s.c>c.c&&(f.s.c=c.c),f.e.c<c.c&&(f.e.c=c.c);var d=Tt(f);d!==e["!ref"]&&(e["!ref"]=d)}a.c||(a.c=[]);var h={a:o.author,t:o.t,r:o.r,T:r};o.h&&(h.h=o.h);for(var m=a.c.length-1;m>=0;--m){if(!r&&a.c[m].T)return;r&&!a.c[m].T&&a.c.splice(m,1)}if(r&&n){for(m=0;m<n.length;++m)if(h.a==n[m].id){h.a=n[m].name||h.a;break}}a.c.push(h)})}function Kie(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var c=o.match(/<(?:\w+:)?author[^>]*>(.*)/);c&&r.push(c[1])}});var a=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var c=o.match(/<(?:\w+:)?comment[^>]*>/);if(c){var f=ot(c[0]),d={author:f.authorId&&r[f.authorId]||"sheetjsghost",ref:f.ref,guid:f.guid},h=$n(f.ref);if(!(t.sheetRows&&t.sheetRows<=h.r)){var m=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),v=!!m&&!!m[1]&&rE(m[1])||{r:"",t:"",h:""};d.r=v.r,v.r=="<t></t>"&&(v.t=v.h=""),d.t=(v.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(d.h=v.h),n.push(d)}}}}),n}function Yie(e,t){var r=[],n=!1,i={},a=0;return e.replace(Un,function(c,f){var d=ot(c);switch(Ya(d[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:d.personId,guid:d.id,ref:d.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":a=f+c.length;break;case"</text>":i.t=e.slice(a,f).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return c}),r}function Zie(e,t){var r=[],n=!1;return e.replace(Un,function(a){var o=ot(a);switch(Ya(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return a}),r}function qie(e){var t={};t.iauthor=e.read_shift(4);var r=Nl(e);return t.rfx=r.s,t.ref=ct(r.s),e.l+=16,t}var Qie=Ln;function Jie(e,t){var r=[],n=[],i={},a=!1;return Ms(e,function(c,f,d){switch(d){case 632:n.push(c);break;case 635:i=c;break;case 637:i.t=c.t,i.h=c.h,i.r=c.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,t.sheetRows&&i.rfx&&t.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!f.T){if(!a||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}),r}var eae="application/vnd.ms-office.vbaProject";function tae(e){var t=bt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");bt.utils.cfb_add(t,i,e.FileIndex[n].content)}}),bt.write(t)}function rae(){return{"!type":"dialog"}}function nae(){return{"!type":"dialog"}}function iae(){return{"!type":"macro"}}function aae(){return{"!type":"macro"}}var Ec=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,i,a,o){var c=!1,f=!1;a.length==0?f=!0:a.charAt(0)=="["&&(f=!0,a=a.slice(1,-1)),o.length==0?c=!0:o.charAt(0)=="["&&(c=!0,o=o.slice(1,-1));var d=a.length>0?parseInt(a,10)|0:0,h=o.length>0?parseInt(o,10)|0:0;return c?h+=t.c:--h,f?d+=t.r:--d,i+(c?"":"$")+$r(h)+(f?"":"$")+Cn(d)}return function(i,a){return t=a,i.replace(e,r)}}(),p5=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,sae=function(){return function(t,r){return t.replace(p5,function(n,i,a,o,c,f){var d=Zw(o)-(a?0:r.c),h=Yw(f)-(c?0:r.r),m=h==0?"":c?h+1:"["+h+"]",v=d==0?"":a?d+1:"["+d+"]";return i+"R"+m+"C"+v})}}();function g5(e,t){return e.replace(p5,function(r,n,i,a,o,c){return n+(i=="$"?i+a:$r(Zw(a)+t.c))+(o=="$"?o+c:Cn(Yw(c)+t.r))})}function oae(e,t,r){var n=nu(t),i=n.s,a=$n(r),o={r:a.r-i.r,c:a.c-i.c};return g5(e,o)}function lae(e){return e.length!=1}function _4(e){return e.replace(/_xlfn\./g,"")}function Pr(e){e.l+=1}function Eo(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function m5(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return x5(e);r.biff==12&&(n=4)}var i=e.read_shift(n),a=e.read_shift(n),o=Eo(e),c=Eo(e);return{s:{r:i,c:o[0],cRel:o[1],rRel:o[2]},e:{r:a,c:c[0],cRel:c[1],rRel:c[2]}}}function x5(e){var t=Eo(e),r=Eo(e),n=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function cae(e,t,r){if(r.biff<8)return x5(e);var n=e.read_shift(r.biff==12?4:2),i=e.read_shift(r.biff==12?4:2),a=Eo(e),o=Eo(e);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function v5(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return uae(e);var n=e.read_shift(r&&r.biff==12?4:2),i=Eo(e);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function uae(e){var t=Eo(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function fae(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function dae(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return hae(e);var i=e.read_shift(n>=12?4:2),a=e.read_shift(2),o=(a&16384)>>14,c=(a&32768)>>15;if(a&=16383,c==1)for(;i>524287;)i-=1048576;if(o==1)for(;a>8191;)a=a-16384;return{r:i,c:a,cRel:o,rRel:c}}function hae(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),i==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:i,rRel:n}}function pae(e,t,r){var n=(e[e.l++]&96)>>5,i=m5(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function gae(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}var o=m5(e,a,r);return[n,i,o]}function mae(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function xae(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}return e.l+=a,[n,i]}function vae(e,t,r){var n=(e[e.l++]&96)>>5,i=cae(e,t-1,r);return[n,i]}function yae(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function b4(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function wae(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),i=[],a=0;a<=n;++a)i.push(e.read_shift(r&&r.biff==2?1:2));return i}function Eae(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function Aae(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function Cae(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function Sae(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function y5(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function _ae(e){return e.read_shift(2),y5(e)}function bae(e){return e.read_shift(2),y5(e)}function Tae(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=v5(e,0,r);return[n,i]}function Oae(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=dae(e,0,r);return[n,i]}function kae(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var a=v5(e,0,r);return[n,i,a]}function Iae(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(r&&r.biff<=3?1:2);return[Nse[i],A5[i],n]}function Nae(e,t,r){var n=e[e.l++],i=e.read_shift(1),a=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:Pae(e);return[i,(a[0]===0?A5:Ise)[a[1]]]}function Pae(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function Dae(e,t,r){e.l+=r&&r.biff==2?3:4}function Rae(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function Mae(e){return e.l++,Pl[e.read_shift(1)]}function Fae(e){return e.l++,e.read_shift(2)}function Lae(e){return e.l++,e.read_shift(1)!==0}function Bae(e){return e.l++,Rn(e)}function jae(e,t,r){return e.l++,kf(e,t-1,r)}function Uae(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Ir(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Pl[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Rn(e);break;case 2:r[1]=Dl(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function zae(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),i=[],a=0;a!=n;++a)i.push((r.biff==12?Nl:sg)(e));return i}function Wae(e,t,r){var n=0,i=0;r.biff==12?(n=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var a=0,o=[];a!=n&&(o[a]=[]);++a)for(var c=0;c!=i;++c)o[a][c]=Uae(e,r.biff);return o}function Vae(e,t,r){var n=e.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,a=e.read_shift(i);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,a]}function Hae(e,t,r){if(r.biff==5)return Gae(e);var n=e.read_shift(1)>>>5&3,i=e.read_shift(2),a=e.read_shift(4);return[n,i,a]}function Gae(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function $ae(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function Xae(e,t,r){var n=e.read_shift(1)>>>5&3,i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function Kae(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function Yae(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return e.l+=a,[n,i]}var Zae=jn,qae=jn,Qae=jn;function Nf(e,t,r){return e.l+=2,[fae(e)]}function iE(e){return e.l+=6,[]}var Jae=Nf,ese=iE,tse=iE,rse=Nf;function w5(e){return e.l+=2,[Rr(e),e.read_shift(2)&1]}var nse=Nf,ise=w5,ase=iE,sse=Nf,ose=Nf,lse=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function cse(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i=e.read_shift(2),a=e.read_shift(2),o=lse[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:n,c:i,C:a}}function use(e){return e.l+=2,[e.read_shift(4)]}function fse(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function dse(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function hse(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function pse(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function gse(e){return e.l+=4,[0,0]}var T4={1:{n:"PtgExp",f:Rae},2:{n:"PtgTbl",f:Qae},3:{n:"PtgAdd",f:Pr},4:{n:"PtgSub",f:Pr},5:{n:"PtgMul",f:Pr},6:{n:"PtgDiv",f:Pr},7:{n:"PtgPower",f:Pr},8:{n:"PtgConcat",f:Pr},9:{n:"PtgLt",f:Pr},10:{n:"PtgLe",f:Pr},11:{n:"PtgEq",f:Pr},12:{n:"PtgGe",f:Pr},13:{n:"PtgGt",f:Pr},14:{n:"PtgNe",f:Pr},15:{n:"PtgIsect",f:Pr},16:{n:"PtgUnion",f:Pr},17:{n:"PtgRange",f:Pr},18:{n:"PtgUplus",f:Pr},19:{n:"PtgUminus",f:Pr},20:{n:"PtgPercent",f:Pr},21:{n:"PtgParen",f:Pr},22:{n:"PtgMissArg",f:Pr},23:{n:"PtgStr",f:jae},26:{n:"PtgSheet",f:fse},27:{n:"PtgEndSheet",f:dse},28:{n:"PtgErr",f:Mae},29:{n:"PtgBool",f:Lae},30:{n:"PtgInt",f:Fae},31:{n:"PtgNum",f:Bae},32:{n:"PtgArray",f:yae},33:{n:"PtgFunc",f:Iae},34:{n:"PtgFuncVar",f:Nae},35:{n:"PtgName",f:Vae},36:{n:"PtgRef",f:Tae},37:{n:"PtgArea",f:pae},38:{n:"PtgMemArea",f:$ae},39:{n:"PtgMemErr",f:Zae},40:{n:"PtgMemNoMem",f:qae},41:{n:"PtgMemFunc",f:Xae},42:{n:"PtgRefErr",f:Kae},43:{n:"PtgAreaErr",f:mae},44:{n:"PtgRefN",f:Oae},45:{n:"PtgAreaN",f:vae},46:{n:"PtgMemAreaN",f:hse},47:{n:"PtgMemNoMemN",f:pse},57:{n:"PtgNameX",f:Hae},58:{n:"PtgRef3d",f:kae},59:{n:"PtgArea3d",f:gae},60:{n:"PtgRefErr3d",f:Yae},61:{n:"PtgAreaErr3d",f:xae},255:{}},mse={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},xse={1:{n:"PtgElfLel",f:w5},2:{n:"PtgElfRw",f:sse},3:{n:"PtgElfCol",f:Jae},6:{n:"PtgElfRwV",f:ose},7:{n:"PtgElfColV",f:rse},10:{n:"PtgElfRadical",f:nse},11:{n:"PtgElfRadicalS",f:ase},13:{n:"PtgElfColS",f:ese},15:{n:"PtgElfColSV",f:tse},16:{n:"PtgElfRadicalLel",f:ise},25:{n:"PtgList",f:cse},29:{n:"PtgSxName",f:use},255:{}},vse={0:{n:"PtgAttrNoop",f:gse},1:{n:"PtgAttrSemi",f:Sae},2:{n:"PtgAttrIf",f:Aae},4:{n:"PtgAttrChoose",f:wae},8:{n:"PtgAttrGoto",f:Eae},16:{n:"PtgAttrSum",f:Dae},32:{n:"PtgAttrBaxcel",f:b4},33:{n:"PtgAttrBaxcel",f:b4},64:{n:"PtgAttrSpace",f:_ae},65:{n:"PtgAttrSpaceSemi",f:bae},128:{n:"PtgAttrIfError",f:Cae},255:{}};function Pf(e,t,r,n){if(n.biff<8)return jn(e,t);for(var i=e.l+t,a=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=Wae(e,0,n),a.push(r[o][1]);break;case"PtgMemArea":r[o][2]=zae(e,r[o][1],n),a.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=e.read_shift(4),a.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=i-e.l,t!==0&&a.push(jn(e,t)),a}function Df(e,t,r){for(var n=e.l+t,i,a,o=[];n!=e.l;)t=n-e.l,a=e[e.l],i=T4[a]||T4[mse[a]],(a===24||a===25)&&(i=(a===24?xse:vse)[e[e.l+1]]),!i||!i.f?jn(e,t):o.push([i.n,i.f(e,t,r)]);return o}function yse(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],i=[],a=0;a<n.length;++a){var o=n[a];if(o)switch(o[0]){case 2:i.push('"'+o[1].replace(/"/g,'""')+'"');break;default:i.push(o[1])}else i.push("")}t.push(i.join(","))}return t.join(";")}var wse={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Ese(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function E5(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(e[n[0]][0]){case 357:return i=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return e[n[0]][0][3]?(i=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function O4(e,t,r){var n=E5(e,t,r);return n=="#REF"?n:Ese(n,r)}function Nn(e,t,r,n,i){var a=i&&i.biff||8,o={s:{c:0,r:0}},c=[],f,d,h,m=0,v=0,w,E="";if(!e[0]||!e[0][0])return"";for(var A=-1,S="",b=0,T=e[0].length;b<T;++b){var _=e[0][b];switch(_[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(f=c.pop(),d=c.pop(),A>=0){switch(e[0][A][1][0]){case 0:S=br(" ",e[0][A][1][1]);break;case 1:S=br("\r",e[0][A][1][1]);break;default:if(S="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][A][1][0])}d=d+S,A=-1}c.push(d+wse[_[0]]+f);break;case"PtgIsect":f=c.pop(),d=c.pop(),c.push(d+" "+f);break;case"PtgUnion":f=c.pop(),d=c.pop(),c.push(d+","+f);break;case"PtgRange":f=c.pop(),d=c.pop(),c.push(d+":"+f);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":h=r0(_[1][1],o,i),c.push(n0(h,a));break;case"PtgRefN":h=r?r0(_[1][1],r,i):_[1][1],c.push(n0(h,a));break;case"PtgRef3d":m=_[1][1],h=r0(_[1][2],o,i),E=O4(n,m,i),c.push(E+"!"+n0(h,a));break;case"PtgFunc":case"PtgFuncVar":var N=_[1][0],M=_[1][1];N||(N=0),N&=127;var R=N==0?[]:c.slice(-N);c.length-=N,M==="User"&&(M=R.shift()),c.push(M+"("+R.join(",")+")");break;case"PtgBool":c.push(_[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(_[1]);break;case"PtgNum":c.push(String(_[1]));break;case"PtgStr":c.push('"'+_[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(_[1]);break;case"PtgAreaN":w=l4(_[1][1],r?{s:r}:o,i),c.push(Am(w,i));break;case"PtgArea":w=l4(_[1][1],o,i),c.push(Am(w,i));break;case"PtgArea3d":m=_[1][1],w=_[1][2],E=O4(n,m,i),c.push(E+"!"+Am(w,i));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":v=_[1][2];var P=(n.names||[])[v-1]||(n[0]||[])[v],z=P?P.Name:"SH33TJSNAME"+String(v);z&&z.slice(0,6)=="_xlfn."&&!i.xlfn&&(z=z.slice(6)),c.push(z);break;case"PtgNameX":var B=_[1][1];v=_[1][2];var re;if(i.biff<=5)B<0&&(B=-B),n[B]&&(re=n[B][v]);else{var ee="";if(((n[B]||[])[0]||[])[0]==14849||(((n[B]||[])[0]||[])[0]==1025?n[B][v]&&n[B][v].itab>0&&(ee=n.SheetNames[n[B][v].itab-1]+"!"):ee=n.SheetNames[v-1]+"!"),n[B]&&n[B][v])ee+=n[B][v].Name;else if(n[0]&&n[0][v])ee+=n[0][v].Name;else{var V=(E5(n,B,i)||"").split(";;");V[v-1]?ee=V[v-1]:ee+="SH33TJSERRX"}c.push(ee);break}re||(re={Name:"SH33TJSERRY"}),c.push(re.Name);break;case"PtgParen":var de="(",pe=")";if(A>=0){switch(S="",e[0][A][1][0]){case 2:de=br(" ",e[0][A][1][1])+de;break;case 3:de=br("\r",e[0][A][1][1])+de;break;case 4:pe=br(" ",e[0][A][1][1])+pe;break;case 5:pe=br("\r",e[0][A][1][1])+pe;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][A][1][0])}A=-1}c.push(de+c.pop()+pe);break;case"PtgRefErr":c.push("#REF!");break;case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":h={c:_[1][1],r:_[1][0]};var K={c:r.c,r:r.r};if(n.sharedf[ct(h)]){var Ce=n.sharedf[ct(h)];c.push(Nn(Ce,o,K,n,i))}else{var ue=!1;for(f=0;f!=n.arrayf.length;++f)if(d=n.arrayf[f],!(h.c<d[0].s.c||h.c>d[0].e.c)&&!(h.r<d[0].s.r||h.r>d[0].e.r)){c.push(Nn(d[1],o,K,n,i)),ue=!0;break}ue||c.push(_[1])}break;case"PtgArray":c.push("{"+yse(_[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":A=b;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":c.push("#REF!");break;case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+_[1].idx+"[#"+_[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(_));default:throw new Error("Unrecognized Formula Token: "+String(_))}var se=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&A>=0&&se.indexOf(e[0][b][0])==-1){_=e[0][A];var q=!0;switch(_[1][0]){case 4:q=!1;case 0:S=br(" ",_[1][1]);break;case 5:q=!1;case 1:S=br("\r",_[1][1]);break;default:if(S="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+_[1][0])}c.push((q?S:"")+c.pop()+(q?"":S)),A=-1}}if(c.length>1&&i.WTF)throw new Error("bad formula stack");return c[0]}function Ase(e,t,r){var n=e.l+t,i=r.biff==2?1:2,a,o=e.read_shift(i);if(o==65535)return[[],jn(e,t-2)];var c=Df(e,o,r);return t!==o+i&&(a=Pf(e,t-o-i,c,r)),e.l=n,[c,a]}function Cse(e,t,r){var n=e.l+t,i=r.biff==2?1:2,a,o=e.read_shift(i);if(o==65535)return[[],jn(e,t-2)];var c=Df(e,o,r);return t!==o+i&&(a=Pf(e,t-o-i,c,r)),e.l=n,[c,a]}function Sse(e,t,r,n){var i=e.l+t,a=Df(e,n,r),o;return i!==e.l&&(o=Pf(e,i-e.l,a,r)),[a,o]}function _se(e,t,r){var n=e.l+t,i,a=e.read_shift(2),o=Df(e,a,r);return a==65535?[[],jn(e,t-2)]:(t!==a+2&&(i=Pf(e,n-a-2,o,r)),[o,i])}function bse(e){var t;if(ls(e,e.l+6)!==65535)return[Rn(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function _m(e,t,r){var n=e.l+t,i=Za(e);r.biff==2&&++e.l;var a=bse(e),o=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var c=Cse(e,n-e.l,r);return{cell:i,val:a[0],formula:c,shared:o>>3&1,tt:a[1]}}function og(e,t,r){var n=e.read_shift(4),i=Df(e,n,r),a=e.read_shift(4),o=a>0?Pf(e,a,i,r):null;return[i,o]}var Tse=og,lg=og,Ose=og,kse=og,Ise={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},A5={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Nse={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function k4(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function bm(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var o0={},Ac={};function l0(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function C5(e,t,r,n,i,a){try{n.cellNF&&(e.z=ft[t])}catch(c){if(n.WTF)throw c}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=ln(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(ft[t]==null&&tl(Pee[t]||"General",t),e.t==="e")e.w=e.w||Pl[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=G0(e.v);else if(e.t==="d"){var o=qn(e.v);(o|0)===o?e.w=o.toString(10):e.w=G0(o)}else{if(e.v===void 0)return"";e.w=vl(e.v,Ac)}else e.t==="d"?e.w=ta(t,qn(e.v),Ac):e.w=ta(t,e.v,Ac)}catch(c){if(n.WTF)throw c}if(n.cellStyles&&r!=null)try{e.s=a.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=O1(i.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=i.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=O1(i.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=i.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(c){if(n.WTF&&a.Fills)throw c}}}function Pse(e,t){var r=Tr(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Tt(r))}var Dse=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Rse=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,Mse=/<(?:\w:)?hyperlink [^>]*>/mg,Fse=/"(\w*:\w*)"/,Lse=/<(?:\w:)?col\b[^>]*[\/]?>/g,Bse=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,jse=/<(?:\w:)?pageMargins[^>]*\/>/g,S5=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Use=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,zse=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function Wse(e,t,r,n,i,a,o){if(!e)return e;n||(n={"!id":{}});var c=t.dense?[]:{},f={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",h="",m=e.match(Rse);m?(d=e.slice(0,m.index),h=e.slice(m.index+m[0].length)):d=h=e;var v=d.match(S5);v?aE(v[0],c,i,r):(v=d.match(Use))&&Vse(v[0],v[1]||"",c,i,r);var w=(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(w>0){var E=d.slice(w,w+50).match(Fse);E&&Pse(c,E[1])}var A=d.match(zse);A&&A[1]&&Yse(A[1],i);var S=[];if(t.cellStyles){var b=d.match(Lse);b&&$se(S,b)}m&&Zse(m[1],c,t,f,a,o);var T=h.match(Bse);T&&(c["!autofilter"]=Xse(T[0]));var _=[],N=h.match(Dse);if(N)for(w=0;w!=N.length;++w)_[w]=Tr(N[w].slice(N[w].indexOf('"')+1));var M=h.match(Mse);M&&Hse(c,M,n);var R=h.match(jse);if(R&&(c["!margins"]=Gse(ot(R[0]))),!c["!ref"]&&f.e.c>=f.s.c&&f.e.r>=f.s.r&&(c["!ref"]=Tt(f)),t.sheetRows>0&&c["!ref"]){var P=Tr(c["!ref"]);t.sheetRows<=+P.e.r&&(P.e.r=t.sheetRows-1,P.e.r>f.e.r&&(P.e.r=f.e.r),P.e.r<P.s.r&&(P.s.r=P.e.r),P.e.c>f.e.c&&(P.e.c=f.e.c),P.e.c<P.s.c&&(P.s.c=P.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Tt(P))}return S.length>0&&(c["!cols"]=S),_.length>0&&(c["!merges"]=_),c}function aE(e,t,r,n){var i=ot(e);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=Nt(qt(i.codeName)))}function Vse(e,t,r,n,i){aE(e.slice(0,e.indexOf(">")),r,n,i)}function Hse(e,t,r){for(var n=Array.isArray(e),i=0;i!=t.length;++i){var a=ot(qt(t[i]),!0);if(!a.ref)return;var o=((r||{})["!id"]||[])[a.id];o?(a.Target=o.Target,a.location&&(a.Target+="#"+Nt(a.location))):(a.Target="#"+Nt(a.location),o={Target:a.Target,TargetMode:"Internal"}),a.Rel=o,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var c=Tr(a.ref),f=c.s.r;f<=c.e.r;++f)for(var d=c.s.c;d<=c.e.c;++d){var h=ct({c:d,r:f});n?(e[f]||(e[f]=[]),e[f][d]||(e[f][d]={t:"z",v:void 0}),e[f][d].l=a):(e[h]||(e[h]={t:"z",v:void 0}),e[h].l=a)}}}function Gse(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function $se(e,t){for(var r=!1,n=0;n!=t.length;++n){var i=ot(t[n],!0);i.hidden&&(i.hidden=cr(i.hidden));var a=parseInt(i.min,10)-1,o=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,nE(i.width)),zc(i);a<=o;)e[a++]=An(i)}}function Xse(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}var Kse=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function Yse(e,t){t.Views||(t.Views=[{}]),(e.match(Kse)||[]).forEach(function(r,n){var i=ot(r);t.Views[n]||(t.Views[n]={}),+i.zoomScale&&(t.Views[n].zoom=+i.zoomScale),cr(i.rightToLeft)&&(t.Views[n].RTL=!0)})}var Zse=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,a=$0("v"),o=$0("f");return function(f,d,h,m,v,w){for(var E=0,A="",S=[],b=[],T=0,_=0,N=0,M="",R,P,z=0,B=0,re,ee,V=0,de=0,pe=Array.isArray(w.CellXf),K,Ce=[],ue=[],se=Array.isArray(d),q=[],fe={},we=!1,G=!!h.sheetStubs,le=f.split(t),ne=0,ae=le.length;ne!=ae;++ne){A=le[ne].trim();var he=A.length;if(he!==0){var ke=0;e:for(E=0;E<he;++E)switch(A[E]){case">":if(A[E-1]!="/"){++E;break e}if(h&&h.cellStyles){if(P=ot(A.slice(ke,E),!0),z=P.r!=null?parseInt(P.r,10):z+1,B=-1,h.sheetRows&&h.sheetRows<z)continue;fe={},we=!1,P.ht&&(we=!0,fe.hpt=parseFloat(P.ht),fe.hpx=Z0(fe.hpt)),P.hidden=="1"&&(we=!0,fe.hidden=!0),P.outlineLevel!=null&&(we=!0,fe.level=+P.outlineLevel),we&&(q[z-1]=fe)}break;case"<":ke=E;break}if(ke>=E)break;if(P=ot(A.slice(ke,E),!0),z=P.r!=null?parseInt(P.r,10):z+1,B=-1,!(h.sheetRows&&h.sheetRows<z)){m.s.r>z-1&&(m.s.r=z-1),m.e.r<z-1&&(m.e.r=z-1),h&&h.cellStyles&&(fe={},we=!1,P.ht&&(we=!0,fe.hpt=parseFloat(P.ht),fe.hpx=Z0(fe.hpt)),P.hidden=="1"&&(we=!0,fe.hidden=!0),P.outlineLevel!=null&&(we=!0,fe.level=+P.outlineLevel),we&&(q[z-1]=fe)),S=A.slice(E).split(e);for(var De=0;De!=S.length&&S[De].trim().charAt(0)=="<";++De);for(S=S.slice(De),E=0;E!=S.length;++E)if(A=S[E].trim(),A.length!==0){if(b=A.match(r),T=E,_=0,N=0,A="<c "+(A.slice(0,1)=="<"?">":"")+A,b!=null&&b.length===2){for(T=0,M=b[1],_=0;_!=M.length&&!((N=M.charCodeAt(_)-64)<1||N>26);++_)T=26*T+N;--T,B=T}else++B;for(_=0;_!=A.length&&A.charCodeAt(_)!==62;++_);if(++_,P=ot(A.slice(0,_),!0),P.r||(P.r=ct({r:z-1,c:B})),M=A.slice(_),R={t:""},(b=M.match(a))!=null&&b[1]!==""&&(R.v=Nt(b[1])),h.cellFormula){if((b=M.match(o))!=null&&b[1]!==""){if(R.f=Nt(qt(b[1])).replace(/\r\n/g,`
`),h.xlfn||(R.f=_4(R.f)),b[0].indexOf('t="array"')>-1)R.F=(M.match(i)||[])[1],R.F.indexOf(":")>-1&&Ce.push([Tr(R.F),R.F]);else if(b[0].indexOf('t="shared"')>-1){ee=ot(b[0]);var ce=Nt(qt(b[1]));h.xlfn||(ce=_4(ce)),ue[parseInt(ee.si,10)]=[ee,ce,P.r]}}else(b=M.match(/<f[^>]*\/>/))&&(ee=ot(b[0]),ue[ee.si]&&(R.f=oae(ue[ee.si][1],ue[ee.si][2],P.r)));var be=$n(P.r);for(_=0;_<Ce.length;++_)be.r>=Ce[_][0].s.r&&be.r<=Ce[_][0].e.r&&be.c>=Ce[_][0].s.c&&be.c<=Ce[_][0].e.c&&(R.F=Ce[_][1])}if(P.t==null&&R.v===void 0)if(R.f||R.F)R.v=0,R.t="n";else if(G)R.t="z";else continue;else R.t=P.t||"n";switch(m.s.c>B&&(m.s.c=B),m.e.c<B&&(m.e.c=B),R.t){case"n":if(R.v==""||R.v==null){if(!G)continue;R.t="z"}else R.v=parseFloat(R.v);break;case"s":if(typeof R.v>"u"){if(!G)continue;R.t="z"}else re=o0[parseInt(R.v,10)],R.v=re.t,R.r=re.r,h.cellHTML&&(R.h=re.h);break;case"str":R.t="s",R.v=R.v!=null?qt(R.v):"",h.cellHTML&&(R.h=$w(R.v));break;case"inlineStr":b=M.match(n),R.t="s",b!=null&&(re=rE(b[1]))?(R.v=re.t,h.cellHTML&&(R.h=re.h)):R.v="";break;case"b":R.v=cr(R.v);break;case"d":h.cellDates?R.v=ln(R.v,1):(R.v=qn(ln(R.v,1)),R.t="n");break;case"e":(!h||h.cellText!==!1)&&(R.w=R.v),R.v=GP[R.v];break}if(V=de=0,K=null,pe&&P.s!==void 0&&(K=w.CellXf[P.s],K!=null&&(K.numFmtId!=null&&(V=K.numFmtId),h.cellStyles&&K.fillId!=null&&(de=K.fillId))),C5(R,V,de,h,v,w),h.cellDates&&pe&&R.t=="n"&&ru(ft[V])&&(R.t="d",R.v=ag(R.v)),P.cm&&h.xlmeta){var ze=(h.xlmeta.Cell||[])[+P.cm-1];ze&&ze.type=="XLDAPR"&&(R.D=!0)}if(se){var W=$n(P.r);d[W.r]||(d[W.r]=[]),d[W.r][W.c]=R}else d[P.r]=R}}}}q.length>0&&(d["!rows"]=q)}}();function qse(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var a=e.read_shift(1);return e.l=n,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=i/20),r}var Qse=Nl;function Jse(){}function eoe(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=Ate(e),r}function toe(e){var t=ia(e);return[t]}function roe(e){var t=Il(e);return[t]}function noe(e){var t=ia(e),r=e.read_shift(1);return[t,r,"b"]}function ioe(e){var t=Il(e),r=e.read_shift(1);return[t,r,"b"]}function aoe(e){var t=ia(e),r=e.read_shift(1);return[t,r,"e"]}function soe(e){var t=Il(e),r=e.read_shift(1);return[t,r,"e"]}function ooe(e){var t=ia(e),r=e.read_shift(4);return[t,r,"s"]}function loe(e){var t=Il(e),r=e.read_shift(4);return[t,r,"s"]}function coe(e){var t=ia(e),r=Rn(e);return[t,r,"n"]}function _5(e){var t=Il(e),r=Rn(e);return[t,r,"n"]}function uoe(e){var t=ia(e),r=Jw(e);return[t,r,"n"]}function foe(e){var t=Il(e),r=Jw(e);return[t,r,"n"]}function doe(e){var t=ia(e),r=qw(e);return[t,r,"is"]}function hoe(e){var t=ia(e),r=Ln(e);return[t,r,"str"]}function poe(e){var t=Il(e),r=Ln(e);return[t,r,"str"]}function goe(e,t,r){var n=e.l+t,i=ia(e);i.r=r["!row"];var a=e.read_shift(1),o=[i,a,"b"];if(r.cellFormula){e.l+=2;var c=lg(e,n-e.l,r);o[3]=Nn(c,null,i,r.supbooks,r)}else e.l=n;return o}function moe(e,t,r){var n=e.l+t,i=ia(e);i.r=r["!row"];var a=e.read_shift(1),o=[i,a,"e"];if(r.cellFormula){e.l+=2;var c=lg(e,n-e.l,r);o[3]=Nn(c,null,i,r.supbooks,r)}else e.l=n;return o}function xoe(e,t,r){var n=e.l+t,i=ia(e);i.r=r["!row"];var a=Rn(e),o=[i,a,"n"];if(r.cellFormula){e.l+=2;var c=lg(e,n-e.l,r);o[3]=Nn(c,null,i,r.supbooks,r)}else e.l=n;return o}function voe(e,t,r){var n=e.l+t,i=ia(e);i.r=r["!row"];var a=Ln(e),o=[i,a,"str"];if(r.cellFormula){e.l+=2;var c=lg(e,n-e.l,r);o[3]=Nn(c,null,i,r.supbooks,r)}else e.l=n;return o}var yoe=Nl;function woe(e,t){var r=e.l+t,n=Nl(e),i=Qw(e),a=Ln(e),o=Ln(e),c=Ln(e);e.l=r;var f={rfx:n,relId:i,loc:a,display:c};return o&&(f.Tooltip=o),f}function Eoe(){}function Aoe(e,t,r){var n=e.l+t,i=WP(e),a=e.read_shift(1),o=[i];if(o[2]=a,r.cellFormula){var c=Tse(e,n-e.l,r);o[1]=c}else e.l=n;return o}function Coe(e,t,r){var n=e.l+t,i=Nl(e),a=[i];if(r.cellFormula){var o=kse(e,n-e.l,r);a[1]=o,e.l=n}else e.l=n;return a}var Soe=["left","right","top","bottom","header","footer"];function _oe(e){var t={};return Soe.forEach(function(r){t[r]=Rn(e)}),t}function boe(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function Toe(){}function Ooe(){}function koe(e,t,r,n,i,a,o){if(!e)return e;var c=t||{};n||(n={"!id":{}});var f=c.dense?[]:{},d,h={s:{r:2e6,c:2e6},e:{r:0,c:0}},m=!1,v=!1,w,E,A,S,b,T,_,N,M,R=[];c.biff=12,c["!row"]=0;var P=0,z=!1,B=[],re={},ee=c.supbooks||i.supbooks||[[]];if(ee.sharedf=re,ee.arrayf=B,ee.SheetNames=i.SheetNames||i.Sheets.map(function(se){return se.name}),!c.supbooks&&(c.supbooks=ee,i.Names))for(var V=0;V<i.Names.length;++V)ee[0][V+1]=i.Names[V];var de=[],pe=[],K=!1;N1[16]={n:"BrtShortReal",f:_5};var Ce;if(Ms(e,function(q,fe,we){if(!v)switch(we){case 148:d=q;break;case 0:w=q,c.sheetRows&&c.sheetRows<=w.r&&(v=!0),N=Cn(S=w.r),c["!row"]=w.r,(q.hidden||q.hpt||q.level!=null)&&(q.hpt&&(q.hpx=Z0(q.hpt)),pe[q.r]=q);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(E={t:q[2]},q[2]){case"n":E.v=q[1];break;case"s":_=o0[q[1]],E.v=_.t,E.r=_.r;break;case"b":E.v=!!q[1];break;case"e":E.v=q[1],c.cellText!==!1&&(E.w=Pl[E.v]);break;case"str":E.t="s",E.v=q[1];break;case"is":E.t="s",E.v=q[1].t;break}if((A=o.CellXf[q[0].iStyleRef])&&C5(E,A.numFmtId,null,c,a,o),b=q[0].c==-1?b+1:q[0].c,c.dense?(f[S]||(f[S]=[]),f[S][b]=E):f[$r(b)+N]=E,c.cellFormula){for(z=!1,P=0;P<B.length;++P){var G=B[P];w.r>=G[0].s.r&&w.r<=G[0].e.r&&b>=G[0].s.c&&b<=G[0].e.c&&(E.F=Tt(G[0]),z=!0)}!z&&q.length>3&&(E.f=q[3])}if(h.s.r>w.r&&(h.s.r=w.r),h.s.c>b&&(h.s.c=b),h.e.r<w.r&&(h.e.r=w.r),h.e.c<b&&(h.e.c=b),c.cellDates&&A&&E.t=="n"&&ru(ft[A.numFmtId])){var le=Yo(E.v);le&&(E.t="d",E.v=new Date(le.y,le.m-1,le.d,le.H,le.M,le.S,le.u))}Ce&&(Ce.type=="XLDAPR"&&(E.D=!0),Ce=void 0);break;case 1:case 12:if(!c.sheetStubs||m)break;E={t:"z",v:void 0},b=q[0].c==-1?b+1:q[0].c,c.dense?(f[S]||(f[S]=[]),f[S][b]=E):f[$r(b)+N]=E,h.s.r>w.r&&(h.s.r=w.r),h.s.c>b&&(h.s.c=b),h.e.r<w.r&&(h.e.r=w.r),h.e.c<b&&(h.e.c=b),Ce&&(Ce.type=="XLDAPR"&&(E.D=!0),Ce=void 0);break;case 176:R.push(q);break;case 49:Ce=((c.xlmeta||{}).Cell||[])[q-1];break;case 494:var ne=n["!id"][q.relId];for(ne?(q.Target=ne.Target,q.loc&&(q.Target+="#"+q.loc),q.Rel=ne):q.relId==""&&(q.Target="#"+q.loc),S=q.rfx.s.r;S<=q.rfx.e.r;++S)for(b=q.rfx.s.c;b<=q.rfx.e.c;++b)c.dense?(f[S]||(f[S]=[]),f[S][b]||(f[S][b]={t:"z",v:void 0}),f[S][b].l=q):(T=ct({c:b,r:S}),f[T]||(f[T]={t:"z",v:void 0}),f[T].l=q);break;case 426:if(!c.cellFormula)break;B.push(q),M=c.dense?f[S][b]:f[$r(b)+N],M.f=Nn(q[1],h,{r:w.r,c:b},ee,c),M.F=Tt(q[0]);break;case 427:if(!c.cellFormula)break;re[ct(q[0].s)]=q[1],M=c.dense?f[S][b]:f[$r(b)+N],M.f=Nn(q[1],h,{r:w.r,c:b},ee,c);break;case 60:if(!c.cellStyles)break;for(;q.e>=q.s;)de[q.e--]={width:q.w/256,hidden:!!(q.flags&1),level:q.level},K||(K=!0,nE(q.w/256)),zc(de[q.e+1]);break;case 161:f["!autofilter"]={ref:Tt(q)};break;case 476:f["!margins"]=q;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),q.name&&(i.Sheets[r].CodeName=q.name),(q.above||q.left)&&(f["!outline"]={above:q.above,left:q.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),q.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:m=!0;break;case 36:m=!1;break;case 37:m=!0;break;case 38:m=!1;break;default:if(!fe.T){if(!m||c.WTF)throw new Error("Unexpected record 0x"+we.toString(16))}}},c),delete c.supbooks,delete c["!row"],!f["!ref"]&&(h.s.r<2e6||d&&(d.e.r>0||d.e.c>0||d.s.r>0||d.s.c>0))&&(f["!ref"]=Tt(d||h)),c.sheetRows&&f["!ref"]){var ue=Tr(f["!ref"]);c.sheetRows<=+ue.e.r&&(ue.e.r=c.sheetRows-1,ue.e.r>h.e.r&&(ue.e.r=h.e.r),ue.e.r<ue.s.r&&(ue.s.r=ue.e.r),ue.e.c>h.e.c&&(ue.e.c=h.e.c),ue.e.c<ue.s.c&&(ue.s.c=ue.e.c),f["!fullref"]=f["!ref"],f["!ref"]=Tt(ue))}return R.length>0&&(f["!merges"]=R),de.length>0&&(f["!cols"]=de),pe.length>0&&(f["!rows"]=pe),f}function Ioe(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(a){var o=a.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(t[+o[1]]=r?+o[2]:o[2])});var i=Nt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(a){n=a.replace(/<.*?>/g,"")}),[t,i,n]}function Noe(e,t,r,n,i,a){var o=a||{"!type":"chart"};if(!e)return a;var c=0,f=0,d="A",h={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(m){var v=Ioe(m);h.s.r=h.s.c=0,h.e.c=c,d=$r(c),v[0].forEach(function(w,E){o[d+Cn(E)]={t:"n",v:w,z:v[1]},f=E}),h.e.r<f&&(h.e.r=f),++c}),c>0&&(o["!ref"]=Tt(h)),o}function Poe(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},o,c=e.match(S5);return c&&aE(c[0],a,i,r),(o=e.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=o[1]),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}function Doe(e,t){e.l+=10;var r=Ln(e);return{name:r}}function Roe(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},o=!1;return Ms(e,function(f,d,h){switch(h){case 550:a["!rel"]=f;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),f.name&&(i.Sheets[r].CodeName=f.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(d.T>0)){if(!(d.T<0)){if(!o||t.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}}},t),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}var b5=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],Moe=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Foe=[],Loe=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function I4(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],i=0;i!=t.length;++i){var a=t[i];if(n[a[0]]==null)n[a[0]]=a[1];else switch(a[2]){case"bool":typeof n[a[0]]=="string"&&(n[a[0]]=cr(n[a[0]]));break;case"int":typeof n[a[0]]=="string"&&(n[a[0]]=parseInt(n[a[0]],10));break}}}function N4(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=cr(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function T5(e){N4(e.WBProps,b5),N4(e.CalcPr,Loe),I4(e.WBView,Moe),I4(e.Sheets,Foe),Ac.date1904=cr(e.WBProps.date1904)}var Boe="][*?/\\".split("");function joe(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return Boe.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}var Uoe=/<\w+:workbook/;function zoe(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",a={},o=0;if(e.replace(Un,function(f,d){var h=ot(f);switch(Ya(h[0])){case"<?xml":break;case"<workbook":f.match(Uoe)&&(i="xmlns"+f.match(/<(\w+):/)[1]),r.xmlns=h[i];break;case"</workbook>":break;case"<fileVersion":delete h[0],r.AppVersion=h;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":b5.forEach(function(m){if(h[m[0]]!=null)switch(m[2]){case"bool":r.WBProps[m[0]]=cr(h[m[0]]);break;case"int":r.WBProps[m[0]]=parseInt(h[m[0]],10);break;default:r.WBProps[m[0]]=h[m[0]]}}),h.codeName&&(r.WBProps.CodeName=qt(h.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete h[0],r.WBView.push(h);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(h.state){case"hidden":h.Hidden=1;break;case"veryHidden":h.Hidden=2;break;default:h.Hidden=0}delete h.state,h.name=Nt(qt(h.name)),delete h[0],r.Sheets.push(h);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":a={},a.Name=qt(h.name),h.comment&&(a.Comment=h.comment),h.localSheetId&&(a.Sheet=+h.localSheetId),cr(h.hidden||"0")&&(a.Hidden=!0),o=d+f.length;break;case"</definedName>":a.Ref=Nt(qt(e.slice(o,d))),r.Names.push(a);break;case"<definedName/>":break;case"<calcPr":delete h[0],r.CalcPr=h;break;case"<calcPr/>":delete h[0],r.CalcPr=h;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+h[0]+" in workbook")}return f}),ate.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return T5(r),r}function Woe(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Iv(e),r.name=Ln(e),r}function Voe(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var i=t>8?Ln(e):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function Hoe(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function Goe(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),a=Cte(e),o=Ose(e,0,r),c=Qw(e);e.l=n;var f={Name:a,Ptg:o};return i<268435455&&(f.Sheet=i),c&&(f.Comment=c),f}function $oe(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;t||(t={}),t.biff=12;var a=[],o=[[]];return o.SheetNames=[],o.XTI=[],N1[16]={n:"BrtFRTArchID$",f:Hoe},Ms(e,function(f,d,h){switch(h){case 156:o.SheetNames.push(f.name),r.Sheets.push(f);break;case 153:r.WBProps=f;break;case 39:f.Sheet!=null&&(t.SID=f.Sheet),f.Ref=Nn(f.Ptg,null,null,o,t),delete t.SID,delete f.Ptg,a.push(f);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([h,f]):o[0]=[h,f],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(f),o.XTI=o.XTI.concat(f);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(h),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(h),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!d.T){if(!i||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+h.toString(16))}}},t),T5(r),r.Names=a,r.supbooks=o,r}function Xoe(e,t,r){return t.slice(-4)===".bin"?$oe(e,r):zoe(e,r)}function Koe(e,t,r,n,i,a,o,c){return t.slice(-4)===".bin"?koe(e,n,r,i,a,o,c):Wse(e,n,r,i,a,o,c)}function Yoe(e,t,r,n,i,a,o,c){return t.slice(-4)===".bin"?Roe(e,n,r,i,a):Poe(e,n,r,i,a)}function Zoe(e,t,r,n,i,a,o,c){return t.slice(-4)===".bin"?iae():aae()}function qoe(e,t,r,n,i,a,o,c){return t.slice(-4)===".bin"?rae():nae()}function Qoe(e,t,r,n){return t.slice(-4)===".bin"?yie(e,r,n):hie(e,r,n)}function Joe(e,t,r){return h5(e,r)}function ele(e,t,r){return t.slice(-4)===".bin"?Mne(e,r):Dne(e,r)}function tle(e,t,r){return t.slice(-4)===".bin"?Jie(e,r):Kie(e,r)}function rle(e,t,r){return t.slice(-4)===".bin"?Gie(e):Vie(e)}function nle(e,t,r,n){return r.slice(-4)===".bin"?$ie(e,t,r,n):void 0}function ile(e,t,r){return t.slice(-4)===".bin"?zie(e,t,r):Wie(e,t,r)}var O5=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,k5=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function la(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var i=e.match(O5),a,o,c,f;if(i)for(f=0;f!=i.length;++f)a=i[f].match(k5),(o=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?c="xmlns"+a[1].slice(6):c=a[1].slice(o+1),n[c]=a[2].slice(1,a[2].length-1));return n}function ale(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(O5),i,a,o,c;if(n)for(c=0;c!=n.length;++c)i=n[c].match(k5),(a=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(a+1),r[o]=i[2].slice(1,i[2].length-1));return r}var c0;function sle(e,t){var r=c0[e]||Nt(e);return r==="General"?vl(t):ta(r,t)}function ole(e,t,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=cr(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=ln(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Nt(t)]=i}function lle(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Pl[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=G0(e.v):e.w=vl(e.v):e.w=sle(t||"General",e.v)}catch(a){if(r.WTF)throw a}try{var n=c0[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&ru(n)){var i=Yo(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(a){if(r.WTF)throw a}}}function cle(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=oie[n.Pattern]||n.Pattern)}e[t.ID]=t}function ule(e,t,r,n,i,a,o,c,f,d){var h="General",m=n.StyleID,v={};d=d||{};var w=[],E=0;for(m===void 0&&c&&(m=c.StyleID),m===void 0&&o&&(m=o.StyleID);a[m]!==void 0&&(a[m].nf&&(h=a[m].nf),a[m].Interior&&w.push(a[m].Interior),!!a[m].Parent);)m=a[m].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=cr(e);break;case"String":n.t="s",n.r=J_(Nt(e)),n.v=e.indexOf("<")>-1?Nt(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(ln(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Nt(e):n.v<60&&(n.v=n.v-1),(!h||h=="General")&&(h="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=GP[e],d.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=J_(t||e));break}if(lle(n,h,d),d.cellFormula!==!1)if(n.Formula){var A=Nt(n.Formula);A.charCodeAt(0)==61&&(A=A.slice(1)),n.f=Ec(A,i),delete n.Formula,n.ArrayRange=="RC"?n.F=Ec("RC:RC",i):n.ArrayRange&&(n.F=Ec(n.ArrayRange,i),f.push([Tr(n.F),n.F]))}else for(E=0;E<f.length;++E)i.r>=f[E][0].s.r&&i.r<=f[E][0].e.r&&i.c>=f[E][0].s.c&&i.c<=f[E][0].e.c&&(n.F=f[E][1]);d.cellStyles&&(w.forEach(function(S){!v.patternType&&S.patternType&&(v.patternType=S.patternType)}),n.s=v),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function fle(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Tm(e,t){var r=t||{};xP();var n=zu(Xw(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=qt(n));var i=n.slice(0,1024).toLowerCase(),a=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var o=An(r);return o.type="string",K0.to_workbook(n,o)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(rt){i.indexOf("<"+rt)>=0&&(a=!0)}),a)return wle(n,r);c0={"General Number":"General","General Date":ft[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ft[15],"Short Date":ft[14],"Long Time":ft[19],"Medium Time":ft[18],"Short Time":ft[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ft[2],Standard:ft[4],Percent:ft[10],Scientific:ft[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var c,f=[],d,h={},m=[],v=r.dense?[]:{},w="",E={},A={},S=la('<Data ss:Type="String">'),b=0,T=0,_=0,N={s:{r:2e6,c:2e6},e:{r:0,c:0}},M={},R={},P="",z=0,B=[],re={},ee={},V=0,de=[],pe=[],K={},Ce=[],ue,se=!1,q=[],fe=[],we={},G=0,le=0,ne={Sheets:[],WBProps:{date1904:!1}},ae={};X0.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var he="";c=X0.exec(n);)switch(c[3]=(he=c[3]).toLowerCase()){case"data":if(he=="data"){if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&f.push([c[3],!0]);break}if(f[f.length-1][1])break;c[1]==="/"?ule(n.slice(b,c.index),P,S,f[f.length-1][0]=="comment"?K:E,{c:T,r:_},M,Ce[T],A,q,r):(P="",S=la(c[0]),b=c.index+c[0].length);break;case"cell":if(c[1]==="/")if(pe.length>0&&(E.c=pe),(!r.sheetRows||r.sheetRows>_)&&E.v!==void 0&&(r.dense?(v[_]||(v[_]=[]),v[_][T]=E):v[$r(T)+Cn(_)]=E),E.HRef&&(E.l={Target:Nt(E.HRef)},E.HRefScreenTip&&(E.l.Tooltip=E.HRefScreenTip),delete E.HRef,delete E.HRefScreenTip),(E.MergeAcross||E.MergeDown)&&(G=T+(parseInt(E.MergeAcross,10)|0),le=_+(parseInt(E.MergeDown,10)|0),B.push({s:{c:T,r:_},e:{c:G,r:le}})),!r.sheetStubs)E.MergeAcross?T=G+1:++T;else if(E.MergeAcross||E.MergeDown){for(var ke=T;ke<=G;++ke)for(var De=_;De<=le;++De)(ke>T||De>_)&&(r.dense?(v[De]||(v[De]=[]),v[De][ke]={t:"z"}):v[$r(ke)+Cn(De)]={t:"z"});T=G+1}else++T;else E=ale(c[0]),E.Index&&(T=+E.Index-1),T<N.s.c&&(N.s.c=T),T>N.e.c&&(N.e.c=T),c[0].slice(-2)==="/>"&&++T,pe=[];break;case"row":c[1]==="/"||c[0].slice(-2)==="/>"?(_<N.s.r&&(N.s.r=_),_>N.e.r&&(N.e.r=_),c[0].slice(-2)==="/>"&&(A=la(c[0]),A.Index&&(_=+A.Index-1)),T=0,++_):(A=la(c[0]),A.Index&&(_=+A.Index-1),we={},(A.AutoFitHeight=="0"||A.Height)&&(we.hpx=parseInt(A.Height,10),we.hpt=d5(we.hpx),fe[_]=we),A.Hidden=="1"&&(we.hidden=!0,fe[_]=we));break;case"worksheet":if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"));m.push(w),N.s.r<=N.e.r&&N.s.c<=N.e.c&&(v["!ref"]=Tt(N),r.sheetRows&&r.sheetRows<=N.e.r&&(v["!fullref"]=v["!ref"],N.e.r=r.sheetRows-1,v["!ref"]=Tt(N))),B.length&&(v["!merges"]=B),Ce.length>0&&(v["!cols"]=Ce),fe.length>0&&(v["!rows"]=fe),h[w]=v}else N={s:{r:2e6,c:2e6},e:{r:0,c:0}},_=T=0,f.push([c[3],!1]),d=la(c[0]),w=Nt(d.Name),v=r.dense?[]:{},B=[],q=[],fe=[],ae={name:w,Hidden:0},ne.Sheets.push(ae);break;case"table":if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else{if(c[0].slice(-2)=="/>")break;f.push([c[3],!1]),Ce=[],se=!1}break;case"style":c[1]==="/"?cle(M,R,r):R=la(c[0]);break;case"numberformat":R.nf=Nt(la(c[0]).Format||"General"),c0[R.nf]&&(R.nf=c0[R.nf]);for(var ce=0;ce!=392&&ft[ce]!=R.nf;++ce);if(ce==392){for(ce=57;ce!=392;++ce)if(ft[ce]==null){tl(R.nf,ce);break}}break;case"column":if(f[f.length-1][0]!=="table")break;if(ue=la(c[0]),ue.Hidden&&(ue.hidden=!0,delete ue.Hidden),ue.Width&&(ue.wpx=parseInt(ue.Width,10)),!se&&ue.wpx>10){se=!0,Hn=u5;for(var be=0;be<Ce.length;++be)Ce[be]&&zc(Ce[be])}se&&zc(ue),Ce[ue.Index-1||Ce.length]=ue;for(var ze=0;ze<+ue.Span;++ze)Ce[Ce.length]=An(ue);break;case"namedrange":if(c[1]==="/")break;ne.Names||(ne.Names=[]);var W=ot(c[0]),He={Name:W.Name,Ref:Ec(W.RefersTo.slice(1),{r:0,c:0})};ne.Sheets.length>0&&(He.Sheet=ne.Sheets.length-1),ne.Names.push(He);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(c[0].slice(-2)==="/>")break;c[1]==="/"?P+=n.slice(z,c.index):z=c.index+c[0].length;break;case"interior":if(!r.cellStyles)break;R.Interior=la(c[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(c[0].slice(-2)==="/>")break;c[1]==="/"?Kte(re,he,n.slice(V,c.index)):V=c.index+c[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else f.push([c[3],!1]);break;case"comment":if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"));fle(K),pe.push(K)}else f.push([c[3],!1]),d=la(c[0]),K={a:d.Author};break;case"autofilter":if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else if(c[0].charAt(c[0].length-2)!=="/"){var Ge=la(c[0]);v["!autofilter"]={ref:Ec(Ge.Range).replace(/\$/g,"")},f.push([c[3],!0])}break;case"name":break;case"datavalidation":if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&f.push([c[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&f.push([c[3],!0]);break;case"null":break;default:if(f.length==0&&c[3]=="document"||f.length==0&&c[3]=="uof")return L4(n,r);var et=!0;switch(f[f.length-1][0]){case"officedocumentsettings":switch(c[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:et=!1}break;case"componentoptions":switch(c[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:et=!1}break;case"excelworkbook":switch(c[3]){case"date1904":ne.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:et=!1}break;case"workbookoptions":switch(c[3]){case"owcversion":break;case"height":break;case"width":break;default:et=!1}break;case"worksheetoptions":switch(c[3]){case"visible":if(c[0].slice(-2)!=="/>")if(c[1]==="/")switch(n.slice(V,c.index)){case"SheetHidden":ae.Hidden=1;break;case"SheetVeryHidden":ae.Hidden=2;break}else V=c.index+c[0].length;break;case"header":v["!margins"]||l0(v["!margins"]={},"xlml"),isNaN(+ot(c[0]).Margin)||(v["!margins"].header=+ot(c[0]).Margin);break;case"footer":v["!margins"]||l0(v["!margins"]={},"xlml"),isNaN(+ot(c[0]).Margin)||(v["!margins"].footer=+ot(c[0]).Margin);break;case"pagemargins":var Ze=ot(c[0]);v["!margins"]||l0(v["!margins"]={},"xlml"),isNaN(+Ze.Top)||(v["!margins"].top=+Ze.Top),isNaN(+Ze.Left)||(v["!margins"].left=+Ze.Left),isNaN(+Ze.Right)||(v["!margins"].right=+Ze.Right),isNaN(+Ze.Bottom)||(v["!margins"].bottom=+Ze.Bottom);break;case"displayrighttoleft":ne.Views||(ne.Views=[]),ne.Views[0]||(ne.Views[0]={}),ne.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":v["!outline"]||(v["!outline"]={}),v["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":v["!outline"]||(v["!outline"]={}),v["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:et=!1}break;case"pivottable":case"pivotcache":switch(c[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:et=!1}break;case"pagebreaks":switch(c[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:et=!1}break;case"autofilter":switch(c[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:et=!1}break;case"querytable":switch(c[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:et=!1}break;case"datavalidation":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:et=!1}break;case"sorting":case"conditionalformatting":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:et=!1}break;case"mapinfo":case"schema":case"data":switch(c[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:et=!1}break;case"smarttags":break;default:et=!1;break}if(et||c[3].match(/!\[CDATA/))break;if(!f[f.length-1][1])throw"Unrecognized tag: "+c[3]+"|"+f.join("|");if(f[f.length-1][0]==="customdocumentproperties"){if(c[0].slice(-2)==="/>")break;c[1]==="/"?ole(ee,he,de,n.slice(V,c.index)):(de=c,V=c.index+c[0].length);break}if(r.WTF)throw"Unrecognized tag: "+c[3]+"|"+f.join("|")}var Ie={};return!r.bookSheets&&!r.bookProps&&(Ie.Sheets=h),Ie.SheetNames=m,Ie.Workbook=ne,Ie.SSF=An(ft),Ie.Props=re,Ie.Custprops=ee,Ie}function Rv(e,t){switch(lE(t=t||{}),t.type||"base64"){case"base64":return Tm(ki(e),t);case"binary":case"buffer":case"file":return Tm(e,t);case"array":return Tm(kl(e),t)}}function dle(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=bte(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=Tte(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var hle=[60,1084,2066,2165,2175];function ple(e,t,r,n,i){var a=n,o=[],c=r.slice(r.l,r.l+a);if(i&&i.enc&&i.enc.insitu&&c.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(c)}o.push(c),r.l+=a;for(var f=ls(r,r.l),d=Mv[f],h=0;d!=null&&hle.indexOf(f)>-1;)a=ls(r,r.l+2),h=r.l+4,f==2066?h+=4:(f==2165||f==2175)&&(h+=12),c=r.slice(h,r.l+4+a),o.push(c),r.l+=4+a,d=Mv[f=ls(r,r.l)];var m=Js(o);yn(m,0);var v=0;m.lens=[];for(var w=0;w<o.length;++w)m.lens.push(v),v+=o[w].length;if(m.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+m.length+" < "+n;return t.f(m,m.length,i)}function Ma(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=ft[n])}catch(a){if(t.WTF)throw a}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Pl[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=G0(e.v):e.w=vl(e.v):e.w=ta(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(a){if(t.WTF)throw a}if(t.cellDates&&n&&e.t=="n"&&ru(ft[n]||String(n))){var i=Yo(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function Id(e,t,r){return{v:e,ixfe:t,t:r}}function gle(e,t){var r={opts:{}},n={},i=t.dense?[]:{},a={},o={},c=null,f=[],d="",h={},m,v="",w,E,A,S,b={},T=[],_,N,M=[],R=[],P={Sheets:[],WBProps:{date1904:!1},Views:[{}]},z={},B=function(dt){return dt<8?rl[dt]:dt<64&&R[dt-8]||rl[dt]},re=function(dt,Xt,ei){var ht=Xt.XF.data;if(!(!ht||!ht.patternType||!ei||!ei.cellStyles)){Xt.s={},Xt.s.patternType=ht.patternType;var We;(We=Y0(B(ht.icvFore)))&&(Xt.s.fgColor={rgb:We}),(We=Y0(B(ht.icvBack)))&&(Xt.s.bgColor={rgb:We})}},ee=function(dt,Xt,ei){if(!(we>1)&&!(ei.sheetRows&&dt.r>=ei.sheetRows)){if(ei.cellStyles&&Xt.XF&&Xt.XF.data&&re(dt,Xt,ei),delete Xt.ixfe,delete Xt.XF,m=dt,v=ct(dt),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),dt.r<o.s.r&&(o.s.r=dt.r),dt.c<o.s.c&&(o.s.c=dt.c),dt.r+1>o.e.r&&(o.e.r=dt.r+1),dt.c+1>o.e.c&&(o.e.c=dt.c+1),ei.cellFormula&&Xt.f){for(var ht=0;ht<T.length;++ht)if(!(T[ht][0].s.c>dt.c||T[ht][0].s.r>dt.r)&&!(T[ht][0].e.c<dt.c||T[ht][0].e.r<dt.r)){Xt.F=Tt(T[ht][0]),(T[ht][0].s.c!=dt.c||T[ht][0].s.r!=dt.r)&&delete Xt.f,Xt.f&&(Xt.f=""+Nn(T[ht][1],o,dt,q,V));break}}ei.dense?(i[dt.r]||(i[dt.r]=[]),i[dt.r][dt.c]=Xt):i[v]=Xt}},V={enc:!1,sbcch:0,snames:[],sharedf:b,arrayf:T,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(V.password=t.password);var de,pe=[],K=[],Ce=[],ue=[],se=!1,q=[];q.SheetNames=V.snames,q.sharedf=V.sharedf,q.arrayf=V.arrayf,q.names=[],q.XTI=[];var fe=0,we=0,G=0,le=[],ne=[],ae;V.codepage=1200,xa(1200);for(var he=!1;e.l<e.length-1;){var ke=e.l,De=e.read_shift(2);if(De===0&&fe===10)break;var ce=e.l===e.length?0:e.read_shift(2),be=Mv[De];if(be&&be.f){if(t.bookSheets&&fe===133&&De!==133)break;if(fe=De,be.r===2||be.r==12){var ze=e.read_shift(2);if(ce-=2,!V.enc&&ze!==De&&((ze&255)<<8|ze>>8)!==De)throw new Error("rt mismatch: "+ze+"!="+De);be.r==12&&(e.l+=10,ce-=10)}var W={};if(De===10?W=be.f(e,ce,V):W=ple(De,be,e,ce,V),we==0&&[9,521,1033,2057].indexOf(fe)===-1)continue;switch(De){case 34:r.opts.Date1904=P.WBProps.date1904=W;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(V.enc||(e.l=0),V.enc=W,!t.password)throw new Error("File is password-protected");if(W.valid==null)throw new Error("Encryption scheme unsupported");if(!W.valid)throw new Error("Password is incorrect");break;case 92:V.lastuser=W;break;case 66:var He=Number(W);switch(He){case 21010:He=1200;break;case 32768:He=1e4;break;case 32769:He=1252;break}xa(V.codepage=He),he=!0;break;case 317:V.rrtabid=W;break;case 25:V.winlocked=W;break;case 439:r.opts.RefreshAll=W;break;case 12:r.opts.CalcCount=W;break;case 16:r.opts.CalcDelta=W;break;case 17:r.opts.CalcIter=W;break;case 13:r.opts.CalcMode=W;break;case 14:r.opts.CalcPrecision=W;break;case 95:r.opts.CalcSaveRecalc=W;break;case 15:V.CalcRefMode=W;break;case 2211:r.opts.FullCalc=W;break;case 129:W.fDialog&&(i["!type"]="dialog"),W.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),W.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:M.push(W);break;case 430:q.push([W]),q[q.length-1].XTI=[];break;case 35:case 547:q[q.length-1].push(W);break;case 24:case 536:ae={Name:W.Name,Ref:Nn(W.rgce,o,null,q,V)},W.itab>0&&(ae.Sheet=W.itab-1),q.names.push(ae),q[0]||(q[0]=[],q[0].XTI=[]),q[q.length-1].push(W),W.Name=="_xlnm._FilterDatabase"&&W.itab>0&&W.rgce&&W.rgce[0]&&W.rgce[0][0]&&W.rgce[0][0][0]=="PtgArea3d"&&(ne[W.itab-1]={ref:Tt(W.rgce[0][0][1][2])});break;case 22:V.ExternCount=W;break;case 23:q.length==0&&(q[0]=[],q[0].XTI=[]),q[q.length-1].XTI=q[q.length-1].XTI.concat(W),q.XTI=q.XTI.concat(W);break;case 2196:if(V.biff<8)break;ae!=null&&(ae.Comment=W[1]);break;case 18:i["!protect"]=W;break;case 19:W!==0&&V.WTF&&console.error("Password verifier: "+W);break;case 133:a[W.pos]=W,V.snames.push(W.name);break;case 10:{if(--we)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,i["!ref"]=Tt(o),t.sheetRows&&t.sheetRows<=o.e.r){var Ge=o.e.r;o.e.r=t.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=Tt(o),o.e.r=Ge}o.e.r++,o.e.c++}pe.length>0&&(i["!merges"]=pe),K.length>0&&(i["!objects"]=K),Ce.length>0&&(i["!cols"]=Ce),ue.length>0&&(i["!rows"]=ue),P.Sheets.push(z)}d===""?h=i:n[d]=i,i=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(V.biff===8&&(V.biff={9:2,521:3,1033:4}[De]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[W.BIFFVer]||8),V.biffguess=W.BIFFVer==0,W.BIFFVer==0&&W.dt==4096&&(V.biff=5,he=!0,xa(V.codepage=28591)),V.biff==8&&W.BIFFVer==0&&W.dt==16&&(V.biff=2),we++)break;if(i=t.dense?[]:{},V.biff<8&&!he&&(he=!0,xa(V.codepage=t.codepage||1252)),V.biff<5||W.BIFFVer==0&&W.dt==4096){d===""&&(d="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var et={pos:e.l-ce,name:d};a[et.pos]=et,V.snames.push(d)}else d=(a[ke]||{name:""}).name;W.dt==32&&(i["!type"]="chart"),W.dt==64&&(i["!type"]="macro"),pe=[],K=[],V.arrayf=T=[],Ce=[],ue=[],se=!1,z={Hidden:(a[ke]||{hs:0}).hs,name:d}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(t.dense?(i[W.r]||[])[W.c]:i[ct({c:W.c,r:W.r})])&&++W.c,_={ixfe:W.ixfe,XF:M[W.ixfe]||{},v:W.val,t:"n"},G>0&&(_.z=le[_.ixfe>>8&63]),Ma(_,t,r.opts.Date1904),ee({c:W.c,r:W.r},_,t);break;case 5:case 517:_={ixfe:W.ixfe,XF:M[W.ixfe],v:W.val,t:W.t},G>0&&(_.z=le[_.ixfe>>8&63]),Ma(_,t,r.opts.Date1904),ee({c:W.c,r:W.r},_,t);break;case 638:_={ixfe:W.ixfe,XF:M[W.ixfe],v:W.rknum,t:"n"},G>0&&(_.z=le[_.ixfe>>8&63]),Ma(_,t,r.opts.Date1904),ee({c:W.c,r:W.r},_,t);break;case 189:for(var Ze=W.c;Ze<=W.C;++Ze){var Ie=W.rkrec[Ze-W.c][0];_={ixfe:Ie,XF:M[Ie],v:W.rkrec[Ze-W.c][1],t:"n"},G>0&&(_.z=le[_.ixfe>>8&63]),Ma(_,t,r.opts.Date1904),ee({c:Ze,r:W.r},_,t)}break;case 6:case 518:case 1030:{if(W.val=="String"){c=W;break}if(_=Id(W.val,W.cell.ixfe,W.tt),_.XF=M[_.ixfe],t.cellFormula){var rt=W.formula;if(rt&&rt[0]&&rt[0][0]&&rt[0][0][0]=="PtgExp"){var at=rt[0][0][1][0],Br=rt[0][0][1][1],$e=ct({r:at,c:Br});b[$e]?_.f=""+Nn(W.formula,o,W.cell,q,V):_.F=((t.dense?(i[at]||[])[Br]:i[$e])||{}).F}else _.f=""+Nn(W.formula,o,W.cell,q,V)}G>0&&(_.z=le[_.ixfe>>8&63]),Ma(_,t,r.opts.Date1904),ee(W.cell,_,t),c=W}break;case 7:case 519:if(c)c.val=W,_=Id(W,c.cell.ixfe,"s"),_.XF=M[_.ixfe],t.cellFormula&&(_.f=""+Nn(c.formula,o,c.cell,q,V)),G>0&&(_.z=le[_.ixfe>>8&63]),Ma(_,t,r.opts.Date1904),ee(c.cell,_,t),c=null;else throw new Error("String record expects Formula");break;case 33:case 545:{T.push(W);var Pi=ct(W[0].s);if(w=t.dense?(i[W[0].s.r]||[])[W[0].s.c]:i[Pi],t.cellFormula&&w){if(!c||!Pi||!w)break;w.f=""+Nn(W[1],o,W[0],q,V),w.F=Tt(W[0])}}break;case 1212:{if(!t.cellFormula)break;if(v){if(!c)break;b[ct(c.cell)]=W[0],w=t.dense?(i[c.cell.r]||[])[c.cell.c]:i[ct(c.cell)],(w||{}).f=""+Nn(W[0],o,m,q,V)}}break;case 253:_=Id(f[W.isst].t,W.ixfe,"s"),f[W.isst].h&&(_.h=f[W.isst].h),_.XF=M[_.ixfe],G>0&&(_.z=le[_.ixfe>>8&63]),Ma(_,t,r.opts.Date1904),ee({c:W.c,r:W.r},_,t);break;case 513:t.sheetStubs&&(_={ixfe:W.ixfe,XF:M[W.ixfe],t:"z"},G>0&&(_.z=le[_.ixfe>>8&63]),Ma(_,t,r.opts.Date1904),ee({c:W.c,r:W.r},_,t));break;case 190:if(t.sheetStubs)for(var Be=W.c;Be<=W.C;++Be){var Qe=W.ixfe[Be-W.c];_={ixfe:Qe,XF:M[Qe],t:"z"},G>0&&(_.z=le[_.ixfe>>8&63]),Ma(_,t,r.opts.Date1904),ee({c:Be,r:W.r},_,t)}break;case 214:case 516:case 4:_=Id(W.val,W.ixfe,"s"),_.XF=M[_.ixfe],G>0&&(_.z=le[_.ixfe>>8&63]),Ma(_,t,r.opts.Date1904),ee({c:W.c,r:W.r},_,t);break;case 0:case 512:we===1&&(o=W);break;case 252:f=W;break;case 1054:if(V.biff==4){le[G++]=W[1];for(var _t=0;_t<G+163&&ft[_t]!=W[1];++_t);_t>=163&&tl(W[1],G+163)}else tl(W[1],W[0]);break;case 30:{le[G++]=W;for(var Rt=0;Rt<G+163&&ft[Rt]!=W;++Rt);Rt>=163&&tl(W,G+163)}break;case 229:pe=pe.concat(W);break;case 93:K[W.cmo[0]]=V.lastobj=W;break;case 438:V.lastobj.TxO=W;break;case 127:V.lastobj.ImData=W;break;case 440:for(S=W[0].s.r;S<=W[0].e.r;++S)for(A=W[0].s.c;A<=W[0].e.c;++A)w=t.dense?(i[S]||[])[A]:i[ct({c:A,r:S})],w&&(w.l=W[1]);break;case 2048:for(S=W[0].s.r;S<=W[0].e.r;++S)for(A=W[0].s.c;A<=W[0].e.c;++A)w=t.dense?(i[S]||[])[A]:i[ct({c:A,r:S})],w&&w.l&&(w.l.Tooltip=W[1]);break;case 28:{if(V.biff<=5&&V.biff>=2)break;w=t.dense?(i[W[0].r]||[])[W[0].c]:i[ct(W[0])];var Fs=K[W[2]];w||(t.dense?(i[W[0].r]||(i[W[0].r]=[]),w=i[W[0].r][W[0].c]={t:"z"}):w=i[ct(W[0])]={t:"z"},o.e.r=Math.max(o.e.r,W[0].r),o.s.r=Math.min(o.s.r,W[0].r),o.e.c=Math.max(o.e.c,W[0].c),o.s.c=Math.min(o.s.c,W[0].c)),w.c||(w.c=[]),E={a:W[1],t:Fs.TxO.t},w.c.push(E)}break;case 2173:Lie(M[W.ixfe],W.ext);break;case 125:{if(!V.cellStyles)break;for(;W.e>=W.s;)Ce[W.e--]={width:W.w/256,level:W.level||0,hidden:!!(W.flags&1)},se||(se=!0,nE(W.w/256)),zc(Ce[W.e+1])}break;case 520:{var sr={};W.level!=null&&(ue[W.r]=sr,sr.level=W.level),W.hidden&&(ue[W.r]=sr,sr.hidden=!0),W.hpt&&(ue[W.r]=sr,sr.hpt=W.hpt,sr.hpx=Z0(W.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||l0(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[De]]=W;break;case 161:i["!margins"]||l0(i["!margins"]={}),i["!margins"].header=W.header,i["!margins"].footer=W.footer;break;case 574:W.RTL&&(P.Views[0].RTL=!0);break;case 146:R=W;break;case 2198:de=W;break;case 140:N=W;break;case 442:d?z.CodeName=W||z.name:P.WBProps.CodeName=W||"ThisWorkbook";break}}else be||console.error("Missing Info for XLS Record 0x"+De.toString(16)),e.l+=ce}return r.SheetNames=Ka(a).sort(function($t,dt){return Number($t)-Number(dt)}).map(function($t){return a[$t].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&h["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=h)):r.Preamble=h,r.Sheets&&ne.forEach(function($t,dt){r.Sheets[r.SheetNames[dt]]["!autofilter"]=$t}),r.Strings=f,r.SSF=An(ft),V.enc&&(r.Encryption=V.enc),de&&(r.Themes=de),r.Metadata={},N!==void 0&&(r.Metadata.Country=N),q.names.length>0&&(P.Names=q.names),r.Workbook=P,r}var P4={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function mle(e,t,r){var n=bt.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=g4(n,Dte,P4.DSI);for(var a in i)t[a]=i[a]}catch(d){if(r.WTF)throw d}var o=bt.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var c=g4(o,Rte,P4.SI);for(var f in c)t[f]==null&&(t[f]=c[f])}catch(d){if(r.WTF)throw d}t.HeadingPairs&&t.TitlesOfParts&&(XP(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function I5(e,t){t||(t={}),lE(t),aP(),t.codepage&&Uw(t.codepage);var r,n;if(e.FullPaths){if(bt.find(e,"/encryption"))throw new Error("File is password-protected");r=bt.find(e,"!CompObj"),n=bt.find(e,"/Workbook")||bt.find(e,"/Book")}else{switch(t.type){case"base64":e=ma(ki(e));break;case"binary":e=ma(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}yn(e,0),n={content:e}}var i,a;if(r&&dle(r),t.bookProps&&!t.bookSheets)i={};else{var o=Ct?"buffer":"array";if(n&&n.content)i=gle(n.content,t);else if((a=bt.find(e,"PerfectOffice_MAIN"))&&a.content)i=s0.to_workbook(a.content,(t.type=o,t));else if((a=bt.find(e,"NativeContent_MAIN"))&&a.content)i=s0.to_workbook(a.content,(t.type=o,t));else throw(a=bt.find(e,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&bt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=tae(e))}var c={};return e.FullPaths&&mle(e,c,t),i.Props=i.Custprops=c,t.bookFiles&&(i.cfb=e),i}var N1={0:{f:qse},1:{f:toe},2:{f:uoe},3:{f:aoe},4:{f:noe},5:{f:coe},6:{f:hoe},7:{f:ooe},8:{f:voe},9:{f:xoe},10:{f:goe},11:{f:moe},12:{f:roe},13:{f:foe},14:{f:soe},15:{f:ioe},16:{f:_5},17:{f:poe},18:{f:loe},19:{f:qw},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:Goe},40:{},42:{},43:{f:gie},44:{f:pie},45:{f:mie},46:{f:vie},47:{f:xie},48:{},49:{f:yte},50:{},51:{f:jie},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:a5},62:{f:doe},63:{f:Hie},64:{f:Toe},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:jn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:boe},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:eoe},148:{f:Qse,p:16},151:{f:Eoe},152:{},153:{f:Voe},154:{},155:{},156:{f:Woe},157:{},158:{},159:{T:1,f:Rne},160:{T:-1},161:{T:1,f:Nl},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:yoe},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Bie},336:{T:-1},337:{f:Uie,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Iv},357:{},358:{},359:{},360:{T:1},361:{},362:{f:i5},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:Aoe},427:{f:Coe},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:_oe},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:Jse},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:woe},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Iv},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Qie},633:{T:1},634:{T:-1},635:{T:1,f:qie},636:{T:-1},637:{f:Ete},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Doe},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Ooe},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Mv={6:{f:_m},10:{f:Gs},12:{f:Rr},13:{f:Rr},14:{f:Ir},15:{f:Ir},16:{f:Rn},17:{f:Ir},18:{f:Ir},19:{f:Rr},20:{f:y4},21:{f:y4},23:{f:i5},24:{f:E4},25:{f:Ir},26:{},27:{},28:{f:Yre},29:{},34:{f:Ir},35:{f:w4},38:{f:Rn},39:{f:Rn},40:{f:Rn},41:{f:Rn},42:{f:Ir},43:{f:Ir},47:{f:Jne},49:{f:Ire},51:{f:Rr},60:{},61:{f:Tre},64:{f:Ir},65:{f:kre},66:{f:Rr},77:{},80:{},81:{},82:{},85:{f:Rr},89:{},90:{},91:{},92:{f:yre},93:{f:qre},94:{},95:{f:Ir},96:{},97:{},99:{f:Ir},125:{f:a5},128:{f:Ure},129:{f:wre},130:{f:Rr},131:{f:Ir},132:{f:Ir},133:{f:Ere},134:{},140:{f:nne},141:{f:Rr},144:{},146:{f:ane},151:{},152:{},153:{},154:{},155:{},156:{f:Rr},157:{},158:{},160:{f:une},161:{f:one},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:Fre},190:{f:Lre},193:{f:Gs},197:{},198:{},199:{},200:{},201:{},202:{f:Ir},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Rr},220:{},221:{f:Ir},222:{},224:{f:jre},225:{f:vre},226:{f:Gs},227:{},229:{f:Zre},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:Are},253:{f:Nre},255:{f:Cre},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:QP},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Ir},353:{f:Gs},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:Wre},431:{f:Ir},432:{},433:{},434:{},437:{},438:{f:ene},439:{f:Ir},440:{f:tne},441:{},442:{f:If},443:{},444:{f:Rr},445:{},446:{},448:{f:Gs},449:{f:bre,r:2},450:{f:Gs},512:{f:x4},513:{f:cne},515:{f:zre},516:{f:Pre},517:{f:v4},519:{f:fne},520:{f:Sre},523:{},545:{f:A4},549:{f:m4},566:{},574:{f:Ore},638:{f:Mre},659:{},1048:{},1054:{f:Dre},1084:{},1212:{f:$re},2048:{f:rne},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Td},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Gs},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:sne,r:12},2173:{f:Fie,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Ir,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:Gre,r:12},2197:{},2198:{f:Iie,r:12},2199:{},2200:{},2201:{},2202:{f:Xre,r:12},2203:{f:Gs},2204:{},2205:{},2206:{},2207:{},2211:{f:_re},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Rr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:lne},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:ine},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:x4},1:{},2:{f:gne},3:{f:pne},4:{f:hne},5:{f:v4},7:{f:mne},8:{},9:{f:Td},11:{},22:{f:Rr},30:{f:Rre},31:{},32:{},33:{f:A4},36:{},37:{f:m4},50:{f:xne},62:{},52:{},67:{},68:{f:Rr},69:{},86:{},126:{},127:{f:dne},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:vne},223:{},234:{},354:{},421:{},518:{f:_m},521:{f:Td},536:{f:E4},547:{f:w4},561:{},579:{},1030:{f:_m},1033:{f:Td},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function ca(e,t,r,n){var i=t;if(!isNaN(i)){var a=(r||[]).length||0,o=e.next(4);o.write_shift(2,i),o.write_shift(2,a),a>0&&jP(r)&&e.push(r)}}function D4(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var i=e.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var a=e.match(/<\/table/i),o=i.index,c=a&&a.index||e.length,f=zee(e.slice(o,c),/(:?<tr[^>]*>)/i,"<tr>"),d=-1,h=0,m=0,v=0,w={s:{r:1e7,c:1e7},e:{r:0,c:0}},E=[];for(o=0;o<f.length;++o){var A=f[o].trim(),S=A.slice(0,3).toLowerCase();if(S=="<tr"){if(++d,r.sheetRows&&r.sheetRows<=d){--d;break}h=0;continue}if(!(S!="<td"&&S!="<th")){var b=A.split(/<\/t[dh]>/i);for(c=0;c<b.length;++c){var T=b[c].trim();if(T.match(/<t[dh]/i)){for(var _=T,N=0;_.charAt(0)=="<"&&(N=_.indexOf(">"))>-1;)_=_.slice(N+1);for(var M=0;M<E.length;++M){var R=E[M];R.s.c==h&&R.s.r<d&&d<=R.e.r&&(h=R.e.c+1,M=-1)}var P=ot(T.slice(0,T.indexOf(">")));v=P.colspan?+P.colspan:1,((m=+P.rowspan)>1||v>1)&&E.push({s:{r:d,c:h},e:{r:d+(m||1)-1,c:h+v-1}});var z=P.t||P["data-t"]||"";if(!_.length){h+=v;continue}if(_=bP(_),w.s.r>d&&(w.s.r=d),w.e.r<d&&(w.e.r=d),w.s.c>h&&(w.s.c=h),w.e.c<h&&(w.e.c=h),!_.length){h+=v;continue}var B={t:"s",v:_};r.raw||!_.trim().length||z=="s"||(_==="TRUE"?B={t:"b",v:!0}:_==="FALSE"?B={t:"b",v:!1}:isNaN(Aa(_))?isNaN(Uc(_).getDate())||(B={t:"d",v:ln(_)},r.cellDates||(B={t:"n",v:qn(B.v)}),B.z=r.dateNF||ft[14]):B={t:"n",v:Aa(_)}),r.dense?(n[d]||(n[d]=[]),n[d][h]=B):n[ct({r:d,c:h})]=B,h+=v}}}}return n["!ref"]=Tt(w),E.length&&(n["!merges"]=E),n}function xle(e,t,r,n){for(var i=e["!merges"]||[],a=[],o=t.s.c;o<=t.e.c;++o){for(var c=0,f=0,d=0;d<i.length;++d)if(!(i[d].s.r>r||i[d].s.c>o)&&!(i[d].e.r<r||i[d].e.c<o)){if(i[d].s.r<r||i[d].s.c<o){c=-1;break}c=i[d].e.r-i[d].s.r+1,f=i[d].e.c-i[d].s.c+1;break}if(!(c<0)){var h=ct({r,c:o}),m=n.dense?(e[r]||[])[o]:e[h],v=m&&m.v!=null&&(m.h||$w(m.w||(_s(m),m.w)||""))||"",w={};c>1&&(w.rowspan=c),f>1&&(w.colspan=f),n.editable?v='<span contenteditable="true">'+v+"</span>":m&&(w["data-t"]=m&&m.t||"z",m.v!=null&&(w["data-v"]=m.v),m.z!=null&&(w["data-z"]=m.z),m.l&&(m.l.Target||"#").charAt(0)!="#"&&(v='<a href="'+m.l.Target+'">'+v+"</a>")),w.id=(n.id||"sjs")+"-"+h,a.push(nte("td",v,w))}}var E="<tr>";return E+a.join("")+"</tr>"}var vle='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',yle="</body></html>";function wle(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return ko(D4(r[0],t),t);var n=uE();return r.forEach(function(i,a){fE(n,D4(i,t),"Sheet"+(a+1))}),n}function Ele(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function Ale(e,t){var r=t||{},n=r.header!=null?r.header:vle,i=r.footer!=null?r.footer:yle,a=[n],o=nu(e["!ref"]);r.dense=Array.isArray(e),a.push(Ele(e,o,r));for(var c=o.s.r;c<=o.e.r;++c)a.push(xle(e,o,c,r));return a.push("</table>"+i),a.join("")}function N5(e,t,r){var n=r||{},i=0,a=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var o=typeof n.origin=="string"?$n(n.origin):n.origin;i=o.r,a=o.c}var c=t.getElementsByTagName("tr"),f=Math.min(n.sheetRows||1e7,c.length),d={s:{r:0,c:0},e:{r:i,c:a}};if(e["!ref"]){var h=nu(e["!ref"]);d.s.r=Math.min(d.s.r,h.s.r),d.s.c=Math.min(d.s.c,h.s.c),d.e.r=Math.max(d.e.r,h.e.r),d.e.c=Math.max(d.e.c,h.e.c),i==-1&&(d.e.r=i=h.e.r+1)}var m=[],v=0,w=e["!rows"]||(e["!rows"]=[]),E=0,A=0,S=0,b=0,T=0,_=0;for(e["!cols"]||(e["!cols"]=[]);E<c.length&&A<f;++E){var N=c[E];if(R4(N)){if(n.display)continue;w[A]={hidden:!0}}var M=N.children;for(S=b=0;S<M.length;++S){var R=M[S];if(!(n.display&&R4(R))){var P=R.hasAttribute("data-v")?R.getAttribute("data-v"):R.hasAttribute("v")?R.getAttribute("v"):bP(R.innerHTML),z=R.getAttribute("data-z")||R.getAttribute("z");for(v=0;v<m.length;++v){var B=m[v];B.s.c==b+a&&B.s.r<A+i&&A+i<=B.e.r&&(b=B.e.c+1-a,v=-1)}_=+R.getAttribute("colspan")||1,((T=+R.getAttribute("rowspan")||1)>1||_>1)&&m.push({s:{r:A+i,c:b+a},e:{r:A+i+(T||1)-1,c:b+a+(_||1)-1}});var re={t:"s",v:P},ee=R.getAttribute("data-t")||R.getAttribute("t")||"";P!=null&&(P.length==0?re.t=ee||"z":n.raw||P.trim().length==0||ee=="s"||(P==="TRUE"?re={t:"b",v:!0}:P==="FALSE"?re={t:"b",v:!1}:isNaN(Aa(P))?isNaN(Uc(P).getDate())||(re={t:"d",v:ln(P)},n.cellDates||(re={t:"n",v:qn(re.v)}),re.z=n.dateNF||ft[14]):re={t:"n",v:Aa(P)})),re.z===void 0&&z!=null&&(re.z=z);var V="",de=R.getElementsByTagName("A");if(de&&de.length)for(var pe=0;pe<de.length&&!(de[pe].hasAttribute("href")&&(V=de[pe].getAttribute("href"),V.charAt(0)!="#"));++pe);V&&V.charAt(0)!="#"&&(re.l={Target:V}),n.dense?(e[A+i]||(e[A+i]=[]),e[A+i][b+a]=re):e[ct({c:b+a,r:A+i})]=re,d.e.c<b+a&&(d.e.c=b+a),b+=_}}++A}return m.length&&(e["!merges"]=(e["!merges"]||[]).concat(m)),d.e.r=Math.max(d.e.r,A-1+i),e["!ref"]=Tt(d),A>=f&&(e["!fullref"]=Tt((d.e.r=c.length-E+A-1+i,d))),e}function P5(e,t){var r=t||{},n=r.dense?[]:{};return N5(n,e,t)}function Cle(e,t){return ko(P5(e,t),t)}function R4(e){var t="",r=Sle(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function Sle(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function _le(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Nt(t.replace(/<[^>]*>/g,""));return[r]}var M4={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function D5(e,t){var r=t||{},n=Xw(e),i=[],a,o,c={name:""},f="",d=0,h,m,v={},w=[],E=r.dense?[]:{},A,S,b={value:""},T="",_=0,N=[],M=-1,R=-1,P={s:{r:1e6,c:1e7},e:{r:0,c:0}},z=0,B={},re=[],ee={},V=0,de=0,pe=[],K=1,Ce=1,ue=[],se={Names:[]},q={},fe=["",""],we=[],G={},le="",ne=0,ae=!1,he=!1,ke=0;for(X0.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");A=X0.exec(n);)switch(A[3]=A[3].replace(/_.*$/,"")){case"table":case"":A[1]==="/"?(P.e.c>=P.s.c&&P.e.r>=P.s.r?E["!ref"]=Tt(P):E["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=P.e.r&&(E["!fullref"]=E["!ref"],P.e.r=r.sheetRows-1,E["!ref"]=Tt(P)),re.length&&(E["!merges"]=re),pe.length&&(E["!rows"]=pe),h.name=h.||h.name,typeof JSON<"u"&&JSON.stringify(h),w.push(h.name),v[h.name]=E,he=!1):A[0].charAt(A[0].length-2)!=="/"&&(h=ot(A[0],!1),M=R=-1,P.s.r=P.s.c=1e7,P.e.r=P.e.c=0,E=r.dense?[]:{},re=[],pe=[],he=!0);break;case"table-row-group":A[1]==="/"?--z:++z;break;case"table-row":case"":if(A[1]==="/"){M+=K,K=1;break}if(m=ot(A[0],!1),m.?M=m.-1:M==-1&&(M=0),K=+m["number-rows-repeated"]||1,K<10)for(ke=0;ke<K;++ke)z>0&&(pe[M+ke]={level:z});R=-1;break;case"covered-table-cell":A[1]!=="/"&&++R,r.sheetStubs&&(r.dense?(E[M]||(E[M]=[]),E[M][R]={t:"z"}):E[ct({r:M,c:R})]={t:"z"}),T="",N=[];break;case"table-cell":case"":if(A[0].charAt(A[0].length-2)==="/")++R,b=ot(A[0],!1),Ce=parseInt(b["number-columns-repeated"]||"1",10),S={t:"z",v:null},b.formula&&r.cellFormula!=!1&&(S.f=k4(Nt(b.formula))),(b.||b["value-type"])=="string"&&(S.t="s",S.v=Nt(b["string-value"]||""),r.dense?(E[M]||(E[M]=[]),E[M][R]=S):E[ct({r:M,c:R})]=S),R+=Ce-1;else if(A[1]!=="/"){++R,T="",_=0,N=[],Ce=1;var De=K?M+K-1:M;if(R>P.e.c&&(P.e.c=R),R<P.s.c&&(P.s.c=R),M<P.s.r&&(P.s.r=M),De>P.e.r&&(P.e.r=De),b=ot(A[0],!1),we=[],G={},S={t:b.||b["value-type"],v:null},r.cellFormula)if(b.formula&&(b.formula=Nt(b.formula)),b["number-matrix-columns-spanned"]&&b["number-matrix-rows-spanned"]&&(V=parseInt(b["number-matrix-rows-spanned"],10)||0,de=parseInt(b["number-matrix-columns-spanned"],10)||0,ee={s:{r:M,c:R},e:{r:M+V-1,c:R+de-1}},S.F=Tt(ee),ue.push([ee,S.F])),b.formula)S.f=k4(b.formula);else for(ke=0;ke<ue.length;++ke)M>=ue[ke][0].s.r&&M<=ue[ke][0].e.r&&R>=ue[ke][0].s.c&&R<=ue[ke][0].e.c&&(S.F=ue[ke][1]);switch((b["number-columns-spanned"]||b["number-rows-spanned"])&&(V=parseInt(b["number-rows-spanned"],10)||0,de=parseInt(b["number-columns-spanned"],10)||0,ee={s:{r:M,c:R},e:{r:M+V-1,c:R+de-1}},re.push(ee)),b["number-columns-repeated"]&&(Ce=parseInt(b["number-columns-repeated"],10)),S.t){case"boolean":S.t="b",S.v=cr(b["boolean-value"]);break;case"float":S.t="n",S.v=parseFloat(b.value);break;case"percentage":S.t="n",S.v=parseFloat(b.value);break;case"currency":S.t="n",S.v=parseFloat(b.value);break;case"date":S.t="d",S.v=ln(b["date-value"]),r.cellDates||(S.t="n",S.v=qn(S.v)),S.z="m/d/yy";break;case"time":S.t="n",S.v=Bee(b["time-value"])/86400,r.cellDates&&(S.t="d",S.v=ag(S.v)),S.z="HH:MM:SS";break;case"number":S.t="n",S.v=parseFloat(b.);break;default:if(S.t==="string"||S.t==="text"||!S.t)S.t="s",b["string-value"]!=null&&(T=Nt(b["string-value"]),N=[]);else throw new Error("Unsupported value type "+S.t)}}else{if(ae=!1,S.t==="s"&&(S.v=T||"",N.length&&(S.R=N),ae=_==0),q.Target&&(S.l=q),we.length>0&&(S.c=we,we=[]),T&&r.cellText!==!1&&(S.w=T),ae&&(S.t="z",delete S.v),(!ae||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=M))for(var ce=0;ce<K;++ce){if(Ce=parseInt(b["number-columns-repeated"]||"1",10),r.dense)for(E[M+ce]||(E[M+ce]=[]),E[M+ce][R]=ce==0?S:An(S);--Ce>0;)E[M+ce][R+Ce]=An(S);else for(E[ct({r:M+ce,c:R})]=S;--Ce>0;)E[ct({r:M+ce,c:R+Ce})]=An(S);P.e.c<=R&&(P.e.c=R)}Ce=parseInt(b["number-columns-repeated"]||"1",10),R+=Ce-1,Ce=0,S={},T="",N=[]}q={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(A[1]==="/"){if((a=i.pop())[0]!==A[3])throw"Bad state: "+a}else A[0].charAt(A[0].length-2)!=="/"&&i.push([A[3],!0]);break;case"annotation":if(A[1]==="/"){if((a=i.pop())[0]!==A[3])throw"Bad state: "+a;G.t=T,N.length&&(G.R=N),G.a=le,we.push(G)}else A[0].charAt(A[0].length-2)!=="/"&&i.push([A[3],!1]);le="",ne=0,T="",_=0,N=[];break;case"creator":A[1]==="/"?le=n.slice(ne,A.index):ne=A.index+A[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(A[1]==="/"){if((a=i.pop())[0]!==A[3])throw"Bad state: "+a}else A[0].charAt(A[0].length-2)!=="/"&&i.push([A[3],!1]);T="",_=0,N=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(A[1]==="/"){if(B[c.name]=f,(a=i.pop())[0]!==A[3])throw"Bad state: "+a}else A[0].charAt(A[0].length-2)!=="/"&&(f="",c=ot(A[0],!1),i.push([A[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":o=ot(A[0],!1),f+=M4[A[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":o=ot(A[0],!1),f+=M4[A[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(A[0].slice(-2)==="/>")break;if(A[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":f+=n.slice(d,A.index);break}else d=A.index+A[0].length;break;case"named-range":o=ot(A[0],!1),fe=bm(o["cell-range-address"]);var be={Name:o.name,Ref:fe[0]+"!"+fe[1]};he&&(be.Sheet=w.length),se.Names.push(be);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(A[1]==="/"&&(!b||!b["string-value"])){var ze=_le(n.slice(_,A.index));T=(T.length>0?T+`
`:"")+ze[0]}else ot(A[0],!1),_=A.index+A[0].length;break;case"s":break;case"database-range":if(A[1]==="/")break;try{fe=bm(ot(A[0])["target-range-address"]),v[fe[0]]["!autofilter"]={ref:fe[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(A[1]!=="/"){if(q=ot(A[0],!1),!q.href)break;q.Target=Nt(q.href),delete q.href,q.Target.charAt(0)=="#"&&q.Target.indexOf(".")>-1?(fe=bm(q.Target.slice(1)),q.Target="#"+fe[0]+"!"+fe[1]):q.Target.match(/^\.\.[\\\/]/)&&(q.Target=q.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(A[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(A)}}var W={Sheets:v,SheetNames:w,Workbook:se};return r.bookSheets&&delete W.Sheets,W}function F4(e,t){t=t||{},Hi(e,"META-INF/manifest.xml")&&zte(Dr(e,"META-INF/manifest.xml"),t);var r=Ai(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=D5(qt(r),t);return Hi(e,"meta.xml")&&(n.Props=$P(Dr(e,"meta.xml"))),n}function L4(e,t){return D5(e,t)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function sE(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Fv(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):qt(kl(e))}function Lv(e){var t=e.reduce(function(i,a){return i+a.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(i){r.set(i,n),n+=i.length}),r}function B4(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function ble(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,i=t+13;i>=t;--i)n=n*256+e[i];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function q0(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Xr(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Mn(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],i=q0(e,r),a=i&7;i=Math.floor(i/8);var o=0,c;if(i==0)break;switch(a){case 0:{for(var f=r[0];e[r[0]++]>=128;);c=e.slice(f,r[0])}break;case 5:o=4,c=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,c=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=q0(e,r),c=e.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(i," at offset ").concat(n))}var d={data:c,type:a};t[i]==null?t[i]=[d]:t[i].push(d)}return t}function oE(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function Tle(e){for(var t,r=[],n=[0];n[0]<e.length;){var i=q0(e,n),a=Mn(e.slice(n[0],n[0]+i));n[0]+=i;var o={id:Xr(a[1][0].data),messages:[]};a[2].forEach(function(c){var f=Mn(c.data),d=Xr(f[3][0].data);o.messages.push({meta:f,data:e.slice(n[0],n[0]+d)}),n[0]+=d}),(t=a[3])!=null&&t[0]&&(o.merge=Xr(a[3][0].data)>>>0>0),r.push(o)}return r}function Ole(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=q0(t,r),i=[];r[0]<t.length;){var a=t[r[0]]&3;if(a==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var c=o-59;o=t[r[0]],c>1&&(o|=t[r[0]+1]<<8),c>2&&(o|=t[r[0]+2]<<16),c>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=c}i.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var f=0,d=0;if(a==1?(d=(t[r[0]]>>2&7)+4,f=(t[r[0]++]&224)<<3,f|=t[r[0]++]):(d=(t[r[0]++]>>2)+1,a==2?(f=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(f=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),i=[Lv(i)],f==0)throw new Error("Invalid offset 0");if(f>i[0].length)throw new Error("Invalid offset beyond length");if(d>=f)for(i.push(i[0].slice(-f)),d-=f;d>=i[i.length-1].length;)i.push(i[i.length-1]),d-=i[i.length-1].length;i.push(i[0].slice(-f,-f+d))}}var h=Lv(i);if(h.length!=n)throw new Error("Unexpected length: ".concat(h.length," != ").concat(n));return h}function kle(e){for(var t=[],r=0;r<e.length;){var n=e[r++],i=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(Ole(n,e.slice(r,r+i))),r+=i}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Lv(t)}function Ile(e,t,r,n){var i=sE(e),a=i.getUint32(4,!0),o=(n>1?12:8)+B4(a&(n>1?3470:398))*4,c=-1,f=-1,d=NaN,h=new Date(2001,0,1);a&512&&(c=i.getUint32(o,!0),o+=4),o+=B4(a&(n>1?12288:4096))*4,a&16&&(f=i.getUint32(o,!0),o+=4),a&32&&(d=i.getFloat64(o,!0),o+=8),a&64&&(h.setTime(h.getTime()+i.getFloat64(o,!0)*1e3),o+=8);var m;switch(e[2]){case 0:break;case 2:m={t:"n",v:d};break;case 3:m={t:"s",v:t[f]};break;case 5:m={t:"d",v:h};break;case 6:m={t:"b",v:d>0};break;case 7:m={t:"n",v:d/86400};break;case 8:m={t:"e",v:0};break;case 9:if(c>-1)m={t:"s",v:r[c]};else if(f>-1)m={t:"s",v:t[f]};else if(!isNaN(d))m={t:"n",v:d};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return m}function Nle(e,t,r){var n=sE(e),i=n.getUint32(8,!0),a=12,o=-1,c=-1,f=NaN,d=NaN,h=new Date(2001,0,1);i&1&&(f=ble(e,a),a+=16),i&2&&(d=n.getFloat64(a,!0),a+=8),i&4&&(h.setTime(h.getTime()+n.getFloat64(a,!0)*1e3),a+=8),i&8&&(c=n.getUint32(a,!0),a+=4),i&16&&(o=n.getUint32(a,!0),a+=4);var m;switch(e[1]){case 0:break;case 2:m={t:"n",v:f};break;case 3:m={t:"s",v:t[c]};break;case 5:m={t:"d",v:h};break;case 6:m={t:"b",v:d>0};break;case 7:m={t:"n",v:d/86400};break;case 8:m={t:"e",v:0};break;case 9:if(o>-1)m={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)));break;case 10:m={t:"n",v:f};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)))}return m}function Ple(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return Ile(e,t,r,e[0]);case 5:return Nle(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function mo(e){var t=Mn(e);return q0(t[1][0].data)}function j4(e,t){var r=Mn(t.data),n=Xr(r[1][0].data),i=r[3],a=[];return(i||[]).forEach(function(o){var c=Mn(o.data),f=Xr(c[1][0].data)>>>0;switch(n){case 1:a[f]=Fv(c[3][0].data);break;case 8:{var d=e[mo(c[9][0].data)][0],h=Mn(d.data),m=e[mo(h[1][0].data)][0],v=Xr(m.meta[1][0].data);if(v!=2001)throw new Error("2000 unexpected reference to ".concat(v));var w=Mn(m.data);a[f]=w[3].map(function(E){return Fv(E.data)}).join("")}break}}),a}function Dle(e,t){var r,n,i,a,o,c,f,d,h,m,v,w,E,A,S=Mn(e),b=Xr(S[1][0].data)>>>0,T=Xr(S[2][0].data)>>>0,_=((n=(r=S[8])==null?void 0:r[0])==null?void 0:n.data)&&Xr(S[8][0].data)>0||!1,N,M;if((a=(i=S[7])==null?void 0:i[0])!=null&&a.data&&t!=0)N=(c=(o=S[7])==null?void 0:o[0])==null?void 0:c.data,M=(d=(f=S[6])==null?void 0:f[0])==null?void 0:d.data;else if((m=(h=S[4])==null?void 0:h[0])!=null&&m.data&&t!=1)N=(w=(v=S[4])==null?void 0:v[0])==null?void 0:w.data,M=(A=(E=S[3])==null?void 0:E[0])==null?void 0:A.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var R=_?4:1,P=sE(N),z=[],B=0;B<N.length/2;++B){var re=P.getUint16(B*2,!0);re<65535&&z.push([B,re])}if(z.length!=T)throw"Expected ".concat(T," cells, found ").concat(z.length);var ee=[];for(B=0;B<z.length-1;++B)ee[z[B][0]]=M.subarray(z[B][1]*R,z[B+1][1]*R);return z.length>=1&&(ee[z[z.length-1][0]]=M.subarray(z[z.length-1][1]*R)),{R:b,cells:ee}}function Rle(e,t){var r,n=Mn(t.data),i=(r=n==null?void 0:n[7])!=null&&r[0]?Xr(n[7][0].data)>>>0>0?1:0:-1,a=oE(n[5],function(o){return Dle(o,i)});return{nrows:Xr(n[4][0].data)>>>0,data:a.reduce(function(o,c){return o[c.R]||(o[c.R]=[]),c.cells.forEach(function(f,d){if(o[c.R][d])throw new Error("Duplicate cell r=".concat(c.R," c=").concat(d));o[c.R][d]=f}),o},[])}}function Mle(e,t,r){var n,i=Mn(t.data),a={s:{r:0,c:0},e:{r:0,c:0}};if(a.e.r=(Xr(i[6][0].data)>>>0)-1,a.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(a.e.c=(Xr(i[7][0].data)>>>0)-1,a.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=Tt(a);var o=Mn(i[4][0].data),c=j4(e,e[mo(o[4][0].data)][0]),f=(n=o[17])!=null&&n[0]?j4(e,e[mo(o[17][0].data)][0]):[],d=Mn(o[3][0].data),h=0;d[1].forEach(function(m){var v=Mn(m.data),w=e[mo(v[2][0].data)][0],E=Xr(w.meta[1][0].data);if(E!=6002)throw new Error("6001 unexpected reference to ".concat(E));var A=Rle(e,w);A.data.forEach(function(S,b){S.forEach(function(T,_){var N=ct({r:h+b,c:_}),M=Ple(T,c,f);M&&(r[N]=M)})}),h+=A.nrows})}function Fle(e,t){var r=Mn(t.data),n={"!ref":"A1"},i=e[mo(r[2][0].data)],a=Xr(i[0].meta[1][0].data);if(a!=6001)throw new Error("6000 unexpected reference to ".concat(a));return Mle(e,i[0],n),n}function Lle(e,t){var r,n=Mn(t.data),i={name:(r=n[1])!=null&&r[0]?Fv(n[1][0].data):"",sheets:[]},a=oE(n[2],mo);return a.forEach(function(o){e[o].forEach(function(c){var f=Xr(c.meta[1][0].data);f==6e3&&i.sheets.push(Fle(e,c))})}),i}function Ble(e,t){var r=uE(),n=Mn(t.data),i=oE(n[1],mo);if(i.forEach(function(a){e[a].forEach(function(o){var c=Xr(o.meta[1][0].data);if(c==2){var f=Lle(e,o);f.sheets.forEach(function(d,h){fE(r,d,h==0?f.name:f.name+"_"+h,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Om(e){var t,r,n,i,a={},o=[];if(e.FullPaths.forEach(function(f){if(f.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(f){if(f.name.match(/\.iwa$/)){var d;try{d=kle(f.content)}catch(m){return console.log("?? "+f.content.length+" "+(m.message||m))}var h;try{h=Tle(d)}catch(m){return console.log("## "+(m.message||m))}h.forEach(function(m){a[m.id]=m.messages,o.push(m.id)})}}),!o.length)throw new Error("File has no messages");var c=((i=(n=(r=(t=a==null?void 0:a[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&Xr(a[1][0].meta[1][0].data)==1&&a[1][0];if(c||o.forEach(function(f){a[f].forEach(function(d){var h=Xr(d.meta[1][0].data)>>>0;if(h==1)if(!c)c=d;else throw new Error("Document has multiple roots")})}),!c)throw new Error("Cannot find Document root");return Ble(a,c)}function jle(e){return function(r){for(var n=0;n!=e.length;++n){var i=e[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function lE(e){jle([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Ule(e){return fc.WS.indexOf(e)>-1?"sheet":e==fc.CS?"chart":e==fc.DS?"dialog":e==fc.MS?"macro":e&&e.length?e:"sheet"}function zle(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,Ule(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function Wle(e,t,r,n,i,a,o,c,f,d,h,m){try{a[n]=i0(Ai(e,r,!0),t);var v=Dr(e,t),w;switch(c){case"sheet":w=Koe(v,t,i,f,a[n],d,h,m);break;case"chart":if(w=Yoe(v,t,i,f,a[n],d,h,m),!w||!w["!drawel"])break;var E=Vu(w["!drawel"].Target,t),A=Nv(E),S=Xie(Ai(e,E,!0),i0(Ai(e,A,!0),E)),b=Vu(S,E),T=Nv(b);w=Noe(Ai(e,b,!0),b,f,i0(Ai(e,T,!0),b),d,w);break;case"macro":w=Zoe(v,t,i,f,a[n],d,h,m);break;case"dialog":w=qoe(v,t,i,f,a[n],d,h,m);break;default:throw new Error("Unrecognized sheet type "+c)}o[n]=w;var _=[];a&&a[n]&&Ka(a[n]).forEach(function(N){var M="";if(a[n][N].Type==fc.CMNT){M=Vu(a[n][N].Target,t);var R=tle(Dr(e,M,!0),M,f);if(!R||!R.length)return;S4(w,R,!1)}a[n][N].Type==fc.TCMNT&&(M=Vu(a[n][N].Target,t),_=_.concat(Yie(Dr(e,M,!0),f)))}),_&&_.length&&S4(w,_,!0,f.people||[])}catch(N){if(f.WTF)throw N}}function Ui(e){return e.charAt(0)=="/"?e.slice(1):e}function Vle(e,t){if(xP(),t=t||{},lE(t),Hi(e,"META-INF/manifest.xml")||Hi(e,"objectdata.xml"))return F4(e,t);if(Hi(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Om<"u"){if(e.FileIndex)return Om(e);var r=bt.utils.cfb_new();return q_(e).forEach(function(pe){Hee(r,pe,Vee(e,pe))}),Om(r)}throw new Error("Unsupported NUMBERS file")}if(!Hi(e,"[Content_Types].xml"))throw Hi(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Hi(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=q_(e),i=jte(Ai(e,"[Content_Types].xml")),a=!1,o,c;if(i.workbooks.length===0&&(c="xl/workbook.xml",Dr(e,c,!0)&&i.workbooks.push(c)),i.workbooks.length===0){if(c="xl/workbook.bin",!Dr(e,c,!0))throw new Error("Could not find workbook");i.workbooks.push(c),a=!0}i.workbooks[0].slice(-3)=="bin"&&(a=!0);var f={},d={};if(!t.bookSheets&&!t.bookProps){if(o0=[],i.sst)try{o0=ele(Dr(e,Ui(i.sst)),i.sst,t)}catch(pe){if(t.WTF)throw pe}t.cellStyles&&i.themes.length&&(f=Joe(Ai(e,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],t)),i.style&&(d=Qoe(Dr(e,Ui(i.style)),i.style,f,t))}i.links.map(function(pe){try{var K=i0(Ai(e,Nv(Ui(pe))),pe);return nle(Dr(e,Ui(pe)),K,pe,t)}catch{}});var h=Xoe(Dr(e,Ui(i.workbooks[0])),i.workbooks[0],t),m={},v="";i.coreprops.length&&(v=Dr(e,Ui(i.coreprops[0]),!0),v&&(m=$P(v)),i.extprops.length!==0&&(v=Dr(e,Ui(i.extprops[0]),!0),v&&Hte(v,m,t)));var w={};(!t.bookSheets||t.bookProps)&&i.custprops.length!==0&&(v=Ai(e,Ui(i.custprops[0]),!0),v&&(w=$te(v,t)));var E={};if((t.bookSheets||t.bookProps)&&(h.Sheets?o=h.Sheets.map(function(K){return K.name}):m.Worksheets&&m.SheetNames.length>0&&(o=m.SheetNames),t.bookProps&&(E.Props=m,E.Custprops=w),t.bookSheets&&typeof o<"u"&&(E.SheetNames=o),t.bookSheets?E.SheetNames:t.bookProps))return E;o={};var A={};t.bookDeps&&i.calcchain&&(A=rle(Dr(e,Ui(i.calcchain)),i.calcchain));var S=0,b={},T,_;{var N=h.Sheets;m.Worksheets=N.length,m.SheetNames=[];for(var M=0;M!=N.length;++M)m.SheetNames[M]=N[M].name}var R=a?"bin":"xml",P=i.workbooks[0].lastIndexOf("/"),z=(i.workbooks[0].slice(0,P+1)+"_rels/"+i.workbooks[0].slice(P+1)+".rels").replace(/^\//,"");Hi(e,z)||(z="xl/_rels/workbook."+R+".rels");var B=i0(Ai(e,z,!0),z.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(t.xlmeta=ile(Dr(e,Ui(i.metadata[0])),i.metadata[0],t)),(i.people||[]).length>=1&&(t.people=Zie(Dr(e,Ui(i.people[0])),t)),B&&(B=zle(B,h.Sheets));var re=Dr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(S=0;S!=m.Worksheets;++S){var ee="sheet";if(B&&B[S]?(T="xl/"+B[S][1].replace(/[\/]?xl\//,""),Hi(e,T)||(T=B[S][1]),Hi(e,T)||(T=z.replace(/_rels\/.*$/,"")+B[S][1]),ee=B[S][2]):(T="xl/worksheets/sheet"+(S+1-re)+"."+R,T=T.replace(/sheet0\./,"sheet.")),_=T.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(S!=t.sheets)continue e;break;case"string":if(m.SheetNames[S].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var V=!1,de=0;de!=t.sheets.length;++de)typeof t.sheets[de]=="number"&&t.sheets[de]==S&&(V=1),typeof t.sheets[de]=="string"&&t.sheets[de].toLowerCase()==m.SheetNames[S].toLowerCase()&&(V=1);if(!V)continue e}}Wle(e,T,_,m.SheetNames[S],S,b,o,ee,t,h,f,d)}return E={Directory:i,Workbook:h,Props:m,Custprops:w,Deps:A,Sheets:o,SheetNames:m.SheetNames,Strings:o0,Styles:d,Themes:f,SSF:An(ft)},t&&t.bookFiles&&(e.files?(E.keys=n,E.files=e.files):(E.keys=[],E.files={},e.FullPaths.forEach(function(pe,K){pe=pe.replace(/^Root Entry[\/]/,""),E.keys.push(pe),E.files[pe]=e.FileIndex[K]}))),t&&t.bookVBA&&(i.vba.length>0?E.vbaraw=Dr(e,Ui(i.vba[0]),!0):i.defaults&&i.defaults.bin===eae&&(E.vbaraw=Dr(e,"xl/vbaProject.bin",!0))),E}function Hle(e,t){var r=t||{},n="Workbook",i=bt.find(e,n);try{if(n="/!DataSpaces/Version",i=bt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(Fne(i.content),n="/!DataSpaces/DataSpaceMap",i=bt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=Bne(i.content);if(a.length!==1||a[0].comps.length!==1||a[0].comps[0].t!==0||a[0].name!=="StrongEncryptionDataSpace"||a[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=bt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=jne(i.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=bt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);zne(i.content)}catch{}if(n="/EncryptionInfo",i=bt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var c=Wne(i.content);if(n="/EncryptedPackage",i=bt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(c[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(c[1],i.content,r.password||"",r);if(c[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(c[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function cE(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=ki(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function Gle(e,t){return bt.find(e,"EncryptedPackage")?Hle(e,t):I5(e,t)}function $le(e,t){var r,n=e,i=t||{};return i.type||(i.type=Ct&&Buffer.isBuffer(e)?"buffer":"base64"),r=CP(n,i),Vle(r,i)}function R5(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Rv(e.slice(r),t);default:break e}return K0.to_workbook(e,t)}function Xle(e,t){var r="",n=cE(e,t);switch(t.type){case"base64":r=ki(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=yl(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=qt(r)),t.type="binary",R5(r,t)}function Kle(e,t){var r=e;return t.type=="base64"&&(r=ki(r)),r=H0.utils.decode(1200,r.slice(2),"str"),t.type="binary",R5(r,t)}function Yle(e){return e.match(/[^\x00-\x7F]/)?Hu(e):e}function km(e,t,r,n){return n?(r.type="string",K0.to_workbook(e,r)):K0.to_workbook(t,r)}function Bv(e,t){aP();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Bv(new Uint8Array(e),(r=An(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,i=[0,0,0,0],a=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Ac={},r.dateNF&&(Ac.dateNF=r.dateNF),r.type||(r.type=Ct&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Ct?"buffer":"binary",n=Fee(e),typeof Uint8Array<"u"&&!Ct&&(r.type="array")),r.type=="string"&&(a=!0,r.type="binary",r.codepage=65001,n=Yle(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),c=new Uint8Array(o);if(c.foo="bar",!c.foo)return r=An(r),r.type="array",Bv(zw(n),r)}switch((i=cE(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return Gle(bt.read(n,r),r);break;case 9:if(i[1]<=8)return I5(n,r);break;case 60:return Rv(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return Cne(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return Ene.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?$le(n,r):km(e,n,r,a);case 239:return i[3]===60?Rv(n,r):km(e,n,r,a);case 255:if(i[1]===254)return Kle(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return s0.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return s0.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return C4.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return eie.to_workbook(n,r);break;case 10:case 13:case 32:return Xle(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return yne.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?C4.to_workbook(n,r):km(e,n,r,a)}function Zle(e,t,r,n,i,a,o,c){var f=Cn(r),d=c.defval,h=c.raw||!Object.prototype.hasOwnProperty.call(c,"raw"),m=!0,v=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(v,"__rowNum__",{value:r,enumerable:!1})}catch{v.__rowNum__=r}else v.__rowNum__=r;if(!o||e[r])for(var w=t.s.c;w<=t.e.c;++w){var E=o?e[r][w]:e[n[w]+f];if(E===void 0||E.t===void 0){if(d===void 0)continue;a[w]!=null&&(v[a[w]]=d);continue}var A=E.v;switch(E.t){case"z":if(A==null)break;continue;case"e":A=A==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+E.t)}if(a[w]!=null){if(A==null)if(E.t=="e"&&A===null)v[a[w]]=null;else if(d!==void 0)v[a[w]]=d;else if(h&&A===null)v[a[w]]=null;else continue;else v[a[w]]=h&&(E.t!=="n"||E.t==="n"&&c.rawNumbers!==!1)?A:_s(E,A,c);A!=null&&(m=!1)}}return{row:v,isempty:m}}function jv(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,a=[],o=0,c="",f={s:{r:0,c:0},e:{r:0,c:0}},d=t||{},h=d.range!=null?d.range:e["!ref"];switch(d.header===1?n=1:d.header==="A"?n=2:Array.isArray(d.header)?n=3:d.header==null&&(n=0),typeof h){case"string":f=Tr(h);break;case"number":f=Tr(e["!ref"]),f.s.r=h;break;default:f=h}n>0&&(i=0);var m=Cn(f.s.r),v=[],w=[],E=0,A=0,S=Array.isArray(e),b=f.s.r,T=0,_={};S&&!e[b]&&(e[b]=[]);var N=d.skipHidden&&e["!cols"]||[],M=d.skipHidden&&e["!rows"]||[];for(T=f.s.c;T<=f.e.c;++T)if(!(N[T]||{}).hidden)switch(v[T]=$r(T),r=S?e[b][T]:e[v[T]+m],n){case 1:a[T]=T-f.s.c;break;case 2:a[T]=v[T];break;case 3:a[T]=d.header[T-f.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),c=o=_s(r,null,d),A=_[o]||0,!A)_[o]=1;else{do c=o+"_"+A++;while(_[c]);_[o]=A,_[c]=1}a[T]=c}for(b=f.s.r+i;b<=f.e.r;++b)if(!(M[b]||{}).hidden){var R=Zle(e,f,b,v,n,a,S,d);(R.isempty===!1||(n===1?d.blankrows!==!1:d.blankrows))&&(w[E++]=R.row)}return w.length=E,w}var U4=/"/g;function qle(e,t,r,n,i,a,o,c){for(var f=!0,d=[],h="",m=Cn(r),v=t.s.c;v<=t.e.c;++v)if(n[v]){var w=c.dense?(e[r]||[])[v]:e[n[v]+m];if(w==null)h="";else if(w.v!=null){f=!1,h=""+(c.rawNumbers&&w.t=="n"?w.v:_s(w,null,c));for(var E=0,A=0;E!==h.length;++E)if((A=h.charCodeAt(E))===i||A===a||A===34||c.forceQuotes){h='"'+h.replace(U4,'""')+'"';break}h=="ID"&&(h='"ID"')}else w.f!=null&&!w.F?(f=!1,h="="+w.f,h.indexOf(",")>=0&&(h='"'+h.replace(U4,'""')+'"')):h="";d.push(h)}return c.blankrows===!1&&f?null:d.join(o)}function M5(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var i=Tr(e["!ref"]),a=n.FS!==void 0?n.FS:",",o=a.charCodeAt(0),c=n.RS!==void 0?n.RS:`
`,f=c.charCodeAt(0),d=new RegExp((a=="|"?"\\|":a)+"+$"),h="",m=[];n.dense=Array.isArray(e);for(var v=n.skipHidden&&e["!cols"]||[],w=n.skipHidden&&e["!rows"]||[],E=i.s.c;E<=i.e.c;++E)(v[E]||{}).hidden||(m[E]=$r(E));for(var A=0,S=i.s.r;S<=i.e.r;++S)(w[S]||{}).hidden||(h=qle(e,i,S,m,o,f,a,n),h!=null&&(n.strip&&(h=h.replace(d,"")),(h||n.blankrows!==!1)&&r.push((A++?c:"")+h)));return delete n.dense,r.join("")}function Qle(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=M5(e,t);return r}function Jle(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var i=Tr(e["!ref"]),a="",o=[],c,f=[],d=Array.isArray(e);for(c=i.s.c;c<=i.e.c;++c)o[c]=$r(c);for(var h=i.s.r;h<=i.e.r;++h)for(a=Cn(h),c=i.s.c;c<=i.e.c;++c)if(t=o[c]+a,r=d?(e[h]||[])[c]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}f[f.length]=t+"="+n}return f}function F5(e,t,r){var n=r||{},i=+!n.skipHeader,a=e||{},o=0,c=0;if(a&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var f=typeof n.origin=="string"?$n(n.origin):n.origin;o=f.r,c=f.c}var d,h={s:{c:0,r:0},e:{c,r:o+t.length-1+i}};if(a["!ref"]){var m=Tr(a["!ref"]);h.e.c=Math.max(h.e.c,m.e.c),h.e.r=Math.max(h.e.r,m.e.r),o==-1&&(o=m.e.r+1,h.e.r=o+t.length-1+i)}else o==-1&&(o=0,h.e.r=t.length-1+i);var v=n.header||[],w=0;t.forEach(function(A,S){Ka(A).forEach(function(b){(w=v.indexOf(b))==-1&&(v[w=v.length]=b);var T=A[b],_="z",N="",M=ct({c:c+w,r:o+S+i});d=Q0(a,M),T&&typeof T=="object"&&!(T instanceof Date)?a[M]=T:(typeof T=="number"?_="n":typeof T=="boolean"?_="b":typeof T=="string"?_="s":T instanceof Date?(_="d",n.cellDates||(_="n",T=qn(T)),N=n.dateNF||ft[14]):T===null&&n.nullError&&(_="e",T=0),d?(d.t=_,d.v=T,delete d.w,delete d.R,N&&(d.z=N)):a[M]=d={t:_,v:T},N&&(d.z=N))})}),h.e.c=Math.max(h.e.c,c+v.length-1);var E=Cn(o);if(i)for(w=0;w<v.length;++w)a[$r(w+c)+E]={t:"s",v:v[w]};return a["!ref"]=Tt(h),a}function ece(e,t){return F5(null,e,t)}function Q0(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=$n(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Q0(e,ct(t)):Q0(e,ct({r:t,c:r||0}))}function tce(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function uE(){return{SheetNames:[],Sheets:{}}}function fE(e,t,r,n){var i=1;if(!r)for(;i<=65535&&e.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);i=a&&+a[2]||0;var o=a&&a[1]||r;for(++i;i<=65535&&e.SheetNames.indexOf(r=o+i)!=-1;++i);}if(joe(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function rce(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=tce(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function nce(e,t){return e.z=t,e}function L5(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function ice(e,t,r){return L5(e,"#"+t,r)}function ace(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function sce(e,t,r,n){for(var i=typeof t!="string"?t:Tr(t),a=typeof t=="string"?t:Tt(t),o=i.s.r;o<=i.e.r;++o)for(var c=i.s.c;c<=i.e.c;++c){var f=Q0(e,o,c);f.t="n",f.F=a,delete f.v,o==i.s.r&&c==i.s.c&&(f.f=r,n&&(f.D=!0))}return e}var oce={encode_col:$r,encode_row:Cn,encode_cell:ct,encode_range:Tt,decode_col:Zw,decode_row:Yw,split_cell:vte,decode_cell:$n,decode_range:nu,format_cell:_s,sheet_add_aoa:zP,sheet_add_json:F5,sheet_add_dom:N5,aoa_to_sheet:iu,json_to_sheet:ece,table_to_sheet:P5,table_to_book:Cle,sheet_to_csv:M5,sheet_to_txt:Qle,sheet_to_json:jv,sheet_to_html:Ale,sheet_to_formulae:Jle,sheet_to_row_object_array:jv,sheet_get_cell:Q0,book_new:uE,book_append_sheet:fE,book_set_sheet_visibility:rce,cell_set_number_format:nce,cell_set_hyperlink:L5,cell_set_internal_link:ice,cell_add_comment:ace,sheet_set_array_formula:sce,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const Im={Radiology:{Icon:T0,color:"#0ea5e9",gradient:"linear-gradient(135deg, #0ea5e9 0%, #0284c7 100%)"},Cardiology:{Icon:s7,color:"#ef4444",gradient:"linear-gradient(135deg, #ef4444 0%, #dc2626 100%)"},MLT:{Icon:n7,color:"#8b5cf6",gradient:"linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%)"},Emergency:{Icon:YM,color:"#f59e0b",gradient:"linear-gradient(135deg, #f59e0b 0%, #d97706 100%)"},Dental:{Icon:C7,color:"#06b6d4",gradient:"linear-gradient(135deg, #06b6d4 0%, #0891b2 100%)"},Surgical:{Icon:QM,color:"#10b981",gradient:"linear-gradient(135deg, #10b981 0%, #059669 100%)"},Optometry:{Icon:t7,color:"#6366f1",gradient:"linear-gradient(135deg, #6366f1 0%, #4f46e5 100%)"}};function lce({isAdmin:e=!0}){var ue;const{addToast:t}=Cl(),[r,n]=I.useState([]),[i,a]=I.useState([]),[o,c]=I.useState({name:"",department:""}),[f,d]=I.useState(!1),[h,m]=I.useState(!1),[v,w]=I.useState(!1),[E,A]=I.useState(!1),[S,b]=I.useState(null),[T,_]=I.useState(null),[N,M]=I.useState(null),[R,P]=I.useState(null),z=rr.useRef(null),B=I.useCallback(async()=>{try{const q=await(await fetch(`${Ut}/students/departments`,{credentials:"include"})).json();n(q.departments||[])}catch{n([])}},[]),re=I.useCallback(async()=>{d(!0);try{const se=await fetch(`${Ut}/students`,{credentials:"include"}),q=await se.json();if(!se.ok)throw new Error(q.message||"Failed to load students");a(q)}catch(se){t({message:se.message||"Failed to load students",type:"error",size:"small"}),a([])}finally{d(!1)}},[t]);I.useEffect(()=>{B()},[B]),I.useEffect(()=>{re()},[re]);const ee=rr.useMemo(()=>{const se={};return r.forEach(q=>{se[q]=[]}),i.forEach(q=>{se[q.department]&&se[q.department].push(q)}),se},[i,r]),V=async se=>{se.preventDefault();const q=(o.name||"").trim(),fe=(o.department||"").trim();if(!q||!fe){t({message:"Name and department are required",type:"error",size:"small"});return}m(!0);try{const we=await fetch(`${Ut}/students`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({name:q,department:fe})}),G=await we.json();if(!we.ok)throw new Error(G.message||"Failed to add student");_(fe),b(fe),c({name:"",department:""}),t({message:`${G.name} added to ${fe}`,type:"success",size:"small"}),await re(),setTimeout(()=>_(null),1500)}catch(we){t({message:we.message||"Failed to add student",type:"error",size:"small"})}finally{m(!1)}},de=async se=>{if(window.confirm("Delete this student?"))try{const q=await fetch(`${Ut}/students/${se}`,{method:"DELETE",credentials:"include"}),fe=await q.json();if(!q.ok)throw new Error(fe.message||"Delete failed");t({message:"Student deleted",type:"success",size:"small"}),re()}catch(q){t({message:q.message||"Delete failed",type:"error",size:"small"})}},pe=se=>new Promise((q,fe)=>{const we=(se.name.split(".").pop()||"").toLowerCase(),G=new FileReader;G.onload=le=>{var ne;try{let ae=[];const he=(ne=le.target)==null?void 0:ne.result;if(we==="json"){const ke=JSON.parse(he);ae=Array.isArray(ke)?ke:[ke]}else if(we==="csv"){const ke=he.trim().split(/\n/).filter(Boolean);if(ke.length<2)return fe(new Error("CSV needs header + data"));const De=ke[0].split(/[,\t]/).map(ce=>ce.trim().toLowerCase().replace(/\s+/g,""));ae=ke.slice(1).map(ce=>{const be=ce.split(/[,\t]/).map(W=>W.trim()),ze={};return De.forEach((W,He)=>{const Ge=W==="studentid"?"studentId":W==="name"?"name":W==="department"?"department":W;ze[Ge]=be[He]||""}),ze})}else if(we==="xlsx"||we==="xls"){const ke=Bv(he,{type:"binary"}),De=ke.Sheets[ke.SheetNames[0]],ce=oce.sheet_to_json(De,{header:1,defval:""});if(ce.length<2)return fe(new Error("Excel needs header + data"));const ze=ce[0].map(W=>String(W||"").trim()).map(W=>W.toLowerCase().replace(/\s+|_/g,""));ae=ce.slice(1).map(W=>{const He=Array.isArray(W)?W:Object.values(W),Ge={};return ze.forEach((et,Ze)=>{let Ie=et;et==="studentid"||et==="student_id"?Ie="studentId":et==="name"?Ie="name":et==="department"&&(Ie="department"),Ge[Ie]=String(He[Ze]??"").trim()}),Ge})}else return fe(new Error("Use CSV, JSON, or XLS/XLSX"));q(ae)}catch(ae){fe(ae)}},G.onerror=()=>fe(new Error("Failed to read file")),we==="json"||we==="csv"?G.readAsText(se):we==="xlsx"||we==="xls"?G.readAsBinaryString(se):fe(new Error("Use CSV, JSON, or XLS/XLSX"))}),K=async()=>{if(window.confirm("Add 50 dummy students to each department (350 total)? IDs will be auto-generated.")){A(!0);try{const se=await fetch(`${Ut}/students/seed-dummy`,{method:"POST",credentials:"include"}),q=await se.json();if(!se.ok)throw new Error(q.message||"Seed failed");t({message:`Created ${q.created} students (${q.perDepartment} per department)`,type:"success",size:"small"}),await re()}catch(se){t({message:se.message||"Seed failed",type:"error",size:"small"})}finally{A(!1)}}},Ce=async se=>{var fe;const q=(fe=se.target.files)==null?void 0:fe[0];if(q){se.target.value="",P(null),w(!0);try{const we=await pe(q);if(!we.length)throw new Error("No valid records");const G=await fetch(`${Ut}/students/bulk`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({students:we})}),le=await G.json();if(!G.ok)throw new Error(le.message||"Import failed");P(le),t({message:`Imported ${le.created} students`,type:"success",size:"small"}),re()}catch(we){P({error:we.message}),t({message:we.message||"Import failed",type:"error",size:"small"})}finally{w(!1)}}};return k.jsxs("div",{className:"admin-section register-students-panel",children:[k.jsxs("div",{className:"panel-header",children:[k.jsx("div",{className:"panel-icon",children:k.jsx(R2,{size:20,strokeWidth:2})}),k.jsx("h3",{children:"Register Students"})]}),k.jsx("p",{className:"section-hint",children:"Add students by department. Each student is auto-assigned to their department card."}),k.jsxs("form",{className:"form-large student-form dept-form",onSubmit:V,children:[k.jsxs("div",{className:"form-row-inline",children:[k.jsxs("div",{className:"form-group",children:[k.jsx("label",{children:"Full Name"}),k.jsx("input",{name:"name",value:o.name,onChange:se=>c(q=>({...q,name:se.target.value})),className:"input-large",placeholder:"Student name",required:!0})]}),k.jsxs("div",{className:"form-group",children:[k.jsx("label",{children:"Department"}),k.jsxs("select",{name:"department",value:o.department,onChange:se=>c(q=>({...q,department:se.target.value})),className:"input-large select-professional",required:!0,children:[k.jsx("option",{value:"",children:"Select department..."}),r.map(se=>k.jsx("option",{value:se,children:se},se))]})]})]}),k.jsx("button",{type:"submit",className:"btn-primary-wide",disabled:h,children:h?k.jsxs(k.Fragment,{children:[k.jsx(Ic,{})," Adding..."]}):"+ Add Student"})]}),k.jsxs("div",{className:"bulk-row",children:[k.jsx("input",{ref:z,type:"file",accept:".csv,.json,.xls,.xlsx",onChange:Ce,style:{display:"none"}}),k.jsx("button",{type:"button",className:"btn-secondary",disabled:v,onClick:()=>{var se;return(se=z.current)==null?void 0:se.click()},children:v?"Importing...":k.jsxs(k.Fragment,{children:[k.jsx(I7,{size:16,strokeWidth:2,style:{marginRight:6,verticalAlign:"middle"}})," Bulk Import (CSV / JSON / XLS)"]})}),e&&k.jsx("button",{type:"button",className:"btn-secondary",disabled:E,onClick:K,children:E?k.jsxs(k.Fragment,{children:[k.jsx(Ic,{})," Seeding..."]}):k.jsxs(k.Fragment,{children:[k.jsx(E7,{size:16,strokeWidth:2,style:{marginRight:6,verticalAlign:"middle"}})," Seed 50 Dummy Students per Dept"]})}),R&&!R.error&&k.jsxs("span",{className:"bulk-ok",children:["Created: ",R.created,", Skipped: ",R.skipped]}),(R==null?void 0:R.error)&&k.jsx("span",{className:"bulk-err",children:R.error})]}),S?k.jsxs("div",{className:"dept-table-page",children:[k.jsxs("div",{className:"dept-table-header",children:[k.jsx("button",{type:"button",className:"btn-back",onClick:()=>b(null),children:" Back to Departments"}),k.jsxs("h3",{className:"dept-table-title",children:[((ue=Im[S])==null?void 0:ue.Icon)&&k.jsx("span",{className:"dept-title-icon",children:rr.createElement(Im[S].Icon,{size:20,strokeWidth:2})}),S,"  Students"]})]}),(ee[S]||[]).length===0?k.jsx("div",{className:"empty-state",children:"No students in this department yet."}):k.jsx("div",{className:"table-wrapper dept-students-table",children:k.jsxs("table",{className:"table-large",children:[k.jsx("thead",{children:k.jsxs("tr",{children:[k.jsx("th",{children:"Student ID"}),k.jsx("th",{children:"Name"}),k.jsx("th",{children:"QR Code Value"}),k.jsx("th",{children:"Actions"})]})}),k.jsx("tbody",{children:(ee[S]||[]).map(se=>k.jsxs("tr",{children:[k.jsx("td",{children:k.jsx("strong",{children:se.studentId})}),k.jsx("td",{children:se.name}),k.jsx("td",{children:se.qrCodeValue||""}),k.jsxs("td",{children:[k.jsx("button",{type:"button",className:"btn-secondary btn-sm",onClick:()=>M(se),children:"Print Card"}),e&&k.jsx("button",{type:"button",className:"btn-small danger",onClick:()=>de(se._id),children:"Delete"})]})]},se._id))})]})})]}):k.jsxs(k.Fragment,{children:[k.jsx("h4",{className:"dept-cards-title",children:"Click a department to view its students"}),f?k.jsx("div",{className:"dept-cards-grid dept-skeleton",children:[1,2,3,4,5,6,7].map(se=>k.jsx("div",{className:"dept-card skeleton-card",style:{pointerEvents:"none"},children:k.jsxs("div",{className:"dept-card-header",style:{background:"#94a3b8"},children:[k.jsx("span",{className:"dept-icon",children:k.jsx(MA,{size:20,strokeWidth:2})}),k.jsxs("div",{className:"dept-info",children:[k.jsx("div",{className:"skeleton",style:{width:"80%",height:"1rem",borderRadius:6}}),k.jsx("div",{className:"skeleton",style:{width:"50%",height:"0.8rem",marginTop:"0.5rem",borderRadius:6}})]})]})},se))}):k.jsx("div",{className:"dept-cards-grid",children:r.map(se=>{const q=Im[se]||{Icon:MA,gradient:"linear-gradient(135deg, #64748b 0%, #475569 100%)"},fe=ee[se]||[],we=T===se;return k.jsx("div",{className:`dept-card dept-card-clickable ${we?"just-added":""}`,style:{"--dept-gradient":q.gradient},onClick:()=>b(se),children:k.jsxs("div",{className:"dept-card-header",children:[k.jsx("span",{className:"dept-icon",children:q.Icon?k.jsx(q.Icon,{size:20,strokeWidth:2}):null}),k.jsxs("div",{className:"dept-info",children:[k.jsx("span",{className:"dept-name",children:se}),k.jsxs("span",{className:"dept-count",children:[fe.length," student",fe.length!==1?"s":""]})]}),k.jsx("span",{className:"dept-chevron",children:""})]})},se)})})]}),N&&k.jsx(b8,{type:"student",data:N,onClose:()=>M(null),autoPrint:!1,playSound:!1})]})}const cce=({activeTab:e})=>{const{addToast:t}=Cl(),{user:r,setUser:n}=l8(),[i,a]=I.useState(!1),[o,c]=I.useState({username:"",password:""}),[f,d]=I.useState(null),h=e||"visitors",[m,v]=I.useState([]),[w,E]=I.useState({from:"",to:"",q:""}),[A,S]=I.useState([]),[b,T]=I.useState({from:"",to:"",studentId:"",department:""}),[_,N]=I.useState([]),[M,R]=I.useState({name:"",department:""}),[P,z]=I.useState(""),[B,re]=I.useState(null),[ee,V]=I.useState(null);I.useRef(null);const[de,pe]=I.useState(null),[K,Ce]=I.useState(!1),[ue,se]=I.useState(!1),[q,fe]=I.useState(!1),[we,G]=I.useState(!1),[le,ne]=I.useState(!1),[ae,he]=I.useState(!1),[ke,De]=I.useState(null),[ce,be]=I.useState(!1),[ze,W]=I.useState([]);I.useRef(null);const He=(r==null?void 0:r.role)!=="security",Ge=Be=>{const{name:Qe,value:_t}=Be.target;c(Rt=>({...Rt,[Qe]:_t}))},et=async Be=>{Be.preventDefault(),d(null),ne(!0);try{const Qe=await fetch(`${Ut}/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(o)}),_t=await Qe.json();if(!Qe.ok)throw new Error(_t.message||"Login failed");const Rt={username:_t.username,role:_t.role||"admin"};a(!0),n(Rt),d({type:"success",message:"Logged in as "+_t.username}),t({message:"Logged in as "+_t.username,type:"success",size:"small"})}catch(Qe){d({type:"error",message:Qe.message||"Login failed"}),t({message:Qe.message||"Login failed",type:"error",size:"small"})}finally{ne(!1)}},Ze=async()=>{Ce(!0);try{const Be=new URLSearchParams;w.from&&Be.append("from",w.from),w.to&&Be.append("to",w.to),w.q&&Be.append("q",w.q);const Qe=await fetch(`${Ut}/visitors?${Be.toString()}`,{credentials:"include"}),_t=await Qe.json();if(!Qe.ok)throw new Error(_t.message||"Failed to load visitors");v(_t)}catch(Be){d({type:"error",message:Be.message||"Failed to load visitors"}),t({message:Be.message||"Failed to load visitors",type:"error",size:"small"})}finally{Ce(!1)}},Ie=()=>{const Be=new URLSearchParams;w.from&&Be.append("from",w.from),w.to&&Be.append("to",w.to),w.q&&Be.append("q",w.q);const Qe=`${Ut}/export/visitors?${Be.toString()}`;window.open(Qe,"_blank"),t({message:"CSV export opened in new tab",type:"success",size:"small"})},rt=async()=>{fe(!0);try{const Be=new URLSearchParams;b.from&&Be.append("from",b.from),b.to&&Be.append("to",b.to),b.studentId&&Be.append("studentId",b.studentId),b.department&&Be.append("department",b.department);const Qe=await fetch(`${Ut}/students/logs/all?${Be.toString()}`,{credentials:"include"}),_t=await Qe.json();if(!Qe.ok)throw new Error(_t.message||"Failed to load logs");S(_t)}catch(Be){d({type:"error",message:Be.message||"Failed to load student logs"}),t({message:Be.message||"Failed to load logs",type:"error",size:"small"})}finally{fe(!1)}},at=async()=>{G(!0);try{const Be=await fetch(`${Ut}/reports/daily`,{credentials:"include"}),Qe=await Be.json();if(!Be.ok)throw new Error(Qe.message||"Failed to load report");pe(Qe)}catch(Be){d({type:"error",message:Be.message||"Failed to load report"}),t({message:Be.message||"Failed to load report",type:"error",size:"small"})}finally{G(!1)}};I.useEffect(()=>{fetch(`${Ut}/auth/me`,{credentials:"include"}).then(Be=>Be.json()).then(Be=>{Be.user&&(a(!0),n(Be.user))}).catch(()=>{})},[n]),I.useEffect(()=>{fetch(`${Ut}/students/departments`,{credentials:"include"}).then(Be=>Be.json()).then(Be=>W(Be.departments||[])).catch(()=>W([]))},[]),I.useEffect(()=>{i&&(h==="visitors"?Ze():h==="studentLogs"?rt():h==="students"||h==="report"&&at())},[i,h]);const Br=Be=>{const{name:Qe,value:_t}=Be.target;E(Rt=>({...Rt,[Qe]:_t}))},$e=async Be=>{if(window.confirm("Delete this visitor record?"))try{const Qe=await fetch(`${Ut}/visitors/${Be}`,{method:"DELETE",credentials:"include"}),_t=await Qe.json();if(!Qe.ok)throw new Error(_t.message||"Delete failed");d({type:"success",message:"Visitor deleted"}),t({message:"Visitor deleted",type:"success",size:"small"}),Ze()}catch(Qe){d({type:"error",message:Qe.message||"Delete failed"}),t({message:Qe.message||"Delete failed",type:"error",size:"small"})}};if(!i)return k.jsxs("div",{className:"admin-login panel",children:[k.jsxs("div",{className:"panel-header",children:[k.jsx("div",{className:"panel-icon",children:k.jsx(u7,{size:20,strokeWidth:2})}),k.jsx("h3",{children:"Admin Login"})]}),k.jsxs("form",{className:"form-large",onSubmit:et,children:[k.jsxs("div",{className:"form-group",children:[k.jsx("label",{children:"Username"}),k.jsx("input",{name:"username",value:o.username,onChange:Ge,className:"input-large",placeholder:"Enter username"})]}),k.jsxs("div",{className:"form-group",children:[k.jsx("label",{children:"Password"}),k.jsx("input",{type:"password",name:"password",value:o.password,onChange:Ge,className:"input-large",placeholder:"Enter password"})]}),k.jsx("button",{type:"submit",className:"btn-primary-wide",disabled:le,children:le?k.jsxs(k.Fragment,{children:[k.jsx(Ic,{})," Signing in..."]}):"Sign In"}),f&&k.jsx("div",{className:f.type==="success"?"status success":"status error",children:f.message})]})]});const Pi=async()=>{try{await fetch(`${Ut}/auth/logout`,{method:"POST",credentials:"include"}),a(!1),n(null),t({message:"Logged out",type:"success",size:"small"})}catch{}};return k.jsxs("div",{className:"admin-panel",children:[k.jsxs("div",{className:"page-header",style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:"0.5rem"},children:[k.jsxs("div",{children:[k.jsx("h2",{children:"Admin Dashboard"}),k.jsxs("span",{className:"page-subtitle",children:["Overview ",r&&` ${r.username} (${r.role||"admin"})`]})]}),k.jsx("button",{type:"button",className:"btn-secondary",onClick:Pi,children:"Log Out"})]}),f&&k.jsx("div",{className:f.type==="success"?"status success":"status error",children:f.message}),h==="visitors"&&k.jsxs("div",{className:"admin-section",children:[k.jsxs("div",{className:"panel-header",children:[k.jsx("div",{className:"panel-icon",children:k.jsx(t8,{size:20,strokeWidth:2})}),k.jsx("h3",{children:"Visitor Logs"})]}),k.jsxs("div",{className:"filters-row",children:[k.jsxs("div",{children:[k.jsx("label",{children:"From"}),k.jsx("input",{type:"date",name:"from",value:w.from,onChange:Br})]}),k.jsxs("div",{children:[k.jsx("label",{children:"To"}),k.jsx("input",{type:"date",name:"to",value:w.to,onChange:Br})]}),k.jsxs("div",{children:[k.jsx("label",{children:"Search (CNIC / Name)"}),k.jsx("input",{name:"q",value:w.q,onChange:Br,placeholder:"Search by CNIC or name"})]}),k.jsx("button",{className:"btn-secondary",onClick:Ze,children:"Apply Filters"}),k.jsx("button",{className:"btn-secondary",onClick:Ie,children:"Export CSV"})]}),K?k.jsx(Ah,{rows:6,cols:8}):k.jsx("div",{className:"table-wrapper",children:k.jsxs("table",{className:"table-large",children:[k.jsx("thead",{children:k.jsxs("tr",{children:[k.jsx("th",{children:"Token"}),k.jsx("th",{children:"Name"}),k.jsx("th",{children:"Type"}),k.jsx("th",{children:"CNIC"}),k.jsx("th",{children:"Phone"}),k.jsx("th",{children:"Purpose"}),k.jsx("th",{children:"Person To Meet"}),k.jsx("th",{children:"Check-In"}),k.jsx("th",{children:"Check-Out"}),k.jsx("th",{children:"Actions"})]})}),k.jsx("tbody",{children:m.map(Be=>k.jsxs("tr",{children:[k.jsx("td",{children:k.jsx("span",{className:"token-badge",children:Be.tokenNumber||""})}),k.jsx("td",{children:Be.name}),k.jsx("td",{children:k.jsx("span",{className:"visitor-type-badge",children:Be.visitorType||"Guest"})}),k.jsx("td",{children:Be.cnic}),k.jsx("td",{children:Be.phone}),k.jsx("td",{children:Be.purpose}),k.jsx("td",{children:Be.personToMeet}),k.jsx("td",{children:Be.checkInTime?new Date(Be.checkInTime).toLocaleString():""}),k.jsx("td",{children:Be.checkOutTime?new Date(Be.checkOutTime).toLocaleString():""}),k.jsx("td",{children:He&&k.jsx("button",{className:"btn-small danger",onClick:()=>$e(Be._id),children:"Delete"})})]},Be._id))})]})})]}),h==="students"&&k.jsx(lce,{isAdmin:He}),h==="studentLogs"&&k.jsxs("div",{className:"admin-section",children:[k.jsxs("div",{className:"panel-header",children:[k.jsx("div",{className:"panel-icon",children:k.jsx(e8,{size:20,strokeWidth:2})}),k.jsx("h3",{children:"Student Entry Logs"})]}),k.jsxs("div",{className:"filters-row",style:{marginBottom:"1rem"},children:[k.jsxs("div",{children:[k.jsx("label",{children:"From"}),k.jsx("input",{type:"date",value:b.from,onChange:Be=>T(Qe=>({...Qe,from:Be.target.value}))})]}),k.jsxs("div",{children:[k.jsx("label",{children:"To"}),k.jsx("input",{type:"date",value:b.to,onChange:Be=>T(Qe=>({...Qe,to:Be.target.value}))})]}),k.jsxs("div",{children:[k.jsx("label",{children:"Department"}),k.jsxs("select",{value:b.department,onChange:Be=>T(Qe=>({...Qe,department:Be.target.value})),children:[k.jsx("option",{value:"",children:"All"}),ze.map(Be=>k.jsx("option",{value:Be,children:Be},Be))]})]}),k.jsxs("div",{children:[k.jsx("label",{children:"Student ID"}),k.jsx("input",{type:"text",value:b.studentId,onChange:Be=>T(Qe=>({...Qe,studentId:Be.target.value})),placeholder:"Filter by ID"})]}),k.jsx("button",{className:"btn-secondary",onClick:rt,children:"Apply"})]}),q?k.jsx(Ah,{rows:6,cols:4}):k.jsx("div",{className:"table-wrapper",children:k.jsxs("table",{className:"table-large",children:[k.jsx("thead",{children:k.jsxs("tr",{children:[k.jsx("th",{children:"Student ID"}),k.jsx("th",{children:"Name"}),k.jsx("th",{children:"Department"}),k.jsx("th",{children:"Entry Time"})]})}),k.jsx("tbody",{children:A.map(Be=>{var Qe,_t,Rt;return k.jsxs("tr",{children:[k.jsx("td",{children:(Qe=Be.student)==null?void 0:Qe.studentId}),k.jsx("td",{children:(_t=Be.student)==null?void 0:_t.name}),k.jsx("td",{children:k.jsx("span",{className:"dept-badge",children:(Rt=Be.student)==null?void 0:Rt.department})}),k.jsx("td",{children:Be.entryTime?new Date(Be.entryTime).toLocaleString():""})]},Be._id)})})]})})]}),h==="addFine"&&k.jsx(iee,{}),h==="finesHistory"&&k.jsx(aee,{}),h==="report"&&k.jsxs("div",{className:"admin-section",children:[k.jsxs("div",{className:"panel-header",children:[k.jsx("div",{className:"panel-icon",children:k.jsx(n8,{size:20,strokeWidth:2})}),k.jsx("h3",{children:"Today's Summary"})]}),we?k.jsx(sF,{count:3}):de?k.jsxs("div",{className:"report-cards",children:[k.jsxs("div",{className:"report-card",children:[k.jsx("span",{className:"label",children:"Date"}),k.jsx("span",{className:"value",children:de.date})]}),k.jsxs("div",{className:"report-card",children:[k.jsx("span",{className:"label",children:"Total Visitors"}),k.jsx("span",{className:"value",children:de.visitorCount})]}),k.jsxs("div",{className:"report-card",children:[k.jsx("span",{className:"label",children:"Student Entries"}),k.jsx("span",{className:"value",children:de.studentEntryCount})]})]}):k.jsx("button",{className:"btn-secondary",onClick:at,disabled:we,children:we?"Loading...":"Load Today's Report"})]})]})},uce=[{id:"visitors",label:"Visitor Logs",Icon:t8},{id:"students",label:"Register Students",Icon:R2},{id:"studentLogs",label:"Student Entry Logs",Icon:e8},{id:"report",label:"Daily Report",Icon:n8},{id:"addFine",label:"Add Fine",Icon:r8},{id:"finesHistory",label:"Fines History",Icon:Y1}],fce=()=>{const[e,t]=I.useState("reception"),[r,n]=I.useState(!1),[i,a]=I.useState(!1),{user:o}=l8(),c=(o==null?void 0:o.role)!=="security";return I.useEffect(()=>{document.body.classList.toggle("dark-mode",i)},[i]),k.jsxs("div",{className:`app-layout ${i?"dark":""}`,children:[k.jsxs("aside",{className:`sidebar ${r?"collapsed":""}`,children:[k.jsxs("div",{className:"sidebar-brand",children:[k.jsx(GM,{className:"brand-icon",size:28,strokeWidth:2}),!r&&k.jsx("span",{className:"brand-text",children:"IHS Visitor Management"})]}),k.jsxs("div",{className:"sidebar-user",children:[k.jsx("div",{className:"user-avatar",children:"R"}),!r&&k.jsxs("div",{className:"user-info",children:[k.jsx("span",{className:"user-name",children:"Reception"}),k.jsx("span",{className:"user-role",children:"Entry Management"}),k.jsx("span",{className:"user-status",children:" Active"})]})]}),k.jsxs("nav",{className:"sidebar-nav",children:[k.jsxs("button",{className:`nav-item ${e==="reception"?"active":""}`,onClick:()=>t("reception"),children:[k.jsx(l7,{className:"nav-icon",size:20,strokeWidth:2}),!r&&k.jsx("span",{children:"Reception"})]}),uce.filter(f=>f.id!=="addFine"||c).map(f=>k.jsxs("button",{className:`nav-item ${e===f.id?"active":""}`,onClick:()=>t(f.id),children:[k.jsx(f.Icon,{className:"nav-icon",size:20,strokeWidth:2}),!r&&k.jsx("span",{children:f.label})]},f.id))]})]}),k.jsxs("div",{className:"main-wrapper",children:[k.jsxs("header",{className:"top-bar",children:[k.jsx("button",{className:"top-bar-toggle",onClick:()=>n(f=>!f),"aria-label":"Toggle sidebar",children:k.jsx(p7,{size:20,strokeWidth:2})}),k.jsxs("div",{className:"top-bar-title",children:[k.jsx("h1",{children:"Institute of Health Sciences"}),k.jsx("p",{children:"Visitor & Student Entry Management System"})]}),k.jsx("div",{className:"top-bar-actions",children:k.jsx("button",{className:"top-bar-btn",onClick:()=>a(f=>!f),title:i?"Light mode":"Dark mode",children:i?k.jsx(_7,{size:18,strokeWidth:2}):k.jsx(m7,{size:18,strokeWidth:2})})})]}),k.jsx("main",{className:"main-content",children:k.jsx(B7,{children:k.jsx(L7,{children:e==="reception"?k.jsx(ree,{}):k.jsx(cce,{activeTab:e})})})})]})]})},dce=()=>k.jsx(j7,{children:k.jsx(fce,{})}),hce=()=>k.jsx(dce,{});Nm.createRoot(document.getElementById("root")).render(k.jsx(rr.StrictMode,{children:k.jsx(hce,{})}));
